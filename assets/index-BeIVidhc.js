const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-C8t41uN7.js","assets/vendor-CSmKP8en.js","assets/ui-CI4uNW0_.js","assets/utils-BMuL4SXP.js","assets/supabase-7HAHYOsO.js"])))=>i.map(i=>d[i]);
import{j as c,V as cy,R as ly,A as uy,C as dy,T as fy,D as hy,P as LC,c as Ui,a as ll,u as Wr,b as ah,d as cr,e as rt,f as Sa,g as Fp,h as Bp,S as py,i as FC,k as $p,l as Up,m as my,n as ih,o as ul,p as di,q as xu,O as qp,r as Vp,s as zp,t as Hp,v as Wp,w as gy,x as vy,y as xy,z as yy,I as BC,B as by,E as wy,F as $C,G as _y,H as UC,L as Cy,J as Ny,K as qC,M as VC,N as Sy,Q as zC,U as HC,W as WC,_ as GC,X as YC,Y as Oc,Z as KC,$ as XC,a0 as QC,a1 as ZC,a2 as JC,a3 as eN,a4 as Gp,a5 as Ey,a6 as Ay,a7 as jy,a8 as Py,a9 as Dy,aa as Iy,ab as tN,ac as Ty,ad as Oy,ae as ky,af as rN,ag as Yp,ah as nN,ai as aN,aj as iN,ak as Vd,al as oN,am as sN,an as cN,ao as lN}from"./ui-CI4uNW0_.js";import{a as Kp,r as w,R as se,b as Xp,c as oh,e as uN}from"./vendor-CSmKP8en.js";import{c as sn,t as dN,f as pt,b as L0,a as Kl,d as fN,e as Xl,i as My,g as hN,s as yu,h as Wo,p as Go,j as Ry,k as sh,l as ch,m as Ly,n as Fy,o as pN,q as Ro,r as co,u as mN,v as gN,w as Lo,x as Yo,y as vN,z as Mn,A as Pv,B as Es,C as li,D as kc,E as Dt,F as pu,G as R1,H as By,I as $y,J as L1,K as ro,L as no,M as Fo,N as F1,O as Pi,P as Bo,Q as Zc,R as xN,S as Uy,T as yN,U as B1,V as gf,W as vf,X as xf,Y as bN,Z as Qp,_ as wN,$ as qy,a0 as _N,a1 as CN,a2 as bu,a3 as Vy,a4 as If,a5 as Tf,a6 as Of,a7 as kf,a8 as Dv,a9 as Iv,aa as NN,ab as SN,ac as Tv,ad as EN}from"./utils-BMuL4SXP.js";import{c as AN,_ as $1}from"./supabase-7HAHYOsO.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();var zy,Ov=Kp;zy=Ov.createRoot,Ov.hydrateRoot;const jN=1,PN=1e6;let F0=0;function DN(){return F0=(F0+1)%Number.MAX_SAFE_INTEGER,F0.toString()}const B0=new Map,kv=r=>{if(B0.has(r))return;const e=setTimeout(()=>{B0.delete(r),mu({type:"REMOVE_TOAST",toastId:r})},PN);B0.set(r,e)},IN=(r,e)=>{switch(e.type){case"ADD_TOAST":return{...r,toasts:[e.toast,...r.toasts].slice(0,jN)};case"UPDATE_TOAST":return{...r,toasts:r.toasts.map(t=>t.id===e.toast.id?{...t,...e.toast}:t)};case"DISMISS_TOAST":{const{toastId:t}=e;return t?kv(t):r.toasts.forEach(n=>{kv(n.id)}),{...r,toasts:r.toasts.map(n=>n.id===t||t===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return e.toastId===void 0?{...r,toasts:[]}:{...r,toasts:r.toasts.filter(t=>t.id!==e.toastId)}}},yf=[];let bf={toasts:[]};function mu(r){bf=IN(bf,r),yf.forEach(e=>{e(bf)})}function Zp({...r}){const e=DN(),t=a=>mu({type:"UPDATE_TOAST",toast:{...a,id:e}}),n=()=>mu({type:"DISMISS_TOAST",toastId:e});return mu({type:"ADD_TOAST",toast:{...r,id:e,open:!0,onOpenChange:a=>{a||n()}}}),{id:e,dismiss:n,update:t}}function Lt(){const[r,e]=w.useState(bf);return w.useEffect(()=>(yf.push(e),()=>{const t=yf.indexOf(e);t>-1&&yf.splice(t,1)}),[r]),{...r,toast:Zp,dismiss:t=>mu({type:"DISMISS_TOAST",toastId:t})}}const Mv=r=>typeof r=="boolean"?`${r}`:r===0?"0":r,Rv=sn,Tu=(r,e)=>t=>{var n;if(e?.variants==null)return Rv(r,t?.class,t?.className);const{variants:a,defaultVariants:i}=e,o=Object.keys(a).map(u=>{const d=t?.[u],f=i?.[u];if(d===null)return null;const h=Mv(d)||Mv(f);return a[u][h]}),s=t&&Object.entries(t).reduce((u,d)=>{let[f,h]=d;return h===void 0||(u[f]=h),u},{}),l=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((u,d)=>{let{class:f,className:h,...p}=d;return Object.entries(p).every(g=>{let[v,b]=g;return Array.isArray(b)?b.includes({...i,...s}[v]):{...i,...s}[v]===b})?[...u,f,h]:u},[]);return Rv(r,o,l,t?.class,t?.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TN=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Hy=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ON={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=w.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:o,...s},l)=>w.createElement("svg",{ref:l,...ON,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:Hy("lucide",a),...s},[...o.map(([u,d])=>w.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(r,e)=>{const t=w.forwardRef(({className:n,...a},i)=>w.createElement(kN,{ref:i,iconNode:e,className:Hy(`lucide-${TN(r)}`,n),...a}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=tt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=tt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=tt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=tt("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=tt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yy=tt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U1=tt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const es=tt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lh=tt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MN=tt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=tt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jp=tt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RN=tt("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=tt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=tt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LN=tt("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=tt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q1=tt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const em=tt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=tt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=tt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $N=tt("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xy=tt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wu=tt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V1=tt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UN=tt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=tt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qN=tt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VN=tt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=tt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=tt("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mi=tt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zN=tt("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dr=tt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=tt("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uh=tt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=tt("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WN=tt("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=tt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=tt("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dh=tt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=tt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dl=tt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=tt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zy=tt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=tt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=tt("SwitchCamera",[["path",{d:"M11 19H4a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h5",key:"mtk2lu"}],["path",{d:"M13 5h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-5",key:"120jsl"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"m18 22-3-3 3-3",key:"kgdoj7"}],["path",{d:"m6 2 3 3-3 3",key:"1fnbkv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YN=tt("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jy=tt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=tt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=tt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=tt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=tt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $o=tt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eb=tt("Warehouse",[["path",{d:"M22 8.35V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8.35A2 2 0 0 1 3.26 6.5l8-3.2a2 2 0 0 1 1.48 0l8 3.2A2 2 0 0 1 22 8.35Z",key:"gksnxg"}],["path",{d:"M6 18h12",key:"9pbo8z"}],["path",{d:"M6 14h12",key:"4cwo0f"}],["rect",{width:"12",height:"12",x:"6",y:"10",key:"apd30q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QN=tt("Webhook",[["path",{d:"M18 16.98h-5.99c-1.1 0-1.95.94-2.48 1.9A4 4 0 0 1 2 17c.01-.7.2-1.4.57-2",key:"q3hayz"}],["path",{d:"m6 17 3.13-5.78c.53-.97.1-2.18-.5-3.1a4 4 0 1 1 6.89-4.06",key:"1go1hn"}],["path",{d:"m12 6 3.13 5.73C15.66 12.7 16.9 13 18 13a4 4 0 0 1 0 8",key:"qlwsc0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ko=tt("Weight",[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lo=tt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Le(...r){return dN(sn(r))}const ZN=LC,tb=w.forwardRef(({className:r,...e},t)=>c.jsx(cy,{ref:t,className:Le("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",r),...e}));tb.displayName=cy.displayName;const JN=Tu("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),rb=w.forwardRef(({className:r,variant:e,...t},n)=>c.jsx(ly,{ref:n,className:Le(JN({variant:e}),r),...t}));rb.displayName=ly.displayName;const eS=w.forwardRef(({className:r,...e},t)=>c.jsx(uy,{ref:t,className:Le("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",r),...e}));eS.displayName=uy.displayName;const nb=w.forwardRef(({className:r,...e},t)=>c.jsx(dy,{ref:t,className:Le("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",r),"toast-close":"",...e,children:c.jsx(lo,{className:"h-4 w-4"})}));nb.displayName=dy.displayName;const ab=w.forwardRef(({className:r,...e},t)=>c.jsx(fy,{ref:t,className:Le("text-sm font-semibold",r),...e}));ab.displayName=fy.displayName;const ib=w.forwardRef(({className:r,...e},t)=>c.jsx(hy,{ref:t,className:Le("text-sm opacity-90",r),...e}));ib.displayName=hy.displayName;function tS(){const{toasts:r}=Lt();return c.jsxs(ZN,{children:[r.map(function({id:e,title:t,description:n,action:a,...i}){return c.jsxs(rb,{...i,children:[c.jsxs("div",{className:"grid gap-1",children:[t&&c.jsx(ab,{children:t}),n&&c.jsx(ib,{children:n})]}),a,c.jsx(nb,{})]},e)}),c.jsx(tb,{})]})}var Fv=["light","dark"],rS="(prefers-color-scheme: dark)",nS=w.createContext(void 0),aS={setTheme:r=>{},themes:[]},iS=()=>{var r;return(r=w.useContext(nS))!=null?r:aS};w.memo(({forcedTheme:r,storageKey:e,attribute:t,enableSystem:n,enableColorScheme:a,defaultTheme:i,value:o,attrs:s,nonce:l})=>{let u=i==="system",d=t==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${s.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${t}',s='setAttribute';`,f=a?Fv.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(g,v=!1,b=!0)=>{let y=o?o[g]:g,C=v?g+"|| ''":`'${y}'`,S="";return a&&b&&!v&&Fv.includes(g)&&(S+=`d.style.colorScheme = '${g}';`),t==="class"?v||y?S+=`c.add(${C})`:S+="null":y&&(S+=`d[s](n,${C})`),S},p=r?`!function(){${d}${h(r)}}()`:n?`!function(){try{${d}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${u})){var t='${rS}',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}${u?"":"else{"+h(i,!1,!1)+"}"}${f}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${e}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${h(o?"x[e]":"e",!0)}}else{${h(i,!1,!1)};}${f}}catch(t){}}();`;return w.createElement("script",{nonce:l,dangerouslySetInnerHTML:{__html:p}})});var oS=r=>{switch(r){case"success":return lS;case"info":return dS;case"warning":return uS;case"error":return fS;default:return null}},sS=Array(12).fill(0),cS=({visible:r})=>se.createElement("div",{className:"sonner-loading-wrapper","data-visible":r},se.createElement("div",{className:"sonner-spinner"},sS.map((e,t)=>se.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${t}`})))),lS=se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},se.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),uS=se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},se.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),dS=se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},se.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),fS=se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},se.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),hS=()=>{let[r,e]=se.useState(document.hidden);return se.useEffect(()=>{let t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),r},z1=1,pS=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...a}=e,i=typeof e?.id=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:z1++,o=this.toasts.find(l=>l.id===i),s=e.dismissible===void 0?!0:e.dismissible;return o?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...e,id:i,title:n}),{...l,...e,id:i,dismissible:s,title:n}):l):this.addToast({title:n,...a,dismissible:s,id:i}),i},this.dismiss=e=>(e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let a=e instanceof Promise?e:e(),i=n!==void 0;return a.then(async o=>{if(gS(o)&&!o.ok){i=!1;let s=typeof t.error=="function"?await t.error(`HTTP error! status: ${o.status}`):t.error,l=typeof t.description=="function"?await t.description(`HTTP error! status: ${o.status}`):t.description;this.create({id:n,type:"error",message:s,description:l})}else if(t.success!==void 0){i=!1;let s=typeof t.success=="function"?await t.success(o):t.success,l=typeof t.description=="function"?await t.description(o):t.description;this.create({id:n,type:"success",message:s,description:l})}}).catch(async o=>{if(t.error!==void 0){i=!1;let s=typeof t.error=="function"?await t.error(o):t.error,l=typeof t.description=="function"?await t.description(o):t.description;this.create({id:n,type:"error",message:s,description:l})}}).finally(()=>{var o;i&&(this.dismiss(n),n=void 0),(o=t.finally)==null||o.call(t)}),n},this.custom=(e,t)=>{let n=t?.id||z1++;return this.create({jsx:e(n),id:n,...t}),n},this.subscribers=[],this.toasts=[]}},ya=new pS,mS=(r,e)=>{let t=e?.id||z1++;return ya.addToast({title:r,...e,id:t}),t},gS=r=>r&&typeof r=="object"&&"ok"in r&&typeof r.ok=="boolean"&&"status"in r&&typeof r.status=="number",vS=mS,xS=()=>ya.toasts;Object.assign(vS,{success:ya.success,info:ya.info,warning:ya.warning,error:ya.error,custom:ya.custom,message:ya.message,promise:ya.promise,dismiss:ya.dismiss,loading:ya.loading},{getHistory:xS});function yS(r,{insertAt:e}={}){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e==="top"&&t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n),n.styleSheet?n.styleSheet.cssText=r:n.appendChild(document.createTextNode(r))}yS(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}:where([data-sonner-toaster][data-x-position="right"]){right:max(var(--offset),env(safe-area-inset-right))}:where([data-sonner-toaster][data-x-position="left"]){left:max(var(--offset),env(safe-area-inset-left))}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:max(var(--offset),env(safe-area-inset-top))}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:max(var(--offset),env(safe-area-inset-bottom))}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:0;right:0;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function zd(r){return r.label!==void 0}var bS=3,wS="32px",_S=4e3,CS=356,NS=14,SS=20,ES=200;function AS(...r){return r.filter(Boolean).join(" ")}var jS=r=>{var e,t,n,a,i,o,s,l,u,d;let{invert:f,toast:h,unstyled:p,interacting:g,setHeights:v,visibleToasts:b,heights:y,index:C,toasts:S,expanded:j,removeToast:D,defaultRichColors:F,closeButton:M,style:T,cancelButtonStyle:q,actionButtonStyle:J,className:O="",descriptionClassName:k="",duration:H,position:X,gap:ce,loadingIcon:Q,expandByDefault:re,classNames:G,icons:Y,closeButtonAriaLabel:ge="Close toast",pauseWhenPageIsHidden:ye,cn:A}=r,[$,V]=se.useState(!1),[K,ee]=se.useState(!1),[oe,fe]=se.useState(!1),[ve,Ie]=se.useState(!1),[Te,Be]=se.useState(0),[$e,ct]=se.useState(0),we=se.useRef(null),te=se.useRef(null),vt=C===0,Ze=C+1<=b,je=h.type,Oe=h.dismissible!==!1,Ve=h.className||"",Ue=h.descriptionClassName||"",et=se.useMemo(()=>y.findIndex(Ye=>Ye.toastId===h.id)||0,[y,h.id]),mt=se.useMemo(()=>{var Ye;return(Ye=h.closeButton)!=null?Ye:M},[h.closeButton,M]),bt=se.useMemo(()=>h.duration||H||_S,[h.duration,H]),St=se.useRef(0),At=se.useRef(0),Gt=se.useRef(0),it=se.useRef(null),[jt,ze]=X.split("-"),Qr=se.useMemo(()=>y.reduce((Ye,Ut,dt)=>dt>=et?Ye:Ye+Ut.height,0),[y,et]),Mt=hS(),fa=h.invert||f,Yt=je==="loading";At.current=se.useMemo(()=>et*ce+Qr,[et,Qr]),se.useEffect(()=>{V(!0)},[]),se.useLayoutEffect(()=>{if(!$)return;let Ye=te.current,Ut=Ye.style.height;Ye.style.height="auto";let dt=Ye.getBoundingClientRect().height;Ye.style.height=Ut,ct(dt),v(Er=>Er.find(Fr=>Fr.toastId===h.id)?Er.map(Fr=>Fr.toastId===h.id?{...Fr,height:dt}:Fr):[{toastId:h.id,height:dt,position:h.position},...Er])},[$,h.title,h.description,v,h.id]);let $t=se.useCallback(()=>{ee(!0),Be(At.current),v(Ye=>Ye.filter(Ut=>Ut.toastId!==h.id)),setTimeout(()=>{D(h)},ES)},[h,D,v,At]);se.useEffect(()=>{if(h.promise&&je==="loading"||h.duration===1/0||h.type==="loading")return;let Ye,Ut=bt;return j||g||ye&&Mt?(()=>{if(Gt.current<St.current){let dt=new Date().getTime()-St.current;Ut=Ut-dt}Gt.current=new Date().getTime()})():Ut!==1/0&&(St.current=new Date().getTime(),Ye=setTimeout(()=>{var dt;(dt=h.onAutoClose)==null||dt.call(h,h),$t()},Ut)),()=>clearTimeout(Ye)},[j,g,re,h,bt,$t,h.promise,je,ye,Mt]),se.useEffect(()=>{let Ye=te.current;if(Ye){let Ut=Ye.getBoundingClientRect().height;return ct(Ut),v(dt=>[{toastId:h.id,height:Ut,position:h.position},...dt]),()=>v(dt=>dt.filter(Er=>Er.toastId!==h.id))}},[v,h.id]),se.useEffect(()=>{h.delete&&$t()},[$t,h.delete]);function Aa(){return Y!=null&&Y.loading?se.createElement("div",{className:"sonner-loader","data-visible":je==="loading"},Y.loading):Q?se.createElement("div",{className:"sonner-loader","data-visible":je==="loading"},Q):se.createElement(cS,{visible:je==="loading"})}return se.createElement("li",{"aria-live":h.important?"assertive":"polite","aria-atomic":"true",role:"status",tabIndex:0,ref:te,className:A(O,Ve,G?.toast,(e=h?.classNames)==null?void 0:e.toast,G?.default,G?.[je],(t=h?.classNames)==null?void 0:t[je]),"data-sonner-toast":"","data-rich-colors":(n=h.richColors)!=null?n:F,"data-styled":!(h.jsx||h.unstyled||p),"data-mounted":$,"data-promise":!!h.promise,"data-removed":K,"data-visible":Ze,"data-y-position":jt,"data-x-position":ze,"data-index":C,"data-front":vt,"data-swiping":oe,"data-dismissible":Oe,"data-type":je,"data-invert":fa,"data-swipe-out":ve,"data-expanded":!!(j||re&&$),style:{"--index":C,"--toasts-before":C,"--z-index":S.length-C,"--offset":`${K?Te:At.current}px`,"--initial-height":re?"auto":`${$e}px`,...T,...h.style},onPointerDown:Ye=>{Yt||!Oe||(we.current=new Date,Be(At.current),Ye.target.setPointerCapture(Ye.pointerId),Ye.target.tagName!=="BUTTON"&&(fe(!0),it.current={x:Ye.clientX,y:Ye.clientY}))},onPointerUp:()=>{var Ye,Ut,dt,Er;if(ve||!Oe)return;it.current=null;let Fr=Number(((Ye=te.current)==null?void 0:Ye.style.getPropertyValue("--swipe-amount").replace("px",""))||0),lr=new Date().getTime()-((Ut=we.current)==null?void 0:Ut.getTime()),gt=Math.abs(Fr)/lr;if(Math.abs(Fr)>=SS||gt>.11){Be(At.current),(dt=h.onDismiss)==null||dt.call(h,h),$t(),Ie(!0);return}(Er=te.current)==null||Er.style.setProperty("--swipe-amount","0px"),fe(!1)},onPointerMove:Ye=>{var Ut;if(!it.current||!Oe)return;let dt=Ye.clientY-it.current.y,Er=Ye.clientX-it.current.x,Fr=(jt==="top"?Math.min:Math.max)(0,dt),lr=Ye.pointerType==="touch"?10:2;Math.abs(Fr)>lr?(Ut=te.current)==null||Ut.style.setProperty("--swipe-amount",`${dt}px`):Math.abs(Er)>lr&&(it.current=null)}},mt&&!h.jsx?se.createElement("button",{"aria-label":ge,"data-disabled":Yt,"data-close-button":!0,onClick:Yt||!Oe?()=>{}:()=>{var Ye;$t(),(Ye=h.onDismiss)==null||Ye.call(h,h)},className:A(G?.closeButton,(a=h?.classNames)==null?void 0:a.closeButton)},se.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},se.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),se.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"}))):null,h.jsx||se.isValidElement(h.title)?h.jsx||h.title:se.createElement(se.Fragment,null,je||h.icon||h.promise?se.createElement("div",{"data-icon":"",className:A(G?.icon,(i=h?.classNames)==null?void 0:i.icon)},h.promise||h.type==="loading"&&!h.icon?h.icon||Aa():null,h.type!=="loading"?h.icon||Y?.[je]||oS(je):null):null,se.createElement("div",{"data-content":"",className:A(G?.content,(o=h?.classNames)==null?void 0:o.content)},se.createElement("div",{"data-title":"",className:A(G?.title,(s=h?.classNames)==null?void 0:s.title)},h.title),h.description?se.createElement("div",{"data-description":"",className:A(k,Ue,G?.description,(l=h?.classNames)==null?void 0:l.description)},h.description):null),se.isValidElement(h.cancel)?h.cancel:h.cancel&&zd(h.cancel)?se.createElement("button",{"data-button":!0,"data-cancel":!0,style:h.cancelButtonStyle||q,onClick:Ye=>{var Ut,dt;zd(h.cancel)&&Oe&&((dt=(Ut=h.cancel).onClick)==null||dt.call(Ut,Ye),$t())},className:A(G?.cancelButton,(u=h?.classNames)==null?void 0:u.cancelButton)},h.cancel.label):null,se.isValidElement(h.action)?h.action:h.action&&zd(h.action)?se.createElement("button",{"data-button":!0,"data-action":!0,style:h.actionButtonStyle||J,onClick:Ye=>{var Ut,dt;zd(h.action)&&(Ye.defaultPrevented||((dt=(Ut=h.action).onClick)==null||dt.call(Ut,Ye),$t()))},className:A(G?.actionButton,(d=h?.classNames)==null?void 0:d.actionButton)},h.action.label):null))};function Bv(){if(typeof window>"u"||typeof document>"u")return"ltr";let r=document.documentElement.getAttribute("dir");return r==="auto"||!r?window.getComputedStyle(document.documentElement).direction:r}var PS=r=>{let{invert:e,position:t="bottom-right",hotkey:n=["altKey","KeyT"],expand:a,closeButton:i,className:o,offset:s,theme:l="light",richColors:u,duration:d,style:f,visibleToasts:h=bS,toastOptions:p,dir:g=Bv(),gap:v=NS,loadingIcon:b,icons:y,containerAriaLabel:C="Notifications",pauseWhenPageIsHidden:S,cn:j=AS}=r,[D,F]=se.useState([]),M=se.useMemo(()=>Array.from(new Set([t].concat(D.filter(ye=>ye.position).map(ye=>ye.position)))),[D,t]),[T,q]=se.useState([]),[J,O]=se.useState(!1),[k,H]=se.useState(!1),[X,ce]=se.useState(l!=="system"?l:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),Q=se.useRef(null),re=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),G=se.useRef(null),Y=se.useRef(!1),ge=se.useCallback(ye=>{var A;(A=D.find($=>$.id===ye.id))!=null&&A.delete||ya.dismiss(ye.id),F($=>$.filter(({id:V})=>V!==ye.id))},[D]);return se.useEffect(()=>ya.subscribe(ye=>{if(ye.dismiss){F(A=>A.map($=>$.id===ye.id?{...$,delete:!0}:$));return}setTimeout(()=>{Xp.flushSync(()=>{F(A=>{let $=A.findIndex(V=>V.id===ye.id);return $!==-1?[...A.slice(0,$),{...A[$],...ye},...A.slice($+1)]:[ye,...A]})})})}),[]),se.useEffect(()=>{if(l!=="system"){ce(l);return}l==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?ce("dark"):ce("light")),typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",({matches:ye})=>{ce(ye?"dark":"light")})},[l]),se.useEffect(()=>{D.length<=1&&O(!1)},[D]),se.useEffect(()=>{let ye=A=>{var $,V;n.every(K=>A[K]||A.code===K)&&(O(!0),($=Q.current)==null||$.focus()),A.code==="Escape"&&(document.activeElement===Q.current||(V=Q.current)!=null&&V.contains(document.activeElement))&&O(!1)};return document.addEventListener("keydown",ye),()=>document.removeEventListener("keydown",ye)},[n]),se.useEffect(()=>{if(Q.current)return()=>{G.current&&(G.current.focus({preventScroll:!0}),G.current=null,Y.current=!1)}},[Q.current]),D.length?se.createElement("section",{"aria-label":`${C} ${re}`,tabIndex:-1},M.map((ye,A)=>{var $;let[V,K]=ye.split("-");return se.createElement("ol",{key:ye,dir:g==="auto"?Bv():g,tabIndex:-1,ref:Q,className:o,"data-sonner-toaster":!0,"data-theme":X,"data-y-position":V,"data-x-position":K,style:{"--front-toast-height":`${(($=T[0])==null?void 0:$.height)||0}px`,"--offset":typeof s=="number"?`${s}px`:s||wS,"--width":`${CS}px`,"--gap":`${v}px`,...f},onBlur:ee=>{Y.current&&!ee.currentTarget.contains(ee.relatedTarget)&&(Y.current=!1,G.current&&(G.current.focus({preventScroll:!0}),G.current=null))},onFocus:ee=>{ee.target instanceof HTMLElement&&ee.target.dataset.dismissible==="false"||Y.current||(Y.current=!0,G.current=ee.relatedTarget)},onMouseEnter:()=>O(!0),onMouseMove:()=>O(!0),onMouseLeave:()=>{k||O(!1)},onPointerDown:ee=>{ee.target instanceof HTMLElement&&ee.target.dataset.dismissible==="false"||H(!0)},onPointerUp:()=>H(!1)},D.filter(ee=>!ee.position&&A===0||ee.position===ye).map((ee,oe)=>{var fe,ve;return se.createElement(jS,{key:ee.id,icons:y,index:oe,toast:ee,defaultRichColors:u,duration:(fe=p?.duration)!=null?fe:d,className:p?.className,descriptionClassName:p?.descriptionClassName,invert:e,visibleToasts:h,closeButton:(ve=p?.closeButton)!=null?ve:i,interacting:k,position:ye,style:p?.style,unstyled:p?.unstyled,classNames:p?.classNames,cancelButtonStyle:p?.cancelButtonStyle,actionButtonStyle:p?.actionButtonStyle,removeToast:ge,toasts:D.filter(Ie=>Ie.position==ee.position),heights:T.filter(Ie=>Ie.position==ee.position),setHeights:q,expandByDefault:a,gap:v,loadingIcon:b,expanded:J,pauseWhenPageIsHidden:S,cn:j})}))})):null};const DS=({...r})=>{const{theme:e="system"}=iS();return c.jsx(PS,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...r})};var[hh,aH]=Ui("Tooltip",[ll]),nm=ll(),ob="TooltipProvider",IS=700,$v="tooltip.open",[TS,sb]=hh(ob),cb=r=>{const{__scopeTooltip:e,delayDuration:t=IS,skipDelayDuration:n=300,disableHoverableContent:a=!1,children:i}=r,[o,s]=w.useState(!0),l=w.useRef(!1),u=w.useRef(0);return w.useEffect(()=>{const d=u.current;return()=>window.clearTimeout(d)},[]),c.jsx(TS,{scope:e,isOpenDelayed:o,delayDuration:t,onOpen:w.useCallback(()=>{window.clearTimeout(u.current),s(!1)},[]),onClose:w.useCallback(()=>{window.clearTimeout(u.current),u.current=window.setTimeout(()=>s(!0),n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:w.useCallback(d=>{l.current=d},[]),disableHoverableContent:a,children:i})};cb.displayName=ob;var lb="Tooltip",[iH,ph]=hh(lb),H1="TooltipTrigger",OS=w.forwardRef((r,e)=>{const{__scopeTooltip:t,...n}=r,a=ph(H1,t),i=sb(H1,t),o=nm(t),s=w.useRef(null),l=Wr(e,s,a.onTriggerChange),u=w.useRef(!1),d=w.useRef(!1),f=w.useCallback(()=>u.current=!1,[]);return w.useEffect(()=>()=>document.removeEventListener("pointerup",f),[f]),c.jsx(ah,{asChild:!0,...o,children:c.jsx(cr.button,{"aria-describedby":a.open?a.contentId:void 0,"data-state":a.stateAttribute,...n,ref:l,onPointerMove:rt(r.onPointerMove,h=>{h.pointerType!=="touch"&&!d.current&&!i.isPointerInTransitRef.current&&(a.onTriggerEnter(),d.current=!0)}),onPointerLeave:rt(r.onPointerLeave,()=>{a.onTriggerLeave(),d.current=!1}),onPointerDown:rt(r.onPointerDown,()=>{u.current=!0,document.addEventListener("pointerup",f,{once:!0})}),onFocus:rt(r.onFocus,()=>{u.current||a.onOpen()}),onBlur:rt(r.onBlur,a.onClose),onClick:rt(r.onClick,a.onClose)})})});OS.displayName=H1;var kS="TooltipPortal",[oH,MS]=hh(kS,{forceMount:void 0}),Jc="TooltipContent",ub=w.forwardRef((r,e)=>{const t=MS(Jc,r.__scopeTooltip),{forceMount:n=t.forceMount,side:a="top",...i}=r,o=ph(Jc,r.__scopeTooltip);return c.jsx(Sa,{present:n||o.open,children:o.disableHoverableContent?c.jsx(db,{side:a,...i,ref:e}):c.jsx(RS,{side:a,...i,ref:e})})}),RS=w.forwardRef((r,e)=>{const t=ph(Jc,r.__scopeTooltip),n=sb(Jc,r.__scopeTooltip),a=w.useRef(null),i=Wr(e,a),[o,s]=w.useState(null),{trigger:l,onClose:u}=t,d=a.current,{onPointerInTransitChange:f}=n,h=w.useCallback(()=>{s(null),f(!1)},[f]),p=w.useCallback((g,v)=>{const b=g.currentTarget,y={x:g.clientX,y:g.clientY},C=$S(y,b.getBoundingClientRect()),S=US(y,C),j=qS(v.getBoundingClientRect()),D=zS([...S,...j]);s(D),f(!0)},[f]);return w.useEffect(()=>()=>h(),[h]),w.useEffect(()=>{if(l&&d){const g=b=>p(b,d),v=b=>p(b,l);return l.addEventListener("pointerleave",g),d.addEventListener("pointerleave",v),()=>{l.removeEventListener("pointerleave",g),d.removeEventListener("pointerleave",v)}}},[l,d,p,h]),w.useEffect(()=>{if(o){const g=v=>{const b=v.target,y={x:v.clientX,y:v.clientY},C=l?.contains(b)||d?.contains(b),S=!VS(y,o);C?h():S&&(h(),u())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[l,d,o,u,h]),c.jsx(db,{...r,ref:i})}),[LS,FS]=hh(lb,{isInside:!1}),db=w.forwardRef((r,e)=>{const{__scopeTooltip:t,children:n,"aria-label":a,onEscapeKeyDown:i,onPointerDownOutside:o,...s}=r,l=ph(Jc,t),u=nm(t),{onClose:d}=l;return w.useEffect(()=>(document.addEventListener($v,d),()=>document.removeEventListener($v,d)),[d]),w.useEffect(()=>{if(l.trigger){const f=h=>{h.target?.contains(l.trigger)&&d()};return window.addEventListener("scroll",f,{capture:!0}),()=>window.removeEventListener("scroll",f,{capture:!0})}},[l.trigger,d]),c.jsx(Fp,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:f=>f.preventDefault(),onDismiss:d,children:c.jsxs(Bp,{"data-state":l.stateAttribute,...u,...s,ref:e,style:{...s.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[c.jsx(py,{children:n}),c.jsx(LS,{scope:t,isInside:!0,children:c.jsx(FC,{id:l.contentId,role:"tooltip",children:a||n})})]})})});ub.displayName=Jc;var fb="TooltipArrow",BS=w.forwardRef((r,e)=>{const{__scopeTooltip:t,...n}=r,a=nm(t);return FS(fb,t).isInside?null:c.jsx($p,{...a,...n,ref:e})});BS.displayName=fb;function $S(r,e){const t=Math.abs(e.top-r.y),n=Math.abs(e.bottom-r.y),a=Math.abs(e.right-r.x),i=Math.abs(e.left-r.x);switch(Math.min(t,n,a,i)){case i:return"left";case a:return"right";case t:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function US(r,e,t=5){const n=[];switch(e){case"top":n.push({x:r.x-t,y:r.y+t},{x:r.x+t,y:r.y+t});break;case"bottom":n.push({x:r.x-t,y:r.y-t},{x:r.x+t,y:r.y-t});break;case"left":n.push({x:r.x+t,y:r.y-t},{x:r.x+t,y:r.y+t});break;case"right":n.push({x:r.x-t,y:r.y-t},{x:r.x-t,y:r.y+t});break}return n}function qS(r){const{top:e,right:t,bottom:n,left:a}=r;return[{x:a,y:e},{x:t,y:e},{x:t,y:n},{x:a,y:n}]}function VS(r,e){const{x:t,y:n}=r;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const s=e[i].x,l=e[i].y,u=e[o].x,d=e[o].y;l>n!=d>n&&t<(u-s)*(n-l)/(d-l)+s&&(a=!a)}return a}function zS(r){const e=r.slice();return e.sort((t,n)=>t.x<n.x?-1:t.x>n.x?1:t.y<n.y?-1:t.y>n.y?1:0),HS(e)}function HS(r){if(r.length<=1)return r.slice();const e=[];for(let n=0;n<r.length;n++){const a=r[n];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))e.pop();else break}e.push(a)}e.pop();const t=[];for(let n=r.length-1;n>=0;n--){const a=r[n];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(a.y-o.y)>=(i.y-o.y)*(a.x-o.x))t.pop();else break}t.push(a)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var WS=cb,hb=ub;const GS=WS,YS=w.forwardRef(({className:r,sideOffset:e=4,...t},n)=>c.jsx(hb,{ref:n,sideOffset:e,className:Le("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...t}));YS.displayName=hb.displayName;var fl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Os=typeof window>"u"||"Deno"in globalThis;function La(){}function KS(r,e){return typeof r=="function"?r(e):r}function W1(r){return typeof r=="number"&&r>=0&&r!==1/0}function pb(r,e){return Math.max(r+(e||0)-Date.now(),0)}function zc(r,e){return typeof r=="function"?r(e):r}function ui(r,e){return typeof r=="function"?r(e):r}function Uv(r,e){const{type:t="all",exact:n,fetchStatus:a,predicate:i,queryKey:o,stale:s}=r;if(o){if(n){if(e.queryHash!==am(o,e.options))return!1}else if(!Cu(e.queryKey,o))return!1}if(t!=="all"){const l=e.isActive();if(t==="active"&&!l||t==="inactive"&&l)return!1}return!(typeof s=="boolean"&&e.isStale()!==s||a&&a!==e.state.fetchStatus||i&&!i(e))}function qv(r,e){const{exact:t,status:n,predicate:a,mutationKey:i}=r;if(i){if(!e.options.mutationKey)return!1;if(t){if(ks(e.options.mutationKey)!==ks(i))return!1}else if(!Cu(e.options.mutationKey,i))return!1}return!(n&&e.state.status!==n||a&&!a(e))}function am(r,e){return(e?.queryKeyHashFn||ks)(r)}function ks(r){return JSON.stringify(r,(e,t)=>G1(t)?Object.keys(t).sort().reduce((n,a)=>(n[a]=t[a],n),{}):t)}function Cu(r,e){return r===e?!0:typeof r!=typeof e?!1:r&&e&&typeof r=="object"&&typeof e=="object"?!Object.keys(e).some(t=>!Cu(r[t],e[t])):!1}function mb(r,e){if(r===e)return r;const t=Vv(r)&&Vv(e);if(t||G1(r)&&G1(e)){const n=t?r:Object.keys(r),a=n.length,i=t?e:Object.keys(e),o=i.length,s=t?[]:{};let l=0;for(let u=0;u<o;u++){const d=t?u:i[u];(!t&&n.includes(d)||t)&&r[d]===void 0&&e[d]===void 0?(s[d]=void 0,l++):(s[d]=mb(r[d],e[d]),s[d]===r[d]&&r[d]!==void 0&&l++)}return a===o&&l===a?r:s}return e}function Mf(r,e){if(!e||Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(r[t]!==e[t])return!1;return!0}function Vv(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function G1(r){if(!zv(r))return!1;const e=r.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!zv(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function zv(r){return Object.prototype.toString.call(r)==="[object Object]"}function XS(r){return new Promise(e=>{setTimeout(e,r)})}function Y1(r,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(r,e):t.structuralSharing!==!1?mb(r,e):e}function QS(r,e,t=0){const n=[...r,e];return t&&n.length>t?n.slice(1):n}function ZS(r,e,t=0){const n=[e,...r];return t&&n.length>t?n.slice(0,-1):n}var im=Symbol();function gb(r,e){return!r.queryFn&&e?.initialPromise?()=>e.initialPromise:!r.queryFn||r.queryFn===im?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}var JS=class extends fl{#e;#t;#n;constructor(){super(),this.#n=r=>{if(!Os&&window.addEventListener){const e=()=>r();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(r){this.#n=r,this.#t?.(),this.#t=r(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(r){this.#e!==r&&(this.#e=r,this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(e=>{e(r)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},om=new JS,eE=class extends fl{#e=!0;#t;#n;constructor(){super(),this.#n=r=>{if(!Os&&window.addEventListener){const e=()=>r(!0),t=()=>r(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(r){this.#n=r,this.#t?.(),this.#t=r(this.setOnline.bind(this))}setOnline(r){this.#e!==r&&(this.#e=r,this.listeners.forEach(t=>{t(r)}))}isOnline(){return this.#e}},Rf=new eE;function K1(){let r,e;const t=new Promise((a,i)=>{r=a,e=i});t.status="pending",t.catch(()=>{});function n(a){Object.assign(t,a),delete t.resolve,delete t.reject}return t.resolve=a=>{n({status:"fulfilled",value:a}),r(a)},t.reject=a=>{n({status:"rejected",reason:a}),e(a)},t}function tE(r){return Math.min(1e3*2**r,3e4)}function vb(r){return(r??"online")==="online"?Rf.isOnline():!0}var xb=class extends Error{constructor(r){super("CancelledError"),this.revert=r?.revert,this.silent=r?.silent}};function $0(r){return r instanceof xb}function yb(r){let e=!1,t=0,n=!1,a;const i=K1(),o=v=>{n||(h(new xb(v)),r.abort?.())},s=()=>{e=!0},l=()=>{e=!1},u=()=>om.isFocused()&&(r.networkMode==="always"||Rf.isOnline())&&r.canRun(),d=()=>vb(r.networkMode)&&r.canRun(),f=v=>{n||(n=!0,r.onSuccess?.(v),a?.(),i.resolve(v))},h=v=>{n||(n=!0,r.onError?.(v),a?.(),i.reject(v))},p=()=>new Promise(v=>{a=b=>{(n||u())&&v(b)},r.onPause?.()}).then(()=>{a=void 0,n||r.onContinue?.()}),g=()=>{if(n)return;let v;const b=t===0?r.initialPromise:void 0;try{v=b??r.fn()}catch(y){v=Promise.reject(y)}Promise.resolve(v).then(f).catch(y=>{if(n)return;const C=r.retry??(Os?0:3),S=r.retryDelay??tE,j=typeof S=="function"?S(t,y):S,D=C===!0||typeof C=="number"&&t<C||typeof C=="function"&&C(t,y);if(e||!D){h(y);return}t++,r.onFail?.(t,y),XS(j).then(()=>u()?void 0:p()).then(()=>{e?h(y):g()})})};return{promise:i,cancel:o,continue:()=>(a?.(),i),cancelRetry:s,continueRetry:l,canStart:d,start:()=>(d()?g():p().then(g),i)}}function rE(){let r=[],e=0,t=s=>{s()},n=s=>{s()},a=s=>setTimeout(s,0);const i=s=>{e?r.push(s):a(()=>{t(s)})},o=()=>{const s=r;r=[],s.length&&a(()=>{n(()=>{s.forEach(l=>{t(l)})})})};return{batch:s=>{let l;e++;try{l=s()}finally{e--,e||o()}return l},batchCalls:s=>(...l)=>{i(()=>{s(...l)})},schedule:i,setNotifyFunction:s=>{t=s},setBatchNotifyFunction:s=>{n=s},setScheduler:s=>{a=s}}}var nn=rE(),bb=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),W1(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Os?1/0:5*60*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},nE=class extends bb{#e;#t;#n;#r;#o;#i;constructor(r){super(),this.#i=!1,this.#o=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.#n=r.cache,this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.#e=aE(this.options),this.state=r.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(r){this.options={...this.#o,...r},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(r,e){const t=Y1(this.state.data,r,this.options);return this.#a({data:t,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),t}setState(r,e){this.#a({type:"setState",state:r,setStateOptions:e})}cancel(r){const e=this.#r?.promise;return this.#r?.cancel(r),e?e.then(La).catch(La):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(r=>ui(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===im||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(r=0){return this.state.isInvalidated||this.state.data===void 0||!pb(this.state.dataUpdatedAt,r)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(e=>e!==r),this.observers.length||(this.#r&&(this.#i?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}fetch(r,e){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(r&&this.setOptions(r),!this.options.queryFn){const s=this.observers.find(l=>l.options.queryFn);s&&this.setOptions(s.options)}const t=new AbortController,n=s=>{Object.defineProperty(s,"signal",{enumerable:!0,get:()=>(this.#i=!0,t.signal)})},a=()=>{const s=gb(this.options,e),l={queryKey:this.queryKey,meta:this.meta};return n(l),this.#i=!1,this.options.persister?this.options.persister(s,l,this):s(l)},i={fetchOptions:e,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:a};n(i),this.options.behavior?.onFetch(i,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==i.fetchOptions?.meta)&&this.#a({type:"fetch",meta:i.fetchOptions?.meta});const o=s=>{$0(s)&&s.silent||this.#a({type:"error",error:s}),$0(s)||(this.#n.config.onError?.(s,this),this.#n.config.onSettled?.(this.state.data,s,this)),this.scheduleGc()};return this.#r=yb({initialPromise:e?.initialPromise,fn:i.fetchFn,abort:t.abort.bind(t),onSuccess:s=>{if(s===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(s)}catch(l){o(l);return}this.#n.config.onSuccess?.(s,this),this.#n.config.onSettled?.(s,this.state.error,this),this.scheduleGc()},onError:o,onFail:(s,l)=>{this.#a({type:"failed",failureCount:s,error:l})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0}),this.#r.start()}#a(r){const e=t=>{switch(r.type){case"failed":return{...t,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...wb(t.data,this.options),fetchMeta:r.meta??null};case"success":return{...t,data:r.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:r.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const n=r.error;return $0(n)&&n.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...t,error:n,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:n,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...r.state}}};this.state=e(this.state),nn.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:r})})}};function wb(r,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:vb(e.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function aE(r){const e=typeof r.initialData=="function"?r.initialData():r.initialData,t=e!==void 0,n=t?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}var iE=class extends fl{constructor(r={}){super(),this.config=r,this.#e=new Map}#e;build(r,e,t){const n=e.queryKey,a=e.queryHash??am(n,e);let i=this.get(a);return i||(i=new nE({cache:this,queryKey:n,queryHash:a,options:r.defaultQueryOptions(e),state:t,defaultOptions:r.getQueryDefaults(n)}),this.add(i)),i}add(r){this.#e.has(r.queryHash)||(this.#e.set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const e=this.#e.get(r.queryHash);e&&(r.destroy(),e===r&&this.#e.delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){nn.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return this.#e.get(r)}getAll(){return[...this.#e.values()]}find(r){const e={exact:!0,...r};return this.getAll().find(t=>Uv(e,t))}findAll(r={}){const e=this.getAll();return Object.keys(r).length>0?e.filter(t=>Uv(r,t)):e}notify(r){nn.batch(()=>{this.listeners.forEach(e=>{e(r)})})}onFocus(){nn.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){nn.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},oE=class extends bb{#e;#t;#n;constructor(r){super(),this.mutationId=r.mutationId,this.#t=r.mutationCache,this.#e=[],this.state=r.state||_b(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){this.#e.includes(r)||(this.#e.push(r),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){this.#e=this.#e.filter(e=>e!==r),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(r){this.#n=yb({fn:()=>this.options.mutationFn?this.options.mutationFn(r):Promise.reject(new Error("No mutationFn found")),onFail:(n,a)=>{this.#r({type:"failed",failureCount:n,error:a})},onPause:()=>{this.#r({type:"pause"})},onContinue:()=>{this.#r({type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const e=this.state.status==="pending",t=!this.#n.canStart();try{if(!e){this.#r({type:"pending",variables:r,isPaused:t}),await this.#t.config.onMutate?.(r,this);const a=await this.options.onMutate?.(r);a!==this.state.context&&this.#r({type:"pending",context:a,variables:r,isPaused:t})}const n=await this.#n.start();return await this.#t.config.onSuccess?.(n,r,this.state.context,this),await this.options.onSuccess?.(n,r,this.state.context),await this.#t.config.onSettled?.(n,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(n,null,r,this.state.context),this.#r({type:"success",data:n}),n}catch(n){try{throw await this.#t.config.onError?.(n,r,this.state.context,this),await this.options.onError?.(n,r,this.state.context),await this.#t.config.onSettled?.(void 0,n,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,n,r,this.state.context),n}finally{this.#r({type:"error",error:n})}}finally{this.#t.runNext(this)}}#r(r){const e=t=>{switch(r.type){case"failed":return{...t,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...t,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:r.error,failureCount:t.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=e(this.state),nn.batch(()=>{this.#e.forEach(t=>{t.onMutationUpdate(r)}),this.#t.notify({mutation:this,type:"updated",action:r})})}};function _b(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var sE=class extends fl{constructor(r={}){super(),this.config=r,this.#e=new Map,this.#t=Date.now()}#e;#t;build(r,e,t){const n=new oE({mutationCache:this,mutationId:++this.#t,options:r.defaultMutationOptions(e),state:t});return this.add(n),n}add(r){const e=Hd(r),t=this.#e.get(e)??[];t.push(r),this.#e.set(e,t),this.notify({type:"added",mutation:r})}remove(r){const e=Hd(r);if(this.#e.has(e)){const t=this.#e.get(e)?.filter(n=>n!==r);t&&(t.length===0?this.#e.delete(e):this.#e.set(e,t))}this.notify({type:"removed",mutation:r})}canRun(r){const e=this.#e.get(Hd(r))?.find(t=>t.state.status==="pending");return!e||e===r}runNext(r){return this.#e.get(Hd(r))?.find(t=>t!==r&&t.state.isPaused)?.continue()??Promise.resolve()}clear(){nn.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}getAll(){return[...this.#e.values()].flat()}find(r){const e={exact:!0,...r};return this.getAll().find(t=>qv(e,t))}findAll(r={}){return this.getAll().filter(e=>qv(r,e))}notify(r){nn.batch(()=>{this.listeners.forEach(e=>{e(r)})})}resumePausedMutations(){const r=this.getAll().filter(e=>e.state.isPaused);return nn.batch(()=>Promise.all(r.map(e=>e.continue().catch(La))))}};function Hd(r){return r.options.scope?.id??String(r.mutationId)}function Hv(r){return{onFetch:(e,t)=>{const n=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,i=e.state.data?.pages||[],o=e.state.data?.pageParams||[];let s={pages:[],pageParams:[]},l=0;const u=async()=>{let d=!1;const f=g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(e.signal.aborted?d=!0:e.signal.addEventListener("abort",()=>{d=!0}),e.signal)})},h=gb(e.options,e.fetchOptions),p=async(g,v,b)=>{if(d)return Promise.reject();if(v==null&&g.pages.length)return Promise.resolve(g);const y={queryKey:e.queryKey,pageParam:v,direction:b?"backward":"forward",meta:e.options.meta};f(y);const C=await h(y),{maxPages:S}=e.options,j=b?ZS:QS;return{pages:j(g.pages,C,S),pageParams:j(g.pageParams,v,S)}};if(a&&i.length){const g=a==="backward",v=g?cE:Wv,b={pages:i,pageParams:o},y=v(n,b);s=await p(b,y,g)}else{const g=r??i.length;do{const v=l===0?o[0]??n.initialPageParam:Wv(n,s);if(l>0&&v==null)break;s=await p(s,v),l++}while(l<g)}return s};e.options.persister?e.fetchFn=()=>e.options.persister?.(u,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t):e.fetchFn=u}}}function Wv(r,{pages:e,pageParams:t}){const n=e.length-1;return e.length>0?r.getNextPageParam(e[n],e,t[n],t):void 0}function cE(r,{pages:e,pageParams:t}){return e.length>0?r.getPreviousPageParam?.(e[0],e,t[0],t):void 0}var lE=class{#e;#t;#n;#r;#o;#i;#a;#s;constructor(r={}){this.#e=r.queryCache||new iE,this.#t=r.mutationCache||new sE,this.#n=r.defaultOptions||{},this.#r=new Map,this.#o=new Map,this.#i=0}mount(){this.#i++,this.#i===1&&(this.#a=om.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=Rf.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#i--,this.#i===0&&(this.#a?.(),this.#a=void 0,this.#s?.(),this.#s=void 0)}isFetching(r){return this.#e.findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return this.#t.findAll({...r,status:"pending"}).length}getQueryData(r){const e=this.defaultQueryOptions({queryKey:r});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(r){const e=this.getQueryData(r.queryKey);if(e===void 0)return this.fetchQuery(r);{const t=this.defaultQueryOptions(r),n=this.#e.build(this,t);return r.revalidateIfStale&&n.isStaleByTime(zc(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(e)}}getQueriesData(r){return this.#e.findAll(r).map(({queryKey:e,state:t})=>{const n=t.data;return[e,n]})}setQueryData(r,e,t){const n=this.defaultQueryOptions({queryKey:r}),i=this.#e.get(n.queryHash)?.state.data,o=KS(e,i);if(o!==void 0)return this.#e.build(this,n).setData(o,{...t,manual:!0})}setQueriesData(r,e,t){return nn.batch(()=>this.#e.findAll(r).map(({queryKey:n})=>[n,this.setQueryData(n,e,t)]))}getQueryState(r){const e=this.defaultQueryOptions({queryKey:r});return this.#e.get(e.queryHash)?.state}removeQueries(r){const e=this.#e;nn.batch(()=>{e.findAll(r).forEach(t=>{e.remove(t)})})}resetQueries(r,e){const t=this.#e,n={type:"active",...r};return nn.batch(()=>(t.findAll(r).forEach(a=>{a.reset()}),this.refetchQueries(n,e)))}cancelQueries(r={},e={}){const t={revert:!0,...e},n=nn.batch(()=>this.#e.findAll(r).map(a=>a.cancel(t)));return Promise.all(n).then(La).catch(La)}invalidateQueries(r={},e={}){return nn.batch(()=>{if(this.#e.findAll(r).forEach(n=>{n.invalidate()}),r.refetchType==="none")return Promise.resolve();const t={...r,type:r.refetchType??r.type??"active"};return this.refetchQueries(t,e)})}refetchQueries(r={},e){const t={...e,cancelRefetch:e?.cancelRefetch??!0},n=nn.batch(()=>this.#e.findAll(r).filter(a=>!a.isDisabled()).map(a=>{let i=a.fetch(void 0,t);return t.throwOnError||(i=i.catch(La)),a.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(n).then(La)}fetchQuery(r){const e=this.defaultQueryOptions(r);e.retry===void 0&&(e.retry=!1);const t=this.#e.build(this,e);return t.isStaleByTime(zc(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(La).catch(La)}fetchInfiniteQuery(r){return r.behavior=Hv(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(La).catch(La)}ensureInfiniteQueryData(r){return r.behavior=Hv(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return Rf.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(r){this.#n=r}setQueryDefaults(r,e){this.#r.set(ks(r),{queryKey:r,defaultOptions:e})}getQueryDefaults(r){const e=[...this.#r.values()];let t={};return e.forEach(n=>{Cu(r,n.queryKey)&&(t={...t,...n.defaultOptions})}),t}setMutationDefaults(r,e){this.#o.set(ks(r),{mutationKey:r,defaultOptions:e})}getMutationDefaults(r){const e=[...this.#o.values()];let t={};return e.forEach(n=>{Cu(r,n.mutationKey)&&(t={...t,...n.defaultOptions})}),t}defaultQueryOptions(r){if(r._defaulted)return r;const e={...this.#n.queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return e.queryHash||(e.queryHash=am(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===im&&(e.enabled=!1),e}defaultMutationOptions(r){return r?._defaulted?r:{...this.#n.mutations,...r?.mutationKey&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},uE=class extends fl{constructor(r,e){super(),this.options=e,this.#e=r,this.#s=null,this.#a=K1(),this.options.experimental_prefetchInRender||this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#r=void 0;#o;#i;#a;#s;#m;#f;#h;#l;#u;#c;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),Gv(this.#t,this.options)?this.#d():this.updateResult(),this.#y())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return X1(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return X1(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#w(),this.#t.removeObserver(this)}setOptions(r,e){const t=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(r),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ui(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#_(),this.#t.setOptions(this.options),t._defaulted&&!Mf(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const a=this.hasListeners();a&&Yv(this.#t,n,this.options,t)&&this.#d(),this.updateResult(e),a&&(this.#t!==n||ui(this.options.enabled,this.#t)!==ui(t.enabled,this.#t)||zc(this.options.staleTime,this.#t)!==zc(t.staleTime,this.#t))&&this.#g();const i=this.#v();a&&(this.#t!==n||ui(this.options.enabled,this.#t)!==ui(t.enabled,this.#t)||i!==this.#c)&&this.#x(i)}getOptimisticResult(r){const e=this.#e.getQueryCache().build(this.#e,r),t=this.createResult(e,r);return fE(this,t)&&(this.#r=t,this.#i=this.options,this.#o=this.#t.state),t}getCurrentResult(){return this.#r}trackResult(r,e){const t={};return Object.keys(r).forEach(n=>{Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:()=>(this.trackProp(n),e?.(n),r[n])})}),t}trackProp(r){this.#p.add(r)}getCurrentQuery(){return this.#t}refetch({...r}={}){return this.fetch({...r})}fetchOptimistic(r){const e=this.#e.defaultQueryOptions(r),t=this.#e.getQueryCache().build(this.#e,e);return t.fetch().then(()=>this.createResult(t,e))}fetch(r){return this.#d({...r,cancelRefetch:r.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#r))}#d(r){this.#_();let e=this.#t.fetch(this.options,r);return r?.throwOnError||(e=e.catch(La)),e}#g(){this.#b();const r=zc(this.options.staleTime,this.#t);if(Os||this.#r.isStale||!W1(r))return;const t=pb(this.#r.dataUpdatedAt,r)+1;this.#l=setTimeout(()=>{this.#r.isStale||this.updateResult()},t)}#v(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#x(r){this.#w(),this.#c=r,!(Os||ui(this.options.enabled,this.#t)===!1||!W1(this.#c)||this.#c===0)&&(this.#u=setInterval(()=>{(this.options.refetchIntervalInBackground||om.isFocused())&&this.#d()},this.#c))}#y(){this.#g(),this.#x(this.#v())}#b(){this.#l&&(clearTimeout(this.#l),this.#l=void 0)}#w(){this.#u&&(clearInterval(this.#u),this.#u=void 0)}createResult(r,e){const t=this.#t,n=this.options,a=this.#r,i=this.#o,o=this.#i,l=r!==t?r.state:this.#n,{state:u}=r;let d={...u},f=!1,h;if(e._optimisticResults){const M=this.hasListeners(),T=!M&&Gv(r,e),q=M&&Yv(r,t,e,n);(T||q)&&(d={...d,...wb(u.data,r.options)}),e._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:p,errorUpdatedAt:g,status:v}=d;if(e.select&&d.data!==void 0)if(a&&d.data===i?.data&&e.select===this.#m)h=this.#f;else try{this.#m=e.select,h=e.select(d.data),h=Y1(a?.data,h,e),this.#f=h,this.#s=null}catch(M){this.#s=M}else h=d.data;if(e.placeholderData!==void 0&&h===void 0&&v==="pending"){let M;if(a?.isPlaceholderData&&e.placeholderData===o?.placeholderData)M=a.data;else if(M=typeof e.placeholderData=="function"?e.placeholderData(this.#h?.state.data,this.#h):e.placeholderData,e.select&&M!==void 0)try{M=e.select(M),this.#s=null}catch(T){this.#s=T}M!==void 0&&(v="success",h=Y1(a?.data,M,e),f=!0)}this.#s&&(p=this.#s,h=this.#f,g=Date.now(),v="error");const b=d.fetchStatus==="fetching",y=v==="pending",C=v==="error",S=y&&b,j=h!==void 0,F={status:v,fetchStatus:d.fetchStatus,isPending:y,isSuccess:v==="success",isError:C,isInitialLoading:S,isLoading:S,data:h,dataUpdatedAt:d.dataUpdatedAt,error:p,errorUpdatedAt:g,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>l.dataUpdateCount||d.errorUpdateCount>l.errorUpdateCount,isFetching:b,isRefetching:b&&!y,isLoadingError:C&&!j,isPaused:d.fetchStatus==="paused",isPlaceholderData:f,isRefetchError:C&&j,isStale:sm(r,e),refetch:this.refetch,promise:this.#a};if(this.options.experimental_prefetchInRender){const M=J=>{F.status==="error"?J.reject(F.error):F.data!==void 0&&J.resolve(F.data)},T=()=>{const J=this.#a=F.promise=K1();M(J)},q=this.#a;switch(q.status){case"pending":r.queryHash===t.queryHash&&M(q);break;case"fulfilled":(F.status==="error"||F.data!==q.value)&&T();break;case"rejected":(F.status!=="error"||F.error!==q.reason)&&T();break}}return F}updateResult(r){const e=this.#r,t=this.createResult(this.#t,this.options);if(this.#o=this.#t.state,this.#i=this.options,this.#o.data!==void 0&&(this.#h=this.#t),Mf(t,e))return;this.#r=t;const n={},a=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,o=typeof i=="function"?i():i;if(o==="all"||!o&&!this.#p.size)return!0;const s=new Set(o??this.#p);return this.options.throwOnError&&s.add("error"),Object.keys(this.#r).some(l=>{const u=l;return this.#r[u]!==e[u]&&s.has(u)})};r?.listeners!==!1&&a()&&(n.listeners=!0),this.#C({...n,...r})}#_(){const r=this.#e.getQueryCache().build(this.#e,this.options);if(r===this.#t)return;const e=this.#t;this.#t=r,this.#n=r.state,this.hasListeners()&&(e?.removeObserver(this),r.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#y()}#C(r){nn.batch(()=>{r.listeners&&this.listeners.forEach(e=>{e(this.#r)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function dE(r,e){return ui(e.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&e.retryOnMount===!1)}function Gv(r,e){return dE(r,e)||r.state.data!==void 0&&X1(r,e,e.refetchOnMount)}function X1(r,e,t){if(ui(e.enabled,r)!==!1){const n=typeof t=="function"?t(r):t;return n==="always"||n!==!1&&sm(r,e)}return!1}function Yv(r,e,t,n){return(r!==e||ui(n.enabled,r)===!1)&&(!t.suspense||r.state.status!=="error")&&sm(r,t)}function sm(r,e){return ui(e.enabled,r)!==!1&&r.isStaleByTime(zc(e.staleTime,r))}function fE(r,e){return!Mf(r.getCurrentResult(),e)}var hE=class extends fl{#e;#t=void 0;#n;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#o()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const t=this.options;this.options=this.#e.defaultMutationOptions(e),Mf(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),t?.mutationKey&&this.options.mutationKey&&ks(t.mutationKey)!==ks(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#o(),this.#i(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#o(),this.#i()}mutate(e,t){return this.#r=t,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#o(){const e=this.#n?.state??_b();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#i(e){nn.batch(()=>{if(this.#r&&this.hasListeners()){const t=this.#t.variables,n=this.#t.context;e?.type==="success"?(this.#r.onSuccess?.(e.data,t,n),this.#r.onSettled?.(e.data,null,t,n)):e?.type==="error"&&(this.#r.onError?.(e.error,t,n),this.#r.onSettled?.(void 0,e.error,t,n))}this.listeners.forEach(t=>{t(this.#t)})})}},Cb=w.createContext(void 0),Gr=r=>{const e=w.useContext(Cb);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},pE=({client:r,children:e})=>(w.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),c.jsx(Cb.Provider,{value:r,children:e})),Nb=w.createContext(!1),mE=()=>w.useContext(Nb);Nb.Provider;function gE(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var vE=w.createContext(gE()),xE=()=>w.useContext(vE);function Sb(r,e){return typeof r=="function"?r(...e):!!r}function Eb(){}var yE=(r,e)=>{(r.suspense||r.throwOnError)&&(e.isReset()||(r.retryOnMount=!1))},bE=r=>{w.useEffect(()=>{r.clearReset()},[r])},wE=({result:r,errorResetBoundary:e,throwOnError:t,query:n})=>r.isError&&!e.isReset()&&!r.isFetching&&n&&Sb(t,[r.error,n]),_E=r=>{r.suspense&&(r.staleTime===void 0&&(r.staleTime=1e3),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3)))},CE=(r,e)=>r.isLoading&&r.isFetching&&!e,NE=(r,e)=>r?.suspense&&e.isPending,Kv=(r,e,t)=>e.fetchOptimistic(r).catch(()=>{t.clearReset()});function SE(r,e,t){const n=Gr(),a=mE(),i=xE(),o=n.defaultQueryOptions(r);n.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=a?"isRestoring":"optimistic",_E(o),yE(o,i),bE(i);const s=!n.getQueryCache().get(o.queryHash),[l]=w.useState(()=>new e(n,o)),u=l.getOptimisticResult(o);if(w.useSyncExternalStore(w.useCallback(d=>{const f=a?()=>{}:l.subscribe(nn.batchCalls(d));return l.updateResult(),f},[l,a]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),w.useEffect(()=>{l.setOptions(o,{listeners:!1})},[o,l]),NE(o,u))throw Kv(o,l,i);if(wE({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:n.getQueryCache().get(o.queryHash)}))throw u.error;return n.getDefaultOptions().queries?._experimental_afterQuery?.(o,u),o.experimental_prefetchInRender&&!Os&&CE(u,a)&&(s?Kv(o,l,i):n.getQueryCache().get(o.queryHash)?.promise)?.catch(Eb).finally(()=>{l.updateResult()}),o.notifyOnChangeProps?u:l.trackResult(u)}function Rt(r,e){return SE(r,uE)}function ln(r,e){const t=Gr(),[n]=w.useState(()=>new hE(t,r));w.useEffect(()=>{n.setOptions(r)},[n,r]);const a=w.useSyncExternalStore(w.useCallback(o=>n.subscribe(nn.batchCalls(o)),[n]),()=>n.getCurrentResult(),()=>n.getCurrentResult()),i=w.useCallback((o,s)=>{n.mutate(o,s).catch(Eb)},[n]);if(a.error&&Sb(n.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:i,mutateAsync:a.mutate}}/**
 * @remix-run/router v1.20.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nu(){return Nu=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Nu.apply(this,arguments)}var To;(function(r){r.Pop="POP",r.Push="PUSH",r.Replace="REPLACE"})(To||(To={}));const Xv="popstate";function EE(r){r===void 0&&(r={});function e(a,i){let{pathname:o="/",search:s="",hash:l=""}=Fs(a.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Q1("",{pathname:o,search:s,hash:l},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(a,i){let o=a.document.querySelector("base"),s="";if(o&&o.getAttribute("href")){let l=a.location.href,u=l.indexOf("#");s=u===-1?l:l.slice(0,u)}return s+"#"+(typeof i=="string"?i:Ab(i))}function n(a,i){cm(a.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return jE(e,t,n,r)}function zr(r,e){if(r===!1||r===null||typeof r>"u")throw new Error(e)}function cm(r,e){if(!r){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function AE(){return Math.random().toString(36).substr(2,8)}function Qv(r,e){return{usr:r.state,key:r.key,idx:e}}function Q1(r,e,t,n){return t===void 0&&(t=null),Nu({pathname:typeof r=="string"?r:r.pathname,search:"",hash:""},typeof e=="string"?Fs(e):e,{state:t,key:e&&e.key||n||AE()})}function Ab(r){let{pathname:e="/",search:t="",hash:n=""}=r;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Fs(r){let e={};if(r){let t=r.indexOf("#");t>=0&&(e.hash=r.substr(t),r=r.substr(0,t));let n=r.indexOf("?");n>=0&&(e.search=r.substr(n),r=r.substr(0,n)),r&&(e.pathname=r)}return e}function jE(r,e,t,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:i=!1}=n,o=a.history,s=To.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(Nu({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function f(){s=To.Pop;let b=d(),y=b==null?null:b-u;u=b,l&&l({action:s,location:v.location,delta:y})}function h(b,y){s=To.Push;let C=Q1(v.location,b,y);t&&t(C,b),u=d()+1;let S=Qv(C,u),j=v.createHref(C);try{o.pushState(S,"",j)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;a.location.assign(j)}i&&l&&l({action:s,location:v.location,delta:1})}function p(b,y){s=To.Replace;let C=Q1(v.location,b,y);t&&t(C,b),u=d();let S=Qv(C,u),j=v.createHref(C);o.replaceState(S,"",j),i&&l&&l({action:s,location:v.location,delta:0})}function g(b){let y=a.location.origin!=="null"?a.location.origin:a.location.href,C=typeof b=="string"?b:Ab(b);return C=C.replace(/ $/,"%20"),zr(y,"No window.location.(origin|href) available to create URL for href: "+C),new URL(C,y)}let v={get action(){return s},get location(){return r(a,o)},listen(b){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(Xv,f),l=b,()=>{a.removeEventListener(Xv,f),l=null}},createHref(b){return e(a,b)},createURL:g,encodeLocation(b){let y=g(b);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:p,go(b){return o.go(b)}};return v}var Zv;(function(r){r.data="data",r.deferred="deferred",r.redirect="redirect",r.error="error"})(Zv||(Zv={}));function PE(r,e,t){return t===void 0&&(t="/"),DE(r,e,t,!1)}function DE(r,e,t,n){let a=typeof e=="string"?Fs(e):e,i=Db(a.pathname||"/",t);if(i==null)return null;let o=jb(r);IE(o);let s=null;for(let l=0;s==null&&l<o.length;++l){let u=qE(i);s=$E(o[l],u,n)}return s}function jb(r,e,t,n){e===void 0&&(e=[]),t===void 0&&(t=[]),n===void 0&&(n="");let a=(i,o,s)=>{let l={relativePath:s===void 0?i.path||"":s,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};l.relativePath.startsWith("/")&&(zr(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=As([n,l.relativePath]),d=t.concat(l);i.children&&i.children.length>0&&(zr(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),jb(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:FE(u,i.index),routesMeta:d})};return r.forEach((i,o)=>{var s;if(i.path===""||!((s=i.path)!=null&&s.includes("?")))a(i,o);else for(let l of Pb(i.path))a(i,o,l)}),e}function Pb(r){let e=r.split("/");if(e.length===0)return[];let[t,...n]=e,a=t.endsWith("?"),i=t.replace(/\?$/,"");if(n.length===0)return a?[i,""]:[i];let o=Pb(n.join("/")),s=[];return s.push(...o.map(l=>l===""?i:[i,l].join("/"))),a&&s.push(...o),s.map(l=>r.startsWith("/")&&l===""?"/":l)}function IE(r){r.sort((e,t)=>e.score!==t.score?t.score-e.score:BE(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}const TE=/^:[\w-]+$/,OE=3,kE=2,ME=1,RE=10,LE=-2,Jv=r=>r==="*";function FE(r,e){let t=r.split("/"),n=t.length;return t.some(Jv)&&(n+=LE),e&&(n+=kE),t.filter(a=>!Jv(a)).reduce((a,i)=>a+(TE.test(i)?OE:i===""?ME:RE),n)}function BE(r,e){return r.length===e.length&&r.slice(0,-1).every((n,a)=>n===e[a])?r[r.length-1]-e[e.length-1]:0}function $E(r,e,t){let{routesMeta:n}=r,a={},i="/",o=[];for(let s=0;s<n.length;++s){let l=n[s],u=s===n.length-1,d=i==="/"?e:e.slice(i.length)||"/",f=e2({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),h=l.route;if(!f&&u&&t&&!n[n.length-1].route.index&&(f=e2({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},d)),!f)return null;Object.assign(a,f.params),o.push({params:a,pathname:As([i,f.pathname]),pathnameBase:WE(As([i,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(i=As([i,f.pathnameBase]))}return o}function e2(r,e){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[t,n]=UE(r.path,r.caseSensitive,r.end),a=e.match(t);if(!a)return null;let i=a[0],o=i.replace(/(.)\/+$/,"$1"),s=a.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:p}=d;if(h==="*"){let v=s[f]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const g=s[f];return p&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:r}}function UE(r,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),cm(r==="*"||!r.endsWith("*")||r.endsWith("/*"),'Route path "'+r+'" will be treated as if it were '+('"'+r.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+r.replace(/\*$/,"/*")+'".'));let n=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,s,l)=>(n.push({paramName:s,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return r.endsWith("*")?(n.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function qE(r){try{return r.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return cm(!1,'The URL path "'+r+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),r}}function Db(r,e){if(e==="/")return r;if(!r.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=r.charAt(t);return n&&n!=="/"?null:r.slice(t)||"/"}function VE(r,e){e===void 0&&(e="/");let{pathname:t,search:n="",hash:a=""}=typeof r=="string"?Fs(r):r;return{pathname:t?t.startsWith("/")?t:zE(t,e):e,search:GE(n),hash:YE(a)}}function zE(r,e){let t=e.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function U0(r,e,t,n){return"Cannot include a '"+r+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function HE(r){return r.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Ib(r,e){let t=HE(r);return e?t.map((n,a)=>a===t.length-1?n.pathname:n.pathnameBase):t.map(n=>n.pathnameBase)}function Tb(r,e,t,n){n===void 0&&(n=!1);let a;typeof r=="string"?a=Fs(r):(a=Nu({},r),zr(!a.pathname||!a.pathname.includes("?"),U0("?","pathname","search",a)),zr(!a.pathname||!a.pathname.includes("#"),U0("#","pathname","hash",a)),zr(!a.search||!a.search.includes("#"),U0("#","search","hash",a)));let i=r===""||a.pathname==="",o=i?"/":a.pathname,s;if(o==null)s=t;else{let f=e.length-1;if(!n&&o.startsWith("..")){let h=o.split("/");for(;h[0]==="..";)h.shift(),f-=1;a.pathname=h.join("/")}s=f>=0?e[f]:"/"}let l=VE(a,s),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&t.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const As=r=>r.join("/").replace(/\/\/+/g,"/"),WE=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),GE=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,YE=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r;function KE(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}const Ob=["post","put","patch","delete"];new Set(Ob);const XE=["get",...Ob];new Set(XE);/**
 * React Router v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Su(){return Su=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Su.apply(this,arguments)}const lm=w.createContext(null),QE=w.createContext(null),Ou=w.createContext(null),mh=w.createContext(null),Bs=w.createContext({outlet:null,matches:[],isDataRoute:!1}),kb=w.createContext(null);function ku(){return w.useContext(mh)!=null}function gh(){return ku()||zr(!1),w.useContext(mh).location}function Mb(r){w.useContext(Ou).static||w.useLayoutEffect(r)}function ZE(){let{isDataRoute:r}=w.useContext(Bs);return r?dA():JE()}function JE(){ku()||zr(!1);let r=w.useContext(lm),{basename:e,future:t,navigator:n}=w.useContext(Ou),{matches:a}=w.useContext(Bs),{pathname:i}=gh(),o=JSON.stringify(Ib(a,t.v7_relativeSplatPath)),s=w.useRef(!1);return Mb(()=>{s.current=!0}),w.useCallback(function(u,d){if(d===void 0&&(d={}),!s.current)return;if(typeof u=="number"){n.go(u);return}let f=Tb(u,JSON.parse(o),i,d.relative==="path");r==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:As([e,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[e,n,o,i,r])}function eA(r,e){return tA(r,e)}function tA(r,e,t,n){ku()||zr(!1);let{navigator:a}=w.useContext(Ou),{matches:i}=w.useContext(Bs),o=i[i.length-1],s=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=gh(),d;if(e){var f;let b=typeof e=="string"?Fs(e):e;l==="/"||(f=b.pathname)!=null&&f.startsWith(l)||zr(!1),d=b}else d=u;let h=d.pathname||"/",p=h;if(l!=="/"){let b=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(b.length).join("/")}let g=PE(r,{pathname:p}),v=oA(g&&g.map(b=>Object.assign({},b,{params:Object.assign({},s,b.params),pathname:As([l,a.encodeLocation?a.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?l:As([l,a.encodeLocation?a.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),i,t,n);return e&&v?w.createElement(mh.Provider,{value:{location:Su({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:To.Pop}},v):v}function rA(){let r=uA(),e=KE(r)?r.status+" "+r.statusText:r instanceof Error?r.message:JSON.stringify(r),t=r instanceof Error?r.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),t?w.createElement("pre",{style:a},t):null,null)}const nA=w.createElement(rA,null);class aA extends w.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?w.createElement(Bs.Provider,{value:this.props.routeContext},w.createElement(kb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iA(r){let{routeContext:e,match:t,children:n}=r,a=w.useContext(lm);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),w.createElement(Bs.Provider,{value:e},n)}function oA(r,e,t,n){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),n===void 0&&(n=null),r==null){var i;if(!t)return null;if(t.errors)r=t.matches;else if((i=n)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)r=t.matches;else return null}let o=r,s=(a=t)==null?void 0:a.errors;if(s!=null){let d=o.findIndex(f=>f.route.id&&s?.[f.route.id]!==void 0);d>=0||zr(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(t&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:p}=t,g=f.route.loader&&h[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||g){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,h)=>{let p,g=!1,v=null,b=null;t&&(p=s&&f.route.id?s[f.route.id]:void 0,v=f.route.errorElement||nA,l&&(u<0&&h===0?(g=!0,b=null):u===h&&(g=!0,b=f.route.hydrateFallbackElement||null)));let y=e.concat(o.slice(0,h+1)),C=()=>{let S;return p?S=v:g?S=b:f.route.Component?S=w.createElement(f.route.Component,null):f.route.element?S=f.route.element:S=d,w.createElement(iA,{match:f,routeContext:{outlet:d,matches:y,isDataRoute:t!=null},children:S})};return t&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?w.createElement(aA,{location:t.location,revalidation:t.revalidation,component:v,error:p,children:C(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):C()},null)}var Rb=function(r){return r.UseBlocker="useBlocker",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r}(Rb||{}),Lf=function(r){return r.UseBlocker="useBlocker",r.UseLoaderData="useLoaderData",r.UseActionData="useActionData",r.UseRouteError="useRouteError",r.UseNavigation="useNavigation",r.UseRouteLoaderData="useRouteLoaderData",r.UseMatches="useMatches",r.UseRevalidator="useRevalidator",r.UseNavigateStable="useNavigate",r.UseRouteId="useRouteId",r}(Lf||{});function sA(r){let e=w.useContext(lm);return e||zr(!1),e}function cA(r){let e=w.useContext(QE);return e||zr(!1),e}function lA(r){let e=w.useContext(Bs);return e||zr(!1),e}function Lb(r){let e=lA(),t=e.matches[e.matches.length-1];return t.route.id||zr(!1),t.route.id}function uA(){var r;let e=w.useContext(kb),t=cA(Lf.UseRouteError),n=Lb(Lf.UseRouteError);return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function dA(){let{router:r}=sA(Rb.UseNavigateStable),e=Lb(Lf.UseNavigateStable),t=w.useRef(!1);return Mb(()=>{t.current=!0}),w.useCallback(function(a,i){i===void 0&&(i={}),t.current&&(typeof a=="number"?r.navigate(a):r.navigate(a,Su({fromRouteId:e},i)))},[r,e])}function q0(r){let{to:e,replace:t,state:n,relative:a}=r;ku()||zr(!1);let{future:i,static:o}=w.useContext(Ou),{matches:s}=w.useContext(Bs),{pathname:l}=gh(),u=ZE(),d=Tb(e,Ib(s,i.v7_relativeSplatPath),l,a==="path"),f=JSON.stringify(d);return w.useEffect(()=>u(JSON.parse(f),{replace:t,state:n,relative:a}),[u,f,a,t,n]),null}function wf(r){zr(!1)}function fA(r){let{basename:e="/",children:t=null,location:n,navigationType:a=To.Pop,navigator:i,static:o=!1,future:s}=r;ku()&&zr(!1);let l=e.replace(/^\/*/,"/"),u=w.useMemo(()=>({basename:l,navigator:i,static:o,future:Su({v7_relativeSplatPath:!1},s)}),[l,s,i,o]);typeof n=="string"&&(n=Fs(n));let{pathname:d="/",search:f="",hash:h="",state:p=null,key:g="default"}=n,v=w.useMemo(()=>{let b=Db(d,l);return b==null?null:{location:{pathname:b,search:f,hash:h,state:p,key:g},navigationType:a}},[l,d,f,h,p,g,a]);return v==null?null:w.createElement(Ou.Provider,{value:u},w.createElement(mh.Provider,{children:t,value:v}))}function hA(r){let{children:e,location:t}=r;return eA(Z1(e),t)}new Promise(()=>{});function Z1(r,e){e===void 0&&(e=[]);let t=[];return w.Children.forEach(r,(n,a)=>{if(!w.isValidElement(n))return;let i=[...e,a];if(n.type===w.Fragment){t.push.apply(t,Z1(n.props.children,i));return}n.type!==wf&&zr(!1),!n.props.index||!n.props.children||zr(!1);let o={id:n.props.id||i.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Z1(n.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.27.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const pA="6";try{window.__reactRouterVersion=pA}catch{}const mA="startTransition",t2=oh[mA];function gA(r){let{basename:e,children:t,future:n,window:a}=r,i=w.useRef();i.current==null&&(i.current=EE({window:a,v5Compat:!0}));let o=i.current,[s,l]=w.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},d=w.useCallback(f=>{u&&t2?t2(()=>l(f)):l(f)},[l,u]);return w.useLayoutEffect(()=>o.listen(d),[o,d]),w.createElement(fA,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:o,future:n})}var r2;(function(r){r.UseScrollRestoration="useScrollRestoration",r.UseSubmit="useSubmit",r.UseSubmitFetcher="useSubmitFetcher",r.UseFetcher="useFetcher",r.useViewTransitionState="useViewTransitionState"})(r2||(r2={}));var n2;(function(r){r.UseFetcher="useFetcher",r.UseFetchers="useFetchers",r.UseScrollRestoration="useScrollRestoration"})(n2||(n2={}));const vA="https://bnuahsuehizwwcejqilm.supabase.co",xA="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJudWFoc3VlaGl6d3djZWpxaWxtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg2NzY4OTYsImV4cCI6MjA2NDI1Mjg5Nn0.fJL0agNHUI7AK4ReM_bPJECk3DfCKNKpRSApApTqR48",xe=AN(vA,xA),Fb=w.createContext(void 0);function yA({children:r}){const[e,t]=w.useState(null),[n,a]=w.useState(null),[i,o]=w.useState(!0);w.useEffect(()=>{const{data:{subscription:f}}=xe.auth.onAuthStateChange((h,p)=>{a(p),t(p?.user??null),o(!1)});return xe.auth.getSession().then(({data:{session:h}})=>{a(h),t(h?.user??null),o(!1)}),()=>f.unsubscribe()},[]);const d={user:e,session:n,loading:i,signIn:async(f,h)=>{const{error:p}=await xe.auth.signInWithPassword({email:f,password:h});return{error:p}},signUp:async(f,h)=>{const p=`${window.location.origin}/`,{error:g}=await xe.auth.signUp({email:f,password:h,options:{emailRedirectTo:p}});return{error:g}},signOut:async()=>{await xe.auth.signOut()}};return c.jsx(Fb.Provider,{value:d,children:r})}function $s(){const r=w.useContext(Fb);if(r===void 0)throw new Error("useAuth must be used within an AuthProvider");return r}function bA({children:r}){const{user:e,loading:t}=$s();return console.log("ProtectedRoute - user:",e,"loading:",t),t?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Qy,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Cargando..."})]})}):e?c.jsx(c.Fragment,{children:r}):(console.log("ProtectedRoute - No user, App should handle redirect"),null)}const It=w.forwardRef(({className:r,type:e,...t},n)=>c.jsx("input",{type:e,className:Le("flex h-12 w-full rounded-lg border-0 bg-gray-100 px-4 py-3 text-base text-black ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black focus-visible:ring-offset-0 focus-visible:bg-white disabled:cursor-not-allowed disabled:opacity-50 md:text-sm transition-all duration-200",r),ref:n,...t}));It.displayName="Input";const um=Tu("inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium transition-all duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-black text-white hover:bg-gray-800 active:bg-gray-900 rounded-full shadow-none border-0",destructive:"bg-red-500 text-white hover:bg-red-600 active:bg-red-700 rounded-full shadow-none border-0",outline:"border border-gray-300 bg-white text-black hover:bg-gray-50 hover:text-black active:bg-gray-100 rounded-full shadow-none",secondary:"bg-gray-100 text-black hover:bg-gray-200 active:bg-gray-300 rounded-full shadow-none border-0",ghost:"text-black hover:bg-gray-100 hover:text-black active:bg-gray-200 rounded-full",link:"text-black underline-offset-4 hover:underline hover:text-black"},size:{default:"h-12 px-6 py-3",sm:"h-10 rounded-full px-4",lg:"h-14 rounded-full px-8",icon:"h-12 w-12 rounded-full"}},defaultVariants:{variant:"default",size:"default"}}),Ne=w.forwardRef(({className:r,variant:e,size:t,asChild:n=!1,...a},i)=>{const o=n?Up:"button";return c.jsx(o,{className:Le(um({variant:e,size:t,className:r})),ref:i,...a})});Ne.displayName="Button";function dm({searchTerm:r,onSearchChange:e}){const{signOut:t,user:n}=$s(),{toast:a}=Lt(),i=async()=>{try{await t(),a({title:"Sesión cerrada",description:"Has cerrado sesión exitosamente"})}catch{a({title:"Error",description:"No se pudo cerrar la sesión",variant:"destructive"})}};return c.jsx("header",{className:"uber-header",children:c.jsx("div",{className:"container mx-auto px-4 py-4",children:c.jsxs("div",{className:"flex items-center justify-between gap-4",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white",children:"Envíos Ojitos"})}),c.jsx("div",{className:"flex items-center gap-4 flex-1 max-w-md",children:c.jsxs("div",{className:"relative flex-1",children:[c.jsx(fh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),c.jsx(It,{type:"text",placeholder:"Buscar encomiendas...",value:r,onChange:o=>e(o.target.value),className:"pl-10 bg-white"})]})}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("span",{className:"text-sm text-gray-300 hidden sm:block",children:n?.email}),c.jsxs(Ne,{variant:"secondary",size:"sm",onClick:i,className:"flex items-center gap-2",children:[c.jsx(qN,{className:"h-4 w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Salir"})]})]})]})})})}function wA(r,e=[]){let t=[];function n(i,o){const s=w.createContext(o),l=t.length;t=[...t,o];function u(f){const{scope:h,children:p,...g}=f,v=h?.[r][l]||s,b=w.useMemo(()=>g,Object.values(g));return c.jsx(v.Provider,{value:b,children:p})}function d(f,h){const p=h?.[r][l]||s,g=w.useContext(p);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const a=()=>{const i=t.map(o=>w.createContext(o));return function(s){const l=s?.[r]||i;return w.useMemo(()=>({[`__scope${r}`]:{...s,[r]:l}}),[s,l])}};return a.scopeName=r,[n,_A(a,...e)]}function _A(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((s,{useScope:l,scopeName:u})=>{const f=l(i)[`__scope${u}`];return{...s,...f}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}var V0="rovingFocusGroup.onEntryFocus",CA={bubbles:!1,cancelable:!0},vh="RovingFocusGroup",[J1,Bb,NA]=my(vh),[SA,xh]=wA(vh,[NA]),[EA,AA]=SA(vh),$b=w.forwardRef((r,e)=>c.jsx(J1.Provider,{scope:r.__scopeRovingFocusGroup,children:c.jsx(J1.Slot,{scope:r.__scopeRovingFocusGroup,children:c.jsx(jA,{...r,ref:e})})}));$b.displayName=vh;var jA=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:a=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:s,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...f}=r,h=w.useRef(null),p=Wr(e,h),g=ih(i),[v=null,b]=ul({prop:o,defaultProp:s,onChange:l}),[y,C]=w.useState(!1),S=di(u),j=Bb(t),D=w.useRef(!1),[F,M]=w.useState(0);return w.useEffect(()=>{const T=h.current;if(T)return T.addEventListener(V0,S),()=>T.removeEventListener(V0,S)},[S]),c.jsx(EA,{scope:t,orientation:n,dir:g,loop:a,currentTabStopId:v,onItemFocus:w.useCallback(T=>b(T),[b]),onItemShiftTab:w.useCallback(()=>C(!0),[]),onFocusableItemAdd:w.useCallback(()=>M(T=>T+1),[]),onFocusableItemRemove:w.useCallback(()=>M(T=>T-1),[]),children:c.jsx(cr.div,{tabIndex:y||F===0?-1:0,"data-orientation":n,...f,ref:p,style:{outline:"none",...r.style},onMouseDown:rt(r.onMouseDown,()=>{D.current=!0}),onFocus:rt(r.onFocus,T=>{const q=!D.current;if(T.target===T.currentTarget&&q&&!y){const J=new CustomEvent(V0,CA);if(T.currentTarget.dispatchEvent(J),!J.defaultPrevented){const O=j().filter(Q=>Q.focusable),k=O.find(Q=>Q.active),H=O.find(Q=>Q.id===v),ce=[k,H,...O].filter(Boolean).map(Q=>Q.ref.current);Vb(ce,d)}}D.current=!1}),onBlur:rt(r.onBlur,()=>C(!1))})})}),Ub="RovingFocusGroupItem",qb=w.forwardRef((r,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:a=!1,tabStopId:i,...o}=r,s=xu(),l=i||s,u=AA(Ub,t),d=u.currentTabStopId===l,f=Bb(t),{onFocusableItemAdd:h,onFocusableItemRemove:p}=u;return w.useEffect(()=>{if(n)return h(),()=>p()},[n,h,p]),c.jsx(J1.ItemSlot,{scope:t,id:l,focusable:n,active:a,children:c.jsx(cr.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:rt(r.onMouseDown,g=>{n?u.onItemFocus(l):g.preventDefault()}),onFocus:rt(r.onFocus,()=>u.onItemFocus(l)),onKeyDown:rt(r.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){u.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const v=IA(g,u.orientation,u.dir);if(v!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let y=f().filter(C=>C.focusable).map(C=>C.ref.current);if(v==="last")y.reverse();else if(v==="prev"||v==="next"){v==="prev"&&y.reverse();const C=y.indexOf(g.currentTarget);y=u.loop?TA(y,C+1):y.slice(C+1)}setTimeout(()=>Vb(y))}})})})});qb.displayName=Ub;var PA={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function DA(r,e){return e!=="rtl"?r:r==="ArrowLeft"?"ArrowRight":r==="ArrowRight"?"ArrowLeft":r}function IA(r,e,t){const n=DA(r.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return PA[n]}function Vb(r,e=!1){const t=document.activeElement;for(const n of r)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function TA(r,e){return r.map((t,n)=>r[(e+n)%r.length])}var zb=$b,Hb=qb,fm="Tabs",[OA,cH]=Ui(fm,[xh]),Wb=xh(),[kA,hm]=OA(fm),Gb=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,onValueChange:a,defaultValue:i,orientation:o="horizontal",dir:s,activationMode:l="automatic",...u}=r,d=ih(s),[f,h]=ul({prop:n,onChange:a,defaultProp:i});return c.jsx(kA,{scope:t,baseId:xu(),value:f,onValueChange:h,orientation:o,dir:d,activationMode:l,children:c.jsx(cr.div,{dir:d,"data-orientation":o,...u,ref:e})})});Gb.displayName=fm;var Yb="TabsList",Kb=w.forwardRef((r,e)=>{const{__scopeTabs:t,loop:n=!0,...a}=r,i=hm(Yb,t),o=Wb(t);return c.jsx(zb,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:n,children:c.jsx(cr.div,{role:"tablist","aria-orientation":i.orientation,...a,ref:e})})});Kb.displayName=Yb;var Xb="TabsTrigger",Qb=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,disabled:a=!1,...i}=r,o=hm(Xb,t),s=Wb(t),l=ew(o.baseId,n),u=tw(o.baseId,n),d=n===o.value;return c.jsx(Hb,{asChild:!0,...s,focusable:!a,active:d,children:c.jsx(cr.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":a?"":void 0,disabled:a,id:l,...i,ref:e,onMouseDown:rt(r.onMouseDown,f=>{!a&&f.button===0&&f.ctrlKey===!1?o.onValueChange(n):f.preventDefault()}),onKeyDown:rt(r.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&o.onValueChange(n)}),onFocus:rt(r.onFocus,()=>{const f=o.activationMode!=="manual";!d&&!a&&f&&o.onValueChange(n)})})})});Qb.displayName=Xb;var Zb="TabsContent",Jb=w.forwardRef((r,e)=>{const{__scopeTabs:t,value:n,forceMount:a,children:i,...o}=r,s=hm(Zb,t),l=ew(s.baseId,n),u=tw(s.baseId,n),d=n===s.value,f=w.useRef(d);return w.useEffect(()=>{const h=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(h)},[]),c.jsx(Sa,{present:a||d,children:({present:h})=>c.jsx(cr.div,{"data-state":d?"active":"inactive","data-orientation":s.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:u,tabIndex:0,...o,ref:e,style:{...r.style,animationDuration:f.current?"0s":void 0},children:h&&i})})});Jb.displayName=Zb;function ew(r,e){return`${r}-trigger-${e}`}function tw(r,e){return`${r}-content-${e}`}var MA=Gb,rw=Kb,nw=Qb,aw=Jb;const Us=MA,Mu=w.forwardRef(({className:r,...e},t)=>c.jsx(rw,{ref:t,className:Le("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...e}));Mu.displayName=rw.displayName;const kn=w.forwardRef(({className:r,...e},t)=>c.jsx(nw,{ref:t,className:Le("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...e}));kn.displayName=nw.displayName;const xn=w.forwardRef(({className:r,...e},t)=>c.jsx(aw,{ref:t,className:Le("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...e}));xn.displayName=aw.displayName;const RA=Tu("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ot({className:r,variant:e,...t}){return c.jsx("div",{className:Le(RA({variant:e}),r),...t})}const z0=768;function yn(){const[r,e]=w.useState(void 0);return w.useEffect(()=>{const t=window.matchMedia(`(max-width: ${z0-1}px)`),n=()=>{e(window.innerWidth<z0)};return t.addEventListener("change",n),e(window.innerWidth<z0),()=>t.removeEventListener("change",n)},[]),!!r}function Ru(r){const{user:e}=$s();return Rt({queryKey:["current-user-role-with-preview",e?.id,r],queryFn:async()=>{if(!e)return console.log("useCurrentUserRoleWithPreview: No user found"),null;if(r)return console.log("useCurrentUserRoleWithPreview: Using preview role:",r),{role:r,is_active:!0};console.log("useCurrentUserRoleWithPreview: Fetching user role for user:",e.id);const{data:t,error:n}=await xe.from("user_profiles").select("role, is_active").eq("user_id",e.id).single();if(n)throw console.error("useCurrentUserRoleWithPreview: Error fetching user role:",n),n;return console.log("useCurrentUserRoleWithPreview: User role data received:",t),t},enabled:!!e,retry:1,staleTime:5*60*1e3})}function pm({activeTab:r,onTabChange:e,unreadCount:t=0,previewRole:n}){const a=yn(),{data:i,isLoading:o,error:s}=Ru(n);console.log("MainTabs: userRole data:",i),console.log("MainTabs: isLoading:",o),console.log("MainTabs: error:",s),console.log("MainTabs: previewRole:",n);const l=i?.role==="admin",u=i?.role==="admin",d=i?.role==="admin",f=i?.role==="admin",h=i?.role==="admin";if(console.log("MainTabs: showUsersTab:",l),console.log("MainTabs: showNotificationsTab:",u),console.log("MainTabs: showSettingsTab:",d),console.log("MainTabs: showChatTab:",f),console.log("MainTabs: showFinancesTab:",h),o)return console.log("MainTabs: Still loading user role..."),c.jsx("div",{className:"w-full h-10 bg-gray-200 animate-pulse rounded-md"});s&&console.error("MainTabs: Error loading user role:",s);const p=[!0,!0,!0,h,f,u,l,d,!0].filter(Boolean).length;return c.jsx(Us,{value:r,onValueChange:e,className:"w-full",children:c.jsxs(Mu,{className:"grid w-full gap-0.5 sm:gap-1 h-auto p-1 overflow-x-auto",style:{gridTemplateColumns:`repeat(${p}, minmax(0, 1fr))`},children:[c.jsx(kn,{value:"dashboard",className:"text-xs sm:text-sm px-1 sm:px-3 py-2 min-w-0 flex-shrink-0",children:a?"Home":"Dashboard"}),c.jsx(kn,{value:"trips",className:"text-xs sm:text-sm px-1 sm:px-3 py-2 min-w-0 flex-shrink-0",children:"Viajes"}),c.jsx(kn,{value:"dispatches",className:"text-xs sm:text-sm px-1 sm:px-3 py-2 min-w-0 flex-shrink-0",children:a?"Desp.":"Despachos"}),h&&c.jsx(kn,{value:"finances",className:"text-xs sm:text-sm px-1 sm:px-3 py-2 min-w-0 flex-shrink-0",children:"Finanzas"}),f&&c.jsxs(kn,{value:"chat",className:"text-xs sm:text-sm px-1 sm:px-3 py-2 relative min-w-0 flex-shrink-0",children:["Chat",t>0&&c.jsx(Ot,{variant:"destructive",className:"ml-1 sm:ml-2 h-4 w-4 sm:h-5 sm:w-5 rounded-full p-0 text-xs absolute -top-1 -right-1 sm:relative sm:top-auto sm:right-auto",children:t>9?"9+":t})]}),u&&c.jsx(kn,{value:"notifications",className:"text-xs sm:text-sm px-1 sm:px-3 py-2 min-w-0 flex-shrink-0",children:a?"Notif.":"Notificaciones"}),l&&c.jsx(kn,{value:"users",className:"text-xs sm:text-sm px-1 sm:px-3 py-2 min-w-0 flex-shrink-0",children:a?"Users":"Usuarios"}),d&&c.jsx(kn,{value:"settings",className:"text-xs sm:text-sm px-1 sm:px-3 py-2 min-w-0 flex-shrink-0",children:a?"Config":"Configuración"}),c.jsx(kn,{value:"developer",className:"text-xs sm:text-sm px-1 sm:px-3 py-2 min-w-0 flex-shrink-0 bg-purple-100 text-purple-800",children:a?"Dev":"Preview"})]})})}const He=w.forwardRef(({className:r,...e},t)=>c.jsx("div",{ref:t,className:Le("rounded-lg border bg-card text-card-foreground shadow-sm",r),...e}));He.displayName="Card";const yt=w.forwardRef(({className:r,...e},t)=>c.jsx("div",{ref:t,className:Le("flex flex-col space-y-1.5 p-6",r),...e}));yt.displayName="CardHeader";const Nt=w.forwardRef(({className:r,...e},t)=>c.jsx("div",{ref:t,className:Le("text-2xl font-semibold leading-none tracking-tight",r),...e}));Nt.displayName="CardTitle";const Hr=w.forwardRef(({className:r,...e},t)=>c.jsx("div",{ref:t,className:Le("text-sm text-muted-foreground",r),...e}));Hr.displayName="CardDescription";const We=w.forwardRef(({className:r,...e},t)=>c.jsx("div",{ref:t,className:Le("p-6 pt-0",r),...e}));We.displayName="CardContent";const LA=w.forwardRef(({className:r,...e},t)=>c.jsx("div",{ref:t,className:Le("flex items-center p-6 pt-0",r),...e}));LA.displayName="CardFooter";function FA({packageStats:r,customersCount:e}){const t=[{title:"Total Encomiendas",value:r?.total.toString()||"0",change:"+12%",icon:Dr,color:"text-black"},{title:"Clientes Activos",value:e.toString(),change:"+8%",icon:$o,color:"text-black"},{title:"En Tránsito",value:r?.inTransit.toString()||"0",change:"-3%",icon:gi,color:"text-black"},{title:"Entregados",value:r?.delivered.toString()||"0",change:"+15%",icon:KN,color:"text-black"}];return c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:t.map((n,a)=>c.jsxs(He,{className:"bg-gray-100 border-0 rounded-2xl shadow-none hover:bg-gray-200 transition-all duration-200",children:[c.jsxs(yt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[c.jsx(Nt,{className:"text-sm font-medium text-black",children:n.title}),c.jsx(n.icon,{className:`h-4 w-4 ${n.color}`})]}),c.jsxs(We,{children:[c.jsx("div",{className:"text-2xl font-bold text-black",children:n.value}),c.jsxs("p",{className:"text-xs text-gray-600",children:[c.jsx("span",{className:n.change.startsWith("+")?"text-green-600":"text-red-600",children:n.change})," ","desde el mes pasado"]})]})]},a))})}function BA({onNewPackage:r,onNewTrip:e,onViewNotifications:t,onMobileDelivery:n}){return c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(Ne,{onClick:r,variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[c.jsx(ao,{className:"h-6 w-6"}),c.jsx("span",{className:"text-sm",children:"Nueva Encomienda"})]}),c.jsxs(Ne,{onClick:e,variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[c.jsx(Ts,{className:"h-6 w-6"}),c.jsx("span",{className:"text-sm",children:"Nuevo Viaje"})]}),c.jsxs(Ne,{onClick:n,variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[c.jsx(Zy,{className:"h-6 w-6"}),c.jsx("span",{className:"text-sm",children:"Entrega Móvil"})]}),c.jsxs(Ne,{onClick:t,variant:"outline",className:"h-auto p-4 flex flex-col items-center gap-2",children:[c.jsx(Wy,{className:"h-6 w-6"}),c.jsx("span",{className:"text-sm",children:"Notificaciones"})]})]})}const za=w.forwardRef(({className:r,...e},t)=>c.jsx("div",{className:"relative w-full overflow-auto",children:c.jsx("table",{ref:t,className:Le("w-full caption-bottom text-sm",r),...e})}));za.displayName="Table";const Ha=w.forwardRef(({className:r,...e},t)=>c.jsx("thead",{ref:t,className:Le("[&_tr]:border-b",r),...e}));Ha.displayName="TableHeader";const Wa=w.forwardRef(({className:r,...e},t)=>c.jsx("tbody",{ref:t,className:Le("[&_tr:last-child]:border-0",r),...e}));Wa.displayName="TableBody";const $A=w.forwardRef(({className:r,...e},t)=>c.jsx("tfoot",{ref:t,className:Le("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",r),...e}));$A.displayName="TableFooter";const Sr=w.forwardRef(({className:r,...e},t)=>c.jsx("tr",{ref:t,className:Le("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",r),...e}));Sr.displayName="TableRow";const Me=w.forwardRef(({className:r,...e},t)=>c.jsx("th",{ref:t,className:Le("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",r),...e}));Me.displayName="TableHead";const Re=w.forwardRef(({className:r,...e},t)=>c.jsx("td",{ref:t,className:Le("p-4 align-middle [&:has([role=checkbox])]:pr-0",r),...e}));Re.displayName="TableCell";const UA=w.forwardRef(({className:r,...e},t)=>c.jsx("caption",{ref:t,className:Le("mt-4 text-sm text-muted-foreground",r),...e}));UA.displayName="TableCaption";const un=vy,qA=xy,VA=gy,iw=w.forwardRef(({className:r,...e},t)=>c.jsx(qp,{ref:t,className:Le("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e}));iw.displayName=qp.displayName;const Yr=w.forwardRef(({className:r,children:e,...t},n)=>c.jsxs(VA,{children:[c.jsx(iw,{}),c.jsxs(Vp,{ref:n,className:Le("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...t,children:[e,c.jsxs(zp,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[c.jsx(lo,{className:"h-4 w-4"}),c.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Yr.displayName=Vp.displayName;const Kr=({className:r,...e})=>c.jsx("div",{className:Le("flex flex-col space-y-1.5 text-center sm:text-left",r),...e});Kr.displayName="DialogHeader";const rs=({className:r,...e})=>c.jsx("div",{className:Le("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});rs.displayName="DialogFooter";const Xr=w.forwardRef(({className:r,...e},t)=>c.jsx(Hp,{ref:t,className:Le("text-lg font-semibold leading-none tracking-tight",r),...e}));Xr.displayName=Hp.displayName;const sa=w.forwardRef(({className:r,...e},t)=>c.jsx(Wp,{ref:t,className:Le("text-sm text-muted-foreground",r),...e}));sa.displayName=Wp.displayName;var zA="Label",ow=w.forwardRef((r,e)=>c.jsx(cr.label,{...r,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(r.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));ow.displayName=zA;var sw=ow;const HA=Tu("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-black"),at=w.forwardRef(({className:r,...e},t)=>c.jsx(sw,{ref:t,className:Le(HA(),r),...e}));at.displayName=sw.displayName;function WA({selectedCustomerId:r}){const{data:e,isLoading:t}=Rt({queryKey:["customer-details",r],queryFn:async()=>{if(!r)return null;console.log("Buscando detalles del cliente:",r);const{data:n,error:a}=await xe.from("customers").select("id, name, email, phone, id_number").eq("id",r).maybeSingle();if(a)throw console.error("Error al buscar cliente:",a),a;return console.log("Cliente encontrado:",n),n},enabled:!!r});return t?c.jsxs("div",{children:[c.jsx(at,{htmlFor:"customer",children:"Cliente"}),c.jsx("div",{className:"h-10 w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-600 cursor-not-allowed",children:"Cargando cliente..."})]}):e?c.jsxs("div",{children:[c.jsx(at,{htmlFor:"customer",children:"Cliente"}),c.jsx("div",{className:"h-10 w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-600 cursor-not-allowed",children:e.name}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.email," • ",e.phone]})]}):r?c.jsxs("div",{children:[c.jsx(at,{htmlFor:"customer",children:"Cliente"}),c.jsx("div",{className:"h-10 w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-600 cursor-not-allowed",children:"Cliente no encontrado"})]}):c.jsxs("div",{children:[c.jsx(at,{htmlFor:"customer",children:"Cliente"}),c.jsx("div",{className:"h-10 w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-600 cursor-not-allowed",children:"Sin cliente asignado"})]})}const GA={firstName:"",lastName:"",idNumber:"",countryCode:"+57",phoneNumber:"",email:"",address:""},YA=[{code:"+57",country:"CO",flag:"🇨🇴"},{code:"+599",country:"CW",flag:"🇨🇼"}],yh=[{id:"CO",name:"Colombia",departments:[{id:"AMA",name:"Amazonas",cities:[{id:"LET",name:"Leticia"},{id:"PUE",name:"Puerto Nariño"}]},{id:"ANT",name:"Antioquia",cities:[{id:"MED",name:"Medellín"},{id:"BEL",name:"Bello"},{id:"ITG",name:"Itagüí"},{id:"ENV",name:"Envigado"},{id:"CAL",name:"Caldas"},{id:"COP",name:"Copacabana"}]},{id:"ARA",name:"Arauca",cities:[{id:"ARA",name:"Arauca"},{id:"ARA2",name:"Arauquita"},{id:"CRA",name:"Cravo Norte"}]},{id:"ATL",name:"Atlántico",cities:[{id:"BAQ",name:"Barranquilla"},{id:"SOL",name:"Soledad"},{id:"MAL",name:"Malambo"},{id:"BAR",name:"Baranoa"}]},{id:"BOL",name:"Bolívar",cities:[{id:"CTG",name:"Cartagena"},{id:"MAG",name:"Magangué"},{id:"TUR",name:"Turbaco"},{id:"ARM",name:"Arjona"}]},{id:"BOY",name:"Boyacá",cities:[{id:"TUN",name:"Tunja"},{id:"DOL",name:"Duitama"},{id:"SOG",name:"Sogamoso"},{id:"CHI",name:"Chiquinquirá"}]},{id:"CAL",name:"Caldas",cities:[{id:"MAN",name:"Manizales"},{id:"LAD",name:"La Dorada"},{id:"CHI2",name:"Chinchiná"},{id:"RIS",name:"Riosucio"}]},{id:"CAQ",name:"Caquetá",cities:[{id:"FLO",name:"Florencia"},{id:"SVI",name:"San Vicente del Caguán"},{id:"BEL2",name:"Belén de los Andaquíes"}]},{id:"CAS",name:"Casanare",cities:[{id:"YOP",name:"Yopal"},{id:"AGU",name:"Aguazul"},{id:"VIL",name:"Villanueva"},{id:"TAU",name:"Tauramena"}]},{id:"CAU",name:"Cauca",cities:[{id:"POP",name:"Popayán"},{id:"SAN",name:"Santander de Quilichao"},{id:"PUE2",name:"Puerto Tejada"},{id:"GUA",name:"Guapi"}]},{id:"CES",name:"Cesar",cities:[{id:"VAL",name:"Valledupar"},{id:"AGU2",name:"Aguachica"},{id:"BOC",name:"Bosconia"},{id:"COD",name:"Codazzi"}]},{id:"CHO",name:"Chocó",cities:[{id:"QUI",name:"Quibdó"},{id:"ACN",name:"Acandí"},{id:"IST",name:"Istmina"},{id:"CON",name:"Condoto"}]},{id:"COR",name:"Córdoba",cities:[{id:"MON",name:"Montería"},{id:"CER",name:"Cereté"},{id:"LOC",name:"Lorica"},{id:"SAH",name:"Sahagún"}]},{id:"CUN",name:"Cundinamarca",cities:[{id:"BOG",name:"Bogotá"},{id:"SOA",name:"Soacha"},{id:"CHI3",name:"Chía"},{id:"ZIP",name:"Zipaquirá"},{id:"GIR",name:"Girardot"},{id:"FUS",name:"Fusagasugá"}]},{id:"GUA2",name:"Guainía",cities:[{id:"INI",name:"Inírida"},{id:"BAR2",name:"Barranco Minas"}]},{id:"GUV",name:"Guaviare",cities:[{id:"SJG",name:"San José del Guaviare"},{id:"CAL2",name:"Calamar"},{id:"ELR",name:"El Retorno"}]},{id:"HUI",name:"Huila",cities:[{id:"NEI",name:"Neiva"},{id:"GAR",name:"Garzón"},{id:"PIR",name:"Pitalito"},{id:"LAP",name:"La Plata"}]},{id:"LAG",name:"La Guajira",cities:[{id:"RIO",name:"Riohacha"},{id:"MAI",name:"Maicao"},{id:"URB",name:"Uribia"},{id:"VIL2",name:"Villanueva"}]},{id:"MAG2",name:"Magdalena",cities:[{id:"SMA",name:"Santa Marta"},{id:"CIE",name:"Ciénaga"},{id:"FUN",name:"Fundación"},{id:"ARA3",name:"Aracataca"}]},{id:"MET",name:"Meta",cities:[{id:"VIL3",name:"Villavicencio"},{id:"ACE",name:"Acacías"},{id:"GRA",name:"Granada"},{id:"PUE3",name:"Puerto López"}]},{id:"NAR",name:"Nariño",cities:[{id:"PAS",name:"Pasto"},{id:"TUM",name:"Tumaco"},{id:"IPI",name:"Ipiales"},{id:"TUQ",name:"Túquerres"}]},{id:"NSA",name:"Norte de Santander",cities:[{id:"CUC",name:"Cúcuta"},{id:"OCN",name:"Ocaña"},{id:"VCN",name:"Villa del Rosario"},{id:"PAM",name:"Pamplona"}]},{id:"PUT",name:"Putumayo",cities:[{id:"MOC",name:"Mocoa"},{id:"PTO",name:"Puerto Asís"},{id:"ORI",name:"Orito"},{id:"VGZ",name:"Valle del Guamuez"}]},{id:"QUI2",name:"Quindío",cities:[{id:"ARM2",name:"Armenia"},{id:"CAL3",name:"Calarcá"},{id:"MNT",name:"Montenegro"},{id:"QUI3",name:"Quimbaya"}]},{id:"RIS2",name:"Risaralda",cities:[{id:"PER",name:"Pereira"},{id:"DOS",name:"Dosquebradas"},{id:"SRO",name:"Santa Rosa de Cabal"},{id:"LAV",name:"La Virginia"}]},{id:"SAP",name:"San Andrés y Providencia",cities:[{id:"SAN2",name:"San Andrés"},{id:"PRO",name:"Providencia"}]},{id:"SAN3",name:"Santander",cities:[{id:"BUC",name:"Bucaramanga"},{id:"FLO2",name:"Floridablanca"},{id:"GIR2",name:"Girón"},{id:"PIE",name:"Piedecuesta"},{id:"BAR3",name:"Barrancabermeja"}]},{id:"SUC",name:"Sucre",cities:[{id:"SIN",name:"Sincelejo"},{id:"COZ",name:"Corozal"},{id:"SAM",name:"Sampués"},{id:"TOL2",name:"Tolú"}]},{id:"TOL",name:"Tolima",cities:[{id:"IBA",name:"Ibagué"},{id:"ESP",name:"Espinal"},{id:"GUA3",name:"Guamo"},{id:"HON",name:"Honda"}]},{id:"VAC",name:"Valle del Cauca",cities:[{id:"CAL4",name:"Cali"},{id:"YUM",name:"Yumbo"},{id:"PAL",name:"Palmira"},{id:"BUE",name:"Buenaventura"},{id:"TUL",name:"Tuluá"},{id:"CAR",name:"Cartago"}]},{id:"VAU",name:"Vaupés",cities:[{id:"MIT",name:"Mitú"},{id:"CAR2",name:"Carurú"},{id:"TAR",name:"Taraira"}]},{id:"VIC",name:"Vichada",cities:[{id:"PTO2",name:"Puerto Carreño"},{id:"LAP2",name:"La Primavera"},{id:"SFE",name:"Santa Rosalía"}]}]},{id:"CW",name:"Curazao"}],Ca=zC,Na=HC,ia=w.forwardRef(({className:r,children:e,...t},n)=>c.jsxs(yy,{ref:n,className:Le("flex h-12 w-full items-center justify-between rounded-lg border-0 bg-gray-100 px-4 py-3 text-base text-black ring-offset-background placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-0 focus:bg-white disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1 md:text-sm transition-all duration-200",r),...t,children:[e,c.jsx(BC,{asChild:!0,children:c.jsx(lh,{className:"h-4 w-4 opacity-50"})})]}));ia.displayName=yy.displayName;const cw=w.forwardRef(({className:r,...e},t)=>c.jsx(by,{ref:t,className:Le("flex cursor-default items-center justify-center py-1",r),...e,children:c.jsx(Jp,{className:"h-4 w-4"})}));cw.displayName=by.displayName;const lw=w.forwardRef(({className:r,...e},t)=>c.jsx(wy,{ref:t,className:Le("flex cursor-default items-center justify-center py-1",r),...e,children:c.jsx(lh,{className:"h-4 w-4"})}));lw.displayName=wy.displayName;const oa=w.forwardRef(({className:r,children:e,position:t="popper",...n},a)=>c.jsx($C,{children:c.jsxs(_y,{ref:a,className:Le("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:t,...n,children:[c.jsx(cw,{}),c.jsx(UC,{className:Le("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),c.jsx(lw,{})]})}));oa.displayName=_y.displayName;const KA=w.forwardRef(({className:r,...e},t)=>c.jsx(Cy,{ref:t,className:Le("py-1.5 pl-8 pr-2 text-sm font-semibold",r),...e}));KA.displayName=Cy.displayName;const pr=w.forwardRef(({className:r,children:e,...t},n)=>c.jsxs(Ny,{ref:n,className:Le("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(qC,{children:c.jsx(es,{className:"h-4 w-4"})})}),c.jsx(VC,{children:e})]}));pr.displayName=Ny.displayName;const XA=w.forwardRef(({className:r,...e},t)=>c.jsx(Sy,{ref:t,className:Le("-mx-1 my-1 h-px bg-muted",r),...e}));XA.displayName=Sy.displayName;function QA({onCountrySelect:r}){const e=t=>{console.log("🟣 CountryStep country selected:",t),r(t)};return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h4",{className:"font-medium text-lg",children:"Seleccionar País"}),c.jsxs(Ca,{onValueChange:e,children:[c.jsx(ia,{className:"h-12 text-base",children:c.jsx(Na,{placeholder:"Selecciona un país"})}),c.jsx(oa,{className:"w-full",children:yh.map(t=>c.jsx(pr,{value:t.id,className:"py-3 px-4 text-base cursor-pointer hover:bg-gray-100",children:t.name},t.id))})]})]})}var a2=1,ZA=.9,JA=.8,e8=.17,H0=.1,W0=.999,t8=.9999,r8=.99,n8=/[\\\/_+.#"@\[\(\{&]/,a8=/[\\\/_+.#"@\[\(\{&]/g,i8=/[\s-]/,uw=/[\s-]/g;function ep(r,e,t,n,a,i,o){if(i===e.length)return a===r.length?a2:r8;var s=`${a},${i}`;if(o[s]!==void 0)return o[s];for(var l=n.charAt(i),u=t.indexOf(l,a),d=0,f,h,p,g;u>=0;)f=ep(r,e,t,n,u+1,i+1,o),f>d&&(u===a?f*=a2:n8.test(r.charAt(u-1))?(f*=JA,p=r.slice(a,u-1).match(a8),p&&a>0&&(f*=Math.pow(W0,p.length))):i8.test(r.charAt(u-1))?(f*=ZA,g=r.slice(a,u-1).match(uw),g&&a>0&&(f*=Math.pow(W0,g.length))):(f*=e8,a>0&&(f*=Math.pow(W0,u-a))),r.charAt(u)!==e.charAt(i)&&(f*=t8)),(f<H0&&t.charAt(u-1)===n.charAt(i+1)||n.charAt(i+1)===n.charAt(i)&&t.charAt(u-1)!==n.charAt(i))&&(h=ep(r,e,t,n,u+1,i+2,o),h*H0>f&&(f=h*H0)),f>d&&(d=f),u=t.indexOf(l,u+1);return o[s]=d,d}function i2(r){return r.toLowerCase().replace(uw," ")}function o8(r,e,t){return r=t&&t.length>0?`${r+" "+t.join(" ")}`:r,ep(r,e,i2(r),i2(e),0,0,{})}function Yn(){return Yn=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Yn.apply(null,arguments)}function Hc(r,e,{checkForDefaultPrevented:t=!0}={}){return function(a){if(r?.(a),t===!1||!a.defaultPrevented)return e?.(a)}}function s8(r,e){typeof r=="function"?r(e):r!=null&&(r.current=e)}function dw(...r){return e=>r.forEach(t=>s8(t,e))}function Lu(...r){return w.useCallback(dw(...r),r)}function c8(r,e=[]){let t=[];function n(i,o){const s=w.createContext(o),l=t.length;t=[...t,o];function u(f){const{scope:h,children:p,...g}=f,v=h?.[r][l]||s,b=w.useMemo(()=>g,Object.values(g));return w.createElement(v.Provider,{value:b},p)}function d(f,h){const p=h?.[r][l]||s,g=w.useContext(p);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${f}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const a=()=>{const i=t.map(o=>w.createContext(o));return function(s){const l=s?.[r]||i;return w.useMemo(()=>({[`__scope${r}`]:{...s,[r]:l}}),[s,l])}};return a.scopeName=r,[n,l8(a,...e)]}function l8(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(i){const o=n.reduce((s,{useScope:l,scopeName:u})=>{const f=l(i)[`__scope${u}`];return{...s,...f}},{});return w.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return t.scopeName=e.scopeName,t}const tp=globalThis?.document?w.useLayoutEffect:()=>{},u8=oh.useId||(()=>{});let d8=0;function G0(r){const[e,t]=w.useState(u8());return tp(()=>{r||t(n=>n??String(d8++))},[r]),r||(e?`radix-${e}`:"")}function Ms(r){const e=w.useRef(r);return w.useEffect(()=>{e.current=r}),w.useMemo(()=>(...t)=>{var n;return(n=e.current)===null||n===void 0?void 0:n.call(e,...t)},[])}function f8({prop:r,defaultProp:e,onChange:t=()=>{}}){const[n,a]=h8({defaultProp:e,onChange:t}),i=r!==void 0,o=i?r:n,s=Ms(t),l=w.useCallback(u=>{if(i){const f=typeof u=="function"?u(r):u;f!==r&&s(f)}else a(u)},[i,r,a,s]);return[o,l]}function h8({defaultProp:r,onChange:e}){const t=w.useState(r),[n]=t,a=w.useRef(n),i=Ms(e);return w.useEffect(()=>{a.current!==n&&(i(n),a.current=n)},[n,a,i]),t}const mm=w.forwardRef((r,e)=>{const{children:t,...n}=r,a=w.Children.toArray(t),i=a.find(m8);if(i){const o=i.props.children,s=a.map(l=>l===i?w.Children.count(o)>1?w.Children.only(null):w.isValidElement(o)?o.props.children:null:l);return w.createElement(rp,Yn({},n,{ref:e}),w.isValidElement(o)?w.cloneElement(o,void 0,s):null)}return w.createElement(rp,Yn({},n,{ref:e}),t)});mm.displayName="Slot";const rp=w.forwardRef((r,e)=>{const{children:t,...n}=r;return w.isValidElement(t)?w.cloneElement(t,{...g8(n,t.props),ref:e?dw(e,t.ref):t.ref}):w.Children.count(t)>1?w.Children.only(null):null});rp.displayName="SlotClone";const p8=({children:r})=>w.createElement(w.Fragment,null,r);function m8(r){return w.isValidElement(r)&&r.type===p8}function g8(r,e){const t={...e};for(const n in e){const a=r[n],i=e[n];/^on[A-Z]/.test(n)?a&&i?t[n]=(...s)=>{i(...s),a(...s)}:a&&(t[n]=a):n==="style"?t[n]={...a,...i}:n==="className"&&(t[n]=[a,i].filter(Boolean).join(" "))}return{...r,...t}}const v8=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ga=v8.reduce((r,e)=>{const t=w.forwardRef((n,a)=>{const{asChild:i,...o}=n,s=i?mm:e;return w.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),w.createElement(s,Yn({},o,{ref:a}))});return t.displayName=`Primitive.${e}`,{...r,[e]:t}},{});function x8(r,e){r&&Kp.flushSync(()=>r.dispatchEvent(e))}function y8(r,e=globalThis?.document){const t=Ms(r);w.useEffect(()=>{const n=a=>{a.key==="Escape"&&t(a)};return e.addEventListener("keydown",n),()=>e.removeEventListener("keydown",n)},[t,e])}const np="dismissableLayer.update",b8="dismissableLayer.pointerDownOutside",w8="dismissableLayer.focusOutside";let o2;const _8=w.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),C8=w.forwardRef((r,e)=>{var t;const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:s,onDismiss:l,...u}=r,d=w.useContext(_8),[f,h]=w.useState(null),p=(t=f?.ownerDocument)!==null&&t!==void 0?t:globalThis?.document,[,g]=w.useState({}),v=Lu(e,T=>h(T)),b=Array.from(d.layers),[y]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),C=b.indexOf(y),S=f?b.indexOf(f):-1,j=d.layersWithOutsidePointerEventsDisabled.size>0,D=S>=C,F=N8(T=>{const q=T.target,J=[...d.branches].some(O=>O.contains(q));!D||J||(i?.(T),s?.(T),T.defaultPrevented||l?.())},p),M=S8(T=>{const q=T.target;[...d.branches].some(O=>O.contains(q))||(o?.(T),s?.(T),T.defaultPrevented||l?.())},p);return y8(T=>{S===d.layers.size-1&&(a?.(T),!T.defaultPrevented&&l&&(T.preventDefault(),l()))},p),w.useEffect(()=>{if(f)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(o2=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(f)),d.layers.add(f),s2(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=o2)}},[f,p,n,d]),w.useEffect(()=>()=>{f&&(d.layers.delete(f),d.layersWithOutsidePointerEventsDisabled.delete(f),s2())},[f,d]),w.useEffect(()=>{const T=()=>g({});return document.addEventListener(np,T),()=>document.removeEventListener(np,T)},[]),w.createElement(Ga.div,Yn({},u,{ref:v,style:{pointerEvents:j?D?"auto":"none":void 0,...r.style},onFocusCapture:Hc(r.onFocusCapture,M.onFocusCapture),onBlurCapture:Hc(r.onBlurCapture,M.onBlurCapture),onPointerDownCapture:Hc(r.onPointerDownCapture,F.onPointerDownCapture)}))});function N8(r,e=globalThis?.document){const t=Ms(r),n=w.useRef(!1),a=w.useRef(()=>{});return w.useEffect(()=>{const i=s=>{if(s.target&&!n.current){let u=function(){fw(b8,t,l,{discrete:!0})};const l={originalEvent:s};s.pointerType==="touch"?(e.removeEventListener("click",a.current),a.current=u,e.addEventListener("click",a.current,{once:!0})):u()}else e.removeEventListener("click",a.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",a.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function S8(r,e=globalThis?.document){const t=Ms(r),n=w.useRef(!1);return w.useEffect(()=>{const a=i=>{i.target&&!n.current&&fw(w8,t,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",a),()=>e.removeEventListener("focusin",a)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function s2(){const r=new CustomEvent(np);document.dispatchEvent(r)}function fw(r,e,t,{discrete:n}){const a=t.originalEvent.target,i=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&a.addEventListener(r,e,{once:!0}),n?x8(a,i):a.dispatchEvent(i)}const Y0="focusScope.autoFocusOnMount",K0="focusScope.autoFocusOnUnmount",c2={bubbles:!1,cancelable:!0},E8=w.forwardRef((r,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:a,onUnmountAutoFocus:i,...o}=r,[s,l]=w.useState(null),u=Ms(a),d=Ms(i),f=w.useRef(null),h=Lu(e,v=>l(v)),p=w.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;w.useEffect(()=>{if(n){let v=function(S){if(p.paused||!s)return;const j=S.target;s.contains(j)?f.current=j:Do(f.current,{select:!0})},b=function(S){if(p.paused||!s)return;const j=S.relatedTarget;j!==null&&(s.contains(j)||Do(f.current,{select:!0}))},y=function(S){if(document.activeElement===document.body)for(const D of S)D.removedNodes.length>0&&Do(s)};document.addEventListener("focusin",v),document.addEventListener("focusout",b);const C=new MutationObserver(y);return s&&C.observe(s,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",b),C.disconnect()}}},[n,s,p.paused]),w.useEffect(()=>{if(s){u2.add(p);const v=document.activeElement;if(!s.contains(v)){const y=new CustomEvent(Y0,c2);s.addEventListener(Y0,u),s.dispatchEvent(y),y.defaultPrevented||(A8(T8(hw(s)),{select:!0}),document.activeElement===v&&Do(s))}return()=>{s.removeEventListener(Y0,u),setTimeout(()=>{const y=new CustomEvent(K0,c2);s.addEventListener(K0,d),s.dispatchEvent(y),y.defaultPrevented||Do(v??document.body,{select:!0}),s.removeEventListener(K0,d),u2.remove(p)},0)}}},[s,u,d,p]);const g=w.useCallback(v=>{if(!t&&!n||p.paused)return;const b=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,y=document.activeElement;if(b&&y){const C=v.currentTarget,[S,j]=j8(C);S&&j?!v.shiftKey&&y===j?(v.preventDefault(),t&&Do(S,{select:!0})):v.shiftKey&&y===S&&(v.preventDefault(),t&&Do(j,{select:!0})):y===C&&v.preventDefault()}},[t,n,p.paused]);return w.createElement(Ga.div,Yn({tabIndex:-1},o,{ref:h,onKeyDown:g}))});function A8(r,{select:e=!1}={}){const t=document.activeElement;for(const n of r)if(Do(n,{select:e}),document.activeElement!==t)return}function j8(r){const e=hw(r),t=l2(e,r),n=l2(e.reverse(),r);return[t,n]}function hw(r){const e=[],t=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const a=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||a?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function l2(r,e){for(const t of r)if(!P8(t,{upTo:e}))return t}function P8(r,{upTo:e}){if(getComputedStyle(r).visibility==="hidden")return!0;for(;r;){if(e!==void 0&&r===e)return!1;if(getComputedStyle(r).display==="none")return!0;r=r.parentElement}return!1}function D8(r){return r instanceof HTMLInputElement&&"select"in r}function Do(r,{select:e=!1}={}){if(r&&r.focus){const t=document.activeElement;r.focus({preventScroll:!0}),r!==t&&D8(r)&&e&&r.select()}}const u2=I8();function I8(){let r=[];return{add(e){const t=r[0];e!==t&&t?.pause(),r=d2(r,e),r.unshift(e)},remove(e){var t;r=d2(r,e),(t=r[0])===null||t===void 0||t.resume()}}}function d2(r,e){const t=[...r],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function T8(r){return r.filter(e=>e.tagName!=="A")}const O8=w.forwardRef((r,e)=>{var t;const{container:n=globalThis==null||(t=globalThis.document)===null||t===void 0?void 0:t.body,...a}=r;return n?Xp.createPortal(w.createElement(Ga.div,Yn({},a,{ref:e})),n):null});function k8(r,e){return w.useReducer((t,n)=>{const a=e[t][n];return a??t},r)}const bh=r=>{const{present:e,children:t}=r,n=M8(e),a=typeof t=="function"?t({present:n.isPresent}):w.Children.only(t),i=Lu(n.ref,a.ref);return typeof t=="function"||n.isPresent?w.cloneElement(a,{ref:i}):null};bh.displayName="Presence";function M8(r){const[e,t]=w.useState(),n=w.useRef({}),a=w.useRef(r),i=w.useRef("none"),o=r?"mounted":"unmounted",[s,l]=k8(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return w.useEffect(()=>{const u=Wd(n.current);i.current=s==="mounted"?u:"none"},[s]),tp(()=>{const u=n.current,d=a.current;if(d!==r){const h=i.current,p=Wd(u);r?l("MOUNT"):p==="none"||u?.display==="none"?l("UNMOUNT"):l(d&&h!==p?"ANIMATION_OUT":"UNMOUNT"),a.current=r}},[r,l]),tp(()=>{if(e){const u=f=>{const p=Wd(n.current).includes(f.animationName);f.target===e&&p&&Kp.flushSync(()=>l("ANIMATION_END"))},d=f=>{f.target===e&&(i.current=Wd(n.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",u),e.addEventListener("animationend",u),()=>{e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",u),e.removeEventListener("animationend",u)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(s),ref:w.useCallback(u=>{u&&(n.current=getComputedStyle(u)),t(u)},[])}}function Wd(r){return r?.animationName||"none"}let X0=0;function R8(){w.useEffect(()=>{var r,e;const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(r=t[0])!==null&&r!==void 0?r:f2()),document.body.insertAdjacentElement("beforeend",(e=t[1])!==null&&e!==void 0?e:f2()),X0++,()=>{X0===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(n=>n.remove()),X0--}},[])}function f2(){const r=document.createElement("span");return r.setAttribute("data-radix-focus-guard",""),r.tabIndex=0,r.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",r}var pw=WC(),Q0=function(){},wh=w.forwardRef(function(r,e){var t=w.useRef(null),n=w.useState({onScrollCapture:Q0,onWheelCapture:Q0,onTouchMoveCapture:Q0}),a=n[0],i=n[1],o=r.forwardProps,s=r.children,l=r.className,u=r.removeScrollBar,d=r.enabled,f=r.shards,h=r.sideCar,p=r.noIsolation,g=r.inert,v=r.allowPinchZoom,b=r.as,y=b===void 0?"div":b,C=GC(r,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),S=h,j=YC([t,e]),D=Oc(Oc({},C),a);return w.createElement(w.Fragment,null,d&&w.createElement(S,{sideCar:pw,removeScrollBar:u,shards:f,noIsolation:p,inert:g,setCallbacks:i,allowPinchZoom:!!v,lockRef:t}),o?w.cloneElement(w.Children.only(s),Oc(Oc({},D),{ref:j})):w.createElement(y,Oc({},D,{className:l,ref:j}),s))});wh.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};wh.classNames={fullWidth:KC,zeroRight:XC};var ap=!1;if(typeof window<"u")try{var Gd=Object.defineProperty({},"passive",{get:function(){return ap=!0,!0}});window.addEventListener("test",Gd,Gd),window.removeEventListener("test",Gd,Gd)}catch{ap=!1}var Sc=ap?{passive:!1}:!1,L8=function(r){return r.tagName==="TEXTAREA"},mw=function(r,e){var t=window.getComputedStyle(r);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!L8(r)&&t[e]==="visible")},F8=function(r){return mw(r,"overflowY")},B8=function(r){return mw(r,"overflowX")},h2=function(r,e){var t=e;do{typeof ShadowRoot<"u"&&t instanceof ShadowRoot&&(t=t.host);var n=gw(r,t);if(n){var a=vw(r,t),i=a[1],o=a[2];if(i>o)return!0}t=t.parentNode}while(t&&t!==document.body);return!1},$8=function(r){var e=r.scrollTop,t=r.scrollHeight,n=r.clientHeight;return[e,t,n]},U8=function(r){var e=r.scrollLeft,t=r.scrollWidth,n=r.clientWidth;return[e,t,n]},gw=function(r,e){return r==="v"?F8(e):B8(e)},vw=function(r,e){return r==="v"?$8(e):U8(e)},q8=function(r,e){return r==="h"&&e==="rtl"?-1:1},V8=function(r,e,t,n,a){var i=q8(r,window.getComputedStyle(e).direction),o=i*n,s=t.target,l=e.contains(s),u=!1,d=o>0,f=0,h=0;do{var p=vw(r,s),g=p[0],v=p[1],b=p[2],y=v-b-i*g;(g||y)&&gw(r,s)&&(f+=y,h+=g),s=s.parentNode}while(!l&&s!==document.body||l&&(e.contains(s)||e===s));return(d&&(f===0||!a)||!d&&(h===0||!a))&&(u=!0),u},Yd=function(r){return"changedTouches"in r?[r.changedTouches[0].clientX,r.changedTouches[0].clientY]:[0,0]},p2=function(r){return[r.deltaX,r.deltaY]},m2=function(r){return r&&"current"in r?r.current:r},z8=function(r,e){return r[0]===e[0]&&r[1]===e[1]},H8=function(r){return`
  .block-interactivity-`.concat(r,` {pointer-events: none;}
  .allow-interactivity-`).concat(r,` {pointer-events: all;}
`)},W8=0,Ec=[];function G8(r){var e=w.useRef([]),t=w.useRef([0,0]),n=w.useRef(),a=w.useState(W8++)[0],i=w.useState(function(){return QC()})[0],o=w.useRef(r);w.useEffect(function(){o.current=r},[r]),w.useEffect(function(){if(r.inert){document.body.classList.add("block-interactivity-".concat(a));var v=ZC([r.lockRef.current],(r.shards||[]).map(m2),!0).filter(Boolean);return v.forEach(function(b){return b.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),v.forEach(function(b){return b.classList.remove("allow-interactivity-".concat(a))})}}},[r.inert,r.lockRef.current,r.shards]);var s=w.useCallback(function(v,b){if("touches"in v&&v.touches.length===2)return!o.current.allowPinchZoom;var y=Yd(v),C=t.current,S="deltaX"in v?v.deltaX:C[0]-y[0],j="deltaY"in v?v.deltaY:C[1]-y[1],D,F=v.target,M=Math.abs(S)>Math.abs(j)?"h":"v";if("touches"in v&&M==="h"&&F.type==="range")return!1;var T=h2(M,F);if(!T)return!0;if(T?D=M:(D=M==="v"?"h":"v",T=h2(M,F)),!T)return!1;if(!n.current&&"changedTouches"in v&&(S||j)&&(n.current=D),!D)return!0;var q=n.current||D;return V8(q,b,v,q==="h"?S:j,!0)},[]),l=w.useCallback(function(v){var b=v;if(!(!Ec.length||Ec[Ec.length-1]!==i)){var y="deltaY"in b?p2(b):Yd(b),C=e.current.filter(function(D){return D.name===b.type&&D.target===b.target&&z8(D.delta,y)})[0];if(C&&C.should){b.cancelable&&b.preventDefault();return}if(!C){var S=(o.current.shards||[]).map(m2).filter(Boolean).filter(function(D){return D.contains(b.target)}),j=S.length>0?s(b,S[0]):!o.current.noIsolation;j&&b.cancelable&&b.preventDefault()}}},[]),u=w.useCallback(function(v,b,y,C){var S={name:v,delta:b,target:y,should:C};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(j){return j!==S})},1)},[]),d=w.useCallback(function(v){t.current=Yd(v),n.current=void 0},[]),f=w.useCallback(function(v){u(v.type,p2(v),v.target,s(v,r.lockRef.current))},[]),h=w.useCallback(function(v){u(v.type,Yd(v),v.target,s(v,r.lockRef.current))},[]);w.useEffect(function(){return Ec.push(i),r.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Sc),document.addEventListener("touchmove",l,Sc),document.addEventListener("touchstart",d,Sc),function(){Ec=Ec.filter(function(v){return v!==i}),document.removeEventListener("wheel",l,Sc),document.removeEventListener("touchmove",l,Sc),document.removeEventListener("touchstart",d,Sc)}},[]);var p=r.removeScrollBar,g=r.inert;return w.createElement(w.Fragment,null,g?w.createElement(i,{styles:H8(a)}):null,p?w.createElement(JC,{gapMode:"margin"}):null)}const Y8=eN(pw,G8);var xw=w.forwardRef(function(r,e){return w.createElement(wh,Oc({},r,{ref:e,sideCar:Y8}))});xw.classNames=wh.classNames;const yw="Dialog",[bw,lH]=c8(yw),[K8,qs]=bw(yw),X8=r=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:a,onOpenChange:i,modal:o=!0}=r,s=w.useRef(null),l=w.useRef(null),[u=!1,d]=f8({prop:n,defaultProp:a,onChange:i});return w.createElement(K8,{scope:e,triggerRef:s,contentRef:l,contentId:G0(),titleId:G0(),descriptionId:G0(),open:u,onOpenChange:d,onOpenToggle:w.useCallback(()=>d(f=>!f),[d]),modal:o},t)},ww="DialogPortal",[Q8,_w]=bw(ww,{forceMount:void 0}),Z8=r=>{const{__scopeDialog:e,forceMount:t,children:n,container:a}=r,i=qs(ww,e);return w.createElement(Q8,{scope:e,forceMount:t},w.Children.map(n,o=>w.createElement(bh,{present:t||i.open},w.createElement(O8,{asChild:!0,container:a},o))))},ip="DialogOverlay",J8=w.forwardRef((r,e)=>{const t=_w(ip,r.__scopeDialog),{forceMount:n=t.forceMount,...a}=r,i=qs(ip,r.__scopeDialog);return i.modal?w.createElement(bh,{present:n||i.open},w.createElement(e6,Yn({},a,{ref:e}))):null}),e6=w.forwardRef((r,e)=>{const{__scopeDialog:t,...n}=r,a=qs(ip,t);return w.createElement(xw,{as:mm,allowPinchZoom:!0,shards:[a.contentRef]},w.createElement(Ga.div,Yn({"data-state":Nw(a.open)},n,{ref:e,style:{pointerEvents:"auto",...n.style}})))}),Eu="DialogContent",t6=w.forwardRef((r,e)=>{const t=_w(Eu,r.__scopeDialog),{forceMount:n=t.forceMount,...a}=r,i=qs(Eu,r.__scopeDialog);return w.createElement(bh,{present:n||i.open},i.modal?w.createElement(r6,Yn({},a,{ref:e})):w.createElement(n6,Yn({},a,{ref:e})))}),r6=w.forwardRef((r,e)=>{const t=qs(Eu,r.__scopeDialog),n=w.useRef(null),a=Lu(e,t.contentRef,n);return w.useEffect(()=>{const i=n.current;if(i)return Gp(i)},[]),w.createElement(Cw,Yn({},r,{ref:a,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Hc(r.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=t.triggerRef.current)===null||o===void 0||o.focus()}),onPointerDownOutside:Hc(r.onPointerDownOutside,i=>{const o=i.detail.originalEvent,s=o.button===0&&o.ctrlKey===!0;(o.button===2||s)&&i.preventDefault()}),onFocusOutside:Hc(r.onFocusOutside,i=>i.preventDefault())}))}),n6=w.forwardRef((r,e)=>{const t=qs(Eu,r.__scopeDialog),n=w.useRef(!1),a=w.useRef(!1);return w.createElement(Cw,Yn({},r,{ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o;if((o=r.onCloseAutoFocus)===null||o===void 0||o.call(r,i),!i.defaultPrevented){var s;n.current||(s=t.triggerRef.current)===null||s===void 0||s.focus(),i.preventDefault()}n.current=!1,a.current=!1},onInteractOutside:i=>{var o,s;(o=r.onInteractOutside)===null||o===void 0||o.call(r,i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const l=i.target;((s=t.triggerRef.current)===null||s===void 0?void 0:s.contains(l))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}}))}),Cw=w.forwardRef((r,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,...o}=r,s=qs(Eu,t),l=w.useRef(null),u=Lu(e,l);return R8(),w.createElement(w.Fragment,null,w.createElement(E8,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i},w.createElement(C8,Yn({role:"dialog",id:s.contentId,"aria-describedby":s.descriptionId,"aria-labelledby":s.titleId,"data-state":Nw(s.open)},o,{ref:u,onDismiss:()=>s.onOpenChange(!1)}))),!1)});function Nw(r){return r?"open":"closed"}const a6=X8,i6=Z8,o6=J8,s6=t6;var Ql='[cmdk-group=""]',Z0='[cmdk-group-items=""]',c6='[cmdk-group-heading=""]',gm='[cmdk-item=""]',g2=`${gm}:not([aria-disabled="true"])`,op="cmdk-item-select",_s="data-value",l6=(r,e,t)=>o8(r,e,t),Sw=w.createContext(void 0),Fu=()=>w.useContext(Sw),Ew=w.createContext(void 0),vm=()=>w.useContext(Ew),Aw=w.createContext(void 0),jw=w.forwardRef((r,e)=>{let t=Mc(()=>{var A,$;return{search:"",value:($=(A=r.value)!=null?A:r.defaultValue)!=null?$:"",filtered:{count:0,items:new Map,groups:new Set}}}),n=Mc(()=>new Set),a=Mc(()=>new Map),i=Mc(()=>new Map),o=Mc(()=>new Set),s=Pw(r),{label:l,children:u,value:d,onValueChange:f,filter:h,shouldFilter:p,loop:g,disablePointerSelection:v=!1,vimBindings:b=!0,...y}=r,C=w.useId(),S=w.useId(),j=w.useId(),D=w.useRef(null),F=b6();Rs(()=>{if(d!==void 0){let A=d.trim();t.current.value=A,M.emit()}},[d]),Rs(()=>{F(6,H)},[]);let M=w.useMemo(()=>({subscribe:A=>(o.current.add(A),()=>o.current.delete(A)),snapshot:()=>t.current,setState:(A,$,V)=>{var K,ee,oe;if(!Object.is(t.current[A],$)){if(t.current[A]=$,A==="search")k(),J(),F(1,O);else if(A==="value"&&(V||F(5,H),((K=s.current)==null?void 0:K.value)!==void 0)){let fe=$??"";(oe=(ee=s.current).onValueChange)==null||oe.call(ee,fe);return}M.emit()}},emit:()=>{o.current.forEach(A=>A())}}),[]),T=w.useMemo(()=>({value:(A,$,V)=>{var K;$!==((K=i.current.get(A))==null?void 0:K.value)&&(i.current.set(A,{value:$,keywords:V}),t.current.filtered.items.set(A,q($,V)),F(2,()=>{J(),M.emit()}))},item:(A,$)=>(n.current.add(A),$&&(a.current.has($)?a.current.get($).add(A):a.current.set($,new Set([A]))),F(3,()=>{k(),J(),t.current.value||O(),M.emit()}),()=>{i.current.delete(A),n.current.delete(A),t.current.filtered.items.delete(A);let V=X();F(4,()=>{k(),V?.getAttribute("id")===A&&O(),M.emit()})}),group:A=>(a.current.has(A)||a.current.set(A,new Set),()=>{i.current.delete(A),a.current.delete(A)}),filter:()=>s.current.shouldFilter,label:l||r["aria-label"],disablePointerSelection:v,listId:C,inputId:j,labelId:S,listInnerRef:D}),[]);function q(A,$){var V,K;let ee=(K=(V=s.current)==null?void 0:V.filter)!=null?K:l6;return A?ee(A,t.current.search,$):0}function J(){if(!t.current.search||s.current.shouldFilter===!1)return;let A=t.current.filtered.items,$=[];t.current.filtered.groups.forEach(K=>{let ee=a.current.get(K),oe=0;ee.forEach(fe=>{let ve=A.get(fe);oe=Math.max(ve,oe)}),$.push([K,oe])});let V=D.current;ce().sort((K,ee)=>{var oe,fe;let ve=K.getAttribute("id"),Ie=ee.getAttribute("id");return((oe=A.get(Ie))!=null?oe:0)-((fe=A.get(ve))!=null?fe:0)}).forEach(K=>{let ee=K.closest(Z0);ee?ee.appendChild(K.parentElement===ee?K:K.closest(`${Z0} > *`)):V.appendChild(K.parentElement===V?K:K.closest(`${Z0} > *`))}),$.sort((K,ee)=>ee[1]-K[1]).forEach(K=>{let ee=D.current.querySelector(`${Ql}[${_s}="${encodeURIComponent(K[0])}"]`);ee?.parentElement.appendChild(ee)})}function O(){let A=ce().find(V=>V.getAttribute("aria-disabled")!=="true"),$=A?.getAttribute(_s);M.setState("value",$||void 0)}function k(){var A,$,V,K;if(!t.current.search||s.current.shouldFilter===!1){t.current.filtered.count=n.current.size;return}t.current.filtered.groups=new Set;let ee=0;for(let oe of n.current){let fe=($=(A=i.current.get(oe))==null?void 0:A.value)!=null?$:"",ve=(K=(V=i.current.get(oe))==null?void 0:V.keywords)!=null?K:[],Ie=q(fe,ve);t.current.filtered.items.set(oe,Ie),Ie>0&&ee++}for(let[oe,fe]of a.current)for(let ve of fe)if(t.current.filtered.items.get(ve)>0){t.current.filtered.groups.add(oe);break}t.current.filtered.count=ee}function H(){var A,$,V;let K=X();K&&(((A=K.parentElement)==null?void 0:A.firstChild)===K&&((V=($=K.closest(Ql))==null?void 0:$.querySelector(c6))==null||V.scrollIntoView({block:"nearest"})),K.scrollIntoView({block:"nearest"}))}function X(){var A;return(A=D.current)==null?void 0:A.querySelector(`${gm}[aria-selected="true"]`)}function ce(){var A;return Array.from((A=D.current)==null?void 0:A.querySelectorAll(g2))}function Q(A){let $=ce()[A];$&&M.setState("value",$.getAttribute(_s))}function re(A){var $;let V=X(),K=ce(),ee=K.findIndex(fe=>fe===V),oe=K[ee+A];($=s.current)!=null&&$.loop&&(oe=ee+A<0?K[K.length-1]:ee+A===K.length?K[0]:K[ee+A]),oe&&M.setState("value",oe.getAttribute(_s))}function G(A){let $=X(),V=$?.closest(Ql),K;for(;V&&!K;)V=A>0?x6(V,Ql):y6(V,Ql),K=V?.querySelector(g2);K?M.setState("value",K.getAttribute(_s)):re(A)}let Y=()=>Q(ce().length-1),ge=A=>{A.preventDefault(),A.metaKey?Y():A.altKey?G(1):re(1)},ye=A=>{A.preventDefault(),A.metaKey?Q(0):A.altKey?G(-1):re(-1)};return w.createElement(Ga.div,{ref:e,tabIndex:-1,...y,"cmdk-root":"",onKeyDown:A=>{var $;if(($=y.onKeyDown)==null||$.call(y,A),!A.defaultPrevented)switch(A.key){case"n":case"j":{b&&A.ctrlKey&&ge(A);break}case"ArrowDown":{ge(A);break}case"p":case"k":{b&&A.ctrlKey&&ye(A);break}case"ArrowUp":{ye(A);break}case"Home":{A.preventDefault(),Q(0);break}case"End":{A.preventDefault(),Y();break}case"Enter":if(!A.nativeEvent.isComposing&&A.keyCode!==229){A.preventDefault();let V=X();if(V){let K=new Event(op);V.dispatchEvent(K)}}}}},w.createElement("label",{"cmdk-label":"",htmlFor:T.inputId,id:T.labelId,style:_6},l),_h(r,A=>w.createElement(Ew.Provider,{value:M},w.createElement(Sw.Provider,{value:T},A))))}),u6=w.forwardRef((r,e)=>{var t,n;let a=w.useId(),i=w.useRef(null),o=w.useContext(Aw),s=Fu(),l=Pw(r),u=(n=(t=l.current)==null?void 0:t.forceMount)!=null?n:o?.forceMount;Rs(()=>{if(!u)return s.item(a,o?.id)},[u]);let d=Dw(a,i,[r.value,r.children,i],r.keywords),f=vm(),h=Ls(F=>F.value&&F.value===d.current),p=Ls(F=>u||s.filter()===!1?!0:F.search?F.filtered.items.get(a)>0:!0);w.useEffect(()=>{let F=i.current;if(!(!F||r.disabled))return F.addEventListener(op,g),()=>F.removeEventListener(op,g)},[p,r.onSelect,r.disabled]);function g(){var F,M;v(),(M=(F=l.current).onSelect)==null||M.call(F,d.current)}function v(){f.setState("value",d.current,!0)}if(!p)return null;let{disabled:b,value:y,onSelect:C,forceMount:S,keywords:j,...D}=r;return w.createElement(Ga.div,{ref:Au([i,e]),...D,id:a,"cmdk-item":"",role:"option","aria-disabled":!!b,"aria-selected":!!h,"data-disabled":!!b,"data-selected":!!h,onPointerMove:b||s.disablePointerSelection?void 0:v,onClick:b?void 0:g},r.children)}),d6=w.forwardRef((r,e)=>{let{heading:t,children:n,forceMount:a,...i}=r,o=w.useId(),s=w.useRef(null),l=w.useRef(null),u=w.useId(),d=Fu(),f=Ls(p=>a||d.filter()===!1?!0:p.search?p.filtered.groups.has(o):!0);Rs(()=>d.group(o),[]),Dw(o,s,[r.value,r.heading,l]);let h=w.useMemo(()=>({id:o,forceMount:a}),[a]);return w.createElement(Ga.div,{ref:Au([s,e]),...i,"cmdk-group":"",role:"presentation",hidden:f?void 0:!0},t&&w.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:u},t),_h(r,p=>w.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":t?u:void 0},w.createElement(Aw.Provider,{value:h},p))))}),f6=w.forwardRef((r,e)=>{let{alwaysRender:t,...n}=r,a=w.useRef(null),i=Ls(o=>!o.search);return!t&&!i?null:w.createElement(Ga.div,{ref:Au([a,e]),...n,"cmdk-separator":"",role:"separator"})}),h6=w.forwardRef((r,e)=>{let{onValueChange:t,...n}=r,a=r.value!=null,i=vm(),o=Ls(d=>d.search),s=Ls(d=>d.value),l=Fu(),u=w.useMemo(()=>{var d;let f=(d=l.listInnerRef.current)==null?void 0:d.querySelector(`${gm}[${_s}="${encodeURIComponent(s)}"]`);return f?.getAttribute("id")},[]);return w.useEffect(()=>{r.value!=null&&i.setState("search",r.value)},[r.value]),w.createElement(Ga.input,{ref:e,...n,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":u,id:l.inputId,type:"text",value:a?r.value:o,onChange:d=>{a||i.setState("search",d.target.value),t?.(d.target.value)}})}),p6=w.forwardRef((r,e)=>{let{children:t,label:n="Suggestions",...a}=r,i=w.useRef(null),o=w.useRef(null),s=Fu();return w.useEffect(()=>{if(o.current&&i.current){let l=o.current,u=i.current,d,f=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let h=l.offsetHeight;u.style.setProperty("--cmdk-list-height",h.toFixed(1)+"px")})});return f.observe(l),()=>{cancelAnimationFrame(d),f.unobserve(l)}}},[]),w.createElement(Ga.div,{ref:Au([i,e]),...a,"cmdk-list":"",role:"listbox","aria-label":n,id:s.listId},_h(r,l=>w.createElement("div",{ref:Au([o,s.listInnerRef]),"cmdk-list-sizer":""},l)))}),m6=w.forwardRef((r,e)=>{let{open:t,onOpenChange:n,overlayClassName:a,contentClassName:i,container:o,...s}=r;return w.createElement(a6,{open:t,onOpenChange:n},w.createElement(i6,{container:o},w.createElement(o6,{"cmdk-overlay":"",className:a}),w.createElement(s6,{"aria-label":r.label,"cmdk-dialog":"",className:i},w.createElement(jw,{ref:e,...s}))))}),g6=w.forwardRef((r,e)=>Ls(t=>t.filtered.count===0)?w.createElement(Ga.div,{ref:e,...r,"cmdk-empty":"",role:"presentation"}):null),v6=w.forwardRef((r,e)=>{let{progress:t,children:n,label:a="Loading...",...i}=r;return w.createElement(Ga.div,{ref:e,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":t,"aria-valuemin":0,"aria-valuemax":100,"aria-label":a},_h(r,o=>w.createElement("div",{"aria-hidden":!0},o)))}),ca=Object.assign(jw,{List:p6,Item:u6,Input:h6,Group:d6,Separator:f6,Dialog:m6,Empty:g6,Loading:v6});function x6(r,e){let t=r.nextElementSibling;for(;t;){if(t.matches(e))return t;t=t.nextElementSibling}}function y6(r,e){let t=r.previousElementSibling;for(;t;){if(t.matches(e))return t;t=t.previousElementSibling}}function Pw(r){let e=w.useRef(r);return Rs(()=>{e.current=r}),e}var Rs=typeof window>"u"?w.useEffect:w.useLayoutEffect;function Mc(r){let e=w.useRef();return e.current===void 0&&(e.current=r()),e}function Au(r){return e=>{r.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}function Ls(r){let e=vm(),t=()=>r(e.snapshot());return w.useSyncExternalStore(e.subscribe,t,t)}function Dw(r,e,t,n=[]){let a=w.useRef(),i=Fu();return Rs(()=>{var o;let s=(()=>{var u;for(let d of t){if(typeof d=="string")return d.trim();if(typeof d=="object"&&"current"in d)return d.current?(u=d.current.textContent)==null?void 0:u.trim():a.current}})(),l=n.map(u=>u.trim());i.value(r,s,l),(o=e.current)==null||o.setAttribute(_s,s),a.current=s}),a}var b6=()=>{let[r,e]=w.useState(),t=Mc(()=>new Map);return Rs(()=>{t.current.forEach(n=>n()),t.current=new Map},[r]),(n,a)=>{t.current.set(n,a),e({})}};function w6(r){let e=r.type;return typeof e=="function"?e(r.props):"render"in e?e.render(r.props):r}function _h({asChild:r,children:e},t){return r&&w.isValidElement(e)?w.cloneElement(w6(e),{ref:e.ref},t(e.props.children)):t(e)}var _6={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Iw=w.forwardRef(({className:r,...e},t)=>c.jsx(ca,{ref:t,className:Le("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",r),...e}));Iw.displayName=ca.displayName;const Tw=w.forwardRef(({className:r,...e},t)=>c.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[c.jsx(fh,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),c.jsx(ca.Input,{ref:t,className:Le("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",r),...e})]}));Tw.displayName=ca.Input.displayName;const Ow=w.forwardRef(({className:r,...e},t)=>c.jsx(ca.List,{ref:t,className:Le("max-h-[300px] overflow-y-auto overflow-x-hidden",r),...e}));Ow.displayName=ca.List.displayName;const kw=w.forwardRef((r,e)=>c.jsx(ca.Empty,{ref:e,className:"py-6 text-center text-sm",...r}));kw.displayName=ca.Empty.displayName;const Mw=w.forwardRef(({className:r,...e},t)=>c.jsx(ca.Group,{ref:t,className:Le("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",r),...e}));Mw.displayName=ca.Group.displayName;const C6=w.forwardRef(({className:r,...e},t)=>c.jsx(ca.Separator,{ref:t,className:Le("-mx-1 h-px bg-border",r),...e}));C6.displayName=ca.Separator.displayName;const Rw=w.forwardRef(({className:r,...e},t)=>c.jsx(ca.Item,{ref:t,className:Le("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",r),...e}));Rw.displayName=ca.Item.displayName;var xm="Popover",[Lw,uH]=Ui(xm,[ll]),Bu=ll(),[N6,ns]=Lw(xm),Fw=r=>{const{__scopePopover:e,children:t,open:n,defaultOpen:a,onOpenChange:i,modal:o=!1}=r,s=Bu(e),l=w.useRef(null),[u,d]=w.useState(!1),[f=!1,h]=ul({prop:n,defaultProp:a,onChange:i});return c.jsx(Dy,{...s,children:c.jsx(N6,{scope:e,contentId:xu(),triggerRef:l,open:f,onOpenChange:h,onOpenToggle:w.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:u,onCustomAnchorAdd:w.useCallback(()=>d(!0),[]),onCustomAnchorRemove:w.useCallback(()=>d(!1),[]),modal:o,children:t})})};Fw.displayName=xm;var Bw="PopoverAnchor",S6=w.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,a=ns(Bw,t),i=Bu(t),{onCustomAnchorAdd:o,onCustomAnchorRemove:s}=a;return w.useEffect(()=>(o(),()=>s()),[o,s]),c.jsx(ah,{...i,...n,ref:e})});S6.displayName=Bw;var $w="PopoverTrigger",Uw=w.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,a=ns($w,t),i=Bu(t),o=Wr(e,a.triggerRef),s=c.jsx(cr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Ww(a.open),...n,ref:o,onClick:rt(r.onClick,a.onOpenToggle)});return a.hasCustomAnchor?s:c.jsx(ah,{asChild:!0,...i,children:s})});Uw.displayName=$w;var ym="PopoverPortal",[E6,A6]=Lw(ym,{forceMount:void 0}),qw=r=>{const{__scopePopover:e,forceMount:t,children:n,container:a}=r,i=ns(ym,e);return c.jsx(E6,{scope:e,forceMount:t,children:c.jsx(Sa,{present:t||i.open,children:c.jsx(Py,{asChild:!0,container:a,children:n})})})};qw.displayName=ym;var el="PopoverContent",Vw=w.forwardRef((r,e)=>{const t=A6(el,r.__scopePopover),{forceMount:n=t.forceMount,...a}=r,i=ns(el,r.__scopePopover);return c.jsx(Sa,{present:n||i.open,children:i.modal?c.jsx(j6,{...a,ref:e}):c.jsx(P6,{...a,ref:e})})});Vw.displayName=el;var j6=w.forwardRef((r,e)=>{const t=ns(el,r.__scopePopover),n=w.useRef(null),a=Wr(e,n),i=w.useRef(!1);return w.useEffect(()=>{const o=n.current;if(o)return Gp(o)},[]),c.jsx(Ey,{as:Up,allowPinchZoom:!0,children:c.jsx(zw,{...r,ref:a,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:rt(r.onCloseAutoFocus,o=>{o.preventDefault(),i.current||t.triggerRef.current?.focus()}),onPointerDownOutside:rt(r.onPointerDownOutside,o=>{const s=o.detail.originalEvent,l=s.button===0&&s.ctrlKey===!0,u=s.button===2||l;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:rt(r.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),P6=w.forwardRef((r,e)=>{const t=ns(el,r.__scopePopover),n=w.useRef(!1),a=w.useRef(!1);return c.jsx(zw,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{r.onCloseAutoFocus?.(i),i.defaultPrevented||(n.current||t.triggerRef.current?.focus(),i.preventDefault()),n.current=!1,a.current=!1},onInteractOutside:i=>{r.onInteractOutside?.(i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const o=i.target;t.triggerRef.current?.contains(o)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&a.current&&i.preventDefault()}})}),zw=w.forwardRef((r,e)=>{const{__scopePopover:t,trapFocus:n,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:s,onPointerDownOutside:l,onFocusOutside:u,onInteractOutside:d,...f}=r,h=ns(el,t),p=Bu(t);return Ay(),c.jsx(jy,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:a,onUnmountAutoFocus:i,children:c.jsx(Fp,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:s,onPointerDownOutside:l,onFocusOutside:u,onDismiss:()=>h.onOpenChange(!1),children:c.jsx(Bp,{"data-state":Ww(h.open),role:"dialog",id:h.contentId,...p,...f,ref:e,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Hw="PopoverClose",D6=w.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,a=ns(Hw,t);return c.jsx(cr.button,{type:"button",...n,ref:e,onClick:rt(r.onClick,()=>a.onOpenChange(!1))})});D6.displayName=Hw;var I6="PopoverArrow",T6=w.forwardRef((r,e)=>{const{__scopePopover:t,...n}=r,a=Bu(t);return c.jsx($p,{...a,...n,ref:e})});T6.displayName=I6;function Ww(r){return r?"open":"closed"}var O6=Fw,k6=Uw,M6=qw,Gw=Vw;const Yw=O6,Kw=k6,bm=w.forwardRef(({className:r,align:e="center",sideOffset:t=4,...n},a)=>c.jsx(M6,{children:c.jsx(Gw,{ref:a,align:e,sideOffset:t,className:Le("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 max-h-[80vh] overflow-y-auto",r),...n})}));bm.displayName=Gw.displayName;const Xw=()=>{const r=[],e=yh.find(t=>t.id==="CO");return e?.departments&&e.departments.forEach(t=>{t.cities.forEach(n=>{r.push({...n,departmentName:t.name,departmentId:t.id})})}),r.sort((t,n)=>t.name.localeCompare(n.name))},Qw=r=>Xw().find(e=>e.id===r),R6=r=>{const e=Qw(r);return e?yh.find(n=>n.id==="CO")?.departments?.find(n=>n.id===e.departmentId):void 0};function L6({onCitySelect:r,onBackToCountry:e}){const[t,n]=w.useState(!1),[a,i]=w.useState(null),o=Xw(),s=l=>{console.log("🟢 AllCitiesStep city selected:",l),i(l),n(!1),r(l.id)};return c.jsxs("div",{className:"space-y-6",children:[c.jsx("h4",{className:"font-medium text-lg",children:"Seleccionar Ciudad"}),c.jsx(Ne,{type:"button",className:"bg-black text-white hover:bg-gray-800 mb-4",size:"sm",onClick:l=>{console.log("🟢 AllCitiesStep back to country clicked"),l.preventDefault(),l.stopPropagation(),e()},children:"← Cambiar País (Colombia)"}),c.jsxs("div",{children:[c.jsx(at,{children:"Ciudad"}),c.jsxs(Yw,{open:t,onOpenChange:n,children:[c.jsx(Kw,{asChild:!0,children:c.jsxs(Ne,{variant:"outline",role:"combobox","aria-expanded":t,className:"w-full justify-between h-12 text-base",children:[a?c.jsxs("span",{children:[a.name," (",a.departmentName,")"]}):"Buscar ciudad...",c.jsx(RN,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),c.jsx(bm,{className:"w-full p-0",align:"start",children:c.jsxs(Iw,{children:[c.jsx(Tw,{placeholder:"Buscar ciudad...",className:"h-12"}),c.jsxs(Ow,{className:"max-h-[300px]",children:[c.jsx(kw,{children:"No se encontró la ciudad."}),c.jsx(Mw,{children:o.map(l=>c.jsxs(Rw,{value:`${l.name} ${l.departmentName}`,onSelect:()=>s(l),className:"py-3 px-4 text-base cursor-pointer",children:[c.jsx(es,{className:Le("mr-2 h-4 w-4",a?.id===l.id?"opacity-100":"opacity-0")}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"font-medium",children:l.name}),c.jsx("span",{className:"text-sm text-gray-500",children:l.departmentName})]})]},l.id))})]})]})})]})]})]})}function F6({country:r,city:e,addressInput:t,onAddressInputChange:n,onAddressSubmit:a,onCancel:i,onBackToCity:o,onBackToCountry:s}){const l=u=>{console.log("🟠 AddressStep handleSubmit called"),u.preventDefault(),u.stopPropagation(),a(t)};return c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"font-medium text-lg",children:"Agregar Dirección"}),r.id!=="CW"&&o&&c.jsxs(Ne,{type:"button",className:"bg-black text-white hover:bg-gray-800 mb-4",size:"sm",onClick:u=>{console.log("🟠 AddressStep back to city clicked"),u.preventDefault(),u.stopPropagation(),o()},children:["← Cambiar Ciudad (",e?.name,")"]}),r.id==="CW"&&s&&c.jsxs(Ne,{type:"button",variant:"outline",size:"sm",onClick:u=>{console.log("🟠 AddressStep back to country clicked"),u.preventDefault(),u.stopPropagation(),s()},className:"mb-2",children:["← Cambiar País (",r.name,")"]}),c.jsxs("form",{onSubmit:l,children:[c.jsxs("div",{children:[c.jsx(at,{htmlFor:"street-address",children:"Dirección Específica"}),c.jsx(It,{id:"street-address",value:t,onChange:u=>{console.log("🟠 AddressStep input changed:",u.target.value),n(u.target.value)},placeholder:"Ingresa la dirección específica...",className:"mt-1"})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx(Ne,{type:"submit",disabled:!t.trim(),className:"flex-1",onClick:u=>{console.log("🟠 AddressStep confirm button clicked")},children:"Confirmar Dirección"}),c.jsx(Ne,{type:"button",variant:"outline",onClick:u=>{console.log("🟠 AddressStep cancel clicked"),u.preventDefault(),u.stopPropagation(),i()},className:"flex-1",children:"Cancelar"})]})]})]})}function B6({value:r,onChange:e}){const[t,n]=w.useState(!1),[a,i]=w.useState({}),[o,s]=w.useState("country"),[l,u]=w.useState(""),d=()=>{console.log("🔵 AddressFormDialog resetSelection called"),i({}),s("country"),u("")},f=C=>{console.log("🔵 AddressFormDialog handleCountrySelect called with:",C);const S=yh.find(j=>j.id===C);i({country:S}),S?.id==="CW"?s("address"):s("city")},h=C=>{console.log("🔵 AddressFormDialog handleCitySelect called with:",C);const S=Qw(C),j=R6(C);if(S&&j){const D={id:S.id,name:S.name};i(F=>({...F,city:D,department:j})),s("address")}},p=C=>{console.log("🔵 AddressFormDialog handleAddressSubmit called with:",C),i(j=>({...j,address:C}));let S="";a.country?.id==="CW"?S=`${a.country.name} - ${C}`:S=`${`${a.country?.name}-${a.department?.name}-${a.city?.name}`} - ${C}`,console.log("🔵 AddressFormDialog calling onChange with:",S),e(S),n(!1),d()},g=C=>{console.log("🔵 AddressFormDialog trigger clicked"),C.preventDefault(),C.stopPropagation(),d(),n(!0)},b=(()=>{if(!r)return null;const C=r.split(" - ");if(C.length<2)return null;const S=C[0],j=C.slice(1).join(" - ");return{locationPart:S,addressPart:j}})(),y=()=>{switch(o){case"country":return c.jsx(QA,{onCountrySelect:f});case"city":return a.country&&c.jsx(L6,{onCitySelect:h,onBackToCountry:()=>s("country")});case"address":return a.country&&c.jsx(F6,{country:a.country,city:a.city,addressInput:l,onAddressInputChange:u,onAddressSubmit:p,onCancel:()=>n(!1),onBackToCity:a.country.id!=="CW"?()=>s("city"):void 0,onBackToCountry:a.country.id==="CW"?()=>s("country"):void 0});default:return null}};return c.jsxs("div",{children:[c.jsx(at,{htmlFor:"address",children:"Dirección (Opcional)"}),c.jsxs(un,{open:t,onOpenChange:n,children:[c.jsx(qA,{asChild:!0,children:c.jsx("div",{className:"mt-1",children:b?c.jsxs("div",{className:"space-y-2",children:[c.jsx("div",{className:"flex items-center gap-2",children:c.jsxs(Ne,{type:"button",variant:"outline",className:"bg-black text-white px-3 py-2 rounded text-sm font-medium flex items-center gap-2",onClick:g,children:[b.locationPart,c.jsx(rm,{className:"h-3 w-3 cursor-pointer"})]})}),c.jsx("div",{className:"text-sm text-gray-600 border rounded px-3 py-2 bg-gray-50",children:b.addressPart})]}):c.jsxs(Ne,{type:"button",variant:"outline",className:"w-full justify-start text-left font-normal",onClick:g,children:[c.jsx(gi,{className:"mr-2 h-4 w-4"}),"Seleccionar dirección"]})})}),c.jsxs(Yr,{className:"w-[95vw] max-w-2xl max-h-[90vh] backdrop-blur-sm flex flex-col",children:[c.jsx(Kr,{className:"flex-shrink-0",children:c.jsx(Xr,{children:"Configurar Dirección"})}),c.jsx("div",{className:"flex-1 overflow-y-auto py-4 min-h-0",children:y()})]})]})]})}function $6({value:r,onChange:e}){return c.jsx(B6,{value:r,onChange:e})}function U6(){const[r,e]=w.useState(!1),[t,n]=w.useState(null),a=w.useCallback(async s=>{if(!s.trim())return n(null),!1;e(!0);try{const{data:l,error:u}=await xe.from("customers").select("id, name").eq("phone",s).maybeSingle();return u?(console.error("Error checking phone:",u),n(null),!1):l?(n({field:"phone",message:`Este teléfono ya está registrado por ${l.name}`}),!0):(n(null),!1)}catch(l){return console.error("Error checking phone:",l),n(null),!1}finally{e(!1)}},[]),i=w.useCallback(async s=>{if(!s.trim())return n(null),!1;e(!0);try{const{data:l,error:u}=await xe.from("customers").select("id, name").eq("id_number",s).maybeSingle();return u?(console.error("Error checking ID number:",u),n(null),!1):l?(n({field:"idNumber",message:`Esta cédula ya está registrada por ${l.name}`}),!0):(n(null),!1)}catch(l){return console.error("Error checking ID number:",l),n(null),!1}finally{e(!1)}},[]),o=w.useCallback(()=>{n(null)},[]);return{isChecking:r,validationError:t,checkCustomerByPhone:a,checkCustomerByIdNumber:i,clearValidationError:o}}function q6({firstName:r,lastName:e,onFirstNameChange:t,onLastNameChange:n}){return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx(at,{htmlFor:"firstName",children:"Nombres *"}),c.jsx(It,{id:"firstName",value:r,onChange:a=>t(a.target.value),required:!0,className:"mt-1"})]}),c.jsxs("div",{children:[c.jsx(at,{htmlFor:"lastName",children:"Apellidos *"}),c.jsx(It,{id:"lastName",value:e,onChange:a=>n(a.target.value),required:!0,className:"mt-1"})]})]})}function V6({value:r,onValueChange:e,className:t}){return c.jsxs(Ca,{value:r,onValueChange:e,children:[c.jsx(ia,{className:t,children:c.jsx(Na,{})}),c.jsx(oa,{children:YA.map((n,a)=>c.jsxs(pr,{value:n.code,children:[n.flag," ",n.code]},`${n.code}-${a}`))})]})}const Ff=(r,e)=>{const t=r.replace(/\D/g,"");return t?e==="+57"?t.length<=3?t:t.length<=6?`${t.slice(0,3)} ${t.slice(3)}`:`${t.slice(0,3)} ${t.slice(3,6)} ${t.slice(6,10)}`:e==="+599"?t.length<=3?t:`${t.slice(0,3)} ${t.slice(3,7)}`:t:""},z6=r=>r.replace(/\D/g,"");function H6({label:r,id:e,countryCode:t,phoneNumber:n,onCountryCodeChange:a,onPhoneNumberChange:i,placeholder:o,required:s=!1,showCountryCodeSelector:l=!0,className:u}){const d=h=>{const p=h.target.value,g=Ff(p,t),v=z6(g);i(v)},f=()=>Ff(n,t);return c.jsxs("div",{children:[c.jsxs(at,{htmlFor:e,children:[r," ",s&&"*"]}),c.jsxs("div",{className:"flex gap-2",children:[l?c.jsx(V6,{value:t,onValueChange:a,className:"w-24"}):c.jsx("div",{className:"w-24 flex items-center justify-center border rounded-md bg-gray-100 text-sm",children:t}),c.jsx(It,{id:e,value:f(),onChange:d,placeholder:o,className:`flex-1 ${u||""}`,required:s})]})]})}const Xo=r=>{const e=r.replace(/\D/g,"");return e?e.replace(/\B(?=(\d{3})+(?!\d))/g,"."):""},$u=r=>r.replace(/\./g,"");function W6({idNumber:r,countryCode:e,phoneNumber:t,validationError:n,isChecking:a,onIdNumberChange:i,onCountryCodeChange:o,onPhoneNumberChange:s}){const l=d=>{const f=d.target.value,h=Xo(f),p=$u(h);i(p)},u=()=>Xo(r);return c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx(at,{htmlFor:"idNumber",children:"Cédula (Opcional)"}),n?.field==="idNumber"&&c.jsxs("div",{className:"flex items-center gap-2 mt-1 mb-2 text-red-600 text-sm",children:[c.jsx(mi,{className:"h-4 w-4"}),c.jsx("span",{children:n.message})]}),c.jsxs("div",{className:"relative",children:[c.jsx(It,{id:"idNumber",value:u(),onChange:l,placeholder:"Número de identificación",className:`mt-1 ${n?.field==="idNumber"?"border-red-500 focus-visible:ring-red-500":""}`,disabled:a}),a&&c.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:c.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-gray-300 border-t-gray-600 rounded-full"})})]})]}),c.jsxs("div",{children:[n?.field==="phone"&&c.jsxs("div",{className:"flex items-center gap-2 mb-2 text-red-600 text-sm",children:[c.jsx(mi,{className:"h-4 w-4"}),c.jsx("span",{children:n.message})]}),c.jsx(H6,{label:"Teléfono",id:"phone",countryCode:e,phoneNumber:t,onCountryCodeChange:o,onPhoneNumberChange:s,placeholder:"Número de teléfono",required:!0,className:n?.field==="phone"?"border-red-500 focus-visible:ring-red-500":""})]})]})}function G6({email:r,showEmailField:e,onEmailChange:t,onToggleEmailField:n}){return c.jsx("div",{className:"space-y-4",children:e?c.jsxs("div",{children:[c.jsx(at,{htmlFor:"email",children:"Email (Opcional)"}),c.jsx(It,{id:"email",type:"email",value:r,onChange:a=>t(a.target.value),placeholder:"correo@ejemplo.com",className:"mt-1"})]}):c.jsxs(Ne,{type:"button",variant:"outline",size:"sm",onClick:n,className:"flex items-center gap-2",children:[c.jsx(VN,{className:"h-4 w-4"}),"Agregar Email (Opcional)"]})})}function Y6({isLoading:r,hasValidationError:e,onCancel:t}){return c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx(Ne,{type:"submit",disabled:r||e,className:"px-6",children:r?"Creando...":"Crear Cliente"}),c.jsx(Ne,{type:"button",variant:"outline",onClick:n=>{console.log("🟢 Cancel button clicked"),n.preventDefault(),n.stopPropagation(),t()},className:"px-6",children:"Cancelar"})]})}function K6({onSuccess:r,onCancel:e}){const[t,n]=w.useState(!1),[a,i]=w.useState(!1),{toast:o}=Lt(),[s,l]=w.useState(GA),{isChecking:u,validationError:d,checkCustomerByPhone:f,checkCustomerByIdNumber:h,clearValidationError:p}=U6(),g=async C=>{if(console.log("🔴 InlineCustomerForm handleSubmit called!"),C.preventDefault(),C.stopPropagation(),d){o({title:"Error de validación",description:"Por favor corrige los errores antes de continuar",variant:"destructive"});return}n(!0);try{const S=`${s.firstName} ${s.lastName}`.trim(),j=`${s.countryCode}${s.phoneNumber}`,D={name:S,email:s.email||`${Date.now()}@temp.com`,phone:j,whatsapp_number:null,address:s.address||null,id_number:s.idNumber||null},{data:F,error:M}=await xe.from("customers").insert([D]).select("id").single();if(M)throw M;o({title:"Cliente creado",description:`${S} ha sido agregado exitosamente`}),r(F.id)}catch(S){console.error("Error creating customer:",S),o({title:"Error",description:"No se pudo crear el cliente",variant:"destructive"})}finally{n(!1)}},v=(C,S)=>{console.log("🟡 updateFormData called for field:",C,"with value:",S),l(j=>({...j,[C]:S}))},b=w.useCallback(async C=>{if(v("phoneNumber",C),C.length>=7){const S=`${s.countryCode}${C}`;await f(S)}else p()},[s.countryCode,f,p]),y=w.useCallback(async C=>{v("idNumber",C),C.length>=6?await h(C):p()},[h,p]);return c.jsx("div",{className:"space-y-6",children:c.jsxs("form",{onSubmit:g,className:"space-y-6",children:[c.jsx(q6,{firstName:s.firstName,lastName:s.lastName,onFirstNameChange:C=>v("firstName",C),onLastNameChange:C=>v("lastName",C)}),c.jsx(W6,{idNumber:s.idNumber,countryCode:s.countryCode,phoneNumber:s.phoneNumber,validationError:d,isChecking:u,onIdNumberChange:y,onCountryCodeChange:C=>v("countryCode",C),onPhoneNumberChange:b}),c.jsx(G6,{email:s.email,showEmailField:a,onEmailChange:C=>v("email",C),onToggleEmailField:()=>{console.log("🟢 Email button clicked"),i(!0)}}),c.jsx("div",{children:c.jsx($6,{value:s.address,onChange:C=>{console.log("🟢 AddressSelector onChange called with value:",C),v("address",C)}})}),c.jsx(Y6,{isLoading:t,hasValidationError:!!d,onCancel:e})]})})}function X6({open:r,onOpenChange:e,onSuccess:t}){const n=i=>{t(i),e(!1)},a=()=>{e(!1)};return c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[700px] max-h-[90vh] flex flex-col",children:[c.jsxs(Kr,{className:"flex-shrink-0",children:[c.jsx(Xr,{children:"Crear Nuevo Cliente"}),c.jsx(sa,{children:"Completa la información para crear un nuevo cliente."})]}),c.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:c.jsx(K6,{onSuccess:n,onCancel:a})})]})})}const Q6=r=>{if(!r)return"";const e=r.replace(/[\s\-\(\)]/g,"");return e.startsWith("+57")?"🇨🇴":e.startsWith("+599")?"🇨🇼":""},Z6=r=>{if(!r)return"";const e=r.replace(/[\s\-\(\)]/g,"");return e.startsWith("+57")?"+57":e.startsWith("+599")?"+599":""},Zw=r=>{if(!r||r.trim()==="")return!1;const e=["tempmail.org","10minutemail.com","guerrillamail.com","mailinator.com","temp-mail.org","throwaway.email","maildrop.cc","yopmail.com","exemplo.com","test.com","temp.com","temporal.com"],t=r.split("@")[1]?.toLowerCase();return t&&!e.includes(t)},J6=r=>{if(!r)return"";const e=Z6(r);return e==="+57"?Ff(r.substring(3),"+57"):e==="+599"?Ff(r.substring(4),"+599"):r};function ej({customer:r,onSelect:e}){const t=Q6(r.phone);return c.jsx("div",{className:"p-3 hover:bg-gray-50 cursor-pointer border-b border-gray-100 last:border-b-0",onClick:()=>e(r),children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ts,{className:"h-4 w-4 text-gray-400"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-medium text-sm",children:r.name}),c.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[Zw(r.email)&&c.jsxs("div",{children:["📧 ",r.email]}),c.jsxs("div",{className:"flex items-center gap-1",children:[t&&c.jsx("span",{children:t}),c.jsxs("span",{children:["📱 ",J6(r.phone)]})]}),r.id_number&&c.jsxs("div",{children:["🆔 ",Xo(r.id_number)]})]})]})]})})}function tj({customers:r,searchTerm:e,show:t,onCustomerSelect:n}){return t?c.jsx("div",{className:"absolute top-full left-0 right-0 z-50 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-y-auto mt-1",children:r.length>0?r.map(a=>c.jsx(ej,{customer:a,onSelect:n},a.id)):e.trim()&&c.jsxs("div",{className:"p-3 text-center text-gray-500 text-sm",children:['No se encontraron clientes que coincidan con "',e,'"']})}):null}function rj({searchTerm:r,filteredCustomers:e,showResults:t,onSearchChange:n,onCustomerSelect:a,onFocus:i,onBlur:o}){return c.jsxs("div",{className:"relative flex-1",children:[c.jsx(fh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx(It,{id:"customer-search",value:r,onChange:s=>n(s.target.value),placeholder:"Buscar por nombre, cédula, teléfono o email...",className:"pl-10",onFocus:i,onBlur:o,required:!0}),c.jsx(tj,{customers:e,searchTerm:r,show:t,onCustomerSelect:a})]})}function nj(r,e){const[t,n]=w.useState(""),[a,i]=w.useState(!1),{data:o=[],refetch:s}=Rt({queryKey:["customers-search"],queryFn:async()=>{const{data:v,error:b}=await xe.from("customers").select("id, name, email, phone, id_number").order("name");if(b)throw b;return v}}),{data:l}=Rt({queryKey:["customer-details",r],queryFn:async()=>{if(!r)return null;console.log("Buscando detalles del cliente:",r);const{data:v,error:b}=await xe.from("customers").select("id, name, email, phone, id_number").eq("id",r).maybeSingle();if(b)throw console.error("Error al buscar cliente:",b),b;return console.log("Cliente encontrado:",v),v},enabled:!!r});w.useEffect(()=>{l&&t!==l.name&&(console.log("Actualizando searchTerm (editable):",l.name),n(l.name))},[l]),w.useEffect(()=>{r||(n(""),i(!1))},[r]);const u=w.useMemo(()=>{if(!t.trim())return[];const v=t.toLowerCase();return o.filter(b=>b.name.toLowerCase().includes(v)||b.phone.includes(v)||Zw(b.email)&&b.email.toLowerCase().includes(v)||b.id_number&&b.id_number.includes(v))},[o,t]);return{searchTerm:t,showResults:a,filteredCustomers:u,selectedCustomer:l,selectedCustomerId:r,handleCustomerSelect:v=>{e(v.id),n(v.name),i(!1)},handleSearchChange:v=>{n(v),i(v.trim().length>0),l&&!l.name.toLowerCase().includes(v.toLowerCase())&&e("")},handleCustomerCreated:v=>{e(v),s();const b=o.find(y=>y.id===v);b&&n(b.name)},handleFocus:()=>{t.trim()&&i(!0)},handleBlur:()=>{setTimeout(()=>i(!1),200)}}}function aj({selectedCustomerId:r,onCustomerChange:e}){const[t,n]=w.useState(!1),{searchTerm:a,showResults:i,filteredCustomers:o,selectedCustomerId:s,handleCustomerSelect:l,handleSearchChange:u,handleCustomerCreated:d,handleFocus:f,handleBlur:h}=nj(r,e);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"relative",children:[c.jsx(at,{htmlFor:"customer-search",children:"Cliente"}),c.jsxs("div",{className:"flex gap-2 mt-1",children:[c.jsx(rj,{searchTerm:a,filteredCustomers:o,showResults:i,onSearchChange:u,onCustomerSelect:l,onFocus:f,onBlur:h}),c.jsx(Ne,{type:"button",variant:"outline",size:"sm",onClick:()=>n(!0),className:"px-3",children:c.jsx(ao,{className:"h-4 w-4"})})]}),a&&!s&&c.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Debe seleccionar un cliente de la lista"})]}),c.jsx(X6,{open:t,onOpenChange:n,onSuccess:d})]})}function Jw({selectedCustomerId:r,onCustomerChange:e,readOnly:t=!1}){return t?c.jsx(WA,{selectedCustomerId:r}):c.jsx(aj,{selectedCustomerId:r,onCustomerChange:e})}function wm({selectedTripId:r,onTripChange:e,disabled:t,readOnly:n}){const{data:a=[]}=Rt({queryKey:["trips-for-packages"],queryFn:async()=>{const{data:s,error:l}=await xe.from("trips").select("id, trip_date, origin, destination, flight_number").eq("status","scheduled").order("trip_date",{ascending:!0});if(l)throw l;return s},enabled:!t&&!n}),{data:i,isLoading:o}=Rt({queryKey:["trip-details",r],queryFn:async()=>{if(!r)return null;console.log("Buscando detalles del viaje:",r);const{data:s,error:l}=await xe.from("trips").select("id, trip_date, origin, destination, flight_number").eq("id",r).maybeSingle();if(l)throw console.error("Error al buscar viaje:",l),l;return console.log("Viaje encontrado:",s),s},enabled:!!r});return t?null:n?o?c.jsxs("div",{children:[c.jsx(at,{htmlFor:"trip",children:"Viaje"}),c.jsx("div",{className:"h-10 w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-600 cursor-not-allowed",children:"Cargando viaje..."})]}):i?c.jsxs("div",{children:[c.jsx(at,{htmlFor:"trip",children:"Viaje"}),c.jsxs("div",{className:"h-10 w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-600 cursor-not-allowed",children:[new Date(i.trip_date).toLocaleDateString()," - ",i.origin," → ",i.destination,i.flight_number&&` (${i.flight_number})`]})]}):r?c.jsxs("div",{children:[c.jsx(at,{htmlFor:"trip",children:"Viaje"}),c.jsx("div",{className:"h-10 w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-600 cursor-not-allowed",children:"Viaje no encontrado"})]}):c.jsxs("div",{children:[c.jsx(at,{htmlFor:"trip",children:"Viaje"}),c.jsx("div",{className:"h-10 w-full rounded-md border border-gray-300 bg-gray-100 px-3 py-2 text-sm text-gray-600 cursor-not-allowed",children:"Sin viaje asignado"})]}):c.jsxs("div",{children:[c.jsx(at,{htmlFor:"trip",children:"Viaje"}),c.jsxs(Ca,{value:r,onValueChange:e,required:!0,children:[c.jsx(ia,{children:c.jsx(Na,{placeholder:"Seleccionar viaje"})}),c.jsx(oa,{children:a.map(s=>c.jsxs(pr,{value:s.id,children:[new Date(s.trip_date).toLocaleDateString()," - ",s.origin," → ",s.destination,s.flight_number&&` (${s.flight_number})`]},s.id))})]})]})}function e5({details:r,onChange:e}){const t=(i,o)=>{const s=[...r];s[i]=o,e(s)},n=i=>{r[i].trim()&&i===r.length-1&&r.length<1e3&&e([...r,""])},a=(i,o)=>{o.key==="Enter"&&(o.preventDefault(),r[i].trim()&&i===r.length-1&&r.length<1e3&&(e([...r,""]),setTimeout(()=>{const l=document.querySelector(`input[data-detail-index="${i+1}"]`);l&&l.focus()},100)))};return c.jsxs("div",{children:[c.jsx(at,{children:"Detalles de productos *"}),c.jsx("div",{className:"space-y-2 mt-2",children:r.map((i,o)=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(It,{"data-detail-index":o,value:i,onChange:s=>t(o,s.target.value),onBlur:()=>n(o),onKeyPress:s=>a(o,s),placeholder:`Producto ${o+1}${o===0?" (requerido)":" (opcional)"}`,required:o===0}),c.jsxs("span",{className:"text-sm text-gray-500 min-w-[60px]",children:[o+1,"/1000"]})]},o))}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Presiona Enter o haz clic fuera del campo para agregar otro producto (máximo 1000)"})]})}function t5({freight:r,freightFormatted:e,weight:t,onFreightChange:n,onWeightChange:a}){console.log("🚢 [FreightAndWeightFields] Current freight (COP):",r),console.log("⚖️ [FreightAndWeightFields] Current weight:",t);const i=o=>{const s=o.target.value,l=Xo(s),u=$u(l);console.log("🚢 [FreightAndWeightFields] Freight changing to:",u,"formatted:",l),n(u,l)};return c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs(at,{htmlFor:"freight",className:"flex items-center gap-2",children:["Flete",c.jsx("span",{className:"text-sm bg-blue-100 px-2 py-1 rounded text-blue-700 font-medium",children:"COP (Peso)"})]}),c.jsx(It,{id:"freight",type:"text",value:e,onChange:i,placeholder:"0"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"El flete siempre se maneja en Pesos Colombianos (COP)"})]}),c.jsxs("div",{children:[c.jsx(at,{htmlFor:"weight",children:"Peso (kg)"}),c.jsx(It,{id:"weight",type:"number",step:"0.1",value:t,onChange:o=>{console.log("⚖️ [FreightAndWeightFields] Weight changing to:",o.target.value),a(o.target.value)},placeholder:"0.0"})]})]})}function ij({currency:r,amountToCollect:e,amountToCollectFormatted:t,onCurrencyChange:n,onAmountChange:a}){const[i,o]=w.useState(!1);console.log("💱 [AmountToCollectSectionNew] Current props:",{currency:r,amountToCollect:e,amountToCollectFormatted:t,currencyType:typeof r});const s=d=>{const f=d.target.value,h=Xo(f),p=$u(h);a(p,h)},l=d=>{console.log("💱 [AmountToCollectSectionNew] Currency change:",{from:r,to:d,type:typeof d});const f=d==="AWG"?"AWG":"COP";console.log("✅ [AmountToCollectSectionNew] Valid currency:",f),n(f),o(!1)},u=()=>{o(!0)};return c.jsxs("div",{className:"space-y-4",children:[c.jsx(at,{htmlFor:"amountToCollect",className:"text-lg font-bold text-black",children:"Valor a Cobrar"}),c.jsxs("div",{className:"flex gap-3",children:[i?c.jsxs(Ca,{value:r,onValueChange:l,children:[c.jsx(ia,{className:"w-28",children:c.jsx(Na,{})}),c.jsxs(oa,{children:[c.jsx(pr,{value:"COP",children:"COP"}),c.jsx(pr,{value:"AWG",children:"AWG"})]})]}):c.jsx("div",{onClick:u,className:"w-28 h-12 flex items-center justify-center bg-gray-100 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-200 transition-colors",children:c.jsx("span",{className:"text-gray-600 font-medium",children:r})}),c.jsx(It,{id:"amountToCollect",type:"text",value:t,onChange:s,placeholder:"0",className:"flex-1"})]})]})}const Uu=w.forwardRef(({className:r,...e},t)=>c.jsx("textarea",{className:Le("flex min-h-[80px] w-full rounded-lg border-0 bg-gray-100 px-4 py-3 text-base text-black ring-offset-background placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-black focus-visible:ring-offset-0 focus-visible:bg-white disabled:cursor-not-allowed disabled:opacity-50 md:text-sm transition-all duration-200",r),ref:t,...e}));Uu.displayName="Textarea";function r5({description:r,onChange:e}){const[t,n]=w.useState(!1);return c.jsxs("div",{children:[c.jsx(Ne,{type:"button",variant:"outline",size:"sm",onClick:()=>n(!t),className:"mb-2",children:t?c.jsxs(c.Fragment,{children:[c.jsx(Jp,{className:"h-4 w-4 mr-2"}),"Ocultar descripción"]}):c.jsxs(c.Fragment,{children:[c.jsx(lh,{className:"h-4 w-4 mr-2"}),"Agregar descripción (opcional)"]})}),t&&c.jsxs("div",{children:[c.jsx(at,{htmlFor:"description",children:"Descripción"}),c.jsx(Uu,{id:"description",value:r,onChange:a=>e(a.target.value),placeholder:"Descripción adicional del contenido...",rows:3})]})]})}var n5="AlertDialog",[oj,dH]=Ui(n5,[Iy]),uo=Iy(),a5=r=>{const{__scopeAlertDialog:e,...t}=r,n=uo(e);return c.jsx(vy,{...n,...t,modal:!0})};a5.displayName=n5;var sj="AlertDialogTrigger",cj=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,a=uo(t);return c.jsx(xy,{...a,...n,ref:e})});cj.displayName=sj;var lj="AlertDialogPortal",i5=r=>{const{__scopeAlertDialog:e,...t}=r,n=uo(e);return c.jsx(gy,{...n,...t})};i5.displayName=lj;var uj="AlertDialogOverlay",o5=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,a=uo(t);return c.jsx(qp,{...a,...n,ref:e})});o5.displayName=uj;var Wc="AlertDialogContent",[dj,fj]=oj(Wc),s5=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,children:n,...a}=r,i=uo(t),o=w.useRef(null),s=Wr(e,o),l=w.useRef(null);return c.jsx(tN,{contentName:Wc,titleName:c5,docsSlug:"alert-dialog",children:c.jsx(dj,{scope:t,cancelRef:l,children:c.jsxs(Vp,{role:"alertdialog",...i,...a,ref:s,onOpenAutoFocus:rt(a.onOpenAutoFocus,u=>{u.preventDefault(),l.current?.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[c.jsx(py,{children:n}),c.jsx(pj,{contentRef:o})]})})})});s5.displayName=Wc;var c5="AlertDialogTitle",l5=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,a=uo(t);return c.jsx(Hp,{...a,...n,ref:e})});l5.displayName=c5;var u5="AlertDialogDescription",d5=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,a=uo(t);return c.jsx(Wp,{...a,...n,ref:e})});d5.displayName=u5;var hj="AlertDialogAction",f5=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,a=uo(t);return c.jsx(zp,{...a,...n,ref:e})});f5.displayName=hj;var h5="AlertDialogCancel",p5=w.forwardRef((r,e)=>{const{__scopeAlertDialog:t,...n}=r,{cancelRef:a}=fj(h5,t),i=uo(t),o=Wr(e,a);return c.jsx(zp,{...i,...n,ref:o})});p5.displayName=h5;var pj=({contentRef:r})=>{const e=`\`${Wc}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Wc}\` by passing a \`${u5}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Wc}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return w.useEffect(()=>{document.getElementById(r.current?.getAttribute("aria-describedby"))||console.warn(e)},[e,r]),null},mj=a5,gj=i5,m5=o5,g5=s5,v5=f5,x5=p5,y5=l5,b5=d5;const w5=mj,vj=gj,_5=w.forwardRef(({className:r,...e},t)=>c.jsx(m5,{className:Le("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...e,ref:t}));_5.displayName=m5.displayName;const _m=w.forwardRef(({className:r,...e},t)=>c.jsxs(vj,{children:[c.jsx(_5,{}),c.jsx(g5,{ref:t,className:Le("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...e})]}));_m.displayName=g5.displayName;const Cm=({className:r,...e})=>c.jsx("div",{className:Le("flex flex-col space-y-2 text-center sm:text-left",r),...e});Cm.displayName="AlertDialogHeader";const Nm=({className:r,...e})=>c.jsx("div",{className:Le("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",r),...e});Nm.displayName="AlertDialogFooter";const Sm=w.forwardRef(({className:r,...e},t)=>c.jsx(y5,{ref:t,className:Le("text-lg font-semibold",r),...e}));Sm.displayName=y5.displayName;const Em=w.forwardRef(({className:r,...e},t)=>c.jsx(b5,{ref:t,className:Le("text-sm text-muted-foreground",r),...e}));Em.displayName=b5.displayName;const Am=w.forwardRef(({className:r,...e},t)=>c.jsx(v5,{ref:t,className:Le(um(),r),...e}));Am.displayName=v5.displayName;const jm=w.forwardRef(({className:r,...e},t)=>c.jsx(x5,{ref:t,className:Le(um({variant:"outline"}),"mt-2 sm:mt-0",r),...e}));jm.displayName=x5.displayName;function xj({package:r,onSuccess:e}){const[t,n]=w.useState(!1),[a,i]=w.useState(!1),{toast:o}=Lt(),s=async()=>{i(!0);try{await xe.from("tracking_events").delete().eq("package_id",r.id);const{error:l}=await xe.from("packages").delete().eq("id",r.id);if(l)throw l;o({title:"Encomienda eliminada",description:"La encomienda ha sido eliminada correctamente"}),n(!1),e()}catch(l){console.error("Error deleting package:",l),o({title:"Error",description:"No se pudo eliminar la encomienda",variant:"destructive"})}finally{i(!1)}};return c.jsxs(c.Fragment,{children:[c.jsxs(Ne,{type:"button",variant:"destructive",onClick:()=>n(!0),className:"flex items-center gap-2",children:[c.jsx(Jy,{className:"h-4 w-4"}),"Eliminar"]}),c.jsx(w5,{open:t,onOpenChange:n,children:c.jsxs(_m,{children:[c.jsxs(Cm,{children:[c.jsx(Sm,{children:"¿Está seguro?"}),c.jsxs(Em,{children:["Esta acción eliminará permanentemente la encomienda ",r.tracking_number,". Esta acción no se puede deshacer."]})]}),c.jsxs(Nm,{children:[c.jsx(jm,{children:"Cancelar"}),c.jsx(Am,{onClick:s,className:"bg-red-600 hover:bg-red-700",disabled:a,children:a?"Eliminando...":"Eliminar"})]})]})})]})}function Pm(){const{toast:r}=Lt(),e=Gr(),t=ln({mutationFn:async({packageId:a,newTripId:i})=>{const{data:o,error:s}=await xe.from("trips").select("origin, destination, flight_number, trip_date").eq("id",i).single();if(s)throw s;const{error:l}=await xe.from("packages").update({trip_id:i,flight_number:o.flight_number,origin:o.origin,destination:o.destination,status:"recibido",updated_at:new Date().toISOString()}).eq("id",a);if(l)throw l;return await xe.from("tracking_events").insert([{package_id:a,event_type:"rescheduled",description:`Encomienda reprogramada para viaje a ${o.destination}`,location:o.origin}]),{packageId:a,newTripId:i,tripDate:o.trip_date}},onSuccess:a=>{if(e.invalidateQueries({queryKey:["packages"]}),e.invalidateQueries({queryKey:["packages-by-date"]}),e.invalidateQueries({queryKey:["packages-by-trip"]}),e.invalidateQueries({queryKey:["dispatch-relations"]}),e.invalidateQueries({queryKey:["dispatch-packages"]}),a.tripDate){const i=pt(new Date(a.tripDate),"yyyy-MM-dd");e.invalidateQueries({queryKey:["packages-by-date",i]})}e.refetchQueries({queryKey:["packages"]}),r({title:"Encomienda reprogramada",description:"La encomienda ha sido reprogramada exitosamente"})},onError:a=>{console.error("Error rescheduling package:",a),r({title:"Error",description:"No se pudo reprogramar la encomienda",variant:"destructive"})}}),n=ln({mutationFn:async a=>{const{error:i}=await xe.from("packages").update({status:"bodega",trip_id:null,flight_number:null,updated_at:new Date().toISOString()}).eq("id",a);if(i)throw i;return await xe.from("tracking_events").insert([{package_id:a,event_type:"warehouse",description:"Encomienda movida a bodega",location:"Bodega"}]),a},onSuccess:()=>{e.invalidateQueries({queryKey:["packages"]}),e.invalidateQueries({queryKey:["packages-by-date"]}),e.invalidateQueries({queryKey:["packages-by-trip"]}),e.invalidateQueries({queryKey:["dispatch-relations"]}),e.invalidateQueries({queryKey:["dispatch-packages"]}),e.refetchQueries({queryKey:["packages"]}),r({title:"Encomienda en bodega",description:"La encomienda ha sido movida a bodega"})},onError:a=>{console.error("Error moving package to warehouse:",a),r({title:"Error",description:"No se pudo mover la encomienda a bodega",variant:"destructive"})}});return{reschedulePackage:async(a,i)=>{try{return await t.mutateAsync({packageId:a,newTripId:i}),!0}catch{return!1}},moveToWarehouse:n.mutate,isRescheduling:t.isPending,isMovingToWarehouse:n.isPending}}function yj({package:r,onSuccess:e}){const[t,n]=w.useState(!1),{moveToWarehouse:a}=Pm(),i=()=>{a(r.id),n(!1),e()};return c.jsxs(c.Fragment,{children:[c.jsxs(Ne,{type:"button",variant:"outline",onClick:()=>n(!0),className:"flex items-center gap-2",children:[c.jsx(eb,{className:"h-4 w-4"}),"Mover a Bodega"]}),c.jsx(w5,{open:t,onOpenChange:n,children:c.jsxs(_m,{children:[c.jsxs(Cm,{children:[c.jsx(Sm,{children:"¿Mover a bodega?"}),c.jsxs(Em,{children:["Esta acción moverá la encomienda ",r.tracking_number," a bodega y la desasignará del viaje actual."]})]}),c.jsxs(Nm,{children:[c.jsx(jm,{children:"Cancelar"}),c.jsx(Am,{onClick:i,children:"Mover a Bodega"})]})]})})]})}function bj({package:r,isLoading:e,onSuccess:t,onCancel:n}){return c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsx(Ne,{type:"submit",disabled:e,className:"w-full",children:e?"Actualizando...":"Actualizar"}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx(yj,{package:r,onSuccess:t}),c.jsx(xj,{package:r,onSuccess:t})]}),c.jsx(Ne,{type:"button",variant:"outline",onClick:n,className:"w-full",children:"Cancelar"})]})}function wj(r){const[e,t]=w.useState({description:"",weight:"",freight:"",freightFormatted:"",amountToCollect:"",amountToCollectFormatted:"",currency:"COP",details:[""]});return w.useEffect(()=>{if(r){console.log("🔄 [useEditPackageFormNew] Initializing with package:",{id:r.id,tracking:r.tracking_number,currency:r.currency,amount:r.amount_to_collect});const i=r.description||"";let o="",s=[""];if(i.includes(" - ")){const d=i.split(" - ");o=d[0],s=d.slice(1).join(" - ").split(", ").filter(h=>h.trim())}else s=i.split(", ").filter(d=>d.trim());s.length===0?s=[""]:s[s.length-1]!==""&&s.push("");const l=r.currency==="AWG"||r.currency==="COP"?r.currency:"COP";console.log("✅ [useEditPackageFormNew] Currency processed:",{original:r.currency,processed:l,type:typeof l});const u={description:o,weight:r.weight?.toString()||"",freight:r.freight?.toString()||"",freightFormatted:r.freight?`$${r.freight.toLocaleString()}`:"",amountToCollect:r.amount_to_collect?.toString()||"",amountToCollectFormatted:r.amount_to_collect?`$${r.amount_to_collect.toLocaleString()}`:"",currency:l,details:s};console.log("📋 [useEditPackageFormNew] Final form data:",u),t(u)}},[r?.id]),{formData:e,updateFormData:i=>{console.log("🔄 [useEditPackageFormNew] Updating form data:",i),t(o=>{const s={...o,...i};return console.log("✅ [useEditPackageFormNew] New form state:",s),s})},getFilledDetails:()=>e.details.filter(i=>i.trim()!=="")}}function _j({package:r,customerId:e,tripId:t,formData:n,getFilledDetails:a,onSuccess:i}){const[o,s]=w.useState(!1),{toast:l}=Lt();return{handleSubmit:async d=>{d.preventDefault();const f=e||r.customer_id,h=t||r.trip_id;if(console.log("🔍 [useEditPackageFormSubmissionNew] Validating IDs:",{formCustomerId:e,packageCustomerId:r.customer_id,finalCustomerId:f,formTripId:t,packageTripId:r.trip_id,finalTripId:h}),!f||!h){console.error("❌ [useEditPackageFormSubmissionNew] Missing required IDs:",{finalCustomerId:f,finalTripId:h,originalCustomerId:r.customer_id,originalTripId:r.trip_id}),l({title:"Error de validación",description:`Faltan datos requeridos: ${f?"":"Cliente"} ${h?"":"Viaje"}`,variant:"destructive"});return}const p=a();if(p.length===0){l({title:"Error",description:"Debe ingresar al menos un detalle del producto",variant:"destructive"});return}s(!0);try{const{data:g,error:v}=await xe.from("trips").select("origin, destination, flight_number").eq("id",h).single();if(v)throw v;let b=p.join(", ");n.description.trim()&&(b=`${n.description.trim()} - ${b}`);const y=n.currency==="AWG"?"AWG":"COP";console.log("📤 [useEditPackageFormSubmissionNew] FINAL DATA TO SAVE:",{packageId:r.id,trackingNumber:r.tracking_number,originalCurrency:r.currency,formCurrency:n.currency,finalCurrency:y,finalCustomerId:f,finalTripId:h,freight:n.freight?parseFloat(n.freight):0,amount_to_collect:n.amountToCollect?parseFloat(n.amountToCollect):0});const C={customer_id:f,description:b,weight:n.weight?parseFloat(n.weight):null,freight:n.freight?parseFloat(n.freight):0,amount_to_collect:n.amountToCollect?parseFloat(n.amountToCollect):0,currency:y,origin:g.origin,destination:g.destination,flight_number:g.flight_number,trip_id:h,updated_at:new Date().toISOString()};console.log("🔥 [useEditPackageFormSubmissionNew] UPDATE DATA:",C);const{error:S}=await xe.from("packages").update(C).eq("id",r.id);if(S)throw console.error("❌ [useEditPackageFormSubmissionNew] Update error:",S),S;console.log("✅ [useEditPackageFormSubmissionNew] PACKAGE UPDATED SUCCESSFULLY WITH CURRENCY:",y),await xe.from("tracking_events").insert([{package_id:r.id,event_type:"updated",description:"Información de encomienda actualizada",location:g.origin}]),l({title:"Encomienda actualizada",description:`La información ha sido actualizada correctamente con divisa ${y}`}),i()}catch(g){console.error("❌ [useEditPackageFormSubmissionNew] Complete error:",g),l({title:"Error",description:"No se pudo actualizar la encomienda",variant:"destructive"})}finally{s(!1)}},isLoading:o}}function Cj({package:r,customerId:e,tripId:t,onSuccess:n,onCancel:a}){const{formData:i,updateFormData:o,getFilledDetails:s}=wj(r),{handleSubmit:l,isLoading:u}=_j({package:r,customerId:e,tripId:t,formData:i,getFilledDetails:s,onSuccess:n});return console.log("🔍 [EditPackageFormNew] Current state:",{packageCurrency:r.currency,formCurrency:i.currency,trackingNumber:r.tracking_number,formCurrencyType:typeof i.currency}),c.jsxs("form",{onSubmit:l,className:"space-y-6",children:[c.jsx(e5,{details:i.details,onChange:d=>o({details:d})}),c.jsx(t5,{freight:i.freight,freightFormatted:i.freightFormatted,weight:i.weight,onFreightChange:(d,f)=>o({freight:d,freightFormatted:f}),onWeightChange:d=>o({weight:d})}),c.jsx(ij,{currency:i.currency,amountToCollect:i.amountToCollect,amountToCollectFormatted:i.amountToCollectFormatted,onCurrencyChange:d=>{console.log("💱 [EditPackageFormNew] Currency change detected:",{from:i.currency,to:d,package:r.tracking_number,currencyType:typeof d}),o({currency:d})},onAmountChange:(d,f)=>o({amountToCollect:d,amountToCollectFormatted:f})}),c.jsx(r5,{description:i.description,onChange:d=>o({description:d})}),c.jsx(bj,{package:r,isLoading:u,onSuccess:n,onCancel:a})]})}function Dm({open:r,onOpenChange:e,package:t,tripId:n,onSuccess:a}){const[i,o]=w.useState(""),[s,l]=w.useState("");w.useEffect(()=>{if(t&&r){console.log("🚀 [EditPackageDialog] Initializing dialog with package and trip:",{packageId:t.id,tracking_number:t.tracking_number,customer_id:t.customer_id,package_trip_id:t.trip_id,passed_trip_id:n,currency:t.currency,amount_to_collect:t.amount_to_collect});const h=n||t.trip_id||"";o(t.customer_id||""),l(h)}},[t,n,r]),w.useEffect(()=>{r||(o(""),l(""))},[r]);const u=()=>{e(!1),a()},d=()=>{e(!1)};if(!t)return null;const f=t.currency==="AWG"||t.currency==="COP"?t.currency:"COP";return console.log("🎯 [EditPackageDialog] Package currency for display:",{original:t.currency,display:f,customer_id:t.customer_id,selectedCustomerId:i,selectedTripId:s}),c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[600px] max-h-[90vh] flex flex-col",children:[c.jsxs(Kr,{className:"flex-shrink-0",children:[c.jsx(Xr,{children:"Editar Encomienda"}),c.jsxs(sa,{children:["Modificar la información de la encomienda ",t.tracking_number,".",c.jsxs("div",{className:"mt-2 text-sm",children:[c.jsxs("span",{className:"inline-block bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:["Divisa: ",f]}),t.amount_to_collect&&c.jsxs("span",{className:"inline-block bg-green-100 text-green-800 px-2 py-1 rounded text-xs ml-2",children:["Monto: ",f," $",t.amount_to_collect.toLocaleString()]}),c.jsxs("span",{className:"inline-block bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs ml-2",children:["Cliente ID: ",i||"No asignado"]}),c.jsxs("span",{className:"inline-block bg-purple-100 text-purple-800 px-2 py-1 rounded text-xs ml-2",children:["Viaje ID: ",s||"No asignado"]})]})]})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 min-h-0",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsx(Jw,{selectedCustomerId:i,onCustomerChange:o,readOnly:!0},`customer-${t.customer_id}-${i}`),c.jsx(wm,{selectedTripId:s,onTripChange:l,readOnly:!0},`trip-${s}`)]}),c.jsx(Cj,{package:t,customerId:i,tripId:s,onSuccess:u,onCancel:d})]})]})})}var Im="Checkbox",[Nj,fH]=Ui(Im),[Sj,Ej]=Nj(Im),C5=w.forwardRef((r,e)=>{const{__scopeCheckbox:t,name:n,checked:a,defaultChecked:i,required:o,disabled:s,value:l="on",onCheckedChange:u,form:d,...f}=r,[h,p]=w.useState(null),g=Wr(e,j=>p(j)),v=w.useRef(!1),b=h?d||!!h.closest("form"):!0,[y=!1,C]=ul({prop:a,defaultProp:i,onChange:u}),S=w.useRef(y);return w.useEffect(()=>{const j=h?.form;if(j){const D=()=>C(S.current);return j.addEventListener("reset",D),()=>j.removeEventListener("reset",D)}},[h,C]),c.jsxs(Sj,{scope:t,state:y,disabled:s,children:[c.jsx(cr.button,{type:"button",role:"checkbox","aria-checked":Uo(y)?"mixed":y,"aria-required":o,"data-state":E5(y),"data-disabled":s?"":void 0,disabled:s,value:l,...f,ref:g,onKeyDown:rt(r.onKeyDown,j=>{j.key==="Enter"&&j.preventDefault()}),onClick:rt(r.onClick,j=>{C(D=>Uo(D)?!0:!D),b&&(v.current=j.isPropagationStopped(),v.current||j.stopPropagation())})}),b&&c.jsx(Aj,{control:h,bubbles:!v.current,name:n,value:l,checked:y,required:o,disabled:s,form:d,style:{transform:"translateX(-100%)"},defaultChecked:Uo(i)?!1:i})]})});C5.displayName=Im;var N5="CheckboxIndicator",S5=w.forwardRef((r,e)=>{const{__scopeCheckbox:t,forceMount:n,...a}=r,i=Ej(N5,t);return c.jsx(Sa,{present:n||Uo(i.state)||i.state===!0,children:c.jsx(cr.span,{"data-state":E5(i.state),"data-disabled":i.disabled?"":void 0,...a,ref:e,style:{pointerEvents:"none",...r.style}})})});S5.displayName=N5;var Aj=r=>{const{control:e,checked:t,bubbles:n=!0,defaultChecked:a,...i}=r,o=w.useRef(null),s=Ty(t),l=Oy(e);w.useEffect(()=>{const d=o.current,f=window.HTMLInputElement.prototype,p=Object.getOwnPropertyDescriptor(f,"checked").set;if(s!==t&&p){const g=new Event("click",{bubbles:n});d.indeterminate=Uo(t),p.call(d,Uo(t)?!1:t),d.dispatchEvent(g)}},[s,t,n]);const u=w.useRef(Uo(t)?!1:t);return c.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a??u.current,...i,tabIndex:-1,ref:o,style:{...r.style,...l,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Uo(r){return r==="indeterminate"}function E5(r){return Uo(r)?"indeterminate":r?"checked":"unchecked"}var A5=C5,jj=S5;const js=w.forwardRef(({className:r,...e},t)=>c.jsx(A5,{ref:t,className:Le("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...e,children:c.jsx(jj,{className:Le("flex items-center justify-center text-current"),children:c.jsx(es,{className:"h-4 w-4"})})}));js.displayName=A5.displayName;function Pj({packages:r,onPrintSelected:e}){const[t,n]=w.useState(new Set),a=d=>{switch(d){case"delivered":return"bg-green-100 text-green-800";case"in_transit":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"delayed":return"bg-red-100 text-red-800";case"arrived":return"bg-purple-100 text-purple-800";case"warehouse":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},i=d=>{switch(d){case"delivered":return"Entregado";case"in_transit":return"En Tránsito";case"pending":return"Pendiente";case"delayed":return"Retrasado";case"arrived":return"Llegado";case"warehouse":return"En Bodega";default:return d}},o=d=>{const f=new Set(t);f.has(d)?f.delete(d):f.add(d),n(f)},s=()=>{t.size===r.length?n(new Set):n(new Set(r.map(d=>d.id)))},l=()=>{const d=r.filter(f=>t.has(f.id));e(d)},u=t.size;return c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(Nt,{children:"Seleccionar Etiquetas para Imprimir"}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(js,{id:"select-all",checked:t.size===r.length&&r.length>0,onCheckedChange:s}),c.jsx("label",{htmlFor:"select-all",className:"text-sm font-medium",children:"Seleccionar todo"})]}),u>0&&c.jsxs(Ne,{onClick:l,className:"flex items-center gap-2",children:[c.jsx(fi,{className:"h-4 w-4"}),"Imprimir ",u," etiqueta",u!==1?"s":""]})]})]})}),c.jsx(We,{children:c.jsx("div",{className:"space-y-3",children:r.map(d=>c.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50",children:[c.jsx(js,{id:d.id,checked:t.has(d.id),onCheckedChange:()=>o(d.id)}),c.jsxs("div",{className:"flex-1 grid grid-cols-5 gap-4 items-center",children:[c.jsx("div",{children:c.jsx("div",{className:"font-medium",children:d.tracking_number})}),c.jsx("div",{children:c.jsx("div",{className:"text-sm",children:d.customers?.name||"N/A"})}),c.jsx("div",{children:c.jsxs("div",{className:"text-sm",children:[d.origin," → ",d.destination]})}),c.jsx("div",{children:c.jsx(Ot,{className:a(d.status),children:i(d.status)})}),c.jsx("div",{className:"text-sm text-gray-500",children:pt(new Date(d.created_at),"dd/MM/yyyy")})]})]},d.id))})})]})}function Dj({package:r,labelData:e,isPrintMode:t=!1}){const n=(s,l)=>new Intl.NumberFormat("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s),a=s=>s==="AWG"?"ƒ":"$",i={width:t?"auto":"10cm",height:t?"auto":"15cm",maxWidth:t?"6in":"10cm",backgroundColor:"white",color:"black",fontSize:t?"14px":"12px",fontFamily:"Arial, sans-serif",display:"flex",flexDirection:"column",border:"1px solid #ccc",margin:"0",padding:"16px",boxSizing:"border-box",lineHeight:"1.2"},o=s=>{const l=new Date(s),d=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][l.getMonth()],f=l.getDate(),h=l.getFullYear().toString().slice(-2);return`${d} ${f}/${h}`};return c.jsxs("div",{style:i,children:[c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px",fontSize:t?"16px":"14px"},children:[c.jsx("div",{style:{fontSize:t?"20px":"18px",fontWeight:"bold"},children:"ENVIOS OJITO"}),c.jsx("div",{style:{fontSize:t?"16px":"14px",fontWeight:"bold"},children:r.tracking_number})]}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"8px",fontSize:t?"14px":"12px"},children:[c.jsx("div",{style:{color:"#666"},children:r.customers?.name||"Cliente"}),c.jsx("div",{style:{color:"#666"},children:o(r.created_at)})]}),c.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"15px",marginBottom:"25px",padding:"10px",border:"2px solid #ddd",borderRadius:"8px",backgroundColor:"#f9f9f9"},children:e?.qrCodeDataUrl&&c.jsx("img",{src:e.qrCodeDataUrl,alt:"QR Code",style:{width:t?"220px":"200px",height:t?"220px":"200px"}})}),c.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px",fontSize:t?"16px":"14px"},children:[c.jsxs("div",{style:{fontWeight:"bold"},children:["Peso: ",r.weight?`${r.weight}kg`:"3kg"]}),c.jsxs("div",{style:{fontWeight:"bold"},children:["Total: ",a(r.currency),r.amount_to_collect?n(r.amount_to_collect,r.currency):"34.543.545"]})]}),c.jsxs("div",{style:{textAlign:"center",fontSize:t?"14px":"12px",lineHeight:"1.4",marginBottom:"12px",fontWeight:"bold"},children:[c.jsx("div",{children:"Toda encomienda debe ser verificada en el local al"}),c.jsx("div",{children:"momento de la entrega. Una vez entregada, no se"}),c.jsx("div",{children:"aceptan reclamos."})]}),c.jsxs("div",{style:{textAlign:"center",fontSize:t?"13px":"11px",lineHeight:"1.5",color:"#000",marginBottom:"15px"},children:[c.jsxs("div",{style:{marginBottom:"6px"},children:[c.jsx("div",{style:{fontWeight:"bold"},children:"Dirección en B/QUILLA: Calle 45B # 22 - 124"}),c.jsx("div",{children:"Tel: +5731272717446"})]}),c.jsxs("div",{children:[c.jsx("div",{style:{fontWeight:"bold"},children:"Dirección Curacao: Jo corsenstraat 48 brievengat"}),c.jsx("div",{children:"Tel: +599 9 6964306"})]})]}),c.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",marginTop:"auto",paddingTop:"10px",borderTop:"1px solid #ddd"},children:e?.barcodeDataUrl&&c.jsxs("div",{style:{textAlign:"center"},children:[c.jsx("img",{src:e.barcodeDataUrl,alt:"Barcode",style:{width:t?"280px":"250px",height:t?"60px":"50px",objectFit:"contain"}}),c.jsx("div",{style:{fontSize:t?"10px":"8px",color:"#666",marginTop:"4px"},children:r.tracking_number})]})})]})}function Ij({packages:r,labelsData:e,onPrint:t,isPDFMode:n=!1}){return c.jsxs("div",{className:"screen-only mb-4 p-4 border rounded-lg bg-white",children:[c.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[n?c.jsx(V1,{className:"h-5 w-5"}):c.jsx(fi,{className:"h-5 w-5"}),"Vista Previa - ",r.length," Etiquetas"]}),c.jsx("div",{className:"text-sm text-gray-600 mb-4",children:n?c.jsxs(c.Fragment,{children:["Se generará un PDF con ",r.length," etiqueta",r.length!==1?"s":"","(cada etiqueta en su propia página tamaño carta)"]}):c.jsxs(c.Fragment,{children:["Se imprimirán ",r.length," etiqueta",r.length!==1?"s":"","en páginas separadas tamaño carta (cada etiqueta en su propia hoja)"]})}),c.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:r.map((a,i)=>{const o=e.get(a.id);return c.jsxs("div",{className:"border border-gray-300 bg-white p-4",children:[c.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:["Página ",i+1," de ",r.length," - ",a.tracking_number]}),c.jsx("div",{className:"text-xs text-gray-400 mb-2",children:"Hoja tamaño carta - Etiqueta centrada"}),c.jsx("div",{className:"flex justify-center bg-gray-50 p-4",children:c.jsx("div",{style:{transform:"scale(0.3)",transformOrigin:"top center"},children:c.jsx(Dj,{package:a,labelData:o})})})]},a.id)})}),c.jsxs(Ne,{onClick:t,className:"mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center gap-2",children:[n?c.jsx(V1,{className:"h-4 w-4"}):c.jsx(fi,{className:"h-4 w-4"}),n?"Generar e Imprimir PDF":"Imprimir"," ",r.length," Etiqueta",r.length!==1?"s":""," (Tamaño Carta)"]})]})}function Tj(){return c.jsx("style",{children:`
      @media screen {
        .print-only {
          display: none;
        }
        .screen-only {
          display: block;
        }
      }
      
      @media print {
        * {
          -webkit-print-color-adjust: exact !important;
          color-adjust: exact !important;
          print-color-adjust: exact !important;
        }
        
        body * {
          visibility: hidden;
        }
        
        .print-container, .print-container * {
          visibility: visible !important;
        }
        
        .print-container {
          position: static !important;
          display: block !important;
          width: 100% !important;
          height: auto !important;
          margin: 0 !important;
          padding: 0 !important;
          background: white !important;
          overflow: visible !important;
        }
        
        .screen-only {
          display: none !important;
        }
        
        @page {
          size: letter;
          margin: 0.5in;
        }
        
        .label-page {
          width: 100% !important;
          height: 100vh !important;
          margin: 0 !important;
          padding: 0 !important;
          display: flex !important;
          flex-direction: column !important;
          justify-content: center !important;
          align-items: center !important;
          position: relative !important;
          box-sizing: border-box !important;
          background: white !important;
          overflow: hidden !important;
          
          /* Forzar salto de página después de cada etiqueta */
          page-break-after: always !important;
          page-break-before: auto !important;
          page-break-inside: avoid !important;
          break-after: page !important;
          break-before: auto !important;
          break-inside: avoid !important;
          
          /* Asegurar que cada página tenga el tamaño correcto */
          min-height: 100vh !important;
          max-height: 100vh !important;
        }
        
        .label-page:first-child {
          page-break-before: avoid !important;
          break-before: avoid !important;
        }
        
        .label-page:last-child {
          page-break-after: auto !important;
          break-after: auto !important;
        }
        
        .label-content {
          width: auto !important;
          height: auto !important;
          margin: 0 auto !important;
          padding: 40px !important;
          display: flex !important;
          justify-content: center !important;
          align-items: center !important;
          border: none !important;
          box-sizing: border-box !important;
          background: white !important;
          position: relative !important;
          overflow: visible !important;
        }
        
        [data-package-id] {
          display: block !important;
          visibility: visible !important;
          opacity: 1 !important;
          width: auto !important;
          height: auto !important;
        }
        
        /* Asegurar que las etiquetas individuales sean visibles */
        .label-page [style*="width"][style*="height"] {
          display: flex !important;
          visibility: visible !important;
        }
        
        /* Forzar recálculo del layout para múltiples páginas */
        .print-container .label-page:nth-child(n+4) {
          page-break-before: always !important;
          break-before: page !important;
        }
      }
    `})}var Vs={},Oj=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},j5={},Ea={};let Tm;const kj=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Ea.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return e*4+17};Ea.getSymbolTotalCodewords=function(e){return kj[e]};Ea.getBCHDigit=function(r){let e=0;for(;r!==0;)e++,r>>>=1;return e};Ea.setToSJISFunction=function(e){if(typeof e!="function")throw new Error('"toSJISFunc" is not a valid function.');Tm=e};Ea.isKanjiModeEnabled=function(){return typeof Tm<"u"};Ea.toSJIS=function(e){return Tm(e)};var Ch={};(function(r){r.L={bit:1},r.M={bit:0},r.Q={bit:3},r.H={bit:2};function e(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return r.L;case"m":case"medium":return r.M;case"q":case"quartile":return r.Q;case"h":case"high":return r.H;default:throw new Error("Unknown EC Level: "+t)}}r.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},r.from=function(n,a){if(r.isValid(n))return n;try{return e(n)}catch{return a}}})(Ch);function P5(){this.buffer=[],this.length=0}P5.prototype={get:function(r){const e=Math.floor(r/8);return(this.buffer[e]>>>7-r%8&1)===1},put:function(r,e){for(let t=0;t<e;t++)this.putBit((r>>>e-t-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(r){const e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),r&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var Mj=P5;function qu(r){if(!r||r<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=r,this.data=new Uint8Array(r*r),this.reservedBit=new Uint8Array(r*r)}qu.prototype.set=function(r,e,t,n){const a=r*this.size+e;this.data[a]=t,n&&(this.reservedBit[a]=!0)};qu.prototype.get=function(r,e){return this.data[r*this.size+e]};qu.prototype.xor=function(r,e,t){this.data[r*this.size+e]^=t};qu.prototype.isReserved=function(r,e){return this.reservedBit[r*this.size+e]};var Rj=qu,D5={};(function(r){const e=Ea.getSymbolSize;r.getRowColCoords=function(n){if(n===1)return[];const a=Math.floor(n/7)+2,i=e(n),o=i===145?26:Math.ceil((i-13)/(2*a-2))*2,s=[i-7];for(let l=1;l<a-1;l++)s[l]=s[l-1]-o;return s.push(6),s.reverse()},r.getPositions=function(n){const a=[],i=r.getRowColCoords(n),o=i.length;for(let s=0;s<o;s++)for(let l=0;l<o;l++)s===0&&l===0||s===0&&l===o-1||s===o-1&&l===0||a.push([i[s],i[l]]);return a}})(D5);var I5={};const Lj=Ea.getSymbolSize,v2=7;I5.getPositions=function(e){const t=Lj(e);return[[0,0],[t-v2,0],[0,t-v2]]};var T5={};(function(r){r.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const e={N1:3,N2:3,N3:40,N4:10};r.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},r.from=function(a){return r.isValid(a)?parseInt(a,10):void 0},r.getPenaltyN1=function(a){const i=a.size;let o=0,s=0,l=0,u=null,d=null;for(let f=0;f<i;f++){s=l=0,u=d=null;for(let h=0;h<i;h++){let p=a.get(f,h);p===u?s++:(s>=5&&(o+=e.N1+(s-5)),u=p,s=1),p=a.get(h,f),p===d?l++:(l>=5&&(o+=e.N1+(l-5)),d=p,l=1)}s>=5&&(o+=e.N1+(s-5)),l>=5&&(o+=e.N1+(l-5))}return o},r.getPenaltyN2=function(a){const i=a.size;let o=0;for(let s=0;s<i-1;s++)for(let l=0;l<i-1;l++){const u=a.get(s,l)+a.get(s,l+1)+a.get(s+1,l)+a.get(s+1,l+1);(u===4||u===0)&&o++}return o*e.N2},r.getPenaltyN3=function(a){const i=a.size;let o=0,s=0,l=0;for(let u=0;u<i;u++){s=l=0;for(let d=0;d<i;d++)s=s<<1&2047|a.get(u,d),d>=10&&(s===1488||s===93)&&o++,l=l<<1&2047|a.get(d,u),d>=10&&(l===1488||l===93)&&o++}return o*e.N3},r.getPenaltyN4=function(a){let i=0;const o=a.data.length;for(let l=0;l<o;l++)i+=a.data[l];return Math.abs(Math.ceil(i*100/o/5)-10)*e.N4};function t(n,a,i){switch(n){case r.Patterns.PATTERN000:return(a+i)%2===0;case r.Patterns.PATTERN001:return a%2===0;case r.Patterns.PATTERN010:return i%3===0;case r.Patterns.PATTERN011:return(a+i)%3===0;case r.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(i/3))%2===0;case r.Patterns.PATTERN101:return a*i%2+a*i%3===0;case r.Patterns.PATTERN110:return(a*i%2+a*i%3)%2===0;case r.Patterns.PATTERN111:return(a*i%3+(a+i)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}r.applyMask=function(a,i){const o=i.size;for(let s=0;s<o;s++)for(let l=0;l<o;l++)i.isReserved(l,s)||i.xor(l,s,t(a,l,s))},r.getBestMask=function(a,i){const o=Object.keys(r.Patterns).length;let s=0,l=1/0;for(let u=0;u<o;u++){i(u),r.applyMask(u,a);const d=r.getPenaltyN1(a)+r.getPenaltyN2(a)+r.getPenaltyN3(a)+r.getPenaltyN4(a);r.applyMask(u,a),d<l&&(l=d,s=u)}return s}})(T5);var Nh={};const Oo=Ch,Kd=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Xd=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Nh.getBlocksCount=function(e,t){switch(t){case Oo.L:return Kd[(e-1)*4+0];case Oo.M:return Kd[(e-1)*4+1];case Oo.Q:return Kd[(e-1)*4+2];case Oo.H:return Kd[(e-1)*4+3];default:return}};Nh.getTotalCodewordsCount=function(e,t){switch(t){case Oo.L:return Xd[(e-1)*4+0];case Oo.M:return Xd[(e-1)*4+1];case Oo.Q:return Xd[(e-1)*4+2];case Oo.H:return Xd[(e-1)*4+3];default:return}};var O5={},Sh={};const gu=new Uint8Array(512),Bf=new Uint8Array(256);(function(){let e=1;for(let t=0;t<255;t++)gu[t]=e,Bf[e]=t,e<<=1,e&256&&(e^=285);for(let t=255;t<512;t++)gu[t]=gu[t-255]})();Sh.log=function(e){if(e<1)throw new Error("log("+e+")");return Bf[e]};Sh.exp=function(e){return gu[e]};Sh.mul=function(e,t){return e===0||t===0?0:gu[Bf[e]+Bf[t]]};(function(r){const e=Sh;r.mul=function(n,a){const i=new Uint8Array(n.length+a.length-1);for(let o=0;o<n.length;o++)for(let s=0;s<a.length;s++)i[o+s]^=e.mul(n[o],a[s]);return i},r.mod=function(n,a){let i=new Uint8Array(n);for(;i.length-a.length>=0;){const o=i[0];for(let l=0;l<a.length;l++)i[l]^=e.mul(a[l],o);let s=0;for(;s<i.length&&i[s]===0;)s++;i=i.slice(s)}return i},r.generateECPolynomial=function(n){let a=new Uint8Array([1]);for(let i=0;i<n;i++)a=r.mul(a,new Uint8Array([1,e.exp(i)]));return a}})(O5);const k5=O5;function Om(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}Om.prototype.initialize=function(e){this.degree=e,this.genPoly=k5.generateECPolynomial(this.degree)};Om.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(e.length+this.degree);t.set(e);const n=k5.mod(t,this.genPoly),a=this.degree-n.length;if(a>0){const i=new Uint8Array(this.degree);return i.set(n,a),i}return n};var Fj=Om,M5={},as={},km={};km.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40};var qi={};const R5="[0-9]+",Bj="[A-Z $%*+\\-./:]+";let ju="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";ju=ju.replace(/u/g,"\\u");const $j="(?:(?![A-Z0-9 $%*+\\-./:]|"+ju+`)(?:.|[\r
]))+`;qi.KANJI=new RegExp(ju,"g");qi.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");qi.BYTE=new RegExp($j,"g");qi.NUMERIC=new RegExp(R5,"g");qi.ALPHANUMERIC=new RegExp(Bj,"g");const Uj=new RegExp("^"+ju+"$"),qj=new RegExp("^"+R5+"$"),Vj=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");qi.testKanji=function(e){return Uj.test(e)};qi.testNumeric=function(e){return qj.test(e)};qi.testAlphanumeric=function(e){return Vj.test(e)};(function(r){const e=km,t=qi;r.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},r.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},r.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},r.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},r.MIXED={bit:-1},r.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!e.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},r.getBestModeForData=function(i){return t.testNumeric(i)?r.NUMERIC:t.testAlphanumeric(i)?r.ALPHANUMERIC:t.testKanji(i)?r.KANJI:r.BYTE},r.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},r.isValid=function(i){return i&&i.bit&&i.ccBits};function n(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return r.NUMERIC;case"alphanumeric":return r.ALPHANUMERIC;case"kanji":return r.KANJI;case"byte":return r.BYTE;default:throw new Error("Unknown mode: "+a)}}r.from=function(i,o){if(r.isValid(i))return i;try{return n(i)}catch{return o}}})(as);(function(r){const e=Ea,t=Nh,n=Ch,a=as,i=km,o=7973,s=e.getBCHDigit(o);function l(h,p,g){for(let v=1;v<=40;v++)if(p<=r.getCapacity(v,g,h))return v}function u(h,p){return a.getCharCountIndicator(h,p)+4}function d(h,p){let g=0;return h.forEach(function(v){const b=u(v.mode,p);g+=b+v.getBitsLength()}),g}function f(h,p){for(let g=1;g<=40;g++)if(d(h,g)<=r.getCapacity(g,p,a.MIXED))return g}r.from=function(p,g){return i.isValid(p)?parseInt(p,10):g},r.getCapacity=function(p,g,v){if(!i.isValid(p))throw new Error("Invalid QR Code version");typeof v>"u"&&(v=a.BYTE);const b=e.getSymbolTotalCodewords(p),y=t.getTotalCodewordsCount(p,g),C=(b-y)*8;if(v===a.MIXED)return C;const S=C-u(v,p);switch(v){case a.NUMERIC:return Math.floor(S/10*3);case a.ALPHANUMERIC:return Math.floor(S/11*2);case a.KANJI:return Math.floor(S/13);case a.BYTE:default:return Math.floor(S/8)}},r.getBestVersionForData=function(p,g){let v;const b=n.from(g,n.M);if(Array.isArray(p)){if(p.length>1)return f(p,b);if(p.length===0)return 1;v=p[0]}else v=p;return l(v.mode,v.getLength(),b)},r.getEncodedBits=function(p){if(!i.isValid(p)||p<7)throw new Error("Invalid QR Code version");let g=p<<12;for(;e.getBCHDigit(g)-s>=0;)g^=o<<e.getBCHDigit(g)-s;return p<<12|g}})(M5);var L5={};const sp=Ea,F5=1335,zj=21522,x2=sp.getBCHDigit(F5);L5.getEncodedBits=function(e,t){const n=e.bit<<3|t;let a=n<<10;for(;sp.getBCHDigit(a)-x2>=0;)a^=F5<<sp.getBCHDigit(a)-x2;return(n<<10|a)^zj};var B5={};const Hj=as;function tl(r){this.mode=Hj.NUMERIC,this.data=r.toString()}tl.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)};tl.prototype.getLength=function(){return this.data.length};tl.prototype.getBitsLength=function(){return tl.getBitsLength(this.data.length)};tl.prototype.write=function(e){let t,n,a;for(t=0;t+3<=this.data.length;t+=3)n=this.data.substr(t,3),a=parseInt(n,10),e.put(a,10);const i=this.data.length-t;i>0&&(n=this.data.substr(t),a=parseInt(n,10),e.put(a,i*3+1))};var Wj=tl;const Gj=as,J0=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function rl(r){this.mode=Gj.ALPHANUMERIC,this.data=r}rl.getBitsLength=function(e){return 11*Math.floor(e/2)+6*(e%2)};rl.prototype.getLength=function(){return this.data.length};rl.prototype.getBitsLength=function(){return rl.getBitsLength(this.data.length)};rl.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let n=J0.indexOf(this.data[t])*45;n+=J0.indexOf(this.data[t+1]),e.put(n,11)}this.data.length%2&&e.put(J0.indexOf(this.data[t]),6)};var Yj=rl;const Kj=as;function nl(r){this.mode=Kj.BYTE,typeof r=="string"?this.data=new TextEncoder().encode(r):this.data=new Uint8Array(r)}nl.getBitsLength=function(e){return e*8};nl.prototype.getLength=function(){return this.data.length};nl.prototype.getBitsLength=function(){return nl.getBitsLength(this.data.length)};nl.prototype.write=function(r){for(let e=0,t=this.data.length;e<t;e++)r.put(this.data[e],8)};var Xj=nl;const Qj=as,Zj=Ea;function al(r){this.mode=Qj.KANJI,this.data=r}al.getBitsLength=function(e){return e*13};al.prototype.getLength=function(){return this.data.length};al.prototype.getBitsLength=function(){return al.getBitsLength(this.data.length)};al.prototype.write=function(r){let e;for(e=0;e<this.data.length;e++){let t=Zj.toSJIS(this.data[e]);if(t>=33088&&t<=40956)t-=33088;else if(t>=57408&&t<=60351)t-=49472;else throw new Error("Invalid SJIS character: "+this.data[e]+`
Make sure your charset is UTF-8`);t=(t>>>8&255)*192+(t&255),r.put(t,13)}};var Jj=al,$5={exports:{}};(function(r){var e={single_source_shortest_paths:function(t,n,a){var i={},o={};o[n]=0;var s=e.PriorityQueue.make();s.push(n,0);for(var l,u,d,f,h,p,g,v,b;!s.empty();){l=s.pop(),u=l.value,f=l.cost,h=t[u]||{};for(d in h)h.hasOwnProperty(d)&&(p=h[d],g=f+p,v=o[d],b=typeof o[d]>"u",(b||v>g)&&(o[d]=g,s.push(d,g),i[d]=u))}if(typeof a<"u"&&typeof o[a]>"u"){var y=["Could not find a path from ",n," to ",a,"."].join("");throw new Error(y)}return i},extract_shortest_path_from_predecessor_list:function(t,n){for(var a=[],i=n;i;)a.push(i),t[i],i=t[i];return a.reverse(),a},find_path:function(t,n,a){var i=e.single_source_shortest_paths(t,n,a);return e.extract_shortest_path_from_predecessor_list(i,a)},PriorityQueue:{make:function(t){var n=e.PriorityQueue,a={},i;t=t||{};for(i in n)n.hasOwnProperty(i)&&(a[i]=n[i]);return a.queue=[],a.sorter=t.sorter||n.default_sorter,a},default_sorter:function(t,n){return t.cost-n.cost},push:function(t,n){var a={value:t,cost:n};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};r.exports=e})($5);var eP=$5.exports;(function(r){const e=as,t=Wj,n=Yj,a=Xj,i=Jj,o=qi,s=Ea,l=eP;function u(y){return unescape(encodeURIComponent(y)).length}function d(y,C,S){const j=[];let D;for(;(D=y.exec(S))!==null;)j.push({data:D[0],index:D.index,mode:C,length:D[0].length});return j}function f(y){const C=d(o.NUMERIC,e.NUMERIC,y),S=d(o.ALPHANUMERIC,e.ALPHANUMERIC,y);let j,D;return s.isKanjiModeEnabled()?(j=d(o.BYTE,e.BYTE,y),D=d(o.KANJI,e.KANJI,y)):(j=d(o.BYTE_KANJI,e.BYTE,y),D=[]),C.concat(S,j,D).sort(function(M,T){return M.index-T.index}).map(function(M){return{data:M.data,mode:M.mode,length:M.length}})}function h(y,C){switch(C){case e.NUMERIC:return t.getBitsLength(y);case e.ALPHANUMERIC:return n.getBitsLength(y);case e.KANJI:return i.getBitsLength(y);case e.BYTE:return a.getBitsLength(y)}}function p(y){return y.reduce(function(C,S){const j=C.length-1>=0?C[C.length-1]:null;return j&&j.mode===S.mode?(C[C.length-1].data+=S.data,C):(C.push(S),C)},[])}function g(y){const C=[];for(let S=0;S<y.length;S++){const j=y[S];switch(j.mode){case e.NUMERIC:C.push([j,{data:j.data,mode:e.ALPHANUMERIC,length:j.length},{data:j.data,mode:e.BYTE,length:j.length}]);break;case e.ALPHANUMERIC:C.push([j,{data:j.data,mode:e.BYTE,length:j.length}]);break;case e.KANJI:C.push([j,{data:j.data,mode:e.BYTE,length:u(j.data)}]);break;case e.BYTE:C.push([{data:j.data,mode:e.BYTE,length:u(j.data)}])}}return C}function v(y,C){const S={},j={start:{}};let D=["start"];for(let F=0;F<y.length;F++){const M=y[F],T=[];for(let q=0;q<M.length;q++){const J=M[q],O=""+F+q;T.push(O),S[O]={node:J,lastCount:0},j[O]={};for(let k=0;k<D.length;k++){const H=D[k];S[H]&&S[H].node.mode===J.mode?(j[H][O]=h(S[H].lastCount+J.length,J.mode)-h(S[H].lastCount,J.mode),S[H].lastCount+=J.length):(S[H]&&(S[H].lastCount=J.length),j[H][O]=h(J.length,J.mode)+4+e.getCharCountIndicator(J.mode,C))}}D=T}for(let F=0;F<D.length;F++)j[D[F]].end=0;return{map:j,table:S}}function b(y,C){let S;const j=e.getBestModeForData(y);if(S=e.from(C,j),S!==e.BYTE&&S.bit<j.bit)throw new Error('"'+y+'" cannot be encoded with mode '+e.toString(S)+`.
 Suggested mode is: `+e.toString(j));switch(S===e.KANJI&&!s.isKanjiModeEnabled()&&(S=e.BYTE),S){case e.NUMERIC:return new t(y);case e.ALPHANUMERIC:return new n(y);case e.KANJI:return new i(y);case e.BYTE:return new a(y)}}r.fromArray=function(C){return C.reduce(function(S,j){return typeof j=="string"?S.push(b(j,null)):j.data&&S.push(b(j.data,j.mode)),S},[])},r.fromString=function(C,S){const j=f(C,s.isKanjiModeEnabled()),D=g(j),F=v(D,S),M=l.find_path(F.map,"start","end"),T=[];for(let q=1;q<M.length-1;q++)T.push(F.table[M[q]].node);return r.fromArray(p(T))},r.rawSplit=function(C){return r.fromArray(f(C,s.isKanjiModeEnabled()))}})(B5);const Eh=Ea,e1=Ch,tP=Mj,rP=Rj,nP=D5,aP=I5,cp=T5,lp=Nh,iP=Fj,$f=M5,oP=L5,sP=as,t1=B5;function cP(r,e){const t=r.size,n=aP.getPositions(e);for(let a=0;a<n.length;a++){const i=n[a][0],o=n[a][1];for(let s=-1;s<=7;s++)if(!(i+s<=-1||t<=i+s))for(let l=-1;l<=7;l++)o+l<=-1||t<=o+l||(s>=0&&s<=6&&(l===0||l===6)||l>=0&&l<=6&&(s===0||s===6)||s>=2&&s<=4&&l>=2&&l<=4?r.set(i+s,o+l,!0,!0):r.set(i+s,o+l,!1,!0))}}function lP(r){const e=r.size;for(let t=8;t<e-8;t++){const n=t%2===0;r.set(t,6,n,!0),r.set(6,t,n,!0)}}function uP(r,e){const t=nP.getPositions(e);for(let n=0;n<t.length;n++){const a=t[n][0],i=t[n][1];for(let o=-2;o<=2;o++)for(let s=-2;s<=2;s++)o===-2||o===2||s===-2||s===2||o===0&&s===0?r.set(a+o,i+s,!0,!0):r.set(a+o,i+s,!1,!0)}}function dP(r,e){const t=r.size,n=$f.getEncodedBits(e);let a,i,o;for(let s=0;s<18;s++)a=Math.floor(s/3),i=s%3+t-8-3,o=(n>>s&1)===1,r.set(a,i,o,!0),r.set(i,a,o,!0)}function r1(r,e,t){const n=r.size,a=oP.getEncodedBits(e,t);let i,o;for(i=0;i<15;i++)o=(a>>i&1)===1,i<6?r.set(i,8,o,!0):i<8?r.set(i+1,8,o,!0):r.set(n-15+i,8,o,!0),i<8?r.set(8,n-i-1,o,!0):i<9?r.set(8,15-i-1+1,o,!0):r.set(8,15-i-1,o,!0);r.set(n-8,8,1,!0)}function fP(r,e){const t=r.size;let n=-1,a=t-1,i=7,o=0;for(let s=t-1;s>0;s-=2)for(s===6&&s--;;){for(let l=0;l<2;l++)if(!r.isReserved(a,s-l)){let u=!1;o<e.length&&(u=(e[o]>>>i&1)===1),r.set(a,s-l,u),i--,i===-1&&(o++,i=7)}if(a+=n,a<0||t<=a){a-=n,n=-n;break}}}function hP(r,e,t){const n=new tP;t.forEach(function(l){n.put(l.mode.bit,4),n.put(l.getLength(),sP.getCharCountIndicator(l.mode,r)),l.write(n)});const a=Eh.getSymbolTotalCodewords(r),i=lp.getTotalCodewordsCount(r,e),o=(a-i)*8;for(n.getLengthInBits()+4<=o&&n.put(0,4);n.getLengthInBits()%8!==0;)n.putBit(0);const s=(o-n.getLengthInBits())/8;for(let l=0;l<s;l++)n.put(l%2?17:236,8);return pP(n,r,e)}function pP(r,e,t){const n=Eh.getSymbolTotalCodewords(e),a=lp.getTotalCodewordsCount(e,t),i=n-a,o=lp.getBlocksCount(e,t),s=n%o,l=o-s,u=Math.floor(n/o),d=Math.floor(i/o),f=d+1,h=u-d,p=new iP(h);let g=0;const v=new Array(o),b=new Array(o);let y=0;const C=new Uint8Array(r.buffer);for(let M=0;M<o;M++){const T=M<l?d:f;v[M]=C.slice(g,g+T),b[M]=p.encode(v[M]),g+=T,y=Math.max(y,T)}const S=new Uint8Array(n);let j=0,D,F;for(D=0;D<y;D++)for(F=0;F<o;F++)D<v[F].length&&(S[j++]=v[F][D]);for(D=0;D<h;D++)for(F=0;F<o;F++)S[j++]=b[F][D];return S}function mP(r,e,t,n){let a;if(Array.isArray(r))a=t1.fromArray(r);else if(typeof r=="string"){let u=e;if(!u){const d=t1.rawSplit(r);u=$f.getBestVersionForData(d,t)}a=t1.fromString(r,u||40)}else throw new Error("Invalid data");const i=$f.getBestVersionForData(a,t);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!e)e=i;else if(e<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=hP(e,t,a),s=Eh.getSymbolSize(e),l=new rP(s);return cP(l,e),lP(l),uP(l,e),r1(l,t,0),e>=7&&dP(l,e),fP(l,o),isNaN(n)&&(n=cp.getBestMask(l,r1.bind(null,l,t))),cp.applyMask(n,l),r1(l,t,n),{modules:l,version:e,errorCorrectionLevel:t,maskPattern:n,segments:a}}j5.create=function(e,t){if(typeof e>"u"||e==="")throw new Error("No input text");let n=e1.M,a,i;return typeof t<"u"&&(n=e1.from(t.errorCorrectionLevel,e1.M),a=$f.from(t.version),i=cp.from(t.maskPattern),t.toSJISFunc&&Eh.setToSJISFunction(t.toSJISFunc)),mP(e,a,n,i)};var U5={},Mm={};(function(r){function e(t){if(typeof t=="number"&&(t=t.toString()),typeof t!="string")throw new Error("Color should be defined as hex string");let n=t.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+t);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(i){return[i,i]}))),n.length===6&&n.push("F","F");const a=parseInt(n.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+n.slice(0,6).join("")}}r.getOptions=function(n){n||(n={}),n.color||(n.color={});const a=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,i=n.width&&n.width>=21?n.width:void 0,o=n.scale||4;return{width:i,scale:i?4:o,margin:a,color:{dark:e(n.color.dark||"#000000ff"),light:e(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},r.getScale=function(n,a){return a.width&&a.width>=n+a.margin*2?a.width/(n+a.margin*2):a.scale},r.getImageWidth=function(n,a){const i=r.getScale(n,a);return Math.floor((n+a.margin*2)*i)},r.qrToImageData=function(n,a,i){const o=a.modules.size,s=a.modules.data,l=r.getScale(o,i),u=Math.floor((o+i.margin*2)*l),d=i.margin*l,f=[i.color.light,i.color.dark];for(let h=0;h<u;h++)for(let p=0;p<u;p++){let g=(h*u+p)*4,v=i.color.light;if(h>=d&&p>=d&&h<u-d&&p<u-d){const b=Math.floor((h-d)/l),y=Math.floor((p-d)/l);v=f[s[b*o+y]?1:0]}n[g++]=v.r,n[g++]=v.g,n[g++]=v.b,n[g]=v.a}}})(Mm);(function(r){const e=Mm;function t(a,i,o){a.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}r.render=function(i,o,s){let l=s,u=o;typeof l>"u"&&(!o||!o.getContext)&&(l=o,o=void 0),o||(u=n()),l=e.getOptions(l);const d=e.getImageWidth(i.modules.size,l),f=u.getContext("2d"),h=f.createImageData(d,d);return e.qrToImageData(h.data,i,l),t(f,u,d),f.putImageData(h,0,0),u},r.renderToDataURL=function(i,o,s){let l=s;typeof l>"u"&&(!o||!o.getContext)&&(l=o,o=void 0),l||(l={});const u=r.render(i,o,l),d=l.type||"image/png",f=l.rendererOpts||{};return u.toDataURL(d,f.quality)}})(U5);var q5={};const gP=Mm;function y2(r,e){const t=r.a/255,n=e+'="'+r.hex+'"';return t<1?n+" "+e+'-opacity="'+t.toFixed(2).slice(1)+'"':n}function n1(r,e,t){let n=r+e;return typeof t<"u"&&(n+=" "+t),n}function vP(r,e,t){let n="",a=0,i=!1,o=0;for(let s=0;s<r.length;s++){const l=Math.floor(s%e),u=Math.floor(s/e);!l&&!i&&(i=!0),r[s]?(o++,s>0&&l>0&&r[s-1]||(n+=i?n1("M",l+t,.5+u+t):n1("m",a,0),a=0,i=!1),l+1<e&&r[s+1]||(n+=n1("h",o),o=0)):a++}return n}q5.render=function(e,t,n){const a=gP.getOptions(t),i=e.modules.size,o=e.modules.data,s=i+a.margin*2,l=a.color.light.a?"<path "+y2(a.color.light,"fill")+' d="M0 0h'+s+"v"+s+'H0z"/>':"",u="<path "+y2(a.color.dark,"stroke")+' d="'+vP(o,i,a.margin)+'"/>',d='viewBox="0 0 '+s+" "+s+'"',h='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+d+' shape-rendering="crispEdges">'+l+u+`</svg>
`;return typeof n=="function"&&n(null,h),h};const xP=Oj,up=j5,V5=U5,yP=q5;function Rm(r,e,t,n,a){const i=[].slice.call(arguments,1),o=i.length,s=typeof i[o-1]=="function";if(!s&&!xP())throw new Error("Callback required as last argument");if(s){if(o<2)throw new Error("Too few arguments provided");o===2?(a=t,t=e,e=n=void 0):o===3&&(e.getContext&&typeof a>"u"?(a=n,n=void 0):(a=n,n=t,t=e,e=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(t=e,e=n=void 0):o===2&&!e.getContext&&(n=t,t=e,e=void 0),new Promise(function(l,u){try{const d=up.create(t,n);l(r(d,e,n))}catch(d){u(d)}})}try{const l=up.create(t,n);a(null,r(l,e,n))}catch(l){a(l)}}Vs.create=up.create;Vs.toCanvas=Rm.bind(null,V5.render);Vs.toDataURL=Rm.bind(null,V5.renderToDataURL);Vs.toString=Rm.bind(null,function(r,e,t){return yP.render(r,t)});var Lm={},Ah={},la={};Object.defineProperty(la,"__esModule",{value:!0});function bP(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var wP=function r(e,t){bP(this,r),this.data=e,this.text=t.text||e,this.options=t};la.default=wP;Object.defineProperty(Ah,"__esModule",{value:!0});Ah.CODE39=void 0;var _P=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),CP=la,NP=SP(CP);function SP(r){return r&&r.__esModule?r:{default:r}}function EP(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function AP(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function jP(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var PP=function(r){jP(e,r);function e(t,n){return EP(this,e),t=t.toUpperCase(),n.mod43&&(t+=TP(OP(t))),AP(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return _P(e,[{key:"encode",value:function(){for(var n=a1("*"),a=0;a<this.data.length;a++)n+=a1(this.data[a])+"0";return n+=a1("*"),{data:n,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)!==-1}}]),e}(NP.default),z5=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],DP=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function a1(r){return IP(H5(r))}function IP(r){return DP[r].toString(2)}function TP(r){return z5[r]}function H5(r){return z5.indexOf(r)}function OP(r){for(var e=0,t=0;t<r.length;t++)e+=H5(r[t]);return e=e%43,e}Ah.CODE39=PP;var Ii={},Fm={},hl={},br={};Object.defineProperty(br,"__esModule",{value:!0});var Zl;function i1(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}var W5=br.SET_A=0,G5=br.SET_B=1,Y5=br.SET_C=2;br.SHIFT=98;var kP=br.START_A=103,MP=br.START_B=104,RP=br.START_C=105;br.MODULO=103;br.STOP=106;br.FNC1=207;br.SET_BY_CODE=(Zl={},i1(Zl,kP,W5),i1(Zl,MP,G5),i1(Zl,RP,Y5),Zl);br.SWAP={101:W5,100:G5,99:Y5};br.A_START_CHAR="Ð";br.B_START_CHAR="Ñ";br.C_START_CHAR="Ò";br.A_CHARS="[\0-_È-Ï]";br.B_CHARS="[ -È-Ï]";br.C_CHARS="(Ï*[0-9]{2}Ï*)";br.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011];Object.defineProperty(hl,"__esModule",{value:!0});var LP=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),FP=la,BP=$P(FP),xa=br;function $P(r){return r&&r.__esModule?r:{default:r}}function UP(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function qP(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function VP(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var zP=function(r){VP(e,r);function e(t,n){UP(this,e);var a=qP(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.substring(1),n));return a.bytes=t.split("").map(function(i){return i.charCodeAt(0)}),a}return LP(e,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var n=this.bytes,a=n.shift()-105,i=xa.SET_BY_CODE[a];if(i===void 0)throw new RangeError("The encoding does not start with a start character.");this.shouldEncodeAsEan128()===!0&&n.unshift(xa.FNC1);var o=e.next(n,1,i);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:e.getBar(a)+o.result+e.getBar((o.checksum+a)%xa.MODULO)+e.getBar(xa.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var n=this.options.ean128||!1;return typeof n=="string"&&(n=n.toLowerCase()==="true"),n}}],[{key:"getBar",value:function(n){return xa.BARS[n]?xa.BARS[n].toString():""}},{key:"correctIndex",value:function(n,a){if(a===xa.SET_A){var i=n.shift();return i<32?i+64:i-32}else return a===xa.SET_B?n.shift()-32:(n.shift()-48)*10+n.shift()-48}},{key:"next",value:function(n,a,i){if(!n.length)return{result:"",checksum:0};var o=void 0,s=void 0;if(n[0]>=200){s=n.shift()-105;var l=xa.SWAP[s];l!==void 0?o=e.next(n,a+1,l):((i===xa.SET_A||i===xa.SET_B)&&s===xa.SHIFT&&(n[0]=i===xa.SET_A?n[0]>95?n[0]-96:n[0]:n[0]<32?n[0]+96:n[0]),o=e.next(n,a+1,i))}else s=e.correctIndex(n,i),o=e.next(n,a+1,i);var u=e.getBar(s),d=s*a;return{result:u+o.result,checksum:d+o.checksum}}}]),e}(BP.default);hl.default=zP;var Bm={};Object.defineProperty(Bm,"__esModule",{value:!0});var qo=br,K5=function(e){return e.match(new RegExp("^"+qo.A_CHARS+"*"))[0].length},X5=function(e){return e.match(new RegExp("^"+qo.B_CHARS+"*"))[0].length},Q5=function(e){return e.match(new RegExp("^"+qo.C_CHARS+"*"))[0]};function $m(r,e){var t=e?qo.A_CHARS:qo.B_CHARS,n=r.match(new RegExp("^("+t+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(n)return n[1]+"Ì"+Z5(r.substring(n[1].length));var a=r.match(new RegExp("^"+t+"+"))[0];return a.length===r.length?r:a+String.fromCharCode(e?205:206)+$m(r.substring(a.length),!e)}function Z5(r){var e=Q5(r),t=e.length;if(t===r.length)return r;r=r.substring(t);var n=K5(r)>=X5(r);return e+String.fromCharCode(n?206:205)+$m(r,n)}Bm.default=function(r){var e=void 0,t=Q5(r).length;if(t>=2)e=qo.C_START_CHAR+Z5(r);else{var n=K5(r)>X5(r);e=(n?qo.A_START_CHAR:qo.B_START_CHAR)+$m(r,n)}return e.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(a,i){return"Ë"+i})};Object.defineProperty(Fm,"__esModule",{value:!0});var HP=hl,WP=J5(HP),GP=Bm,YP=J5(GP);function J5(r){return r&&r.__esModule?r:{default:r}}function KP(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function o1(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function XP(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var QP=function(r){XP(e,r);function e(t,n){if(KP(this,e),/^[\x00-\x7F\xC8-\xD3]+$/.test(t))var a=o1(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,(0,YP.default)(t),n));else var a=o1(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return o1(a)}return e}(WP.default);Fm.default=QP;var Um={};Object.defineProperty(Um,"__esModule",{value:!0});var ZP=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),JP=hl,eD=tD(JP),b2=br;function tD(r){return r&&r.__esModule?r:{default:r}}function rD(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function nD(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function aD(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var iD=function(r){aD(e,r);function e(t,n){return rD(this,e),nD(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,b2.A_START_CHAR+t,n))}return ZP(e,[{key:"valid",value:function(){return new RegExp("^"+b2.A_CHARS+"+$").test(this.data)}}]),e}(eD.default);Um.default=iD;var qm={};Object.defineProperty(qm,"__esModule",{value:!0});var oD=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),sD=hl,cD=lD(sD),w2=br;function lD(r){return r&&r.__esModule?r:{default:r}}function uD(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function dD(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function fD(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var hD=function(r){fD(e,r);function e(t,n){return uD(this,e),dD(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,w2.B_START_CHAR+t,n))}return oD(e,[{key:"valid",value:function(){return new RegExp("^"+w2.B_CHARS+"+$").test(this.data)}}]),e}(cD.default);qm.default=hD;var Vm={};Object.defineProperty(Vm,"__esModule",{value:!0});var pD=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),mD=hl,gD=vD(mD),_2=br;function vD(r){return r&&r.__esModule?r:{default:r}}function xD(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function yD(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function bD(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var wD=function(r){bD(e,r);function e(t,n){return xD(this,e),yD(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,_2.C_START_CHAR+t,n))}return pD(e,[{key:"valid",value:function(){return new RegExp("^"+_2.C_CHARS+"+$").test(this.data)}}]),e}(gD.default);Vm.default=wD;Object.defineProperty(Ii,"__esModule",{value:!0});Ii.CODE128C=Ii.CODE128B=Ii.CODE128A=Ii.CODE128=void 0;var _D=Fm,CD=jh(_D),ND=Um,SD=jh(ND),ED=qm,AD=jh(ED),jD=Vm,PD=jh(jD);function jh(r){return r&&r.__esModule?r:{default:r}}Ii.CODE128=CD.default;Ii.CODE128A=SD.default;Ii.CODE128B=AD.default;Ii.CODE128C=PD.default;var na={},zm={},Ya={};Object.defineProperty(Ya,"__esModule",{value:!0});Ya.SIDE_BIN="101";Ya.MIDDLE_BIN="01010";Ya.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]};Ya.EAN2_STRUCTURE=["LL","LG","GL","GG"];Ya.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"];Ya.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"];var Ph={},zs={};Object.defineProperty(zs,"__esModule",{value:!0});var DD=Ya,ID=function(e,t,n){var a=e.split("").map(function(o,s){return DD.BINARIES[t[s]]}).map(function(o,s){return o?o[e[s]]:""});if(n){var i=e.length-1;a=a.map(function(o,s){return s<i?o+n:o})}return a.join("")};zs.default=ID;Object.defineProperty(Ph,"__esModule",{value:!0});var TD=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),Ac=Ya,OD=zs,C2=e3(OD),kD=la,MD=e3(kD);function e3(r){return r&&r.__esModule?r:{default:r}}function RD(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function LD(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function FD(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var BD=function(r){FD(e,r);function e(t,n){RD(this,e);var a=LD(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return a.fontSize=!n.flat&&n.fontSize>n.width*10?n.width*10:n.fontSize,a.guardHeight=n.height+a.fontSize/2+n.textMargin,a}return TD(e,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(n,a){return this.text.substr(n,a)}},{key:"leftEncode",value:function(n,a){return(0,C2.default)(n,a)}},{key:"rightText",value:function(n,a){return this.text.substr(n,a)}},{key:"rightEncode",value:function(n,a){return(0,C2.default)(n,a)}},{key:"encodeGuarded",value:function(){var n={fontSize:this.fontSize},a={height:this.guardHeight};return[{data:Ac.SIDE_BIN,options:a},{data:this.leftEncode(),text:this.leftText(),options:n},{data:Ac.MIDDLE_BIN,options:a},{data:this.rightEncode(),text:this.rightText(),options:n},{data:Ac.SIDE_BIN,options:a}]}},{key:"encodeFlat",value:function(){var n=[Ac.SIDE_BIN,this.leftEncode(),Ac.MIDDLE_BIN,this.rightEncode(),Ac.SIDE_BIN];return{data:n.join(""),text:this.text}}}]),e}(MD.default);Ph.default=BD;Object.defineProperty(zm,"__esModule",{value:!0});var $D=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),Jl=function r(e,t,n){e===null&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,t);if(a===void 0){var i=Object.getPrototypeOf(e);return i===null?void 0:r(i,t,n)}else{if("value"in a)return a.value;var o=a.get;return o===void 0?void 0:o.call(n)}},UD=Ya,qD=Ph,VD=zD(qD);function zD(r){return r&&r.__esModule?r:{default:r}}function HD(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function WD(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function GD(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var N2=function(e){var t=e.substr(0,12).split("").map(function(n){return+n}).reduce(function(n,a,i){return i%2?n+a*3:n+a},0);return(10-t%10)%10},YD=function(r){GD(e,r);function e(t,n){HD(this,e),t.search(/^[0-9]{12}$/)!==-1&&(t+=N2(t));var a=WD(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return a.lastChar=n.lastChar,a}return $D(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{13}$/)!==-1&&+this.data[12]===N2(this.data)}},{key:"leftText",value:function(){return Jl(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var n=this.data.substr(1,6),a=UD.EAN13_STRUCTURE[this.data[0]];return Jl(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,n,a)}},{key:"rightText",value:function(){return Jl(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var n=this.data.substr(7,6);return Jl(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,n,"RRRRRR")}},{key:"encodeGuarded",value:function(){var n=Jl(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(n.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(n.push({data:"00"}),n.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),n}}]),e}(VD.default);zm.default=YD;var Hm={};Object.defineProperty(Hm,"__esModule",{value:!0});var KD=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),Qd=function r(e,t,n){e===null&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,t);if(a===void 0){var i=Object.getPrototypeOf(e);return i===null?void 0:r(i,t,n)}else{if("value"in a)return a.value;var o=a.get;return o===void 0?void 0:o.call(n)}},XD=Ph,QD=ZD(XD);function ZD(r){return r&&r.__esModule?r:{default:r}}function JD(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function e7(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function t7(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var S2=function(e){var t=e.substr(0,7).split("").map(function(n){return+n}).reduce(function(n,a,i){return i%2?n+a:n+a*3},0);return(10-t%10)%10},r7=function(r){t7(e,r);function e(t,n){return JD(this,e),t.search(/^[0-9]{7}$/)!==-1&&(t+=S2(t)),e7(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return KD(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{8}$/)!==-1&&+this.data[7]===S2(this.data)}},{key:"leftText",value:function(){return Qd(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var n=this.data.substr(0,4);return Qd(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,n,"LLLL")}},{key:"rightText",value:function(){return Qd(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var n=this.data.substr(4,4);return Qd(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,n,"RRRR")}}]),e}(QD.default);Hm.default=r7;var Wm={};Object.defineProperty(Wm,"__esModule",{value:!0});var n7=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),a7=Ya,i7=zs,o7=t3(i7),s7=la,c7=t3(s7);function t3(r){return r&&r.__esModule?r:{default:r}}function l7(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function u7(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function d7(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var f7=function(e){var t=e.split("").map(function(n){return+n}).reduce(function(n,a,i){return i%2?n+a*9:n+a*3},0);return t%10},h7=function(r){d7(e,r);function e(t,n){return l7(this,e),u7(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return n7(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{5}$/)!==-1}},{key:"encode",value:function(){var n=a7.EAN5_STRUCTURE[f7(this.data)];return{data:"1011"+(0,o7.default)(this.data,n,"01"),text:this.text}}}]),e}(c7.default);Wm.default=h7;var Gm={};Object.defineProperty(Gm,"__esModule",{value:!0});var p7=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),m7=Ya,g7=zs,v7=r3(g7),x7=la,y7=r3(x7);function r3(r){return r&&r.__esModule?r:{default:r}}function b7(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function w7(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function _7(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var C7=function(r){_7(e,r);function e(t,n){return b7(this,e),w7(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return p7(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{2}$/)!==-1}},{key:"encode",value:function(){var n=m7.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,v7.default)(this.data,n,"01"),text:this.text}}}]),e}(y7.default);Gm.default=C7;var Vu={};Object.defineProperty(Vu,"__esModule",{value:!0});var N7=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();Vu.checksum=dp;var S7=zs,jc=n3(S7),E7=la,A7=n3(E7);function n3(r){return r&&r.__esModule?r:{default:r}}function j7(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function P7(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function D7(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var I7=function(r){D7(e,r);function e(t,n){j7(this,e),t.search(/^[0-9]{11}$/)!==-1&&(t+=dp(t));var a=P7(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return a.displayValue=n.displayValue,n.fontSize>n.width*10?a.fontSize=n.width*10:a.fontSize=n.fontSize,a.guardHeight=n.height+a.fontSize/2+n.textMargin,a}return N7(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{12}$/)!==-1&&this.data[11]==dp(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var n="";return n+="101",n+=(0,jc.default)(this.data.substr(0,6),"LLLLLL"),n+="01010",n+=(0,jc.default)(this.data.substr(6,6),"RRRRRR"),n+="101",{data:n,text:this.text}}},{key:"guardedEncoding",value:function(){var n=[];return this.displayValue&&n.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),n.push({data:"101"+(0,jc.default)(this.data[0],"L"),options:{height:this.guardHeight}}),n.push({data:(0,jc.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),n.push({data:"01010",options:{height:this.guardHeight}}),n.push({data:(0,jc.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),n.push({data:(0,jc.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&n.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),n}}]),e}(A7.default);function dp(r){var e=0,t;for(t=1;t<11;t+=2)e+=parseInt(r[t]);for(t=0;t<11;t+=2)e+=parseInt(r[t])*3;return(10-e%10)%10}Vu.default=I7;var Ym={};Object.defineProperty(Ym,"__esModule",{value:!0});var T7=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),O7=zs,k7=a3(O7),M7=la,R7=a3(M7),L7=Vu;function a3(r){return r&&r.__esModule?r:{default:r}}function F7(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function s1(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function B7(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var $7=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],U7=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],q7=function(r){B7(e,r);function e(t,n){F7(this,e);var a=s1(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));if(a.isValid=!1,t.search(/^[0-9]{6}$/)!==-1)a.middleDigits=t,a.upcA=E2(t,"0"),a.text=n.text||""+a.upcA[0]+t+a.upcA[a.upcA.length-1],a.isValid=!0;else if(t.search(/^[01][0-9]{7}$/)!==-1)if(a.middleDigits=t.substring(1,t.length-1),a.upcA=E2(a.middleDigits,t[0]),a.upcA[a.upcA.length-1]===t[t.length-1])a.isValid=!0;else return s1(a);else return s1(a);return a.displayValue=n.displayValue,n.fontSize>n.width*10?a.fontSize=n.width*10:a.fontSize=n.fontSize,a.guardHeight=n.height+a.fontSize/2+n.textMargin,a}return T7(e,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var n="";return n+="101",n+=this.encodeMiddleDigits(),n+="010101",{data:n,text:this.text}}},{key:"guardedEncoding",value:function(){var n=[];return this.displayValue&&n.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),n.push({data:"101",options:{height:this.guardHeight}}),n.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),n.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&n.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),n}},{key:"encodeMiddleDigits",value:function(){var n=this.upcA[0],a=this.upcA[this.upcA.length-1],i=U7[parseInt(a)][parseInt(n)];return(0,k7.default)(this.middleDigits,i)}}]),e}(R7.default);function E2(r,e){for(var t=parseInt(r[r.length-1]),n=$7[t],a="",i=0,o=0;o<n.length;o++){var s=n[o];s==="X"?a+=r[i++]:a+=s}return a=""+e+a,""+a+(0,L7.checksum)(a)}Ym.default=q7;Object.defineProperty(na,"__esModule",{value:!0});na.UPCE=na.UPC=na.EAN2=na.EAN5=na.EAN8=na.EAN13=void 0;var V7=zm,z7=pl(V7),H7=Hm,W7=pl(H7),G7=Wm,Y7=pl(G7),K7=Gm,X7=pl(K7),Q7=Vu,Z7=pl(Q7),J7=Ym,eI=pl(J7);function pl(r){return r&&r.__esModule?r:{default:r}}na.EAN13=z7.default;na.EAN8=W7.default;na.EAN5=Y7.default;na.EAN2=X7.default;na.UPC=Z7.default;na.UPCE=eI.default;var il={},Dh={},zu={};Object.defineProperty(zu,"__esModule",{value:!0});zu.START_BIN="1010";zu.END_BIN="11101";zu.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"];Object.defineProperty(Dh,"__esModule",{value:!0});var tI=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),Zd=zu,rI=la,nI=aI(rI);function aI(r){return r&&r.__esModule?r:{default:r}}function iI(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function oI(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function sI(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var cI=function(r){sI(e,r);function e(){return iI(this,e),oI(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return tI(e,[{key:"valid",value:function(){return this.data.search(/^([0-9]{2})+$/)!==-1}},{key:"encode",value:function(){var n=this,a=this.data.match(/.{2}/g).map(function(i){return n.encodePair(i)}).join("");return{data:Zd.START_BIN+a+Zd.END_BIN,text:this.text}}},{key:"encodePair",value:function(n){var a=Zd.BINARIES[n[1]];return Zd.BINARIES[n[0]].split("").map(function(i,o){return(i==="1"?"111":"1")+(a[o]==="1"?"000":"0")}).join("")}}]),e}(nI.default);Dh.default=cI;var Km={};Object.defineProperty(Km,"__esModule",{value:!0});var lI=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),uI=Dh,dI=fI(uI);function fI(r){return r&&r.__esModule?r:{default:r}}function hI(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function pI(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function mI(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var A2=function(e){var t=e.substr(0,13).split("").map(function(n){return parseInt(n,10)}).reduce(function(n,a,i){return n+a*(3-i%2*2)},0);return Math.ceil(t/10)*10-t},gI=function(r){mI(e,r);function e(t,n){return hI(this,e),t.search(/^[0-9]{13}$/)!==-1&&(t+=A2(t)),pI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return lI(e,[{key:"valid",value:function(){return this.data.search(/^[0-9]{14}$/)!==-1&&+this.data[13]===A2(this.data)}}]),e}(dI.default);Km.default=gI;Object.defineProperty(il,"__esModule",{value:!0});il.ITF14=il.ITF=void 0;var vI=Dh,xI=i3(vI),yI=Km,bI=i3(yI);function i3(r){return r&&r.__esModule?r:{default:r}}il.ITF=xI.default;il.ITF14=bI.default;var $a={},Hs={};Object.defineProperty(Hs,"__esModule",{value:!0});var wI=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),_I=la,CI=NI(_I);function NI(r){return r&&r.__esModule?r:{default:r}}function SI(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function EI(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function AI(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var jI=function(r){AI(e,r);function e(t,n){return SI(this,e),EI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return wI(e,[{key:"encode",value:function(){for(var n="110",a=0;a<this.data.length;a++){var i=parseInt(this.data[a]),o=i.toString(2);o=PI(o,4-o.length);for(var s=0;s<o.length;s++)n+=o[s]=="0"?"100":"110"}return n+="1001",{data:n,text:this.text}}},{key:"valid",value:function(){return this.data.search(/^[0-9]+$/)!==-1}}]),e}(CI.default);function PI(r,e){for(var t=0;t<e;t++)r="0"+r;return r}Hs.default=jI;var Xm={},Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.mod10=DI;Ws.mod11=II;function DI(r){for(var e=0,t=0;t<r.length;t++){var n=parseInt(r[t]);(t+r.length)%2===0?e+=n:e+=n*2%10+Math.floor(n*2/10)}return(10-e%10)%10}function II(r){for(var e=0,t=[2,3,4,5,6,7],n=0;n<r.length;n++){var a=parseInt(r[r.length-1-n]);e+=t[n%t.length]*a}return(11-e%11)%11}Object.defineProperty(Xm,"__esModule",{value:!0});var TI=Hs,OI=MI(TI),kI=Ws;function MI(r){return r&&r.__esModule?r:{default:r}}function RI(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function LI(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function FI(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var BI=function(r){FI(e,r);function e(t,n){return RI(this,e),LI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,kI.mod10)(t),n))}return e}(OI.default);Xm.default=BI;var Qm={};Object.defineProperty(Qm,"__esModule",{value:!0});var $I=Hs,UI=VI($I),qI=Ws;function VI(r){return r&&r.__esModule?r:{default:r}}function zI(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function HI(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function WI(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var GI=function(r){WI(e,r);function e(t,n){return zI(this,e),HI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,qI.mod11)(t),n))}return e}(UI.default);Qm.default=GI;var Zm={};Object.defineProperty(Zm,"__esModule",{value:!0});var YI=Hs,KI=XI(YI),j2=Ws;function XI(r){return r&&r.__esModule?r:{default:r}}function QI(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function ZI(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function JI(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var eT=function(r){JI(e,r);function e(t,n){return QI(this,e),t+=(0,j2.mod10)(t),t+=(0,j2.mod10)(t),ZI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return e}(KI.default);Zm.default=eT;var Jm={};Object.defineProperty(Jm,"__esModule",{value:!0});var tT=Hs,rT=nT(tT),P2=Ws;function nT(r){return r&&r.__esModule?r:{default:r}}function aT(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function iT(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function oT(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var sT=function(r){oT(e,r);function e(t,n){return aT(this,e),t+=(0,P2.mod11)(t),t+=(0,P2.mod10)(t),iT(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return e}(rT.default);Jm.default=sT;Object.defineProperty($a,"__esModule",{value:!0});$a.MSI1110=$a.MSI1010=$a.MSI11=$a.MSI10=$a.MSI=void 0;var cT=Hs,lT=Hu(cT),uT=Xm,dT=Hu(uT),fT=Qm,hT=Hu(fT),pT=Zm,mT=Hu(pT),gT=Jm,vT=Hu(gT);function Hu(r){return r&&r.__esModule?r:{default:r}}$a.MSI=lT.default;$a.MSI10=dT.default;$a.MSI11=hT.default;$a.MSI1010=mT.default;$a.MSI1110=vT.default;var Ih={};Object.defineProperty(Ih,"__esModule",{value:!0});Ih.pharmacode=void 0;var xT=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),yT=la,bT=wT(yT);function wT(r){return r&&r.__esModule?r:{default:r}}function _T(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function CT(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function NT(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var ST=function(r){NT(e,r);function e(t,n){_T(this,e);var a=CT(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return a.number=parseInt(t,10),a}return xT(e,[{key:"encode",value:function(){for(var n=this.number,a="";!isNaN(n)&&n!=0;)n%2===0?(a="11100"+a,n=(n-2)/2):(a="100"+a,n=(n-1)/2);return a=a.slice(0,-2),{data:a,text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),e}(bT.default);Ih.pharmacode=ST;var Th={};Object.defineProperty(Th,"__esModule",{value:!0});Th.codabar=void 0;var ET=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),AT=la,jT=PT(AT);function PT(r){return r&&r.__esModule?r:{default:r}}function DT(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function IT(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function TT(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var OT=function(r){TT(e,r);function e(t,n){DT(this,e),t.search(/^[0-9\-\$\:\.\+\/]+$/)===0&&(t="A"+t+"A");var a=IT(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.toUpperCase(),n));return a.text=a.options.text||a.text.replace(/[A-D]/g,""),a}return ET(e,[{key:"valid",value:function(){return this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)!==-1}},{key:"encode",value:function(){for(var n=[],a=this.getEncodings(),i=0;i<this.data.length;i++)n.push(a[this.data.charAt(i)]),i!==this.data.length-1&&n.push("0");return{text:this.text,data:n.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),e}(jT.default);Th.codabar=OT;var Oh={};Object.defineProperty(Oh,"__esModule",{value:!0});Oh.GenericBarcode=void 0;var kT=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),MT=la,RT=LT(MT);function LT(r){return r&&r.__esModule?r:{default:r}}function FT(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function BT(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function $T(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var UT=function(r){$T(e,r);function e(t,n){return FT(this,e),BT(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return kT(e,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),e}(RT.default);Oh.GenericBarcode=UT;Object.defineProperty(Lm,"__esModule",{value:!0});var qT=Ah,Jd=Ii,Pc=na,D2=il,eu=$a,VT=Ih,zT=Th,HT=Oh;Lm.default={CODE39:qT.CODE39,CODE128:Jd.CODE128,CODE128A:Jd.CODE128A,CODE128B:Jd.CODE128B,CODE128C:Jd.CODE128C,EAN13:Pc.EAN13,EAN8:Pc.EAN8,EAN5:Pc.EAN5,EAN2:Pc.EAN2,UPC:Pc.UPC,UPCE:Pc.UPCE,ITF14:D2.ITF14,ITF:D2.ITF,MSI:eu.MSI,MSI10:eu.MSI10,MSI11:eu.MSI11,MSI1010:eu.MSI1010,MSI1110:eu.MSI1110,pharmacode:VT.pharmacode,codabar:zT.codabar,GenericBarcode:HT.GenericBarcode};var ml={};Object.defineProperty(ml,"__esModule",{value:!0});var WT=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r};ml.default=function(r,e){return WT({},r,e)};var eg={};Object.defineProperty(eg,"__esModule",{value:!0});eg.default=GT;function GT(r){var e=[];function t(n){if(Array.isArray(n))for(var a=0;a<n.length;a++)t(n[a]);else n.text=n.text||"",n.data=n.data||"",e.push(n)}return t(r),e}var tg={};Object.defineProperty(tg,"__esModule",{value:!0});tg.default=YT;function YT(r){return r.marginTop=r.marginTop||r.margin,r.marginBottom=r.marginBottom||r.margin,r.marginRight=r.marginRight||r.margin,r.marginLeft=r.marginLeft||r.margin,r}var rg={},ng={},kh={};Object.defineProperty(kh,"__esModule",{value:!0});kh.default=KT;function KT(r){var e=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var t in e)e.hasOwnProperty(t)&&(t=e[t],typeof r[t]=="string"&&(r[t]=parseInt(r[t],10)));return typeof r.displayValue=="string"&&(r.displayValue=r.displayValue!="false"),r}var Mh={};Object.defineProperty(Mh,"__esModule",{value:!0});var XT={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}};Mh.default=XT;Object.defineProperty(ng,"__esModule",{value:!0});var QT=kh,ZT=o3(QT),JT=Mh,I2=o3(JT);function o3(r){return r&&r.__esModule?r:{default:r}}function eO(r){var e={};for(var t in I2.default)I2.default.hasOwnProperty(t)&&(r.hasAttribute("jsbarcode-"+t.toLowerCase())&&(e[t]=r.getAttribute("jsbarcode-"+t.toLowerCase())),r.hasAttribute("data-"+t.toLowerCase())&&(e[t]=r.getAttribute("data-"+t.toLowerCase())));return e.value=r.getAttribute("jsbarcode-value")||r.getAttribute("data-value"),e=(0,ZT.default)(e),e}ng.default=eO;var ag={},ig={},ba={};Object.defineProperty(ba,"__esModule",{value:!0});ba.getTotalWidthOfEncodings=ba.calculateEncodingAttributes=ba.getBarcodePadding=ba.getEncodingHeight=ba.getMaximumHeightOfEncodings=void 0;var tO=ml,rO=nO(tO);function nO(r){return r&&r.__esModule?r:{default:r}}function s3(r,e){return e.height+(e.displayValue&&r.text.length>0?e.fontSize+e.textMargin:0)+e.marginTop+e.marginBottom}function c3(r,e,t){if(t.displayValue&&e<r){if(t.textAlign=="center")return Math.floor((r-e)/2);if(t.textAlign=="left")return 0;if(t.textAlign=="right")return Math.floor(r-e)}return 0}function aO(r,e,t){for(var n=0;n<r.length;n++){var a=r[n],i=(0,rO.default)(e,a.options),o;i.displayValue?o=sO(a.text,i,t):o=0;var s=a.data.length*i.width;a.width=Math.ceil(Math.max(o,s)),a.height=s3(a,i),a.barcodePadding=c3(o,s,i)}}function iO(r){for(var e=0,t=0;t<r.length;t++)e+=r[t].width;return e}function oO(r){for(var e=0,t=0;t<r.length;t++)r[t].height>e&&(e=r[t].height);return e}function sO(r,e,t){var n;if(t)n=t;else if(typeof document<"u")n=document.createElement("canvas").getContext("2d");else return 0;n.font=e.fontOptions+" "+e.fontSize+"px "+e.font;var a=n.measureText(r);if(!a)return 0;var i=a.width;return i}ba.getMaximumHeightOfEncodings=oO;ba.getEncodingHeight=s3;ba.getBarcodePadding=c3;ba.calculateEncodingAttributes=aO;ba.getTotalWidthOfEncodings=iO;Object.defineProperty(ig,"__esModule",{value:!0});var cO=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),lO=ml,uO=dO(lO),c1=ba;function dO(r){return r&&r.__esModule?r:{default:r}}function fO(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var hO=function(){function r(e,t,n){fO(this,r),this.canvas=e,this.encodings=t,this.options=n}return cO(r,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var t=0;t<this.encodings.length;t++){var n=(0,uO.default)(this.options,this.encodings[t].options);this.drawCanvasBarcode(n,this.encodings[t]),this.drawCanvasText(n,this.encodings[t]),this.moveCanvasDrawing(this.encodings[t])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var t=this.canvas.getContext("2d");t.save(),(0,c1.calculateEncodingAttributes)(this.encodings,this.options,t);var n=(0,c1.getTotalWidthOfEncodings)(this.encodings),a=(0,c1.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=n+this.options.marginLeft+this.options.marginRight,this.canvas.height=a,t.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(t.fillStyle=this.options.background,t.fillRect(0,0,this.canvas.width,this.canvas.height)),t.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(t,n){var a=this.canvas.getContext("2d"),i=n.data,o;t.textPosition=="top"?o=t.marginTop+t.fontSize+t.textMargin:o=t.marginTop,a.fillStyle=t.lineColor;for(var s=0;s<i.length;s++){var l=s*t.width+n.barcodePadding;i[s]==="1"?a.fillRect(l,o,t.width,t.height):i[s]&&a.fillRect(l,o,t.width,t.height*i[s])}}},{key:"drawCanvasText",value:function(t,n){var a=this.canvas.getContext("2d"),i=t.fontOptions+" "+t.fontSize+"px "+t.font;if(t.displayValue){var o,s;t.textPosition=="top"?s=t.marginTop+t.fontSize-t.textMargin:s=t.height+t.textMargin+t.marginTop+t.fontSize,a.font=i,t.textAlign=="left"||n.barcodePadding>0?(o=0,a.textAlign="left"):t.textAlign=="right"?(o=n.width-1,a.textAlign="right"):(o=n.width/2,a.textAlign="center"),a.fillText(n.text,o,s)}}},{key:"moveCanvasDrawing",value:function(t){var n=this.canvas.getContext("2d");n.translate(t.width,0)}},{key:"restoreCanvas",value:function(){var t=this.canvas.getContext("2d");t.restore()}}]),r}();ig.default=hO;var og={};Object.defineProperty(og,"__esModule",{value:!0});var pO=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),mO=ml,gO=vO(mO),l1=ba;function vO(r){return r&&r.__esModule?r:{default:r}}function xO(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var ef="http://www.w3.org/2000/svg",yO=function(){function r(e,t,n){xO(this,r),this.svg=e,this.encodings=t,this.options=n,this.document=n.xmlDocument||document}return pO(r,[{key:"render",value:function(){var t=this.options.marginLeft;this.prepareSVG();for(var n=0;n<this.encodings.length;n++){var a=this.encodings[n],i=(0,gO.default)(this.options,a.options),o=this.createGroup(t,i.marginTop,this.svg);this.setGroupOptions(o,i),this.drawSvgBarcode(o,i,a),this.drawSVGText(o,i,a),t+=a.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,l1.calculateEncodingAttributes)(this.encodings,this.options);var t=(0,l1.getTotalWidthOfEncodings)(this.encodings),n=(0,l1.getMaximumHeightOfEncodings)(this.encodings),a=t+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(a,n),this.options.background&&this.drawRect(0,0,a,n,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(t,n,a){var i=a.data,o;n.textPosition=="top"?o=n.fontSize+n.textMargin:o=0;for(var s=0,l=0,u=0;u<i.length;u++)l=u*n.width+a.barcodePadding,i[u]==="1"?s++:s>0&&(this.drawRect(l-n.width*s,o,n.width*s,n.height,t),s=0);s>0&&this.drawRect(l-n.width*(s-1),o,n.width*s,n.height,t)}},{key:"drawSVGText",value:function(t,n,a){var i=this.document.createElementNS(ef,"text");if(n.displayValue){var o,s;i.setAttribute("style","font:"+n.fontOptions+" "+n.fontSize+"px "+n.font),n.textPosition=="top"?s=n.fontSize-n.textMargin:s=n.height+n.textMargin+n.fontSize,n.textAlign=="left"||a.barcodePadding>0?(o=0,i.setAttribute("text-anchor","start")):n.textAlign=="right"?(o=a.width-1,i.setAttribute("text-anchor","end")):(o=a.width/2,i.setAttribute("text-anchor","middle")),i.setAttribute("x",o),i.setAttribute("y",s),i.appendChild(this.document.createTextNode(a.text)),t.appendChild(i)}}},{key:"setSvgAttributes",value:function(t,n){var a=this.svg;a.setAttribute("width",t+"px"),a.setAttribute("height",n+"px"),a.setAttribute("x","0px"),a.setAttribute("y","0px"),a.setAttribute("viewBox","0 0 "+t+" "+n),a.setAttribute("xmlns",ef),a.setAttribute("version","1.1"),a.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(t,n,a){var i=this.document.createElementNS(ef,"g");return i.setAttribute("transform","translate("+t+", "+n+")"),a.appendChild(i),i}},{key:"setGroupOptions",value:function(t,n){t.setAttribute("style","fill:"+n.lineColor+";")}},{key:"drawRect",value:function(t,n,a,i,o){var s=this.document.createElementNS(ef,"rect");return s.setAttribute("x",t),s.setAttribute("y",n),s.setAttribute("width",a),s.setAttribute("height",i),o.appendChild(s),s}}]),r}();og.default=yO;var sg={};Object.defineProperty(sg,"__esModule",{value:!0});var bO=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function wO(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var _O=function(){function r(e,t,n){wO(this,r),this.object=e,this.encodings=t,this.options=n}return bO(r,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),r}();sg.default=_O;Object.defineProperty(ag,"__esModule",{value:!0});var CO=ig,NO=cg(CO),SO=og,EO=cg(SO),AO=sg,jO=cg(AO);function cg(r){return r&&r.__esModule?r:{default:r}}ag.default={CanvasRenderer:NO.default,SVGRenderer:EO.default,ObjectRenderer:jO.default};var gl={};Object.defineProperty(gl,"__esModule",{value:!0});function lg(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}function ug(r,e){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:r}function dg(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(r,e):r.__proto__=e)}var PO=function(r){dg(e,r);function e(t,n){lg(this,e);var a=ug(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.name="InvalidInputException",a.symbology=t,a.input=n,a.message='"'+a.input+'" is not a valid input for '+a.symbology,a}return e}(Error),DO=function(r){dg(e,r);function e(){lg(this,e);var t=ug(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return e}(Error),IO=function(r){dg(e,r);function e(){lg(this,e);var t=ug(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}return e}(Error);gl.InvalidInputException=PO;gl.InvalidElementException=DO;gl.NoElementException=IO;Object.defineProperty(rg,"__esModule",{value:!0});var TO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},OO=ng,fp=l3(OO),kO=ag,su=l3(kO),MO=gl;function l3(r){return r&&r.__esModule?r:{default:r}}function fg(r){if(typeof r=="string")return RO(r);if(Array.isArray(r)){for(var e=[],t=0;t<r.length;t++)e.push(fg(r[t]));return e}else{if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLImageElement)return LO(r);if(r&&r.nodeName&&r.nodeName.toLowerCase()==="svg"||typeof SVGElement<"u"&&r instanceof SVGElement)return{element:r,options:(0,fp.default)(r),renderer:su.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement)return{element:r,options:(0,fp.default)(r),renderer:su.default.CanvasRenderer};if(r&&r.getContext)return{element:r,renderer:su.default.CanvasRenderer};if(r&&(typeof r>"u"?"undefined":TO(r))==="object"&&!r.nodeName)return{element:r,renderer:su.default.ObjectRenderer};throw new MO.InvalidElementException}}function RO(r){var e=document.querySelectorAll(r);if(e.length!==0){for(var t=[],n=0;n<e.length;n++)t.push(fg(e[n]));return t}}function LO(r){var e=document.createElement("canvas");return{element:e,options:(0,fp.default)(r),renderer:su.default.CanvasRenderer,afterRender:function(){r.setAttribute("src",e.toDataURL())}}}rg.default=fg;var hg={};Object.defineProperty(hg,"__esModule",{value:!0});var FO=function(){function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();function BO(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var $O=function(){function r(e){BO(this,r),this.api=e}return FO(r,[{key:"handleCatch",value:function(t){if(t.name==="InvalidInputException")if(this.api._options.valid!==this.api._defaults.valid)this.api._options.valid(!1);else throw t.message;else throw t;this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(t){try{var n=t.apply(void 0,arguments);return this.api._options.valid(!0),n}catch(a){return this.handleCatch(a),this.api}}}]),r}();hg.default=$O;var UO=Lm,Ps=is(UO),qO=ml,Wu=is(qO),VO=eg,u3=is(VO),zO=tg,T2=is(zO),HO=rg,WO=is(HO),GO=kh,YO=is(GO),KO=hg,XO=is(KO),d3=gl,QO=Mh,f3=is(QO);function is(r){return r&&r.__esModule?r:{default:r}}var io=function(){},Rh=function(e,t,n){var a=new io;if(typeof e>"u")throw Error("No element to render on was provided.");return a._renderProperties=(0,WO.default)(e),a._encodings=[],a._options=f3.default,a._errorHandler=new XO.default(a),typeof t<"u"&&(n=n||{},n.format||(n.format=p3()),a.options(n)[n.format](t,n).render()),a};Rh.getModule=function(r){return Ps.default[r]};for(var O2 in Ps.default)Ps.default.hasOwnProperty(O2)&&ZO(Ps.default,O2);function ZO(r,e){io.prototype[e]=io.prototype[e.toUpperCase()]=io.prototype[e.toLowerCase()]=function(t,n){var a=this;return a._errorHandler.wrapBarcodeCall(function(){n.text=typeof n.text>"u"?void 0:""+n.text;var i=(0,Wu.default)(a._options,n);i=(0,YO.default)(i);var o=r[e],s=h3(t,o,i);return a._encodings.push(s),a})}}function h3(r,e,t){r=""+r;var n=new e(r,t);if(!n.valid())throw new d3.InvalidInputException(n.constructor.name,r);var a=n.encode();a=(0,u3.default)(a);for(var i=0;i<a.length;i++)a[i].options=(0,Wu.default)(t,a[i].options);return a}function p3(){return Ps.default.CODE128?"CODE128":Object.keys(Ps.default)[0]}io.prototype.options=function(r){return this._options=(0,Wu.default)(this._options,r),this};io.prototype.blank=function(r){var e=new Array(r+1).join("0");return this._encodings.push({data:e}),this};io.prototype.init=function(){if(this._renderProperties){Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]);var r;for(var e in this._renderProperties){r=this._renderProperties[e];var t=(0,Wu.default)(this._options,r.options);t.format=="auto"&&(t.format=p3()),this._errorHandler.wrapBarcodeCall(function(){var n=t.value,a=Ps.default[t.format.toUpperCase()],i=h3(n,a,t);hp(r,i,t)})}}};io.prototype.render=function(){if(!this._renderProperties)throw new d3.NoElementException;if(Array.isArray(this._renderProperties))for(var r=0;r<this._renderProperties.length;r++)hp(this._renderProperties[r],this._encodings,this._options);else hp(this._renderProperties,this._encodings,this._options);return this};io.prototype._defaults=f3.default;function hp(r,e,t){e=(0,u3.default)(e);for(var n=0;n<e.length;n++)e[n].options=(0,Wu.default)(t,e[n].options),(0,T2.default)(e[n].options);(0,T2.default)(t);var a=r.renderer,i=new a(r.element,e,t);i.render(),r.afterRender&&r.afterRender()}typeof window<"u"&&(window.JsBarcode=Rh);typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(r,e){var t=[];return jQuery(this).each(function(){t.push(this)}),Rh(t,r,e)});var JO=Rh;const m3=uN(JO);async function ek(r){const e={id:r.id,tracking:r.tracking_number,customer:r.customers?.name||"N/A",status:r.status,action:"package_scan"},t=JSON.stringify(e),n=await Vs.toDataURL(t,{width:120,margin:1,color:{dark:"#000000",light:"#FFFFFF"}}),a=document.createElement("canvas");m3(a,r.tracking_number,{format:"CODE128",width:2,height:60,displayValue:!0,fontSize:12,margin:0});const i=a.toDataURL();return{qrCodeDataUrl:n,barcodeDataUrl:i}}async function tk(r){const e=new Map;for(const t of r)try{const n=await ek(t);e.set(t.id,n)}catch(n){console.error(`Error generating codes for package ${t.id}:`,n)}return e}function ir(r){"@babel/helpers - typeof";return ir=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ir(r)}var Ln=Uint8Array,wa=Uint16Array,pg=Int32Array,Lh=new Ln([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Fh=new Ln([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),pp=new Ln([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),g3=function(r,e){for(var t=new wa(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var a=new pg(t[30]),n=1;n<30;++n)for(var i=t[n];i<t[n+1];++i)a[i]=i-t[n]<<5|n;return{b:t,r:a}},v3=g3(Lh,2),x3=v3.b,mp=v3.r;x3[28]=258,mp[258]=28;var y3=g3(Fh,0),rk=y3.b,k2=y3.r,gp=new wa(32768);for(var yr=0;yr<32768;++yr){var Eo=(yr&43690)>>1|(yr&21845)<<1;Eo=(Eo&52428)>>2|(Eo&13107)<<2,Eo=(Eo&61680)>>4|(Eo&3855)<<4,gp[yr]=((Eo&65280)>>8|(Eo&255)<<8)>>1}var Ri=function(r,e,t){for(var n=r.length,a=0,i=new wa(e);a<n;++a)r[a]&&++i[r[a]-1];var o=new wa(e);for(a=1;a<e;++a)o[a]=o[a-1]+i[a-1]<<1;var s;if(t){s=new wa(1<<e);var l=15-e;for(a=0;a<n;++a)if(r[a])for(var u=a<<4|r[a],d=e-r[a],f=o[r[a]-1]++<<d,h=f|(1<<d)-1;f<=h;++f)s[gp[f]>>l]=u}else for(s=new wa(n),a=0;a<n;++a)r[a]&&(s[a]=gp[o[r[a]-1]++]>>15-r[a]);return s},Qo=new Ln(288);for(var yr=0;yr<144;++yr)Qo[yr]=8;for(var yr=144;yr<256;++yr)Qo[yr]=9;for(var yr=256;yr<280;++yr)Qo[yr]=7;for(var yr=280;yr<288;++yr)Qo[yr]=8;var Pu=new Ln(32);for(var yr=0;yr<32;++yr)Pu[yr]=5;var nk=Ri(Qo,9,0),ak=Ri(Qo,9,1),ik=Ri(Pu,5,0),ok=Ri(Pu,5,1),u1=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},ii=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},d1=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},mg=function(r){return(r+7)/8|0},b3=function(r,e,t){return(t==null||t>r.length)&&(t=r.length),new Ln(r.subarray(e,t))},sk=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ci=function(r,e,t){var n=new Error(e||sk[r]);if(n.code=r,Error.captureStackTrace&&Error.captureStackTrace(n,ci),!t)throw n;return n},ck=function(r,e,t,n){var a=r.length,i=0;if(!a||e.f&&!e.l)return t||new Ln(0);var o=!t,s=o||e.i!=2,l=e.i;o&&(t=new Ln(a*3));var u=function(Te){var Be=t.length;if(Te>Be){var $e=new Ln(Math.max(Be*2,Te));$e.set(t),t=$e}},d=e.f||0,f=e.p||0,h=e.b||0,p=e.l,g=e.d,v=e.m,b=e.n,y=a*8;do{if(!p){d=ii(r,f,1);var C=ii(r,f+1,3);if(f+=3,C)if(C==1)p=ak,g=ok,v=9,b=5;else if(C==2){var F=ii(r,f,31)+257,M=ii(r,f+10,15)+4,T=F+ii(r,f+5,31)+1;f+=14;for(var q=new Ln(T),J=new Ln(19),O=0;O<M;++O)J[pp[O]]=ii(r,f+O*3,7);f+=M*3;for(var k=u1(J),H=(1<<k)-1,X=Ri(J,k,1),O=0;O<T;){var ce=X[ii(r,f,H)];f+=ce&15;var S=ce>>4;if(S<16)q[O++]=S;else{var Q=0,re=0;for(S==16?(re=3+ii(r,f,3),f+=2,Q=q[O-1]):S==17?(re=3+ii(r,f,7),f+=3):S==18&&(re=11+ii(r,f,127),f+=7);re--;)q[O++]=Q}}var G=q.subarray(0,F),Y=q.subarray(F);v=u1(G),b=u1(Y),p=Ri(G,v,1),g=Ri(Y,b,1)}else ci(1);else{var S=mg(f)+4,j=r[S-4]|r[S-3]<<8,D=S+j;if(D>a){l&&ci(0);break}s&&u(h+j),t.set(r.subarray(S,D),h),e.b=h+=j,e.p=f=D*8,e.f=d;continue}if(f>y){l&&ci(0);break}}s&&u(h+131072);for(var ge=(1<<v)-1,ye=(1<<b)-1,A=f;;A=f){var Q=p[d1(r,f)&ge],$=Q>>4;if(f+=Q&15,f>y){l&&ci(0);break}if(Q||ci(2),$<256)t[h++]=$;else if($==256){A=f,p=null;break}else{var V=$-254;if($>264){var O=$-257,K=Lh[O];V=ii(r,f,(1<<K)-1)+x3[O],f+=K}var ee=g[d1(r,f)&ye],oe=ee>>4;ee||ci(3),f+=ee&15;var Y=rk[oe];if(oe>3){var K=Fh[oe];Y+=d1(r,f)&(1<<K)-1,f+=K}if(f>y){l&&ci(0);break}s&&u(h+131072);var fe=h+V;if(h<Y){var ve=i-Y,Ie=Math.min(Y,fe);for(ve+h<0&&ci(3);h<Ie;++h)t[h]=n[ve+h]}for(;h<fe;++h)t[h]=t[h-Y]}}e.l=p,e.p=A,e.b=h,e.f=d,p&&(d=1,e.m=v,e.d=g,e.n=b)}while(!d);return h!=t.length&&o?b3(t,0,h):t.subarray(0,h)},to=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8},tu=function(r,e,t){t<<=e&7;var n=e/8|0;r[n]|=t,r[n+1]|=t>>8,r[n+2]|=t>>16},f1=function(r,e){for(var t=[],n=0;n<r.length;++n)r[n]&&t.push({s:n,f:r[n]});var a=t.length,i=t.slice();if(!a)return{t:_3,l:0};if(a==1){var o=new Ln(t[0].s+1);return o[t[0].s]=1,{t:o,l:1}}t.sort(function(D,F){return D.f-F.f}),t.push({s:-1,f:25001});var s=t[0],l=t[1],u=0,d=1,f=2;for(t[0]={s:-1,f:s.f+l.f,l:s,r:l};d!=a-1;)s=t[t[u].f<t[f].f?u++:f++],l=t[u!=d&&t[u].f<t[f].f?u++:f++],t[d++]={s:-1,f:s.f+l.f,l:s,r:l};for(var h=i[0].s,n=1;n<a;++n)i[n].s>h&&(h=i[n].s);var p=new wa(h+1),g=vp(t[d-1],p,0);if(g>e){var n=0,v=0,b=g-e,y=1<<b;for(i.sort(function(F,M){return p[M.s]-p[F.s]||F.f-M.f});n<a;++n){var C=i[n].s;if(p[C]>e)v+=y-(1<<g-p[C]),p[C]=e;else break}for(v>>=b;v>0;){var S=i[n].s;p[S]<e?v-=1<<e-p[S]++-1:++n}for(;n>=0&&v;--n){var j=i[n].s;p[j]==e&&(--p[j],++v)}g=e}return{t:new Ln(p),l:g}},vp=function(r,e,t){return r.s==-1?Math.max(vp(r.l,e,t+1),vp(r.r,e,t+1)):e[r.s]=t},M2=function(r){for(var e=r.length;e&&!r[--e];);for(var t=new wa(++e),n=0,a=r[0],i=1,o=function(l){t[n++]=l},s=1;s<=e;++s)if(r[s]==a&&s!=e)++i;else{if(!a&&i>2){for(;i>138;i-=138)o(32754);i>2&&(o(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(o(a),--i;i>6;i-=6)o(8304);i>2&&(o(i-3<<5|8208),i=0)}for(;i--;)o(a);i=1,a=r[s]}return{c:t.subarray(0,n),n:e}},ru=function(r,e){for(var t=0,n=0;n<e.length;++n)t+=r[n]*e[n];return t},w3=function(r,e,t){var n=t.length,a=mg(e+2);r[a]=n&255,r[a+1]=n>>8,r[a+2]=r[a]^255,r[a+3]=r[a+1]^255;for(var i=0;i<n;++i)r[a+i+4]=t[i];return(a+4+n)*8},R2=function(r,e,t,n,a,i,o,s,l,u,d){to(e,d++,t),++a[256];for(var f=f1(a,15),h=f.t,p=f.l,g=f1(i,15),v=g.t,b=g.l,y=M2(h),C=y.c,S=y.n,j=M2(v),D=j.c,F=j.n,M=new wa(19),T=0;T<C.length;++T)++M[C[T]&31];for(var T=0;T<D.length;++T)++M[D[T]&31];for(var q=f1(M,7),J=q.t,O=q.l,k=19;k>4&&!J[pp[k-1]];--k);var H=u+5<<3,X=ru(a,Qo)+ru(i,Pu)+o,ce=ru(a,h)+ru(i,v)+o+14+3*k+ru(M,J)+2*M[16]+3*M[17]+7*M[18];if(l>=0&&H<=X&&H<=ce)return w3(e,d,r.subarray(l,l+u));var Q,re,G,Y;if(to(e,d,1+(ce<X)),d+=2,ce<X){Q=Ri(h,p,0),re=h,G=Ri(v,b,0),Y=v;var ge=Ri(J,O,0);to(e,d,S-257),to(e,d+5,F-1),to(e,d+10,k-4),d+=14;for(var T=0;T<k;++T)to(e,d+3*T,J[pp[T]]);d+=3*k;for(var ye=[C,D],A=0;A<2;++A)for(var $=ye[A],T=0;T<$.length;++T){var V=$[T]&31;to(e,d,ge[V]),d+=J[V],V>15&&(to(e,d,$[T]>>5&127),d+=$[T]>>12)}}else Q=nk,re=Qo,G=ik,Y=Pu;for(var T=0;T<s;++T){var K=n[T];if(K>255){var V=K>>18&31;tu(e,d,Q[V+257]),d+=re[V+257],V>7&&(to(e,d,K>>23&31),d+=Lh[V]);var ee=K&31;tu(e,d,G[ee]),d+=Y[ee],ee>3&&(tu(e,d,K>>5&8191),d+=Fh[ee])}else tu(e,d,Q[K]),d+=re[K]}return tu(e,d,Q[256]),d+re[256]},lk=new pg([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),_3=new Ln(0),uk=function(r,e,t,n,a,i){var o=i.z||r.length,s=new Ln(n+o+5*(1+Math.ceil(o/7e3))+a),l=s.subarray(n,s.length-a),u=i.l,d=(i.r||0)&7;if(e){d&&(l[0]=i.r>>3);for(var f=lk[e-1],h=f>>13,p=f&8191,g=(1<<t)-1,v=i.p||new wa(32768),b=i.h||new wa(g+1),y=Math.ceil(t/3),C=2*y,S=function(ct){return(r[ct]^r[ct+1]<<y^r[ct+2]<<C)&g},j=new pg(25e3),D=new wa(288),F=new wa(32),M=0,T=0,q=i.i||0,J=0,O=i.w||0,k=0;q+2<o;++q){var H=S(q),X=q&32767,ce=b[H];if(v[X]=ce,b[H]=X,O<=q){var Q=o-q;if((M>7e3||J>24576)&&(Q>423||!u)){d=R2(r,l,0,j,D,F,T,J,k,q-k,d),J=M=T=0,k=q;for(var re=0;re<286;++re)D[re]=0;for(var re=0;re<30;++re)F[re]=0}var G=2,Y=0,ge=p,ye=X-ce&32767;if(Q>2&&H==S(q-ye))for(var A=Math.min(h,Q)-1,$=Math.min(32767,q),V=Math.min(258,Q);ye<=$&&--ge&&X!=ce;){if(r[q+G]==r[q+G-ye]){for(var K=0;K<V&&r[q+K]==r[q+K-ye];++K);if(K>G){if(G=K,Y=ye,K>A)break;for(var ee=Math.min(ye,K-2),oe=0,re=0;re<ee;++re){var fe=q-ye+re&32767,ve=v[fe],Ie=fe-ve&32767;Ie>oe&&(oe=Ie,ce=fe)}}}X=ce,ce=v[X],ye+=X-ce&32767}if(Y){j[J++]=268435456|mp[G]<<18|k2[Y];var Te=mp[G]&31,Be=k2[Y]&31;T+=Lh[Te]+Fh[Be],++D[257+Te],++F[Be],O=q+G,++M}else j[J++]=r[q],++D[r[q]]}}for(q=Math.max(q,O);q<o;++q)j[J++]=r[q],++D[r[q]];d=R2(r,l,u,j,D,F,T,J,k,q-k,d),u||(i.r=d&7|l[d/8|0]<<3,d-=7,i.h=b,i.p=v,i.i=q,i.w=O)}else{for(var q=i.w||0;q<o+u;q+=65535){var $e=q+65535;$e>=o&&(l[d/8|0]=u,$e=o),d=w3(l,d+1,r.subarray(q,$e))}i.i=o}return b3(s,0,n+mg(d)+a)},C3=function(){var r=1,e=0;return{p:function(t){for(var n=r,a=e,i=t.length|0,o=0;o!=i;){for(var s=Math.min(o+2655,i);o<s;++o)a+=n+=t[o];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}r=n,e=a},d:function(){return r%=65521,e%=65521,(r&255)<<24|(r&65280)<<8|(e&255)<<8|e>>8}}},dk=function(r,e,t,n,a){if(!a&&(a={l:1},e.dictionary)){var i=e.dictionary.subarray(-32768),o=new Ln(i.length+r.length);o.set(i),o.set(r,i.length),r=o,a.w=i.length}return uk(r,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+e.mem,t,n,a)},N3=function(r,e,t){for(;t;++e)r[e]=t,t>>>=8},fk=function(r,e){var t=e.level,n=t==0?0:t<6?1:t==9?3:2;if(r[0]=120,r[1]=n<<6|(e.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,e.dictionary){var a=C3();a.p(e.dictionary),N3(r,2,a.d())}},hk=function(r,e){return((r[0]&15)!=8||r[0]>>4>7||(r[0]<<8|r[1])%31)&&ci(6,"invalid zlib data"),(r[1]>>5&1)==+!e&&ci(6,"invalid zlib data: "+(r[1]&32?"need":"unexpected")+" dictionary"),(r[1]>>3&4)+2};function xp(r,e){e||(e={});var t=C3();t.p(r);var n=dk(r,e,e.dictionary?6:2,4);return fk(n,e),N3(n,n.length-4,t.d()),n}function pk(r,e){return ck(r.subarray(hk(r,e),-4),{i:2},e,e)}var mk=typeof TextDecoder<"u"&&new TextDecoder,gk=0;try{mk.decode(_3,{stream:!0}),gk=1}catch{}var ht=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function h1(){ht.console&&typeof ht.console.log=="function"&&ht.console.log.apply(ht.console,arguments)}var dr={log:h1,warn:function(r){ht.console&&(typeof ht.console.warn=="function"?ht.console.warn.apply(ht.console,arguments):h1.call(null,arguments))},error:function(r){ht.console&&(typeof ht.console.error=="function"?ht.console.error.apply(ht.console,arguments):h1(r))}};function p1(r,e,t){var n=new XMLHttpRequest;n.open("GET",r),n.responseType="blob",n.onload=function(){bs(n.response,e,t)},n.onerror=function(){dr.error("could not download file")},n.send()}function L2(r){var e=new XMLHttpRequest;e.open("HEAD",r,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function tf(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(e)}}var vu,yp,bs=ht.saveAs||((typeof window>"u"?"undefined":ir(window))!=="object"||window!==ht?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(r,e,t){var n=ht.URL||ht.webkitURL,a=document.createElement("a");e=e||r.name||"download",a.download=e,a.rel="noopener",typeof r=="string"?(a.href=r,a.origin!==location.origin?L2(a.href)?p1(r,e,t):tf(a,a.target="_blank"):tf(a)):(a.href=n.createObjectURL(r),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){tf(a)},0))}:"msSaveOrOpenBlob"in navigator?function(r,e,t){if(e=e||r.name||"download",typeof r=="string")if(L2(r))p1(r,e,t);else{var n=document.createElement("a");n.href=r,n.target="_blank",setTimeout(function(){tf(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:ir(i)!=="object"&&(dr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(r,t),e)}:function(r,e,t,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof r=="string")return p1(r,e,t);var a=r.type==="application/octet-stream",i=/constructor/i.test(ht.HTMLElement)||ht.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||a&&i)&&(typeof FileReader>"u"?"undefined":ir(FileReader))==="object"){var s=new FileReader;s.onloadend=function(){var d=s.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},s.readAsDataURL(r)}else{var l=ht.URL||ht.webkitURL,u=l.createObjectURL(r);n?n.location=u:location.href=u,n=null,setTimeout(function(){l.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function S3(r){var e;r=r||"",this.ok=!1,r.charAt(0)=="#"&&(r=r.substr(1,6)),r={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[r=(r=r.replace(/ /g,"")).toLowerCase()]||r;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(s){return[parseInt(s[1]),parseInt(s[2]),parseInt(s[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(s){return[parseInt(s[1],16),parseInt(s[2],16),parseInt(s[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(s){return[parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16),parseInt(s[3]+s[3],16)]}}],n=0;n<t.length;n++){var a=t[n].re,i=t[n].process,o=a.exec(r);o&&(e=i(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var s=this.r.toString(16),l=this.g.toString(16),u=this.b.toString(16);return s.length==1&&(s="0"+s),l.length==1&&(l="0"+l),u.length==1&&(u="0"+u),"#"+s+l+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function m1(r,e){var t=r[0],n=r[1],a=r[2],i=r[3];t=Pn(t,n,a,i,e[0],7,-680876936),i=Pn(i,t,n,a,e[1],12,-389564586),a=Pn(a,i,t,n,e[2],17,606105819),n=Pn(n,a,i,t,e[3],22,-1044525330),t=Pn(t,n,a,i,e[4],7,-176418897),i=Pn(i,t,n,a,e[5],12,1200080426),a=Pn(a,i,t,n,e[6],17,-1473231341),n=Pn(n,a,i,t,e[7],22,-45705983),t=Pn(t,n,a,i,e[8],7,1770035416),i=Pn(i,t,n,a,e[9],12,-1958414417),a=Pn(a,i,t,n,e[10],17,-42063),n=Pn(n,a,i,t,e[11],22,-1990404162),t=Pn(t,n,a,i,e[12],7,1804603682),i=Pn(i,t,n,a,e[13],12,-40341101),a=Pn(a,i,t,n,e[14],17,-1502002290),t=Dn(t,n=Pn(n,a,i,t,e[15],22,1236535329),a,i,e[1],5,-165796510),i=Dn(i,t,n,a,e[6],9,-1069501632),a=Dn(a,i,t,n,e[11],14,643717713),n=Dn(n,a,i,t,e[0],20,-373897302),t=Dn(t,n,a,i,e[5],5,-701558691),i=Dn(i,t,n,a,e[10],9,38016083),a=Dn(a,i,t,n,e[15],14,-660478335),n=Dn(n,a,i,t,e[4],20,-405537848),t=Dn(t,n,a,i,e[9],5,568446438),i=Dn(i,t,n,a,e[14],9,-1019803690),a=Dn(a,i,t,n,e[3],14,-187363961),n=Dn(n,a,i,t,e[8],20,1163531501),t=Dn(t,n,a,i,e[13],5,-1444681467),i=Dn(i,t,n,a,e[2],9,-51403784),a=Dn(a,i,t,n,e[7],14,1735328473),t=In(t,n=Dn(n,a,i,t,e[12],20,-1926607734),a,i,e[5],4,-378558),i=In(i,t,n,a,e[8],11,-2022574463),a=In(a,i,t,n,e[11],16,1839030562),n=In(n,a,i,t,e[14],23,-35309556),t=In(t,n,a,i,e[1],4,-1530992060),i=In(i,t,n,a,e[4],11,1272893353),a=In(a,i,t,n,e[7],16,-155497632),n=In(n,a,i,t,e[10],23,-1094730640),t=In(t,n,a,i,e[13],4,681279174),i=In(i,t,n,a,e[0],11,-358537222),a=In(a,i,t,n,e[3],16,-722521979),n=In(n,a,i,t,e[6],23,76029189),t=In(t,n,a,i,e[9],4,-640364487),i=In(i,t,n,a,e[12],11,-421815835),a=In(a,i,t,n,e[15],16,530742520),t=Tn(t,n=In(n,a,i,t,e[2],23,-995338651),a,i,e[0],6,-198630844),i=Tn(i,t,n,a,e[7],10,1126891415),a=Tn(a,i,t,n,e[14],15,-1416354905),n=Tn(n,a,i,t,e[5],21,-57434055),t=Tn(t,n,a,i,e[12],6,1700485571),i=Tn(i,t,n,a,e[3],10,-1894986606),a=Tn(a,i,t,n,e[10],15,-1051523),n=Tn(n,a,i,t,e[1],21,-2054922799),t=Tn(t,n,a,i,e[8],6,1873313359),i=Tn(i,t,n,a,e[15],10,-30611744),a=Tn(a,i,t,n,e[6],15,-1560198380),n=Tn(n,a,i,t,e[13],21,1309151649),t=Tn(t,n,a,i,e[4],6,-145523070),i=Tn(i,t,n,a,e[11],10,-1120210379),a=Tn(a,i,t,n,e[2],15,718787259),n=Tn(n,a,i,t,e[9],21,-343485551),r[0]=ko(t,r[0]),r[1]=ko(n,r[1]),r[2]=ko(a,r[2]),r[3]=ko(i,r[3])}function Bh(r,e,t,n,a,i){return e=ko(ko(e,r),ko(n,i)),ko(e<<a|e>>>32-a,t)}function Pn(r,e,t,n,a,i,o){return Bh(e&t|~e&n,r,e,a,i,o)}function Dn(r,e,t,n,a,i,o){return Bh(e&n|t&~n,r,e,a,i,o)}function In(r,e,t,n,a,i,o){return Bh(e^t^n,r,e,a,i,o)}function Tn(r,e,t,n,a,i,o){return Bh(t^(e|~n),r,e,a,i,o)}function E3(r){var e,t=r.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=r.length;e+=64)m1(n,vk(r.substring(e-64,e)));r=r.substring(e-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<r.length;e++)a[e>>2]|=r.charCodeAt(e)<<(e%4<<3);if(a[e>>2]|=128<<(e%4<<3),e>55)for(m1(n,a),e=0;e<16;e++)a[e]=0;return a[14]=8*t,m1(n,a),n}function vk(r){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=r.charCodeAt(e)+(r.charCodeAt(e+1)<<8)+(r.charCodeAt(e+2)<<16)+(r.charCodeAt(e+3)<<24);return t}vu=ht.atob.bind(ht),yp=ht.btoa.bind(ht);var F2="0123456789abcdef".split("");function xk(r){for(var e="",t=0;t<4;t++)e+=F2[r>>8*t+4&15]+F2[r>>8*t&15];return e}function yk(r){return String.fromCharCode((255&r)>>0,(65280&r)>>8,(16711680&r)>>16,(4278190080&r)>>24)}function bp(r){return E3(r).map(yk).join("")}var bk=function(r){for(var e=0;e<r.length;e++)r[e]=xk(r[e]);return r.join("")}(E3("hello"))!="5d41402abc4b2a76b9719d911017c592";function ko(r,e){if(bk){var t=(65535&r)+(65535&e);return(r>>16)+(e>>16)+(t>>16)<<16|65535&t}return r+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function wp(r,e){var t,n,a,i;if(r!==t){for(var o=(a=r,i=1+(256/r.length>>0),new Array(i+1).join(a)),s=[],l=0;l<256;l++)s[l]=l;var u=0;for(l=0;l<256;l++){var d=s[l];u=(u+d+o.charCodeAt(l))%256,s[l]=s[u],s[u]=d}t=r,n=s}else s=n;var f=e.length,h=0,p=0,g="";for(l=0;l<f;l++)p=(p+(d=s[h=(h+1)%256]))%256,s[h]=s[p],s[p]=d,o=s[(s[h]+s[p])%256],g+=String.fromCharCode(e.charCodeAt(l)^o);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var B2={print:4,modify:8,copy:16,"annot-forms":32};function Rc(r,e,t,n){this.v=1,this.r=2;var a=192;r.forEach(function(s){if(B2.perm!==void 0)throw new Error("Invalid permission: "+s);a+=B2[s]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var i=(e+this.padding).substr(0,32),o=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,o),this.P=-(1+(255^a)),this.encryptionKey=bp(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=wp(this.encryptionKey,this.padding)}function Lc(r){if(/[^\u0000-\u00ff]/.test(r))throw new Error("Invalid PDF Name Object: "+r+", Only accept ASCII characters.");for(var e="",t=r.length,n=0;n<t;n++){var a=r.charCodeAt(n);a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?e+="#"+("0"+a.toString(16)).slice(-2):e+=r[n]}return e}function $2(r){if(ir(r)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,n,a){if(a=a||!1,typeof t!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var i=Math.random().toString(35);return e[t][i]=[n,!!a],i},this.unsubscribe=function(t){for(var n in e)if(e[n][t])return delete e[n][t],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in e[t]){var o=e[t][i];try{o[0].apply(r,n)}catch(s){ht.console&&dr.error("jsPDF PubSub Error",s.message,s)}o[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Uf(r){if(!(this instanceof Uf))return new Uf(r);var e="opacity,stroke-opacity".split(",");for(var t in r)r.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=r[t]);this.id="",this.objectNumber=-1}function A3(r,e){this.gState=r,this.matrix=e,this.id="",this.objectNumber=-1}function Cs(r,e,t,n,a){if(!(this instanceof Cs))return new Cs(r,e,t,n,a);this.type=r==="axial"?2:3,this.coords=e,this.colors=t,A3.call(this,n,a)}function Bc(r,e,t,n,a){if(!(this instanceof Bc))return new Bc(r,e,t,n,a);this.boundingBox=r,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,A3.call(this,n,a)}function ft(r){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],o=[],s=1,l=16,u="S",d=null;ir(r=r||{})==="object"&&(t=r.orientation,n=r.unit||n,a=r.format||a,i=r.compress||r.compressPdf||i,(d=r.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),s=typeof r.userUnit=="number"?Math.abs(r.userUnit):1,r.precision!==void 0&&(e=r.precision),r.floatPrecision!==void 0&&(l=r.floatPrecision),u=r.defaultPathOperation||"S"),o=r.filters||(i===!0?["FlateEncode"]:o),n=n||"mm",t=(""+(t||"P")).toLowerCase();var f=r.putOnlyUsedFonts||!1,h={},p={internal:{},__private__:{}};p.__private__.PubSub=$2;var g="1.3",v=p.__private__.getPdfVersion=function(){return g};p.__private__.setPdfVersion=function(_){g=_};var b={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return b};var y=p.__private__.getPageFormat=function(_){return b[_]};a=a||"a4";var C={COMPAT:"compat",ADVANCED:"advanced"},S=C.COMPAT;function j(){this.saveGraphicsState(),te(new ut(ze,0,0,-ze,0,po()*ze).toString()+" cm"),this.setFontSize(this.getFontSize()/ze),u="n",S=C.ADVANCED}function D(){this.restoreGraphicsState(),u="S",S=C.COMPAT}var F=p.__private__.combineFontStyleAndFontWeight=function(_,I){if(_=="bold"&&I=="normal"||_=="bold"&&I==400||_=="normal"&&I=="italic"||_=="bold"&&I=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return I&&(_=I==400||I==="normal"?_==="italic"?"italic":"normal":I!=700&&I!=="bold"||_!=="normal"?(I==700?"bold":I)+""+_:"bold"),_};p.advancedAPI=function(_){var I=S===C.COMPAT;return I&&j.call(this),typeof _!="function"||(_(this),I&&D.call(this)),this},p.compatAPI=function(_){var I=S===C.ADVANCED;return I&&D.call(this),typeof _!="function"||(_(this),I&&j.call(this)),this},p.isAdvancedAPI=function(){return S===C.ADVANCED};var M,T=function(_){if(S!==C.ADVANCED)throw new Error(_+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},q=p.roundToPrecision=p.__private__.roundToPrecision=function(_,I){var Z=e||I;if(isNaN(_)||isNaN(Z))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return _.toFixed(Z).replace(/0+$/,"")};M=p.hpf=p.__private__.hpf=typeof l=="number"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return q(_,l)}:l==="smart"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return q(_,_>-1&&_<1?16:5)}:function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return q(_,16)};var J=p.f2=p.__private__.f2=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f2");return q(_,2)},O=p.__private__.f3=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f3");return q(_,3)},k=p.scale=p.__private__.scale=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.scale");return S===C.COMPAT?_*ze:S===C.ADVANCED?_:void 0},H=function(_){return S===C.COMPAT?po()-_:S===C.ADVANCED?_:void 0},X=function(_){return k(H(_))};p.__private__.setPrecision=p.setPrecision=function(_){typeof parseInt(_,10)=="number"&&(e=parseInt(_,10))};var ce,Q="00000000000000000000000000000000",re=p.__private__.getFileId=function(){return Q},G=p.__private__.setFileId=function(_){return Q=_!==void 0&&/^[a-fA-F0-9]{32}$/.test(_)?_.toUpperCase():Q.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(An=new Rc(d.userPermissions,d.userPassword,d.ownerPassword,Q)),Q};p.setFileId=function(_){return G(_),this},p.getFileId=function(){return re()};var Y=p.__private__.convertDateToPDFDate=function(_){var I=_.getTimezoneOffset(),Z=I<0?"+":"-",ne=Math.floor(Math.abs(I/60)),de=Math.abs(I%60),_e=[Z,V(ne),"'",V(de),"'"].join("");return["D:",_.getFullYear(),V(_.getMonth()+1),V(_.getDate()),V(_.getHours()),V(_.getMinutes()),V(_.getSeconds()),_e].join("")},ge=p.__private__.convertPDFDateToDate=function(_){var I=parseInt(_.substr(2,4),10),Z=parseInt(_.substr(6,2),10)-1,ne=parseInt(_.substr(8,2),10),de=parseInt(_.substr(10,2),10),_e=parseInt(_.substr(12,2),10),De=parseInt(_.substr(14,2),10);return new Date(I,Z,ne,de,_e,De,0)},ye=p.__private__.setCreationDate=function(_){var I;if(_===void 0&&(_=new Date),_ instanceof Date)I=Y(_);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(_))throw new Error("Invalid argument passed to jsPDF.setCreationDate");I=_}return ce=I},A=p.__private__.getCreationDate=function(_){var I=ce;return _==="jsDate"&&(I=ge(ce)),I};p.setCreationDate=function(_){return ye(_),this},p.getCreationDate=function(_){return A(_)};var $,V=p.__private__.padd2=function(_){return("0"+parseInt(_)).slice(-2)},K=p.__private__.padd2Hex=function(_){return("00"+(_=_.toString())).substr(_.length)},ee=0,oe=[],fe=[],ve=0,Ie=[],Te=[],Be=!1,$e=fe,ct=function(){ee=0,ve=0,fe=[],oe=[],Ie=[],Hi=Br(),Qa=Br()};p.__private__.setCustomOutputDestination=function(_){Be=!0,$e=_};var we=function(_){Be||($e=_)};p.__private__.resetCustomOutputDestination=function(){Be=!1,$e=fe};var te=p.__private__.out=function(_){return _=_.toString(),ve+=_.length+1,$e.push(_),$e},vt=p.__private__.write=function(_){return te(arguments.length===1?_.toString():Array.prototype.join.call(arguments," "))},Ze=p.__private__.getArrayBuffer=function(_){for(var I=_.length,Z=new ArrayBuffer(I),ne=new Uint8Array(Z);I--;)ne[I]=_.charCodeAt(I);return Z},je=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return je};var Oe=r.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(_){return Oe=S===C.ADVANCED?_/ze:_,this};var Ve,Ue=p.__private__.getFontSize=p.getFontSize=function(){return S===C.COMPAT?Oe:Oe*ze},et=r.R2L||!1;p.__private__.setR2L=p.setR2L=function(_){return et=_,this},p.__private__.getR2L=p.getR2L=function(){return et};var mt,bt=p.__private__.setZoomMode=function(_){var I=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(_))Ve=_;else if(isNaN(_)){if(I.indexOf(_)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+_+'" is not recognized.');Ve=_}else Ve=parseInt(_,10)};p.__private__.getZoomMode=function(){return Ve};var St,At=p.__private__.setPageMode=function(_){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(_)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+_+'" is not recognized.');mt=_};p.__private__.getPageMode=function(){return mt};var Gt=p.__private__.setLayoutMode=function(_){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(_)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+_+'" is not recognized.');St=_};p.__private__.getLayoutMode=function(){return St},p.__private__.setDisplayMode=p.setDisplayMode=function(_,I,Z){return bt(_),Gt(I),At(Z),this};var it={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(_){if(Object.keys(it).indexOf(_)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return it[_]},p.__private__.getDocumentProperties=function(){return it},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(_){for(var I in it)it.hasOwnProperty(I)&&_[I]&&(it[I]=_[I]);return this},p.__private__.setDocumentProperty=function(_,I){if(Object.keys(it).indexOf(_)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return it[_]=I};var jt,ze,Qr,Mt,fa,Yt={},$t={},Aa=[],Ye={},Ut={},dt={},Er={},Fr=null,lr=0,gt=[],Zt=new $2(p),os=r.hotfixes||[],wn={},yi={},bi=[],ut=function _(I,Z,ne,de,_e,De){if(!(this instanceof _))return new _(I,Z,ne,de,_e,De);isNaN(I)&&(I=1),isNaN(Z)&&(Z=0),isNaN(ne)&&(ne=0),isNaN(de)&&(de=1),isNaN(_e)&&(_e=0),isNaN(De)&&(De=0),this._matrix=[I,Z,ne,de,_e,De]};Object.defineProperty(ut.prototype,"sx",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(ut.prototype,"shy",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(ut.prototype,"shx",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(ut.prototype,"sy",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(ut.prototype,"tx",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(ut.prototype,"ty",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(ut.prototype,"a",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(ut.prototype,"b",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(ut.prototype,"c",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(ut.prototype,"d",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(ut.prototype,"e",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(ut.prototype,"f",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(ut.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ut.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ut.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ut.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ut.prototype.join=function(_){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(M).join(_)},ut.prototype.multiply=function(_){var I=_.sx*this.sx+_.shy*this.shx,Z=_.sx*this.shy+_.shy*this.sy,ne=_.shx*this.sx+_.sy*this.shx,de=_.shx*this.shy+_.sy*this.sy,_e=_.tx*this.sx+_.ty*this.shx+this.tx,De=_.tx*this.shy+_.ty*this.sy+this.ty;return new ut(I,Z,ne,de,_e,De)},ut.prototype.decompose=function(){var _=this.sx,I=this.shy,Z=this.shx,ne=this.sy,de=this.tx,_e=this.ty,De=Math.sqrt(_*_+I*I),Ke=(_/=De)*Z+(I/=De)*ne;Z-=_*Ke,ne-=I*Ke;var nt=Math.sqrt(Z*Z+ne*ne);return Ke/=nt,_*(ne/=nt)<I*(Z/=nt)&&(_=-_,I=-I,Ke=-Ke,De=-De),{scale:new ut(De,0,0,nt,0,0),translate:new ut(1,0,0,1,de,_e),rotate:new ut(_,I,-I,_,0,0),skew:new ut(1,0,Ke,1,0,0)}},ut.prototype.toString=function(_){return this.join(" ")},ut.prototype.inversed=function(){var _=this.sx,I=this.shy,Z=this.shx,ne=this.sy,de=this.tx,_e=this.ty,De=1/(_*ne-I*Z),Ke=ne*De,nt=-I*De,Ct=-Z*De,wt=_*De;return new ut(Ke,nt,Ct,wt,-Ke*de-Ct*_e,-nt*de-wt*_e)},ut.prototype.applyToPoint=function(_){var I=_.x*this.sx+_.y*this.shx+this.tx,Z=_.x*this.shy+_.y*this.sy+this.ty;return new lc(I,Z)},ut.prototype.applyToRectangle=function(_){var I=this.applyToPoint(_),Z=this.applyToPoint(new lc(_.x+_.w,_.y+_.h));return new Pl(I.x,I.y,Z.x-I.x,Z.y-I.y)},ut.prototype.clone=function(){var _=this.sx,I=this.shy,Z=this.shx,ne=this.sy,de=this.tx,_e=this.ty;return new ut(_,I,Z,ne,de,_e)},p.Matrix=ut;var Xa=p.matrixMult=function(_,I){return I.multiply(_)},wi=new ut(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=wi;var Xn=function(_,I){if(!Ut[_]){var Z=(I instanceof Cs?"Sh":"P")+(Object.keys(Ye).length+1).toString(10);I.id=Z,Ut[_]=Z,Ye[Z]=I,Zt.publish("addPattern",I)}};p.ShadingPattern=Cs,p.TilingPattern=Bc,p.addShadingPattern=function(_,I){return T("addShadingPattern()"),Xn(_,I),this},p.beginTilingPattern=function(_){T("beginTilingPattern()"),vd(_.boundingBox[0],_.boundingBox[1],_.boundingBox[2]-_.boundingBox[0],_.boundingBox[3]-_.boundingBox[1],_.matrix)},p.endTilingPattern=function(_,I){T("endTilingPattern()"),I.stream=Te[$].join(`
`),Xn(_,I),Zt.publish("endTilingPattern",I),bi.pop().restore()};var Zr=p.__private__.newObject=function(){var _=Br();return ha(_,!0),_},Br=p.__private__.newObjectDeferred=function(){return ee++,oe[ee]=function(){return ve},ee},ha=function(_,I){return I=typeof I=="boolean"&&I,oe[_]=ve,I&&te(_+" 0 obj"),_},Xs=p.__private__.newAdditionalObject=function(){var _={objId:Br(),content:""};return Ie.push(_),_},Hi=Br(),Qa=Br(),Za=p.__private__.decodeColorString=function(_){var I=_.split(" ");if(I.length!==2||I[1]!=="g"&&I[1]!=="G")I.length===5&&(I[4]==="k"||I[4]==="K")&&(I=[(1-I[0])*(1-I[3]),(1-I[1])*(1-I[3]),(1-I[2])*(1-I[3]),"r"]);else{var Z=parseFloat(I[0]);I=[Z,Z,Z,"r"]}for(var ne="#",de=0;de<3;de++)ne+=("0"+Math.floor(255*parseFloat(I[de])).toString(16)).slice(-2);return ne},Ja=p.__private__.encodeColorString=function(_){var I;typeof _=="string"&&(_={ch1:_});var Z=_.ch1,ne=_.ch2,de=_.ch3,_e=_.ch4,De=_.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Z=="string"&&Z.charAt(0)!=="#"){var Ke=new S3(Z);if(Ke.ok)Z=Ke.toHex();else if(!/^\d*\.?\d*$/.test(Z))throw new Error('Invalid color "'+Z+'" passed to jsPDF.encodeColorString.')}if(typeof Z=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Z)&&(Z="#"+Z[1]+Z[1]+Z[2]+Z[2]+Z[3]+Z[3]),typeof Z=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Z)){var nt=parseInt(Z.substr(1),16);Z=nt>>16&255,ne=nt>>8&255,de=255&nt}if(ne===void 0||_e===void 0&&Z===ne&&ne===de)if(typeof Z=="string")I=Z+" "+De[0];else switch(_.precision){case 2:I=J(Z/255)+" "+De[0];break;case 3:default:I=O(Z/255)+" "+De[0]}else if(_e===void 0||ir(_e)==="object"){if(_e&&!isNaN(_e.a)&&_e.a===0)return I=["1.","1.","1.",De[1]].join(" ");if(typeof Z=="string")I=[Z,ne,de,De[1]].join(" ");else switch(_.precision){case 2:I=[J(Z/255),J(ne/255),J(de/255),De[1]].join(" ");break;default:case 3:I=[O(Z/255),O(ne/255),O(de/255),De[1]].join(" ")}}else if(typeof Z=="string")I=[Z,ne,de,_e,De[2]].join(" ");else switch(_.precision){case 2:I=[J(Z),J(ne),J(de),J(_e),De[2]].join(" ");break;case 3:default:I=[O(Z),O(ne),O(de),O(_e),De[2]].join(" ")}return I},_i=p.__private__.getFilters=function(){return o},ja=p.__private__.putStream=function(_){var I=(_=_||{}).data||"",Z=_.filters||_i(),ne=_.alreadyAppliedFilters||[],de=_.addLength1||!1,_e=I.length,De=_.objectId,Ke=function(jn){return jn};if(d!==null&&De===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Ke=An.encryptor(De,0));var nt={};Z===!0&&(Z=["FlateEncode"]);var Ct=_.additionalKeyValues||[],wt=(nt=ft.API.processDataByFilters!==void 0?ft.API.processDataByFilters(I,Z):{data:I,reverseChain:[]}).reverseChain+(Array.isArray(ne)?ne.join(" "):ne.toString());if(nt.data.length!==0&&(Ct.push({key:"Length",value:nt.data.length}),de===!0&&Ct.push({key:"Length1",value:_e})),wt.length!=0)if(wt.split("/").length-1==1)Ct.push({key:"Filter",value:wt});else{Ct.push({key:"Filter",value:"["+wt+"]"});for(var Ft=0;Ft<Ct.length;Ft+=1)if(Ct[Ft].key==="DecodeParms"){for(var _r=[],Ar=0;Ar<nt.reverseChain.split("/").length-1;Ar+=1)_r.push("null");_r.push(Ct[Ft].value),Ct[Ft].value="["+_r.join(" ")+"]"}}te("<<");for(var $r=0;$r<Ct.length;$r++)te("/"+Ct[$r].key+" "+Ct[$r].value);te(">>"),nt.data.length!==0&&(te("stream"),te(Ke(nt.data)),te("endstream"))},Ci=p.__private__.putPage=function(_){var I=_.number,Z=_.data,ne=_.objId,de=_.contentsObjId;ha(ne,!0),te("<</Type /Page"),te("/Parent "+_.rootDictionaryObjId+" 0 R"),te("/Resources "+_.resourceDictionaryObjId+" 0 R"),te("/MediaBox ["+parseFloat(M(_.mediaBox.bottomLeftX))+" "+parseFloat(M(_.mediaBox.bottomLeftY))+" "+M(_.mediaBox.topRightX)+" "+M(_.mediaBox.topRightY)+"]"),_.cropBox!==null&&te("/CropBox ["+M(_.cropBox.bottomLeftX)+" "+M(_.cropBox.bottomLeftY)+" "+M(_.cropBox.topRightX)+" "+M(_.cropBox.topRightY)+"]"),_.bleedBox!==null&&te("/BleedBox ["+M(_.bleedBox.bottomLeftX)+" "+M(_.bleedBox.bottomLeftY)+" "+M(_.bleedBox.topRightX)+" "+M(_.bleedBox.topRightY)+"]"),_.trimBox!==null&&te("/TrimBox ["+M(_.trimBox.bottomLeftX)+" "+M(_.trimBox.bottomLeftY)+" "+M(_.trimBox.topRightX)+" "+M(_.trimBox.topRightY)+"]"),_.artBox!==null&&te("/ArtBox ["+M(_.artBox.bottomLeftX)+" "+M(_.artBox.bottomLeftY)+" "+M(_.artBox.topRightX)+" "+M(_.artBox.topRightY)+"]"),typeof _.userUnit=="number"&&_.userUnit!==1&&te("/UserUnit "+_.userUnit),Zt.publish("putPage",{objId:ne,pageContext:gt[I],pageNumber:I,page:Z}),te("/Contents "+de+" 0 R"),te(">>"),te("endobj");var _e=Z.join(`
`);return S===C.ADVANCED&&(_e+=`
Q`),ha(de,!0),ja({data:_e,filters:_i(),objectId:de}),te("endobj"),ne},ss=p.__private__.putPages=function(){var _,I,Z=[];for(_=1;_<=lr;_++)gt[_].objId=Br(),gt[_].contentsObjId=Br();for(_=1;_<=lr;_++)Z.push(Ci({number:_,data:Te[_],objId:gt[_].objId,contentsObjId:gt[_].contentsObjId,mediaBox:gt[_].mediaBox,cropBox:gt[_].cropBox,bleedBox:gt[_].bleedBox,trimBox:gt[_].trimBox,artBox:gt[_].artBox,userUnit:gt[_].userUnit,rootDictionaryObjId:Hi,resourceDictionaryObjId:Qa}));ha(Hi,!0),te("<</Type /Pages");var ne="/Kids [";for(I=0;I<lr;I++)ne+=Z[I]+" 0 R ";te(ne+"]"),te("/Count "+lr),te(">>"),te("endobj"),Zt.publish("postPutPages")},Qs=function(_){Zt.publish("putFont",{font:_,out:te,newObject:Zr,putStream:ja}),_.isAlreadyPutted!==!0&&(_.objectNumber=Zr(),te("<<"),te("/Type /Font"),te("/BaseFont /"+Lc(_.postScriptName)),te("/Subtype /Type1"),typeof _.encoding=="string"&&te("/Encoding /"+_.encoding),te("/FirstChar 32"),te("/LastChar 255"),te(">>"),te("endobj"))},Zs=function(){for(var _ in Yt)Yt.hasOwnProperty(_)&&(f===!1||f===!0&&h.hasOwnProperty(_))&&Qs(Yt[_])},Js=function(_){_.objectNumber=Zr();var I=[];I.push({key:"Type",value:"/XObject"}),I.push({key:"Subtype",value:"/Form"}),I.push({key:"BBox",value:"["+[M(_.x),M(_.y),M(_.x+_.width),M(_.y+_.height)].join(" ")+"]"}),I.push({key:"Matrix",value:"["+_.matrix.toString()+"]"});var Z=_.pages[1].join(`
`);ja({data:Z,additionalKeyValues:I,objectId:_.objectNumber}),te("endobj")},ec=function(){for(var _ in wn)wn.hasOwnProperty(_)&&Js(wn[_])},Ju=function(_,I){var Z,ne=[],de=1/(I-1);for(Z=0;Z<1;Z+=de)ne.push(Z);if(ne.push(1),_[0].offset!=0){var _e={offset:0,color:_[0].color};_.unshift(_e)}if(_[_.length-1].offset!=1){var De={offset:1,color:_[_.length-1].color};_.push(De)}for(var Ke="",nt=0,Ct=0;Ct<ne.length;Ct++){for(Z=ne[Ct];Z>_[nt+1].offset;)nt++;var wt=_[nt].offset,Ft=(Z-wt)/(_[nt+1].offset-wt),_r=_[nt].color,Ar=_[nt+1].color;Ke+=K(Math.round((1-Ft)*_r[0]+Ft*Ar[0]).toString(16))+K(Math.round((1-Ft)*_r[1]+Ft*Ar[1]).toString(16))+K(Math.round((1-Ft)*_r[2]+Ft*Ar[2]).toString(16))}return Ke.trim()},Kh=function(_,I){I||(I=21);var Z=Zr(),ne=Ju(_.colors,I),de=[];de.push({key:"FunctionType",value:"0"}),de.push({key:"Domain",value:"[0.0 1.0]"}),de.push({key:"Size",value:"["+I+"]"}),de.push({key:"BitsPerSample",value:"8"}),de.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),de.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),ja({data:ne,additionalKeyValues:de,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Z}),te("endobj"),_.objectNumber=Zr(),te("<< /ShadingType "+_.type),te("/ColorSpace /DeviceRGB");var _e="/Coords ["+M(parseFloat(_.coords[0]))+" "+M(parseFloat(_.coords[1]))+" ";_.type===2?_e+=M(parseFloat(_.coords[2]))+" "+M(parseFloat(_.coords[3])):_e+=M(parseFloat(_.coords[2]))+" "+M(parseFloat(_.coords[3]))+" "+M(parseFloat(_.coords[4]))+" "+M(parseFloat(_.coords[5])),te(_e+="]"),_.matrix&&te("/Matrix ["+_.matrix.toString()+"]"),te("/Function "+Z+" 0 R"),te("/Extend [true true]"),te(">>"),te("endobj")},Xh=function(_,I){var Z=Br(),ne=Zr();I.push({resourcesOid:Z,objectOid:ne}),_.objectNumber=ne;var de=[];de.push({key:"Type",value:"/Pattern"}),de.push({key:"PatternType",value:"1"}),de.push({key:"PaintType",value:"1"}),de.push({key:"TilingType",value:"1"}),de.push({key:"BBox",value:"["+_.boundingBox.map(M).join(" ")+"]"}),de.push({key:"XStep",value:M(_.xStep)}),de.push({key:"YStep",value:M(_.yStep)}),de.push({key:"Resources",value:Z+" 0 R"}),_.matrix&&de.push({key:"Matrix",value:"["+_.matrix.toString()+"]"}),ja({data:_.stream,additionalKeyValues:de,objectId:_.objectNumber}),te("endobj")},tc=function(_){var I;for(I in Ye)Ye.hasOwnProperty(I)&&(Ye[I]instanceof Cs?Kh(Ye[I]):Ye[I]instanceof Bc&&Xh(Ye[I],_))},ed=function(_){for(var I in _.objectNumber=Zr(),te("<<"),_)switch(I){case"opacity":te("/ca "+J(_[I]));break;case"stroke-opacity":te("/CA "+J(_[I]))}te(">>"),te("endobj")},Qh=function(){var _;for(_ in dt)dt.hasOwnProperty(_)&&ed(dt[_])},yl=function(){for(var _ in te("/XObject <<"),wn)wn.hasOwnProperty(_)&&wn[_].objectNumber>=0&&te("/"+_+" "+wn[_].objectNumber+" 0 R");Zt.publish("putXobjectDict"),te(">>")},Zh=function(){An.oid=Zr(),te("<<"),te("/Filter /Standard"),te("/V "+An.v),te("/R "+An.r),te("/U <"+An.toHexString(An.U)+">"),te("/O <"+An.toHexString(An.O)+">"),te("/P "+An.P),te(">>"),te("endobj")},td=function(){for(var _ in te("/Font <<"),Yt)Yt.hasOwnProperty(_)&&(f===!1||f===!0&&h.hasOwnProperty(_))&&te("/"+_+" "+Yt[_].objectNumber+" 0 R");te(">>")},Jh=function(){if(Object.keys(Ye).length>0){for(var _ in te("/Shading <<"),Ye)Ye.hasOwnProperty(_)&&Ye[_]instanceof Cs&&Ye[_].objectNumber>=0&&te("/"+_+" "+Ye[_].objectNumber+" 0 R");Zt.publish("putShadingPatternDict"),te(">>")}},rc=function(_){if(Object.keys(Ye).length>0){for(var I in te("/Pattern <<"),Ye)Ye.hasOwnProperty(I)&&Ye[I]instanceof p.TilingPattern&&Ye[I].objectNumber>=0&&Ye[I].objectNumber<_&&te("/"+I+" "+Ye[I].objectNumber+" 0 R");Zt.publish("putTilingPatternDict"),te(">>")}},e0=function(){if(Object.keys(dt).length>0){var _;for(_ in te("/ExtGState <<"),dt)dt.hasOwnProperty(_)&&dt[_].objectNumber>=0&&te("/"+_+" "+dt[_].objectNumber+" 0 R");Zt.publish("putGStateDict"),te(">>")}},Ir=function(_){ha(_.resourcesOid,!0),te("<<"),te("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),td(),Jh(),rc(_.objectOid),e0(),yl(),te(">>"),te("endobj")},rd=function(){var _=[];Zs(),Qh(),ec(),tc(_),Zt.publish("putResources"),_.forEach(Ir),Ir({resourcesOid:Qa,objectOid:Number.MAX_SAFE_INTEGER}),Zt.publish("postPutResources")},nd=function(){Zt.publish("putAdditionalObjects");for(var _=0;_<Ie.length;_++){var I=Ie[_];ha(I.objId,!0),te(I.content),te("endobj")}Zt.publish("postPutAdditionalObjects")},ad=function(_){$t[_.fontName]=$t[_.fontName]||{},$t[_.fontName][_.fontStyle]=_.id},bl=function(_,I,Z,ne,de){var _e={id:"F"+(Object.keys(Yt).length+1).toString(10),postScriptName:_,fontName:I,fontStyle:Z,encoding:ne,isStandardFont:de||!1,metadata:{}};return Zt.publish("addFont",{font:_e,instance:this}),Yt[_e.id]=_e,ad(_e),_e.id},t0=function(_){for(var I=0,Z=je.length;I<Z;I++){var ne=bl.call(this,_[I][0],_[I][1],_[I][2],je[I][3],!0);f===!1&&(h[ne]=!0);var de=_[I][0].split("-");ad({id:ne,fontName:de[0],fontStyle:de[1]||""})}Zt.publish("addFonts",{fonts:Yt,dictionary:$t})},ei=function(_){return _.foo=function(){try{return _.apply(this,arguments)}catch(ne){var I=ne.stack||"";~I.indexOf(" at ")&&(I=I.split(" at ")[1]);var Z="Error in function "+I.split(`
`)[0].split("<")[0]+": "+ne.message;if(!ht.console)throw new Error(Z);ht.console.error(Z,ne),ht.alert&&alert(Z)}},_.foo.bar=_,_.foo},nc=function(_,I){var Z,ne,de,_e,De,Ke,nt,Ct,wt;if(de=(I=I||{}).sourceEncoding||"Unicode",De=I.outputEncoding,(I.autoencode||De)&&Yt[jt].metadata&&Yt[jt].metadata[de]&&Yt[jt].metadata[de].encoding&&(_e=Yt[jt].metadata[de].encoding,!De&&Yt[jt].encoding&&(De=Yt[jt].encoding),!De&&_e.codePages&&(De=_e.codePages[0]),typeof De=="string"&&(De=_e[De]),De)){for(nt=!1,Ke=[],Z=0,ne=_.length;Z<ne;Z++)(Ct=De[_.charCodeAt(Z)])?Ke.push(String.fromCharCode(Ct)):Ke.push(_[Z]),Ke[Z].charCodeAt(0)>>8&&(nt=!0);_=Ke.join("")}for(Z=_.length;nt===void 0&&Z!==0;)_.charCodeAt(Z-1)>>8&&(nt=!0),Z--;if(!nt)return _;for(Ke=I.noBOM?[]:[254,255],Z=0,ne=_.length;Z<ne;Z++){if((wt=(Ct=_.charCodeAt(Z))>>8)>>8)throw new Error("Character at position "+Z+" of string '"+_+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ke.push(wt),Ke.push(Ct-(wt<<8))}return String.fromCharCode.apply(void 0,Ke)},Qn=p.__private__.pdfEscape=p.pdfEscape=function(_,I){return nc(_,I).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},wl=p.__private__.beginPage=function(_){Te[++lr]=[],gt[lr]={objId:0,contentsObjId:0,userUnit:Number(s),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(_[0]),topRightY:Number(_[1])}},od(lr),we(Te[$])},id=function(_,I){var Z,ne,de;switch(t=I||t,typeof _=="string"&&(Z=y(_.toLowerCase()),Array.isArray(Z)&&(ne=Z[0],de=Z[1])),Array.isArray(_)&&(ne=_[0]*ze,de=_[1]*ze),isNaN(ne)&&(ne=a[0],de=a[1]),(ne>14400||de>14400)&&(dr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ne=Math.min(14400,ne),de=Math.min(14400,de)),a=[ne,de],t.substr(0,1)){case"l":de>ne&&(a=[de,ne]);break;case"p":ne>de&&(a=[de,ne])}wl(a),fd(Sl),te(ti),Al!==0&&te(Al+" J"),jl!==0&&te(jl+" j"),Zt.publish("addPage",{pageNumber:lr})},r0=function(_){_>0&&_<=lr&&(Te.splice(_,1),gt.splice(_,1),lr--,$>lr&&($=lr),this.setPage($))},od=function(_){_>0&&_<=lr&&($=_)},n0=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return Te.length-1},sd=function(_,I,Z){var ne,de=void 0;return Z=Z||{},_=_!==void 0?_:Yt[jt].fontName,I=I!==void 0?I:Yt[jt].fontStyle,ne=_.toLowerCase(),$t[ne]!==void 0&&$t[ne][I]!==void 0?de=$t[ne][I]:$t[_]!==void 0&&$t[_][I]!==void 0?de=$t[_][I]:Z.disableWarning===!1&&dr.warn("Unable to look up font label for font '"+_+"', '"+I+"'. Refer to getFontList() for available fonts."),de||Z.noFallback||(de=$t.times[I])==null&&(de=$t.times.normal),de},a0=p.__private__.putInfo=function(){var _=Zr(),I=function(ne){return ne};for(var Z in d!==null&&(I=An.encryptor(_,0)),te("<<"),te("/Producer ("+Qn(I("jsPDF "+ft.version))+")"),it)it.hasOwnProperty(Z)&&it[Z]&&te("/"+Z.substr(0,1).toUpperCase()+Z.substr(1)+" ("+Qn(I(it[Z]))+")");te("/CreationDate ("+Qn(I(ce))+")"),te(">>"),te("endobj")},_l=p.__private__.putCatalog=function(_){var I=(_=_||{}).rootDictionaryObjId||Hi;switch(Zr(),te("<<"),te("/Type /Catalog"),te("/Pages "+I+" 0 R"),Ve||(Ve="fullwidth"),Ve){case"fullwidth":te("/OpenAction [3 0 R /FitH null]");break;case"fullheight":te("/OpenAction [3 0 R /FitV null]");break;case"fullpage":te("/OpenAction [3 0 R /Fit]");break;case"original":te("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Z=""+Ve;Z.substr(Z.length-1)==="%"&&(Ve=parseInt(Ve)/100),typeof Ve=="number"&&te("/OpenAction [3 0 R /XYZ null null "+J(Ve)+"]")}switch(St||(St="continuous"),St){case"continuous":te("/PageLayout /OneColumn");break;case"single":te("/PageLayout /SinglePage");break;case"two":case"twoleft":te("/PageLayout /TwoColumnLeft");break;case"tworight":te("/PageLayout /TwoColumnRight")}mt&&te("/PageMode /"+mt),Zt.publish("putCatalog"),te(">>"),te("endobj")},i0=p.__private__.putTrailer=function(){te("trailer"),te("<<"),te("/Size "+(ee+1)),te("/Root "+ee+" 0 R"),te("/Info "+(ee-1)+" 0 R"),d!==null&&te("/Encrypt "+An.oid+" 0 R"),te("/ID [ <"+Q+"> <"+Q+"> ]"),te(">>")},o0=p.__private__.putHeader=function(){te("%PDF-"+g),te("%ºß¬à")},s0=p.__private__.putXRef=function(){var _="0000000000";te("xref"),te("0 "+(ee+1)),te("0000000000 65535 f ");for(var I=1;I<=ee;I++)typeof oe[I]=="function"?te((_+oe[I]()).slice(-10)+" 00000 n "):oe[I]!==void 0?te((_+oe[I]).slice(-10)+" 00000 n "):te("0000000000 00000 n ")},Wi=p.__private__.buildDocument=function(){ct(),we(fe),Zt.publish("buildDocument"),o0(),ss(),nd(),rd(),d!==null&&Zh(),a0(),_l();var _=ve;return s0(),i0(),te("startxref"),te(""+_),te("%%EOF"),we(Te[$]),fe.join(`
`)},ac=p.__private__.getBlob=function(_){return new Blob([Ze(_)],{type:"application/pdf"})},ic=p.output=p.__private__.output=ei(function(_,I){switch(typeof(I=I||{})=="string"?I={filename:I}:I.filename=I.filename||"generated.pdf",_){case void 0:return Wi();case"save":p.save(I.filename);break;case"arraybuffer":return Ze(Wi());case"blob":return ac(Wi());case"bloburi":case"bloburl":if(ht.URL!==void 0&&typeof ht.URL.createObjectURL=="function")return ht.URL&&ht.URL.createObjectURL(ac(Wi()))||void 0;dr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Z="",ne=Wi();try{Z=yp(ne)}catch{Z=yp(unescape(encodeURIComponent(ne)))}return"data:application/pdf;filename="+I.filename+";base64,"+Z;case"pdfobjectnewwindow":if(Object.prototype.toString.call(ht)==="[object Window]"){var de="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",_e=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';I.pdfObjectUrl&&(de=I.pdfObjectUrl,_e="");var De='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+de+'"'+_e+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(I)+");<\/script></body></html>",Ke=ht.open();return Ke!==null&&Ke.document.write(De),Ke}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(ht)==="[object Window]"){var nt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(I.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+I.filename+'" width="500px" height="400px" /></body></html>',Ct=ht.open();if(Ct!==null){Ct.document.write(nt);var wt=this;Ct.document.documentElement.querySelector("#pdfViewer").onload=function(){Ct.document.title=I.filename,Ct.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(wt.output("bloburl"))}}return Ct}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(ht)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Ft='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",I)+'"></iframe></body></html>',_r=ht.open();if(_r!==null&&(_r.document.write(Ft),_r.document.title=I.filename),_r||typeof safari>"u")return _r;break;case"datauri":case"dataurl":return ht.document.location.href=this.output("datauristring",I);default:return null}}),cd=function(_){return Array.isArray(os)===!0&&os.indexOf(_)>-1};switch(n){case"pt":ze=1;break;case"mm":ze=72/25.4;break;case"cm":ze=72/2.54;break;case"in":ze=72;break;case"px":ze=cd("px_scaling")==1?.75:96/72;break;case"pc":case"em":ze=12;break;case"ex":ze=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);ze=n}var An=null;ye(),G();var c0=function(_){return d!==null?An.encryptor(_,0):function(I){return I}},ld=p.__private__.getPageInfo=p.getPageInfo=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:gt[_].objId,pageNumber:_,pageContext:gt[_]}},xt=p.__private__.getPageInfoByObjId=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var I in gt)if(gt[I].objId===_)break;return ld(I)},l0=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:gt[$].objId,pageNumber:$,pageContext:gt[$]}};p.addPage=function(){return id.apply(this,arguments),this},p.setPage=function(){return od.apply(this,arguments),we.call(this,Te[$]),this},p.insertPage=function(_){return this.addPage(),this.movePage($,_),this},p.movePage=function(_,I){var Z,ne;if(_>I){Z=Te[_],ne=gt[_];for(var de=_;de>I;de--)Te[de]=Te[de-1],gt[de]=gt[de-1];Te[I]=Z,gt[I]=ne,this.setPage(I)}else if(_<I){Z=Te[_],ne=gt[_];for(var _e=_;_e<I;_e++)Te[_e]=Te[_e+1],gt[_e]=gt[_e+1];Te[I]=Z,gt[I]=ne,this.setPage(I)}return this},p.deletePage=function(){return r0.apply(this,arguments),this},p.__private__.text=p.text=function(_,I,Z,ne,de){var _e,De,Ke,nt,Ct,wt,Ft,_r,Ar,$r=(ne=ne||{}).scope||this;if(typeof _=="number"&&typeof I=="number"&&(typeof Z=="string"||Array.isArray(Z))){var jn=Z;Z=I,I=_,_=jn}if(arguments[3]instanceof ut?(T("The transform parameter of text() with a Matrix value"),Ar=de):(Ke=arguments[4],nt=arguments[5],ir(Ft=arguments[3])==="object"&&Ft!==null||(typeof Ke=="string"&&(nt=Ke,Ke=null),typeof Ft=="string"&&(nt=Ft,Ft=null),typeof Ft=="number"&&(Ke=Ft,Ft=null),ne={flags:Ft,angle:Ke,align:nt})),isNaN(I)||isNaN(Z)||_==null)throw new Error("Invalid arguments passed to jsPDF.text");if(_.length===0)return $r;var dn="",ri=!1,pa=typeof ne.lineHeightFactor=="number"?ne.lineHeightFactor:ls,Ei=$r.internal.scaleFactor;function xd(fr){return fr=fr.split("	").join(Array(ne.TabLen||9).join(" ")),Qn(fr,Ft)}function Ol(fr){for(var hr,Or=fr.concat(),Jr=[],Qi=Or.length;Qi--;)typeof(hr=Or.shift())=="string"?Jr.push(hr):Array.isArray(fr)&&(hr.length===1||hr[1]===void 0&&hr[2]===void 0)?Jr.push(hr[0]):Jr.push([hr[0],hr[1],hr[2]]);return Jr}function kl(fr,hr){var Or;if(typeof fr=="string")Or=hr(fr)[0];else if(Array.isArray(fr)){for(var Jr,Qi,ql=fr.concat(),bc=[],Cd=ql.length;Cd--;)typeof(Jr=ql.shift())=="string"?bc.push(hr(Jr)[0]):Array.isArray(Jr)&&typeof Jr[0]=="string"&&(Qi=hr(Jr[0],Jr[1],Jr[2]),bc.push([Qi[0],Qi[1],Qi[2]]));Or=bc}return Or}var dc=!1,Ml=!0;if(typeof _=="string")dc=!0;else if(Array.isArray(_)){var Rl=_.concat();De=[];for(var fc,_n=Rl.length;_n--;)(typeof(fc=Rl.shift())!="string"||Array.isArray(fc)&&typeof fc[0]!="string")&&(Ml=!1);dc=Ml}if(dc===!1)throw new Error('Type of text must be string or Array. "'+_+'" is not recognized.');typeof _=="string"&&(_=_.match(/[\r?\n]/)?_.split(/\r\n|\r|\n/g):[_]);var hc=Oe/$r.internal.scaleFactor,pc=hc*(pa-1);switch(ne.baseline){case"bottom":Z-=pc;break;case"top":Z+=hc-pc;break;case"hanging":Z+=hc-2*pc;break;case"middle":Z+=hc/2-pc}if((wt=ne.maxWidth||0)>0&&(typeof _=="string"?_=$r.splitTextToSize(_,wt):Object.prototype.toString.call(_)==="[object Array]"&&(_=_.reduce(function(fr,hr){return fr.concat($r.splitTextToSize(hr,wt))},[]))),_e={text:_,x:I,y:Z,options:ne,mutex:{pdfEscape:Qn,activeFontKey:jt,fonts:Yt,activeFontSize:Oe}},Zt.publish("preProcessText",_e),_=_e.text,Ke=(ne=_e.options).angle,!(Ar instanceof ut)&&Ke&&typeof Ke=="number"){Ke*=Math.PI/180,ne.rotationDirection===0&&(Ke=-Ke),S===C.ADVANCED&&(Ke=-Ke);var mc=Math.cos(Ke),Ll=Math.sin(Ke);Ar=new ut(mc,Ll,-Ll,mc,0,0)}else Ke&&Ke instanceof ut&&(Ar=Ke);S!==C.ADVANCED||Ar||(Ar=wi),(Ct=ne.charSpace||cc)!==void 0&&(dn+=M(k(Ct))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(_r=ne.horizontalScale)!==void 0&&(dn+=M(100*_r)+` Tz
`),ne.lang;var Zn=-1,y0=ne.renderingMode!==void 0?ne.renderingMode:ne.stroke,Fl=$r.internal.getCurrentPageInfo().pageContext;switch(y0){case 0:case!1:case"fill":Zn=0;break;case 1:case!0:case"stroke":Zn=1;break;case 2:case"fillThenStroke":Zn=2;break;case 3:case"invisible":Zn=3;break;case 4:case"fillAndAddForClipping":Zn=4;break;case 5:case"strokeAndAddPathForClipping":Zn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Zn=6;break;case 7:case"addToPathForClipping":Zn=7}var yd=Fl.usedRenderingMode!==void 0?Fl.usedRenderingMode:-1;Zn!==-1?dn+=Zn+` Tr
`:yd!==-1&&(dn+=`0 Tr
`),Zn!==-1&&(Fl.usedRenderingMode=Zn),nt=ne.align||"left";var Pa,gc=Oe*pa,bd=$r.internal.pageSize.getWidth(),wd=Yt[jt];Ct=ne.charSpace||cc,wt=ne.maxWidth||0,Ft=Object.assign({autoencode:!0,noBOM:!0},ne.flags);var mo=[],fs=function(fr){return $r.getStringUnitWidth(fr,{font:wd,charSpace:Ct,fontSize:Oe,doKerning:!1})*Oe/Ei};if(Object.prototype.toString.call(_)==="[object Array]"){var Jn;De=Ol(_),nt!=="left"&&(Pa=De.map(fs));var Un,go=0;if(nt==="right"){I-=Pa[0],_=[],_n=De.length;for(var Yi=0;Yi<_n;Yi++)Yi===0?(Un=Si(I),Jn=Gi(Z)):(Un=k(go-Pa[Yi]),Jn=-gc),_.push([De[Yi],Un,Jn]),go=Pa[Yi]}else if(nt==="center"){I-=Pa[0]/2,_=[],_n=De.length;for(var Ki=0;Ki<_n;Ki++)Ki===0?(Un=Si(I),Jn=Gi(Z)):(Un=k((go-Pa[Ki])/2),Jn=-gc),_.push([De[Ki],Un,Jn]),go=Pa[Ki]}else if(nt==="left"){_=[],_n=De.length;for(var vc=0;vc<_n;vc++)_.push(De[vc])}else if(nt==="justify"&&wd.encoding==="Identity-H"){_=[],_n=De.length,wt=wt!==0?wt:bd;for(var Xi=0,Tr=0;Tr<_n;Tr++)if(Jn=Tr===0?Gi(Z):-gc,Un=Tr===0?Si(I):Xi,Tr<_n-1){var Bl=k((wt-Pa[Tr])/(De[Tr].split(" ").length-1)),qn=De[Tr].split(" ");_.push([qn[0]+" ",Un,Jn]),Xi=0;for(var Da=1;Da<qn.length;Da++){var xc=(fs(qn[Da-1]+" "+qn[Da])-fs(qn[Da]))*Ei+Bl;Da==qn.length-1?_.push([qn[Da],xc,0]):_.push([qn[Da]+" ",xc,0]),Xi-=xc}}else _.push([De[Tr],Un,Jn]);_.push(["",Xi,0])}else{if(nt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(_=[],_n=De.length,wt=wt!==0?wt:bd,Tr=0;Tr<_n;Tr++)Jn=Tr===0?Gi(Z):-gc,Un=Tr===0?Si(I):0,Tr<_n-1?mo.push(M(k((wt-Pa[Tr])/(De[Tr].split(" ").length-1)))):mo.push(0),_.push([De[Tr],Un,Jn])}}var _d=typeof ne.R2L=="boolean"?ne.R2L:et;_d===!0&&(_=kl(_,function(fr,hr,Or){return[fr.split("").reverse().join(""),hr,Or]})),_e={text:_,x:I,y:Z,options:ne,mutex:{pdfEscape:Qn,activeFontKey:jt,fonts:Yt,activeFontSize:Oe}},Zt.publish("postProcessText",_e),_=_e.text,ri=_e.mutex.isHex||!1;var $l=Yt[jt].encoding;$l!=="WinAnsiEncoding"&&$l!=="StandardEncoding"||(_=kl(_,function(fr,hr,Or){return[xd(fr),hr,Or]})),De=Ol(_),_=[];for(var hs,ps,vo,ms=0,yc=1,gs=Array.isArray(De[0])?yc:ms,xo="",Ul=function(fr,hr,Or){var Jr="";return Or instanceof ut?(Or=typeof ne.angle=="number"?Xa(Or,new ut(1,0,0,1,fr,hr)):Xa(new ut(1,0,0,1,fr,hr),Or),S===C.ADVANCED&&(Or=Xa(new ut(1,0,0,-1,0,0),Or)),Jr=Or.join(" ")+` Tm
`):Jr=M(fr)+" "+M(hr)+` Td
`,Jr},Ia=0;Ia<De.length;Ia++){switch(xo="",gs){case yc:vo=(ri?"<":"(")+De[Ia][0]+(ri?">":")"),hs=parseFloat(De[Ia][1]),ps=parseFloat(De[Ia][2]);break;case ms:vo=(ri?"<":"(")+De[Ia]+(ri?">":")"),hs=Si(I),ps=Gi(Z)}mo!==void 0&&mo[Ia]!==void 0&&(xo=mo[Ia]+` Tw
`),Ia===0?_.push(xo+Ul(hs,ps,Ar)+vo):gs===ms?_.push(xo+vo):gs===yc&&_.push(xo+Ul(hs,ps,Ar)+vo)}_=gs===ms?_.join(` Tj
T* `):_.join(` Tj
`),_+=` Tj
`;var Ta=`BT
/`;return Ta+=jt+" "+Oe+` Tf
`,Ta+=M(Oe*pa)+` TL
`,Ta+=us+`
`,Ta+=dn,Ta+=_,te(Ta+="ET"),h[jt]=!0,$r};var u0=p.__private__.clip=p.clip=function(_){return te(_==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return u0("evenodd")},p.__private__.discardPath=p.discardPath=function(){return te("n"),this};var Ni=p.__private__.isValidStyle=function(_){var I=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(_)!==-1&&(I=!0),I};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(_){return Ni(_)&&(u=_),this};var ud=p.__private__.getStyle=p.getStyle=function(_){var I=u;switch(_){case"D":case"S":I="S";break;case"F":I="f";break;case"FD":case"DF":I="B";break;case"f":case"f*":case"B":case"B*":I=_}return I},dd=p.close=function(){return te("h"),this};p.stroke=function(){return te("S"),this},p.fill=function(_){return oc("f",_),this},p.fillEvenOdd=function(_){return oc("f*",_),this},p.fillStroke=function(_){return oc("B",_),this},p.fillStrokeEvenOdd=function(_){return oc("B*",_),this};var oc=function(_,I){ir(I)==="object"?f0(I,_):te(_)},Cl=function(_){_===null||S===C.ADVANCED&&_===void 0||(_=ud(_),te(_))};function d0(_,I,Z,ne,de){var _e=new Bc(I||this.boundingBox,Z||this.xStep,ne||this.yStep,this.gState,de||this.matrix);_e.stream=this.stream;var De=_+"$$"+this.cloneIndex+++"$$";return Xn(De,_e),_e}var f0=function(_,I){var Z=Ut[_.key],ne=Ye[Z];if(ne instanceof Cs)te("q"),te(h0(I)),ne.gState&&p.setGState(ne.gState),te(_.matrix.toString()+" cm"),te("/"+Z+" sh"),te("Q");else if(ne instanceof Bc){var de=new ut(1,0,0,-1,0,po());_.matrix&&(de=de.multiply(_.matrix||wi),Z=d0.call(ne,_.key,_.boundingBox,_.xStep,_.yStep,de).id),te("q"),te("/Pattern cs"),te("/"+Z+" scn"),ne.gState&&p.setGState(ne.gState),te(I),te("Q")}},h0=function(_){switch(_){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Nl=p.moveTo=function(_,I){return te(M(k(_))+" "+M(X(I))+" m"),this},cs=p.lineTo=function(_,I){return te(M(k(_))+" "+M(X(I))+" l"),this},fo=p.curveTo=function(_,I,Z,ne,de,_e){return te([M(k(_)),M(X(I)),M(k(Z)),M(X(ne)),M(k(de)),M(X(_e)),"c"].join(" ")),this};p.__private__.line=p.line=function(_,I,Z,ne,de){if(isNaN(_)||isNaN(I)||isNaN(Z)||isNaN(ne)||!Ni(de))throw new Error("Invalid arguments passed to jsPDF.line");return S===C.COMPAT?this.lines([[Z-_,ne-I]],_,I,[1,1],de||"S"):this.lines([[Z-_,ne-I]],_,I,[1,1]).stroke()},p.__private__.lines=p.lines=function(_,I,Z,ne,de,_e){var De,Ke,nt,Ct,wt,Ft,_r,Ar,$r,jn,dn,ri;if(typeof _=="number"&&(ri=Z,Z=I,I=_,_=ri),ne=ne||[1,1],_e=_e||!1,isNaN(I)||isNaN(Z)||!Array.isArray(_)||!Array.isArray(ne)||!Ni(de)||typeof _e!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Nl(I,Z),De=ne[0],Ke=ne[1],Ct=_.length,jn=I,dn=Z,nt=0;nt<Ct;nt++)(wt=_[nt]).length===2?(jn=wt[0]*De+jn,dn=wt[1]*Ke+dn,cs(jn,dn)):(Ft=wt[0]*De+jn,_r=wt[1]*Ke+dn,Ar=wt[2]*De+jn,$r=wt[3]*Ke+dn,jn=wt[4]*De+jn,dn=wt[5]*Ke+dn,fo(Ft,_r,Ar,$r,jn,dn));return _e&&dd(),Cl(de),this},p.path=function(_){for(var I=0;I<_.length;I++){var Z=_[I],ne=Z.c;switch(Z.op){case"m":Nl(ne[0],ne[1]);break;case"l":cs(ne[0],ne[1]);break;case"c":fo.apply(this,ne);break;case"h":dd()}}return this},p.__private__.rect=p.rect=function(_,I,Z,ne,de){if(isNaN(_)||isNaN(I)||isNaN(Z)||isNaN(ne)||!Ni(de))throw new Error("Invalid arguments passed to jsPDF.rect");return S===C.COMPAT&&(ne=-ne),te([M(k(_)),M(X(I)),M(k(Z)),M(k(ne)),"re"].join(" ")),Cl(de),this},p.__private__.triangle=p.triangle=function(_,I,Z,ne,de,_e,De){if(isNaN(_)||isNaN(I)||isNaN(Z)||isNaN(ne)||isNaN(de)||isNaN(_e)||!Ni(De))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Z-_,ne-I],[de-Z,_e-ne],[_-de,I-_e]],_,I,[1,1],De,!0),this},p.__private__.roundedRect=p.roundedRect=function(_,I,Z,ne,de,_e,De){if(isNaN(_)||isNaN(I)||isNaN(Z)||isNaN(ne)||isNaN(de)||isNaN(_e)||!Ni(De))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ke=4/3*(Math.SQRT2-1);return de=Math.min(de,.5*Z),_e=Math.min(_e,.5*ne),this.lines([[Z-2*de,0],[de*Ke,0,de,_e-_e*Ke,de,_e],[0,ne-2*_e],[0,_e*Ke,-de*Ke,_e,-de,_e],[2*de-Z,0],[-de*Ke,0,-de,-_e*Ke,-de,-_e],[0,2*_e-ne],[0,-_e*Ke,de*Ke,-_e,de,-_e]],_+de,I,[1,1],De,!0),this},p.__private__.ellipse=p.ellipse=function(_,I,Z,ne,de){if(isNaN(_)||isNaN(I)||isNaN(Z)||isNaN(ne)||!Ni(de))throw new Error("Invalid arguments passed to jsPDF.ellipse");var _e=4/3*(Math.SQRT2-1)*Z,De=4/3*(Math.SQRT2-1)*ne;return Nl(_+Z,I),fo(_+Z,I-De,_+_e,I-ne,_,I-ne),fo(_-_e,I-ne,_-Z,I-De,_-Z,I),fo(_-Z,I+De,_-_e,I+ne,_,I+ne),fo(_+_e,I+ne,_+Z,I+De,_+Z,I),Cl(de),this},p.__private__.circle=p.circle=function(_,I,Z,ne){if(isNaN(_)||isNaN(I)||isNaN(Z)||!Ni(ne))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(_,I,Z,Z,ne)},p.setFont=function(_,I,Z){return Z&&(I=F(I,Z)),jt=sd(_,I,{disableWarning:!1}),this};var p0=p.__private__.getFont=p.getFont=function(){return Yt[sd.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var _,I,Z={};for(_ in $t)if($t.hasOwnProperty(_))for(I in Z[_]=[],$t[_])$t[_].hasOwnProperty(I)&&Z[_].push(I);return Z},p.addFont=function(_,I,Z,ne,de){var _e=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&_e.indexOf(arguments[3])!==-1?de=arguments[3]:arguments[3]&&_e.indexOf(arguments[3])==-1&&(Z=F(Z,ne)),de=de||"Identity-H",bl.call(this,_,I,Z,de)};var ls,Sl=r.lineWidth||.200025,sc=p.__private__.getLineWidth=p.getLineWidth=function(){return Sl},fd=p.__private__.setLineWidth=p.setLineWidth=function(_){return Sl=_,te(M(k(_))+" w"),this};p.__private__.setLineDash=ft.API.setLineDash=ft.API.setLineDashPattern=function(_,I){if(_=_||[],I=I||0,isNaN(I)||!Array.isArray(_))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return _=_.map(function(Z){return M(k(Z))}).join(" "),I=M(k(I)),te("["+_+"] "+I+" d"),this};var hd=p.__private__.getLineHeight=p.getLineHeight=function(){return Oe*ls};p.__private__.getLineHeight=p.getLineHeight=function(){return Oe*ls};var pd=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(_){return typeof(_=_||1.15)=="number"&&(ls=_),this},md=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return ls};pd(r.lineHeight);var Si=p.__private__.getHorizontalCoordinate=function(_){return k(_)},Gi=p.__private__.getVerticalCoordinate=function(_){return S===C.ADVANCED?_:gt[$].mediaBox.topRightY-gt[$].mediaBox.bottomLeftY-k(_)},m0=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(_){return M(Si(_))},ho=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(_){return M(Gi(_))},ti=r.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Za(ti)},p.__private__.setStrokeColor=p.setDrawColor=function(_,I,Z,ne){return ti=Ja({ch1:_,ch2:I,ch3:Z,ch4:ne,pdfColorType:"draw",precision:2}),te(ti),this};var El=r.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Za(El)},p.__private__.setFillColor=p.setFillColor=function(_,I,Z,ne){return El=Ja({ch1:_,ch2:I,ch3:Z,ch4:ne,pdfColorType:"fill",precision:2}),te(El),this};var us=r.textColor||"0 g",g0=p.__private__.getTextColor=p.getTextColor=function(){return Za(us)};p.__private__.setTextColor=p.setTextColor=function(_,I,Z,ne){return us=Ja({ch1:_,ch2:I,ch3:Z,ch4:ne,pdfColorType:"text",precision:3}),this};var cc=r.charSpace,v0=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(cc||0)};p.__private__.setCharSpace=p.setCharSpace=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return cc=_,this};var Al=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(_){var I=p.CapJoinStyles[_];if(I===void 0)throw new Error("Line cap style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Al=I,te(I+" J"),this};var jl=0;p.__private__.setLineJoin=p.setLineJoin=function(_){var I=p.CapJoinStyles[_];if(I===void 0)throw new Error("Line join style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return jl=I,te(I+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(_){if(_=_||0,isNaN(_))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return te(M(k(_))+" M"),this},p.GState=Uf,p.setGState=function(_){(_=typeof _=="string"?dt[Er[_]]:gd(null,_)).equals(Fr)||(te("/"+_.id+" gs"),Fr=_)};var gd=function(_,I){if(!_||!Er[_]){var Z=!1;for(var ne in dt)if(dt.hasOwnProperty(ne)&&dt[ne].equals(I)){Z=!0;break}if(Z)I=dt[ne];else{var de="GS"+(Object.keys(dt).length+1).toString(10);dt[de]=I,I.id=de}return _&&(Er[_]=I.id),Zt.publish("addGState",I),I}};p.addGState=function(_,I){return gd(_,I),this},p.saveGraphicsState=function(){return te("q"),Aa.push({key:jt,size:Oe,color:us}),this},p.restoreGraphicsState=function(){te("Q");var _=Aa.pop();return jt=_.key,Oe=_.size,us=_.color,Fr=null,this},p.setCurrentTransformationMatrix=function(_){return te(_.toString()+" cm"),this},p.comment=function(_){return te("#"+_),this};var lc=function(_,I){var Z=_||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Z},set:function(_e){isNaN(_e)||(Z=parseFloat(_e))}});var ne=I||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ne},set:function(_e){isNaN(_e)||(ne=parseFloat(_e))}});var de="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return de},set:function(_e){de=_e.toString()}}),this},Pl=function(_,I,Z,ne){lc.call(this,_,I),this.type="rect";var de=Z||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return de},set:function(De){isNaN(De)||(de=parseFloat(De))}});var _e=ne||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return _e},set:function(De){isNaN(De)||(_e=parseFloat(De))}}),this},Dl=function(){this.page=lr,this.currentPage=$,this.pages=Te.slice(0),this.pagesContext=gt.slice(0),this.x=Qr,this.y=Mt,this.matrix=fa,this.width=ds($),this.height=po($),this.outputDestination=$e,this.id="",this.objectNumber=-1};Dl.prototype.restore=function(){lr=this.page,$=this.currentPage,gt=this.pagesContext,Te=this.pages,Qr=this.x,Mt=this.y,fa=this.matrix,Il($,this.width),Tl($,this.height),$e=this.outputDestination};var vd=function(_,I,Z,ne,de){bi.push(new Dl),lr=$=0,Te=[],Qr=_,Mt=I,fa=de,wl([Z,ne])},x0=function(_){if(yi[_])bi.pop().restore();else{var I=new Dl,Z="Xo"+(Object.keys(wn).length+1).toString(10);I.id=Z,yi[_]=Z,wn[Z]=I,Zt.publish("addFormObject",I),bi.pop().restore()}};for(var uc in p.beginFormObject=function(_,I,Z,ne,de){return vd(_,I,Z,ne,de),this},p.endFormObject=function(_){return x0(_),this},p.doFormObject=function(_,I){var Z=wn[yi[_]];return te("q"),te(I.toString()+" cm"),te("/"+Z.id+" Do"),te("Q"),this},p.getFormObject=function(_){var I=wn[yi[_]];return{x:I.x,y:I.y,width:I.width,height:I.height,matrix:I.matrix}},p.save=function(_,I){return _=_||"generated.pdf",(I=I||{}).returnPromise=I.returnPromise||!1,I.returnPromise===!1?(bs(ac(Wi()),_),typeof bs.unload=="function"&&ht.setTimeout&&setTimeout(bs.unload,911),this):new Promise(function(Z,ne){try{var de=bs(ac(Wi()),_);typeof bs.unload=="function"&&ht.setTimeout&&setTimeout(bs.unload,911),Z(de)}catch(_e){ne(_e.message)}})},ft.API)ft.API.hasOwnProperty(uc)&&(uc==="events"&&ft.API.events.length?function(_,I){var Z,ne,de;for(de=I.length-1;de!==-1;de--)Z=I[de][0],ne=I[de][1],_.subscribe.apply(_,[Z].concat(typeof ne=="function"?[ne]:ne))}(Zt,ft.API.events):p[uc]=ft.API[uc]);var ds=p.getPageWidth=function(_){return(gt[_=_||$].mediaBox.topRightX-gt[_].mediaBox.bottomLeftX)/ze},Il=p.setPageWidth=function(_,I){gt[_].mediaBox.topRightX=I*ze+gt[_].mediaBox.bottomLeftX},po=p.getPageHeight=function(_){return(gt[_=_||$].mediaBox.topRightY-gt[_].mediaBox.bottomLeftY)/ze},Tl=p.setPageHeight=function(_,I){gt[_].mediaBox.topRightY=I*ze+gt[_].mediaBox.bottomLeftY};return p.internal={pdfEscape:Qn,getStyle:ud,getFont:p0,getFontSize:Ue,getCharSpace:v0,getTextColor:g0,getLineHeight:hd,getLineHeightFactor:md,getLineWidth:sc,write:vt,getHorizontalCoordinate:Si,getVerticalCoordinate:Gi,getCoordinateString:m0,getVerticalCoordinateString:ho,collections:{},newObject:Zr,newAdditionalObject:Xs,newObjectDeferred:Br,newObjectDeferredBegin:ha,getFilters:_i,putStream:ja,events:Zt,scaleFactor:ze,pageSize:{getWidth:function(){return ds($)},setWidth:function(_){Il($,_)},getHeight:function(){return po($)},setHeight:function(_){Tl($,_)}},encryptionOptions:d,encryption:An,getEncryptor:c0,output:ic,getNumberOfPages:n0,pages:Te,out:te,f2:J,f3:O,getPageInfo:ld,getPageInfoByObjId:xt,getCurrentPageInfo:l0,getPDFVersion:v,Point:lc,Rectangle:Pl,Matrix:ut,hasHotfix:cd},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return ds($)},set:function(_){Il($,_)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return po($)},set:function(_){Tl($,_)},enumerable:!0,configurable:!0}),t0.call(p,je),jt="F1",id(a,t),Zt.publish("initialized"),p}Rc.prototype.lsbFirstWord=function(r){return String.fromCharCode(r>>0&255,r>>8&255,r>>16&255,r>>24&255)},Rc.prototype.toHexString=function(r){return r.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Rc.prototype.hexToBytes=function(r){for(var e=[],t=0;t<r.length;t+=2)e.push(String.fromCharCode(parseInt(r.substr(t,2),16)));return e.join("")},Rc.prototype.processOwnerPassword=function(r,e){return wp(bp(e).substr(0,5),r)},Rc.prototype.encryptor=function(r,e){var t=bp(this.encryptionKey+String.fromCharCode(255&r,r>>8&255,r>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return wp(t,n)}},Uf.prototype.equals=function(r){var e,t="id,objectNumber,equals";if(!r||ir(r)!==ir(this))return!1;var n=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!r.hasOwnProperty(e)||this[e]!==r[e])return!1;n++}for(e in r)r.hasOwnProperty(e)&&t.indexOf(e)<0&&n--;return n===0},ft.API={events:[]},ft.version="3.0.1";var Pr=ft.API,gg=1,Gs=function(r){return r.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Dc=function(r){return r.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},_t=function(r){return r.toFixed(2)},Ao=function(r){return r.toFixed(5)};Pr.__acroform__={};var ua=function(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r},U2=function(r){return r*gg},ji=function(r){var e=new P3,t=Qe.internal.getHeight(r)||0,n=Qe.internal.getWidth(r)||0;return e.BBox=[0,0,Number(_t(n)),Number(_t(t))],e},wk=Pr.__acroform__.setBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return r|=1<<e},_k=Pr.__acroform__.clearBit=function(r,e){if(r=r||0,e=e||0,isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return r&=~(1<<e)},Ck=Pr.__acroform__.getBit=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return r&1<<e?1:0},Mr=Pr.__acroform__.getBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Ck(r,e-1)},Rr=Pr.__acroform__.setBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return wk(r,e-1)},Lr=Pr.__acroform__.clearBitForPdf=function(r,e){if(isNaN(r)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return _k(r,e-1)},Nk=Pr.__acroform__.calculateCoordinates=function(r,e){var t=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,a=r[0],i=r[1],o=r[2],s=r[3],l={};return l.lowerLeft_X=t(a)||0,l.lowerLeft_Y=n(i+s)||0,l.upperRight_X=t(a+o)||0,l.upperRight_Y=n(i)||0,[Number(_t(l.lowerLeft_X)),Number(_t(l.lowerLeft_Y)),Number(_t(l.upperRight_X)),Number(_t(l.upperRight_Y))]},Sk=function(r){if(r.appearanceStreamContent)return r.appearanceStreamContent;if(r.V||r.DV){var e=[],t=r._V||r.DV,n=_p(r,t),a=r.scope.internal.getFont(r.fontName,r.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(r.scope.__private__.encodeColorString(r.color)),e.push("/"+a+" "+_t(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var i=ji(r);return i.scope=r.scope,i.stream=e.join(`
`),i}},_p=function(r,e){var t=r.fontSize===0?r.maxFontSize:r.fontSize,n={text:"",fontSize:""},a=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");a=r.multiline?a.map(function(O){return O.split(`
`)}):a.map(function(O){return[O]});var i=t,o=Qe.internal.getHeight(r)||0;o=o<0?-o:o;var s=Qe.internal.getWidth(r)||0;s=s<0?-s:s;var l=function(O,k,H){if(O+1<a.length){var X=k+" "+a[O+1][0];return rf(X,r,H).width<=s-4}return!1};i++;e:for(;i>0;){e="",i--;var u,d,f=rf("3",r,i).height,h=r.multiline?o-i:(o-f)/2,p=h+=2,g=0,v=0,b=0;if(i<=0){e=`(...) Tj
`,e+="% Width of Text: "+rf(e,r,i=12).width+", FieldWidth:"+s+`
`;break}for(var y="",C=0,S=0;S<a.length;S++)if(a.hasOwnProperty(S)){var j=!1;if(a[S].length!==1&&b!==a[S].length-1){if((f+2)*(C+2)+2>o)continue e;y+=a[S][b],j=!0,v=S,S--}else{y=(y+=a[S][b]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var D=parseInt(S),F=l(D,y,i),M=S>=a.length-1;if(F&&!M){y+=" ",b=0;continue}if(F||M){if(M)v=D;else if(r.multiline&&(f+2)*(C+2)+2>o)continue e}else{if(!r.multiline||(f+2)*(C+2)+2>o)continue e;v=D}}for(var T="",q=g;q<=v;q++){var J=a[q];if(r.multiline){if(q===v){T+=J[b]+" ",b=(b+1)%J.length;continue}if(q===g){T+=J[J.length-1]+" ";continue}}T+=J[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,d=rf(T,r,i).width,r.textAlign){case"right":u=s-d-2;break;case"center":u=(s-d)/2;break;case"left":default:u=2}e+=_t(u)+" "+_t(p)+` Td
`,e+="("+Gs(T)+`) Tj
`,e+=-_t(u)+` 0 Td
`,p=-(i+2),d=0,g=j?v:v+1,C++,y=""}break}return n.text=e,n.fontSize=i,n},rf=function(r,e,t){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),a=e.scope.getStringUnitWidth(r,{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:a}},Ek={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Ak=function(r,e){var t={type:"reference",object:r};e.internal.getPageInfo(r.page).pageContext.annotations.find(function(n){return n.type===t.type&&n.object===t.object})===void 0&&e.internal.getPageInfo(r.page).pageContext.annotations.push(t)},jk=function(r,e){for(var t in r)if(r.hasOwnProperty(t)){var n=t,a=r[t];e.internal.newObjectDeferredBegin(a.objId,!0),ir(a)==="object"&&typeof a.putStream=="function"&&a.putStream(),delete r[n]}},Pk=function(r,e){if(e.scope=r,r.internal!==void 0&&(r.internal.acroformPlugin===void 0||r.internal.acroformPlugin.isInitialized===!1)){if(vi.FieldNum=0,r.internal.acroformPlugin=JSON.parse(JSON.stringify(Ek)),r.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");gg=r.internal.scaleFactor,r.internal.acroformPlugin.acroFormDictionaryRoot=new D3,r.internal.acroformPlugin.acroFormDictionaryRoot.scope=r,r.internal.acroformPlugin.acroFormDictionaryRoot._eventID=r.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(r)}),r.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&Ak(i,t)}})(r)}),r.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(r)}),r.internal.events.subscribe("postPutPages",function(t){(function(n,a){var i=!n;for(var o in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var s=n[o],l=[],u=s.Rect;if(s.Rect&&(s.Rect=Nk(s.Rect,a)),a.internal.newObjectDeferredBegin(s.objId,!0),s.DA=Qe.createDefaultAppearanceStream(s),ir(s)==="object"&&typeof s.getKeyValueListForStream=="function"&&(l=s.getKeyValueListForStream()),s.Rect=u,s.hasAppearanceStream&&!s.appearanceStreamContent){var d=Sk(s);l.push({key:"AP",value:"<</N "+d+">>"}),a.internal.acroformPlugin.xForms.push(d)}if(s.appearanceStreamContent){var f="";for(var h in s.appearanceStreamContent)if(s.appearanceStreamContent.hasOwnProperty(h)){var p=s.appearanceStreamContent[h];if(f+="/"+h+" ",f+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var o in p)if(p.hasOwnProperty(o)){var g=p[o];typeof g=="function"&&(g=g.call(a,s)),f+="/"+o+" "+g+" ",a.internal.acroformPlugin.xForms.indexOf(g)>=0||a.internal.acroformPlugin.xForms.push(g)}}else typeof(g=p)=="function"&&(g=g.call(a,s)),f+="/"+o+" "+g,a.internal.acroformPlugin.xForms.indexOf(g)>=0||a.internal.acroformPlugin.xForms.push(g);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}a.internal.putStream({additionalKeyValues:l,objectId:s.objId}),a.internal.out("endobj")}i&&jk(a.internal.acroformPlugin.xForms,a)})(t,r)}),r.internal.acroformPlugin.isInitialized=!0}},j3=Pr.__acroform__.arrayToPdfArray=function(r,e,t){var n=function(o){return o};if(Array.isArray(r)){for(var a="[",i=0;i<r.length;i++)switch(i!==0&&(a+=" "),ir(r[i])){case"boolean":case"number":case"object":a+=r[i].toString();break;case"string":r[i].substr(0,1)!=="/"?(e!==void 0&&t&&(n=t.internal.getEncryptor(e)),a+="("+Gs(n(r[i].toString()))+")"):a+=r[i].toString()}return a+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},g1=function(r,e,t){var n=function(a){return a};return e!==void 0&&t&&(n=t.internal.getEncryptor(e)),(r=r||"").toString(),r="("+Gs(n(r))+")"},Ti=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(r){this._objId=r}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ti.prototype.toString=function(){return this.objId+" 0 R"},Ti.prototype.putStream=function(){var r=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:r,objectId:this.objId}),this.scope.internal.out("endobj")},Ti.prototype.getKeyValueListForStream=function(){var r=[],e=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var n=e[t],a=this[n];a&&(Array.isArray(a)?r.push({key:n,value:j3(a,this.objId,this.scope)}):a instanceof Ti?(a.scope=this.scope,r.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&r.push({key:n,value:a}))}return r};var P3=function(){Ti.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var r,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){r=t.trim()},get:function(){return r||null}})};ua(P3,Ti);var D3=function(){Ti.call(this);var r,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(r){var t=function(n){return n};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Gs(t(r))+")"}},set:function(t){r=t}})};ua(D3,Ti);var vi=function r(){Ti.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');e=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Mr(e,3)},set:function(y){y?this.F=Rr(e,3):this.F=Lr(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');t=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof qf)return;i="FieldObject"+r.FieldNum++}var y=function(C){return C};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+Gs(y(i))+")"},set:function(y){i=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(y){i=y}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var s="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return s},set:function(y){s=y}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/gg:u},set:function(y){u=y}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(y){d=y}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof qf||this instanceof Ds))return g1(f,this.objId,this.scope)},set:function(y){y=y.toString(),f=y}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof gn?h:g1(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=this instanceof gn?y:y.substr(0,1)==="("?Dc(y.substr(1,y.length-2)):Dc(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof gn?Dc(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof gn?"/"+y:y}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof gn?p:g1(p,this.objId,this.scope)},set:function(y){y=y.toString(),p=this instanceof gn?y:y.substr(0,1)==="("?Dc(y.substr(1,y.length-2)):Dc(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof gn?Dc(p.substr(1,p.length-1)):p},set:function(y){y=y.toString(),p=this instanceof gn?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,v=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return v},set:function(y){y=!!y,v=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(y){g=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,1)},set:function(y){y?this.Ff=Rr(this.Ff,1):this.Ff=Lr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,2)},set:function(y){y?this.Ff=Rr(this.Ff,2):this.Ff=Lr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,3)},set:function(y){y?this.Ff=Rr(this.Ff,3):this.Ff=Lr(this.Ff,3)}});var b=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(b!==null)return b},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');b=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(b){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:b=2;break;case"center":case 1:b=1;break;case"left":case 0:default:b=0}}})};ua(vi,Ti);var Gc=function(){vi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var r=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return r},set:function(t){r=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return j3(e,this.objId,this.scope)},set:function(t){var n,a;a=[],typeof(n=t)=="string"&&(a=function(i,o,s){s||(s=1);for(var l,u=[];l=o.exec(i);)u.push(l[s]);return u}(n,/\((.*?)\)/g)),e=a}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,n){for(n=n||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,18)},set:function(t){t?this.Ff=Rr(this.Ff,18):this.Ff=Lr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Rr(this.Ff,19):this.Ff=Lr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,20)},set:function(t){t?(this.Ff=Rr(this.Ff,20),e.sort()):this.Ff=Lr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,22)},set:function(t){t?this.Ff=Rr(this.Ff,22):this.Ff=Lr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,23)},set:function(t){t?this.Ff=Rr(this.Ff,23):this.Ff=Lr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,27)},set:function(t){t?this.Ff=Rr(this.Ff,27):this.Ff=Lr(this.Ff,27)}}),this.hasAppearanceStream=!1};ua(Gc,vi);var Yc=function(){Gc.call(this),this.fontName="helvetica",this.combo=!1};ua(Yc,Gc);var Kc=function(){Yc.call(this),this.combo=!0};ua(Kc,Yc);var _f=function(){Kc.call(this),this.edit=!0};ua(_f,Kc);var gn=function(){vi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,15)},set:function(t){t?this.Ff=Rr(this.Ff,15):this.Ff=Lr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,16)},set:function(t){t?this.Ff=Rr(this.Ff,16):this.Ff=Lr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,17)},set:function(t){t?this.Ff=Rr(this.Ff,17):this.Ff=Lr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,26)},set:function(t){t?this.Ff=Rr(this.Ff,26):this.Ff=Lr(this.Ff,26)}});var r,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(i){return i};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,a=[];for(n in a.push("<<"),e)a.push("/"+n+" ("+Gs(t(e[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(t){ir(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(t){r=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(t){r="/"+t}})};ua(gn,vi);var Cf=function(){gn.call(this),this.pushButton=!0};ua(Cf,gn);var Xc=function(){gn.call(this),this.radio=!0,this.pushButton=!1;var r=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e!==void 0?e:[]}})};ua(Xc,gn);var qf=function(){var r,e;vi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(a){e=a}});var t,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(s){return s};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,o=[];for(i in o.push("<<"),n)o.push("/"+i+" ("+Gs(a(n[i]))+")");return o.push(">>"),o.join(`
`)},set:function(a){ir(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(a){t=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(a){t="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Qe.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ua(qf,vi),Xc.prototype.setAppearance=function(r){if(!("createAppearanceStream"in r)||!("getCA"in r))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=r.createAppearanceStream(t.optionName),t.caption=r.getCA()}},Xc.prototype.createOption=function(r){var e=new qf;return e.Parent=this,e.optionName=r,this.Kids.push(e),Dk.call(this.scope,e),e};var Nf=function(){gn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Qe.CheckBox.createAppearanceStream()};ua(Nf,gn);var Ds=function(){vi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,13)},set:function(e){e?this.Ff=Rr(this.Ff,13):this.Ff=Lr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,21)},set:function(e){e?this.Ff=Rr(this.Ff,21):this.Ff=Lr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,23)},set:function(e){e?this.Ff=Rr(this.Ff,23):this.Ff=Lr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,24)},set:function(e){e?this.Ff=Rr(this.Ff,24):this.Ff=Lr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,25)},set:function(e){e?this.Ff=Rr(this.Ff,25):this.Ff=Lr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,26)},set:function(e){e?this.Ff=Rr(this.Ff,26):this.Ff=Lr(this.Ff,26)}});var r=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return r},set:function(e){Number.isInteger(e)&&(r=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ua(Ds,vi);var Sf=function(){Ds.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Mr(this.Ff,14)},set:function(r){r?this.Ff=Rr(this.Ff,14):this.Ff=Lr(this.Ff,14)}}),this.password=!0};ua(Sf,Ds);var Qe={CheckBox:{createAppearanceStream:function(){return{N:{On:Qe.CheckBox.YesNormal},D:{On:Qe.CheckBox.YesPushDown,Off:Qe.CheckBox.OffPushDown}}},YesPushDown:function(r){var e=ji(r);e.scope=r.scope;var t=[],n=r.scope.internal.getFont(r.fontName,r.fontStyle).id,a=r.scope.__private__.encodeColorString(r.color),i=_p(r,r.caption);return t.push("0.749023 g"),t.push("0 0 "+_t(Qe.internal.getWidth(r))+" "+_t(Qe.internal.getHeight(r))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+n+" "+_t(i.fontSize)+" Tf "+a),t.push("BT"),t.push(i.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(r){var e=ji(r);e.scope=r.scope;var t=r.scope.internal.getFont(r.fontName,r.fontStyle).id,n=r.scope.__private__.encodeColorString(r.color),a=[],i=Qe.internal.getHeight(r),o=Qe.internal.getWidth(r),s=_p(r,r.caption);return a.push("1 g"),a.push("0 0 "+_t(o)+" "+_t(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+_t(o-1)+" "+_t(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+t+" "+_t(s.fontSize)+" Tf "+n),a.push(s.text),a.push("ET"),a.push("Q"),e.stream=a.join(`
`),e},OffPushDown:function(r){var e=ji(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_t(Qe.internal.getWidth(r))+" "+_t(Qe.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(r){var e={D:{Off:Qe.RadioButton.Circle.OffPushDown},N:{}};return e.N[r]=Qe.RadioButton.Circle.YesNormal,e.D[r]=Qe.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(r){var e=ji(r);e.scope=r.scope;var t=[],n=Qe.internal.getWidth(r)<=Qe.internal.getHeight(r)?Qe.internal.getWidth(r)/4:Qe.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Qe.internal.Bezier_C,i=Number((n*a).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Ao(Qe.internal.getWidth(r)/2)+" "+Ao(Qe.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),t.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),t.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),t.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=ji(r);e.scope=r.scope;var t=[],n=Qe.internal.getWidth(r)<=Qe.internal.getHeight(r)?Qe.internal.getWidth(r)/4:Qe.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*Qe.internal.Bezier_C).toFixed(5)),o=Number((n*Qe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Ao(Qe.internal.getWidth(r)/2)+" "+Ao(Qe.internal.getHeight(r)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),t.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),t.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),t.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Ao(Qe.internal.getWidth(r)/2)+" "+Ao(Qe.internal.getHeight(r)/2)+" cm"),t.push(n+" 0 m"),t.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),t.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),t.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),t.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(r){var e=ji(r);e.scope=r.scope;var t=[],n=Qe.internal.getWidth(r)<=Qe.internal.getHeight(r)?Qe.internal.getWidth(r)/4:Qe.internal.getHeight(r)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*Qe.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Ao(Qe.internal.getWidth(r)/2)+" "+Ao(Qe.internal.getHeight(r)/2)+" cm"),t.push(a+" 0 m"),t.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),t.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),t.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),t.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(r){var e={D:{Off:Qe.RadioButton.Cross.OffPushDown},N:{}};return e.N[r]=Qe.RadioButton.Cross.YesNormal,e.D[r]=Qe.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(r){var e=ji(r);e.scope=r.scope;var t=[],n=Qe.internal.calculateCross(r);return t.push("q"),t.push("1 1 "+_t(Qe.internal.getWidth(r)-2)+" "+_t(Qe.internal.getHeight(r)-2)+" re"),t.push("W"),t.push("n"),t.push(_t(n.x1.x)+" "+_t(n.x1.y)+" m"),t.push(_t(n.x2.x)+" "+_t(n.x2.y)+" l"),t.push(_t(n.x4.x)+" "+_t(n.x4.y)+" m"),t.push(_t(n.x3.x)+" "+_t(n.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(r){var e=ji(r);e.scope=r.scope;var t=Qe.internal.calculateCross(r),n=[];return n.push("0.749023 g"),n.push("0 0 "+_t(Qe.internal.getWidth(r))+" "+_t(Qe.internal.getHeight(r))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+_t(Qe.internal.getWidth(r)-2)+" "+_t(Qe.internal.getHeight(r)-2)+" re"),n.push("W"),n.push("n"),n.push(_t(t.x1.x)+" "+_t(t.x1.y)+" m"),n.push(_t(t.x2.x)+" "+_t(t.x2.y)+" l"),n.push(_t(t.x4.x)+" "+_t(t.x4.y)+" m"),n.push(_t(t.x3.x)+" "+_t(t.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(r){var e=ji(r);e.scope=r.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+_t(Qe.internal.getWidth(r))+" "+_t(Qe.internal.getHeight(r))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(r){var e=r.scope.internal.getFont(r.fontName,r.fontStyle).id,t=r.scope.__private__.encodeColorString(r.color);return"/"+e+" "+r.fontSize+" Tf "+t}};Qe.internal={Bezier_C:.551915024494,calculateCross:function(r){var e=Qe.internal.getWidth(r),t=Qe.internal.getHeight(r),n=Math.min(e,t);return{x1:{x:(e-n)/2,y:(t-n)/2+n},x2:{x:(e-n)/2+n,y:(t-n)/2},x3:{x:(e-n)/2,y:(t-n)/2},x4:{x:(e-n)/2+n,y:(t-n)/2+n}}}},Qe.internal.getWidth=function(r){var e=0;return ir(r)==="object"&&(e=U2(r.Rect[2])),e},Qe.internal.getHeight=function(r){var e=0;return ir(r)==="object"&&(e=U2(r.Rect[3])),e};var Dk=Pr.addField=function(r){if(Pk(this,r),!(r instanceof vi))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=r).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),r.page=r.scope.internal.getCurrentPageInfo().pageNumber,this};Pr.AcroFormChoiceField=Gc,Pr.AcroFormListBox=Yc,Pr.AcroFormComboBox=Kc,Pr.AcroFormEditBox=_f,Pr.AcroFormButton=gn,Pr.AcroFormPushButton=Cf,Pr.AcroFormRadioButton=Xc,Pr.AcroFormCheckBox=Nf,Pr.AcroFormTextField=Ds,Pr.AcroFormPasswordField=Sf,Pr.AcroFormAppearance=Qe,Pr.AcroForm={ChoiceField:Gc,ListBox:Yc,ComboBox:Kc,EditBox:_f,Button:gn,PushButton:Cf,RadioButton:Xc,CheckBox:Nf,TextField:Ds,PasswordField:Sf,Appearance:Qe},ft.AcroForm={ChoiceField:Gc,ListBox:Yc,ComboBox:Kc,EditBox:_f,Button:gn,PushButton:Cf,RadioButton:Xc,CheckBox:Nf,TextField:Ds,PasswordField:Sf,Appearance:Qe};function I3(r){return r.reduce(function(e,t,n){return e[t]=n,e},{})}(function(r){r.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=r.__addimage__.getImageFileTypeByImageData=function(O,k){var H,X,ce,Q,re,G=e;if((k=k||e)==="RGBA"||O.data!==void 0&&O.data instanceof Uint8ClampedArray&&"height"in O&&"width"in O)return"RGBA";if(F(O))for(re in t)for(ce=t[re],H=0;H<ce.length;H+=1){for(Q=!0,X=0;X<ce[H].length;X+=1)if(ce[H][X]!==void 0&&ce[H][X]!==O[X]){Q=!1;break}if(Q===!0){G=re;break}}else for(re in t)for(ce=t[re],H=0;H<ce.length;H+=1){for(Q=!0,X=0;X<ce[H].length;X+=1)if(ce[H][X]!==void 0&&ce[H][X]!==O.charCodeAt(X)){Q=!1;break}if(Q===!0){G=re;break}}return G===e&&k!==e&&(G=k),G},a=function O(k){for(var H=this.internal.write,X=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);k.objectId=this.internal.newObject();var Q=[];if(Q.push({key:"Type",value:"/XObject"}),Q.push({key:"Subtype",value:"/Image"}),Q.push({key:"Width",value:k.width}),Q.push({key:"Height",value:k.height}),k.colorSpace===b.INDEXED?Q.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(k.palette.length/3-1)+" "+("sMask"in k&&k.sMask!==void 0?k.objectId+2:k.objectId+1)+" 0 R]"}):(Q.push({key:"ColorSpace",value:"/"+k.colorSpace}),k.colorSpace===b.DEVICE_CMYK&&Q.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Q.push({key:"BitsPerComponent",value:k.bitsPerComponent}),"decodeParameters"in k&&k.decodeParameters!==void 0&&Q.push({key:"DecodeParms",value:"<<"+k.decodeParameters+">>"}),"transparency"in k&&Array.isArray(k.transparency)){for(var re="",G=0,Y=k.transparency.length;G<Y;G++)re+=k.transparency[G]+" "+k.transparency[G]+" ";Q.push({key:"Mask",value:"["+re+"]"})}k.sMask!==void 0&&Q.push({key:"SMask",value:k.objectId+1+" 0 R"});var ge=k.filter!==void 0?["/"+k.filter]:void 0;if(X({data:k.data,additionalKeyValues:Q,alreadyAppliedFilters:ge,objectId:k.objectId}),H("endobj"),"sMask"in k&&k.sMask!==void 0){var ye="/Predictor "+k.predictor+" /Colors 1 /BitsPerComponent "+k.bitsPerComponent+" /Columns "+k.width,A={width:k.width,height:k.height,colorSpace:"DeviceGray",bitsPerComponent:k.bitsPerComponent,decodeParameters:ye,data:k.sMask};"filter"in k&&(A.filter=k.filter),O.call(this,A)}if(k.colorSpace===b.INDEXED){var $=this.internal.newObject();X({data:T(new Uint8Array(k.palette)),objectId:$}),H("endobj")}},i=function(){var O=this.internal.collections.addImage_images;for(var k in O)a.call(this,O[k])},o=function(){var O,k=this.internal.collections.addImage_images,H=this.internal.write;for(var X in k)H("/I"+(O=k[X]).index,O.objectId,"0","R")},s=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},l=function(){var O=this.internal.collections.addImage_images;return s.call(this),O},u=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(O){return typeof r["process"+O.toUpperCase()]=="function"},f=function(O){return ir(O)==="object"&&O.nodeType===1},h=function(O,k){if(O.nodeName==="IMG"&&O.hasAttribute("src")){var H=""+O.getAttribute("src");if(H.indexOf("data:image/")===0)return vu(unescape(H).split("base64,").pop());var X=r.loadFile(H,!0);if(X!==void 0)return X}if(O.nodeName==="CANVAS"){if(O.width===0||O.height===0)throw new Error("Given canvas must have data. Canvas width: "+O.width+", height: "+O.height);var ce;switch(k){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;case"JPEG":case"JPG":default:ce="image/jpeg"}return vu(O.toDataURL(ce,1).split("base64,").pop())}},p=function(O){var k=this.internal.collections.addImage_images;if(k){for(var H in k)if(O===k[H].alias)return k[H]}},g=function(O,k,H){return O||k||(O=-96,k=-96),O<0&&(O=-1*H.width*72/O/this.internal.scaleFactor),k<0&&(k=-1*H.height*72/k/this.internal.scaleFactor),O===0&&(O=k*H.width/H.height),k===0&&(k=O*H.height/H.width),[O,k]},v=function(O,k,H,X,ce,Q){var re=g.call(this,H,X,ce),G=this.internal.getCoordinateString,Y=this.internal.getVerticalCoordinateString,ge=l.call(this);if(H=re[0],X=re[1],ge[ce.index]=ce,Q){Q*=Math.PI/180;var ye=Math.cos(Q),A=Math.sin(Q),$=function(K){return K.toFixed(4)},V=[$(ye),$(A),$(-1*A),$(ye),0,0,"cm"]}this.internal.write("q"),Q?(this.internal.write([1,"0","0",1,G(O),Y(k+X),"cm"].join(" ")),this.internal.write(V.join(" ")),this.internal.write([G(H),"0","0",G(X),"0","0","cm"].join(" "))):this.internal.write([G(H),"0","0",G(X),G(O),Y(k+X),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},b=r.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};r.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=r.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},C=r.__addimage__.sHashCode=function(O){var k,H,X=0;if(typeof O=="string")for(H=O.length,k=0;k<H;k++)X=(X<<5)-X+O.charCodeAt(k),X|=0;else if(F(O))for(H=O.byteLength/2,k=0;k<H;k++)X=(X<<5)-X+O[k],X|=0;return X},S=r.__addimage__.validateStringAsBase64=function(O){(O=O||"").toString().trim();var k=!0;return O.length===0&&(k=!1),O.length%4!=0&&(k=!1),/^[A-Za-z0-9+/]+$/.test(O.substr(0,O.length-2))===!1&&(k=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(O.substr(-2))===!1&&(k=!1),k},j=r.__addimage__.extractImageFromDataUrl=function(O){if(O==null||!(O=O.trim()).startsWith("data:"))return null;var k=O.indexOf(",");return k<0?null:O.substring(0,k).trim().endsWith("base64")?O.substring(k+1):null},D=r.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};r.__addimage__.isArrayBuffer=function(O){return D()&&O instanceof ArrayBuffer};var F=r.__addimage__.isArrayBufferView=function(O){return D()&&typeof Uint32Array<"u"&&(O instanceof Int8Array||O instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&O instanceof Uint8ClampedArray||O instanceof Int16Array||O instanceof Uint16Array||O instanceof Int32Array||O instanceof Uint32Array||O instanceof Float32Array||O instanceof Float64Array)},M=r.__addimage__.binaryStringToUint8Array=function(O){for(var k=O.length,H=new Uint8Array(k),X=0;X<k;X++)H[X]=O.charCodeAt(X);return H},T=r.__addimage__.arrayBufferToBinaryString=function(O){for(var k="",H=F(O)?O:new Uint8Array(O),X=0;X<H.length;X+=8192)k+=String.fromCharCode.apply(null,H.subarray(X,X+8192));return k};r.addImage=function(){var O,k,H,X,ce,Q,re,G,Y;if(typeof arguments[1]=="number"?(k=e,H=arguments[1],X=arguments[2],ce=arguments[3],Q=arguments[4],re=arguments[5],G=arguments[6],Y=arguments[7]):(k=arguments[1],H=arguments[2],X=arguments[3],ce=arguments[4],Q=arguments[5],re=arguments[6],G=arguments[7],Y=arguments[8]),ir(O=arguments[0])==="object"&&!f(O)&&"imageData"in O){var ge=O;O=ge.imageData,k=ge.format||k||e,H=ge.x||H||0,X=ge.y||X||0,ce=ge.w||ge.width||ce,Q=ge.h||ge.height||Q,re=ge.alias||re,G=ge.compression||G,Y=ge.rotation||ge.angle||Y}var ye=this.internal.getFilters();if(G===void 0&&ye.indexOf("FlateEncode")!==-1&&(G="SLOW"),isNaN(H)||isNaN(X))throw new Error("Invalid coordinates passed to jsPDF.addImage");s.call(this);var A=q.call(this,O,k,re,G);return v.call(this,H,X,ce,Q,A,Y),this};var q=function(O,k,H,X){var ce,Q,re;if(typeof O=="string"&&n(O)===e){O=unescape(O);var G=J(O,!1);(G!==""||(G=r.loadFile(O,!0))!==void 0)&&(O=G)}if(f(O)&&(O=h(O,k)),k=n(O,k),!d(k))throw new Error("addImage does not support files of type '"+k+"', please ensure that a plugin for '"+k+"' support is added.");if(((re=H)==null||re.length===0)&&(H=function(Y){return typeof Y=="string"||F(Y)?C(Y):F(Y.data)?C(Y.data):null}(O)),(ce=p.call(this,H))||(D()&&(O instanceof Uint8Array||k==="RGBA"||(Q=O,O=M(O))),ce=this["process"+k.toUpperCase()](O,u.call(this),H,function(Y){return Y&&typeof Y=="string"&&(Y=Y.toUpperCase()),Y in r.image_compression?Y:y.NONE}(X),Q)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},J=r.__addimage__.convertBase64ToBinaryString=function(O,k){k=typeof k!="boolean"||k;var H,X="";if(typeof O=="string"){var ce;H=(ce=j(O))!==null&&ce!==void 0?ce:O;try{X=vu(H)}catch(Q){if(k)throw S(H)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Q.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return X};r.getImageProperties=function(O){var k,H,X="";if(f(O)&&(O=h(O)),typeof O=="string"&&n(O)===e&&((X=J(O,!1))===""&&(X=r.loadFile(O)||""),O=X),H=n(O),!d(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(!D()||O instanceof Uint8Array||(O=M(O)),!(k=this["process"+H.toUpperCase()](O)))throw new Error("An unknown error occurred whilst processing the image");return k.fileType=H,k}})(ft.API),function(r){var e=function(t){if(t!==void 0&&t!="")return!0};ft.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),r.events.push(["putPage",function(t){for(var n,a,i,o=this.internal.getCoordinateString,s=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(t.objId),u=t.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var h=0;h<u.length;h++){n=u[h];var p=this.internal.pdfEscape,g=this.internal.getEncryptor(t.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var v=this.internal.newAdditionalObject(),b=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(v.objId),C=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+o(n.bounds.x)+" "+s(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+s(n.bounds.y)+"] ")+"/Contents ("+p(y(n.contents))+")",i+=" /Popup "+b.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+p(y(C))+") >>",v.content=i;var S=v.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+o(n.bounds.x+30)+" "+s(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+s(n.bounds.y)+"] ")+" /Parent "+S,n.open&&(i+=" /Open true"),i+=" >>",b.content=i,this.internal.write(v.objId,"0 R",b.objId,"0 R");break;case"freetext":a="/Rect ["+o(n.bounds.x)+" "+s(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+s(n.bounds.y+n.bounds.h)+"] ";var j=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+p(g(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+j+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var D=this.annotations._nameMap[n.options.name];n.options.pageNumber=D.page,n.options.top=D.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+p(g(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var F=s(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+F+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),r.createAnnotation=function(t){var n=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":n.pageContext.annotations.push(t)}},r.link=function(t,n,a,i,o){var s=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;s.pageContext.annotations.push({finalBounds:{x:l(t),y:u(n),w:l(t+a),h:u(n+i)},options:o,type:"link"})},r.textWithLink=function(t,n,a,i){var o,s,l=this.getTextWidth(t),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){s=i.maxWidth;var d=this.splitTextToSize(t,s).length;o=Math.ceil(u*d)}else s=l,o=u;return this.text(t,n,a,i),a+=.2*u,i.align==="center"&&(n-=l/2),i.align==="right"&&(n-=l),this.link(n,a-u,s,o,i),l},r.getTextWidth=function(t){var n=this.internal.getFontSize();return this.getStringUnitWidth(t)*n/this.internal.scaleFactor}}(ft.API),function(r){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];r.__arabicParser__={};var i=r.__arabicParser__.isInArabicSubstitutionA=function(v){return e[v.charCodeAt(0)]!==void 0},o=r.__arabicParser__.isArabicLetter=function(v){return typeof v=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(v)},s=r.__arabicParser__.isArabicEndLetter=function(v){return o(v)&&i(v)&&e[v.charCodeAt(0)].length<=2},l=r.__arabicParser__.isArabicAlfLetter=function(v){return o(v)&&a.indexOf(v.charCodeAt(0))>=0};r.__arabicParser__.arabicLetterHasIsolatedForm=function(v){return o(v)&&i(v)&&e[v.charCodeAt(0)].length>=1};var u=r.__arabicParser__.arabicLetterHasFinalForm=function(v){return o(v)&&i(v)&&e[v.charCodeAt(0)].length>=2};r.__arabicParser__.arabicLetterHasInitialForm=function(v){return o(v)&&i(v)&&e[v.charCodeAt(0)].length>=3};var d=r.__arabicParser__.arabicLetterHasMedialForm=function(v){return o(v)&&i(v)&&e[v.charCodeAt(0)].length==4},f=r.__arabicParser__.resolveLigatures=function(v){var b=0,y=t,C="",S=0;for(b=0;b<v.length;b+=1)y[v.charCodeAt(b)]!==void 0?(S++,typeof(y=y[v.charCodeAt(b)])=="number"&&(C+=String.fromCharCode(y),y=t,S=0),b===v.length-1&&(y=t,C+=v.charAt(b-(S-1)),b-=S-1,S=0)):(y=t,C+=v.charAt(b-S),b-=S,S=0);return C};r.__arabicParser__.isArabicDiacritic=function(v){return v!==void 0&&n[v.charCodeAt(0)]!==void 0};var h=r.__arabicParser__.getCorrectForm=function(v,b,y){return o(v)?i(v)===!1?-1:!u(v)||!o(b)&&!o(y)||!o(y)&&s(b)||s(v)&&!o(b)||s(v)&&l(b)||s(v)&&s(b)?0:d(v)&&o(b)&&!s(b)&&o(y)&&u(y)?3:s(v)||!o(y)?1:2:-1},p=function(v){var b=0,y=0,C=0,S="",j="",D="",F=(v=v||"").split("\\s+"),M=[];for(b=0;b<F.length;b+=1){for(M.push(""),y=0;y<F[b].length;y+=1)S=F[b][y],j=F[b][y-1],D=F[b][y+1],o(S)?(C=h(S,j,D),M[b]+=C!==-1?String.fromCharCode(e[S.charCodeAt(0)][C]):S):M[b]+=S;M[b]=f(M[b])}return M.join(" ")},g=r.__arabicParser__.processArabic=r.processArabic=function(){var v,b=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(b)){var C=0;for(y=[],C=0;C<b.length;C+=1)Array.isArray(b[C])?y.push([p(b[C][0]),b[C][1],b[C][2]]):y.push([p(b[C])]);v=y}else v=p(b);return typeof arguments[0]=="string"?v:(arguments[0].text=v,arguments[0])};r.events.push(["preProcessText",g])}(ft.API),ft.API.autoPrint=function(r){var e;switch((r=r||{}).variant=r.variant||"non-conform",r.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(r){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(s){t=s}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(s){n=isNaN(s)||Number.isInteger(s)===!1||s<0?150:s,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(s){a=isNaN(s)||Number.isInteger(s)===!1||s<0?300:s,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(s){i=s}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(s){o=s}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,n){var a;if((t=t||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},r.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(ft.API),function(r){var e={left:0,top:0,bottom:0,right:0},t=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(v){l=v}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(v){u=v}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(v){d=v}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(v){f=v}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(v){h=v}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(v){p=v}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(v){g=v}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},r.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},r.getTextDimensions=function(l,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),h=u.scaleFactor||this.internal.scaleFactor,p=0,g=0,v=0,b=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var y=u.maxWidth;y>0?typeof l=="string"?l=this.splitTextToSize(l,y):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(S,j){return S.concat(b.splitTextToSize(j,y))},[])):l=Array.isArray(l)?l:[l];for(var C=0;C<l.length;C++)p<(v=this.getStringUnitWidth(l[C],{font:f})*d)&&(p=v);return p!==0&&(g=l.length),{w:p/=h,h:Math.max((g*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/h,0)}},r.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=r.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||e,h=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===l.lineNumber?(l.x=(u.x||0)+(u.width||0),l.y=u.y||0):u.y+u.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,p&&h&&(this.printHeaderRow(l.lineNumber,!0),l.y+=h[0].height)):l.y=u.y+u.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,t===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-d,l.y+d,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+d,{align:"center",baseline:"top",maxWidth:l.width-d-d}):this.text(l.text,l.x+d,l.y+d,{align:"left",baseline:"top",maxWidth:l.width-d-d})),this.internal.__cell__.lastCell=l,this};r.table=function(l,u,d,f,h){if(n.call(this),!d)throw new Error("No data for PDF table.");var p,g,v,b,y=[],C=[],S=[],j={},D={},F=[],M=[],T=(h=h||{}).autoSize||!1,q=h.printHeaders!==!1,J=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,O=h.margins||Object.assign({width:this.getPageWidth()},e),k=typeof h.padding=="number"?h.padding:3,H=h.headerBackgroundColor||"#c8c8c8",X=h.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=q,this.internal.__cell__.margins=O,this.internal.__cell__.table_font_size=J,this.internal.__cell__.padding=k,this.internal.__cell__.headerBackgroundColor=H,this.internal.__cell__.headerTextColor=X,this.setFontSize(J),f==null)C=y=Object.keys(d[0]),S=y.map(function(){return"left"});else if(Array.isArray(f)&&ir(f[0])==="object")for(y=f.map(function(ge){return ge.name}),C=f.map(function(ge){return ge.prompt||ge.name||""}),S=f.map(function(ge){return ge.align||"left"}),p=0;p<f.length;p+=1)D[f[p].name]=f[p].width*(19.049976/25.4);else Array.isArray(f)&&typeof f[0]=="string"&&(C=y=f,S=y.map(function(){return"left"}));if(T||Array.isArray(f)&&typeof f[0]=="string")for(p=0;p<y.length;p+=1){for(j[b=y[p]]=d.map(function(ge){return ge[b]}),this.setFont(void 0,"bold"),F.push(this.getTextDimensions(C[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=j[b],this.setFont(void 0,"normal"),v=0;v<g.length;v+=1)F.push(this.getTextDimensions(g[v],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);D[b]=Math.max.apply(null,F)+k+k,F=[]}if(q){var ce={};for(p=0;p<y.length;p+=1)ce[y[p]]={},ce[y[p]].text=C[p],ce[y[p]].align=S[p];var Q=s.call(this,ce,D);M=y.map(function(ge){return new i(l,u,D[ge],Q,ce[ge].text,void 0,ce[ge].align)}),this.setTableHeaderRow(M),this.printHeaderRow(1,!1)}var re=f.reduce(function(ge,ye){return ge[ye.name]=ye.align,ge},{});for(p=0;p<d.length;p+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:p,data:d[p]},this);var G=s.call(this,d[p],D);for(v=0;v<y.length;v+=1){var Y=d[p][y[v]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:p,col:v,data:Y},this),o.call(this,new i(l,u,D[y[v]],G,Y,p+2,re[y[v]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=u,this};var s=function(l,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(l).map(function(p){var g=l[p];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,u[p]-d-d)},this).map(function(p){return this.getLineHeightFactor()*p.length*f/h+d+d},this).reduce(function(p,g){return Math.max(p,g)},0)};r.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},r.printHeaderRow=function(l,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){d=this.internal.__cell__.tableHeaderRow[p].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,h.push(d)),d.lineNumber=l;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(g)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),t=!1}}(ft.API);var T3={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},O3=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Cp=I3(O3),k3=[100,200,300,400,500,600,700,800,900],Ik=I3(k3);function Np(r){var e=r.family.replace(/"|'/g,"").toLowerCase(),t=function(i){return T3[i=i||"normal"]?i:"normal"}(r.style),n=function(i){if(!i)return 400;if(typeof i=="number")return i>=100&&i<=900&&i%100==0?i:400;if(/^\d00$/.test(i))return parseInt(i);switch(i){case"bold":return 700;case"normal":default:return 400}}(r.weight),a=function(i){return typeof Cp[i=i||"normal"]=="number"?i:"normal"}(r.stretch);return{family:e,style:t,weight:n,stretch:a,src:r.src||[],ref:r.ref||{name:e,style:[a,t,n].join(" ")}}}function q2(r,e,t,n){var a;for(a=t;a>=0&&a<e.length;a+=n)if(r[e[a]])return r[e[a]];for(a=t;a>=0&&a<e.length;a-=n)if(r[e[a]])return r[e[a]]}var Tk={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},V2={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function z2(r){return[r.stretch,r.style,r.weight,r.family].join(" ")}function Ok(r,e,t){for(var n=(t=t||{}).defaultFontFamily||"times",a=Object.assign({},Tk,t.genericFontFamilies||{}),i=null,o=null,s=0;s<e.length;++s)if(a[(i=Np(e[s])).family]&&(i.family=a[i.family]),r.hasOwnProperty(i.family)){o=r[i.family];break}if(!(o=o||r[n]))throw new Error("Could not find a font-family for the rule '"+z2(i)+"' and default family '"+n+"'.");if(o=function(l,u){if(u[l])return u[l];var d=Cp[l],f=d<=Cp.normal?-1:1,h=q2(u,O3,d,f);if(!h)throw new Error("Could not find a matching font-stretch value for "+l);return h}(i.stretch,o),o=function(l,u){if(u[l])return u[l];for(var d=T3[l],f=0;f<d.length;++f)if(u[d[f]])return u[d[f]];throw new Error("Could not find a matching font-style for "+l)}(i.style,o),!(o=function(l,u){if(u[l])return u[l];if(l===400&&u[500])return u[500];if(l===500&&u[400])return u[400];var d=Ik[l],f=q2(u,k3,d,l<400?-1:1);if(!f)throw new Error("Could not find a matching font-weight for value "+l);return f}(i.weight,o)))throw new Error("Failed to resolve a font for the rule '"+z2(i)+"'.");return o}function H2(r){return r.trimLeft()}function kk(r,e){for(var t=0;t<r.length;){if(r.charAt(t)===e)return[r.substring(0,t),r.substring(t+1)];t+=1}return null}function Mk(r){var e=r.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],r.substring(e[0].length)]}var nf,W2,G2,v1=["times"];(function(r){var e,t,n,a,i,o,s,l,u,d=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new l,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new o,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new o,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};r.events.push(["initialized",function(){this.context2d=new f(this),e=this.internal.f2,t=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,o=this.internal.Point,s=this.internal.Rectangle,l=this.internal.Matrix,u=new d}]);var f=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var $=A;Object.defineProperty(this,"pdf",{get:function(){return $}});var V=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return V},set:function(we){V=!!we}});var K=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return K},set:function(we){K=!!we}});var ee=0;Object.defineProperty(this,"posX",{get:function(){return ee},set:function(we){isNaN(we)||(ee=we)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(we){isNaN(we)||(oe=we)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(we){var te;typeof we=="number"?te=[we,we,we,we]:((te=new Array(4))[0]=we[0],te[1]=we.length>=2?we[1]:te[0],te[2]=we.length>=3?we[2]:te[0],te[3]=we.length>=4?we[3]:te[1]),u.margin=te}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(we){fe=we}});var ve=0;Object.defineProperty(this,"lastBreak",{get:function(){return ve},set:function(we){ve=we}});var Ie=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ie},set:function(we){Ie=we}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(we){we instanceof d&&(u=we)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(we){u.path=we}});var Te=[];Object.defineProperty(this,"ctxStack",{get:function(){return Te},set:function(we){Te=we}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(we){var te;te=h(we),this.ctx.fillStyle=te.style,this.ctx.isFillTransparent=te.a===0,this.ctx.fillOpacity=te.a,this.pdf.setFillColor(te.r,te.g,te.b,{a:te.a}),this.pdf.setTextColor(te.r,te.g,te.b,{a:te.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(we){var te=h(we);this.ctx.strokeStyle=te.style,this.ctx.isStrokeTransparent=te.a===0,this.ctx.strokeOpacity=te.a,te.a===0?this.pdf.setDrawColor(255,255,255):(te.a,this.pdf.setDrawColor(te.r,te.g,te.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(we){["butt","round","square"].indexOf(we)!==-1&&(this.ctx.lineCap=we,this.pdf.setLineCap(we))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(we){isNaN(we)||(this.ctx.lineWidth=we,this.pdf.setLineWidth(we))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(we){["bevel","round","miter"].indexOf(we)!==-1&&(this.ctx.lineJoin=we,this.pdf.setLineJoin(we))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(we){isNaN(we)||(this.ctx.miterLimit=we,this.pdf.setMiterLimit(we))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(we){this.ctx.textBaseline=we}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(we){["right","end","center","left","start"].indexOf(we)!==-1&&(this.ctx.textAlign=we)}});var Be=null;function $e(we,te){if(Be===null){var vt=function(Ze){var je=[];return Object.keys(Ze).forEach(function(Oe){Ze[Oe].forEach(function(Ve){var Ue=null;switch(Ve){case"bold":Ue={family:Oe,weight:"bold"};break;case"italic":Ue={family:Oe,style:"italic"};break;case"bolditalic":Ue={family:Oe,weight:"bold",style:"italic"};break;case"":case"normal":Ue={family:Oe}}Ue!==null&&(Ue.ref={name:Oe,style:Ve},je.push(Ue))})}),je}(we.getFontList());Be=function(Ze){for(var je={},Oe=0;Oe<Ze.length;++Oe){var Ve=Np(Ze[Oe]),Ue=Ve.family,et=Ve.stretch,mt=Ve.style,bt=Ve.weight;je[Ue]=je[Ue]||{},je[Ue][et]=je[Ue][et]||{},je[Ue][et][mt]=je[Ue][et][mt]||{},je[Ue][et][mt][bt]=Ve}return je}(vt.concat(te))}return Be}var ct=null;Object.defineProperty(this,"fontFaces",{get:function(){return ct},set:function(we){Be=null,ct=we}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(we){var te;if(this.ctx.font=we,(te=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(we))!==null){var vt=te[1];te[2];var Ze=te[3],je=te[4];te[5];var Oe=te[6],Ve=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(je)[2];je=Math.floor(Ve==="px"?parseFloat(je)*this.pdf.internal.scaleFactor:Ve==="em"?parseFloat(je)*this.pdf.getFontSize():parseFloat(je)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(je);var Ue=function(it){var jt,ze,Qr=[],Mt=it.trim();if(Mt==="")return v1;if(Mt in V2)return[V2[Mt]];for(;Mt!=="";){switch(ze=null,jt=(Mt=H2(Mt)).charAt(0)){case'"':case"'":ze=kk(Mt.substring(1),jt);break;default:ze=Mk(Mt)}if(ze===null||(Qr.push(ze[0]),(Mt=H2(ze[1]))!==""&&Mt.charAt(0)!==","))return v1;Mt=Mt.replace(/^,/,"")}return Qr}(Oe);if(this.fontFaces){var et=Ok($e(this.pdf,this.fontFaces),Ue.map(function(it){return{family:it,stretch:"normal",weight:Ze,style:vt}}));this.pdf.setFont(et.ref.name,et.ref.style)}else{var mt="";(Ze==="bold"||parseInt(Ze,10)>=700||vt==="bold")&&(mt="bold"),vt==="italic"&&(mt+="italic"),mt.length===0&&(mt="normal");for(var bt="",St={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},At=0;At<Ue.length;At++){if(this.pdf.internal.getFont(Ue[At],mt,{noFallback:!0,disableWarning:!0})!==void 0){bt=Ue[At];break}if(mt==="bolditalic"&&this.pdf.internal.getFont(Ue[At],"bold",{noFallback:!0,disableWarning:!0})!==void 0)bt=Ue[At],mt="bold";else if(this.pdf.internal.getFont(Ue[At],"normal",{noFallback:!0,disableWarning:!0})!==void 0){bt=Ue[At],mt="normal";break}}if(bt===""){for(var Gt=0;Gt<Ue.length;Gt++)if(St[Ue[Gt]]){bt=St[Ue[Gt]];break}}bt=bt===""?"Times":bt,this.pdf.setFont(bt,mt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(we){this.ctx.globalCompositeOperation=we}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(we){this.ctx.globalAlpha=we}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(we){this.ctx.lineDashOffset=we,ye.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(we){this.ctx.lineDash=we,ye.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(we){this.ctx.ignoreClearRect=!!we}})};f.prototype.setLineDash=function(A){this.lineDash=A},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){j.call(this,"fill",!1)},f.prototype.stroke=function(){j.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(A,$){if(isNaN(A)||isNaN($))throw dr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var V=this.ctx.transform.applyToPoint(new o(A,$));this.path.push({type:"mt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(A,$)},f.prototype.closePath=function(){var A=new o(0,0),$=0;for($=this.path.length-1;$!==-1;$--)if(this.path[$].type==="begin"&&ir(this.path[$+1])==="object"&&typeof this.path[$+1].x=="number"){A=new o(this.path[$+1].x,this.path[$+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(A.x,A.y)},f.prototype.lineTo=function(A,$){if(isNaN(A)||isNaN($))throw dr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var V=this.ctx.transform.applyToPoint(new o(A,$));this.path.push({type:"lt",x:V.x,y:V.y}),this.ctx.lastPoint=new o(V.x,V.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),j.call(this,null,!0)},f.prototype.quadraticCurveTo=function(A,$,V,K){if(isNaN(V)||isNaN(K)||isNaN(A)||isNaN($))throw dr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ee=this.ctx.transform.applyToPoint(new o(V,K)),oe=this.ctx.transform.applyToPoint(new o(A,$));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:ee.x,y:ee.y}),this.ctx.lastPoint=new o(ee.x,ee.y)},f.prototype.bezierCurveTo=function(A,$,V,K,ee,oe){if(isNaN(ee)||isNaN(oe)||isNaN(A)||isNaN($)||isNaN(V)||isNaN(K))throw dr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new o(ee,oe)),ve=this.ctx.transform.applyToPoint(new o(A,$)),Ie=this.ctx.transform.applyToPoint(new o(V,K));this.path.push({type:"bct",x1:ve.x,y1:ve.y,x2:Ie.x,y2:Ie.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new o(fe.x,fe.y)},f.prototype.arc=function(A,$,V,K,ee,oe){if(isNaN(A)||isNaN($)||isNaN(V)||isNaN(K)||isNaN(ee))throw dr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new o(A,$));A=fe.x,$=fe.y;var ve=this.ctx.transform.applyToPoint(new o(0,V)),Ie=this.ctx.transform.applyToPoint(new o(0,0));V=Math.sqrt(Math.pow(ve.x-Ie.x,2)+Math.pow(ve.y-Ie.y,2))}Math.abs(ee-K)>=2*Math.PI&&(K=0,ee=2*Math.PI),this.path.push({type:"arc",x:A,y:$,radius:V,startAngle:K,endAngle:ee,counterclockwise:oe})},f.prototype.arcTo=function(A,$,V,K,ee){throw new Error("arcTo not implemented.")},f.prototype.rect=function(A,$,V,K){if(isNaN(A)||isNaN($)||isNaN(V)||isNaN(K))throw dr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,$),this.lineTo(A+V,$),this.lineTo(A+V,$+K),this.lineTo(A,$+K),this.lineTo(A,$),this.lineTo(A+V,$),this.lineTo(A,$)},f.prototype.fillRect=function(A,$,V,K){if(isNaN(A)||isNaN($)||isNaN(V)||isNaN(K))throw dr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var ee={};this.lineCap!=="butt"&&(ee.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ee.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,$,V,K),this.fill(),ee.hasOwnProperty("lineCap")&&(this.lineCap=ee.lineCap),ee.hasOwnProperty("lineJoin")&&(this.lineJoin=ee.lineJoin)}},f.prototype.strokeRect=function(A,$,V,K){if(isNaN(A)||isNaN($)||isNaN(V)||isNaN(K))throw dr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(A,$,V,K),this.stroke())},f.prototype.clearRect=function(A,$,V,K){if(isNaN(A)||isNaN($)||isNaN(V)||isNaN(K))throw dr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,$,V,K))},f.prototype.save=function(A){A=typeof A!="boolean"||A;for(var $=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("q");if(this.pdf.setPage($),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var K=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=K}},f.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var $=this.pdf.internal.getCurrentPageInfo().pageNumber,V=0;V<this.pdf.internal.getNumberOfPages();V++)this.pdf.setPage(V+1),this.pdf.internal.out("Q");this.pdf.setPage($),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(A){var $,V,K,ee;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))$=0,V=0,K=0,ee=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(oe!==null)$=parseInt(oe[1]),V=parseInt(oe[2]),K=parseInt(oe[3]),ee=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)$=parseInt(oe[1]),V=parseInt(oe[2]),K=parseInt(oe[3]),ee=parseFloat(oe[4]);else{if(ee=1,typeof A=="string"&&A.charAt(0)!=="#"){var fe=new S3(A);A=fe.ok?fe.toHex():"#000000"}A.length===4?($=A.substring(1,2),$+=$,V=A.substring(2,3),V+=V,K=A.substring(3,4),K+=K):($=A.substring(1,3),V=A.substring(3,5),K=A.substring(5,7)),$=parseInt($,16),V=parseInt(V,16),K=parseInt(K,16)}}return{r:$,g:V,b:K,a:ee,style:A}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(A,$,V,K){if(isNaN($)||isNaN(V)||typeof A!="string")throw dr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(K=isNaN(K)?void 0:K,!p.call(this)){var ee=G(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;k.call(this,{text:A,x:$,y:V,scale:oe,angle:ee,align:this.textAlign,maxWidth:K})}},f.prototype.strokeText=function(A,$,V,K){if(isNaN($)||isNaN(V)||typeof A!="string")throw dr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){K=isNaN(K)?void 0:K;var ee=G(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;k.call(this,{text:A,x:$,y:V,scale:oe,renderingMode:"stroke",angle:ee,align:this.textAlign,maxWidth:K})}},f.prototype.measureText=function(A){if(typeof A!="string")throw dr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var $=this.pdf,V=this.pdf.internal.scaleFactor,K=$.internal.getFontSize(),ee=$.getStringUnitWidth(A)*K/$.internal.scaleFactor,oe=function(fe){var ve=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ve}}),this};return new oe({width:ee*=Math.round(96*V/72*1e4)/1e4})},f.prototype.scale=function(A,$){if(isNaN(A)||isNaN($))throw dr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var V=new l(A,0,0,$,0,0);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.rotate=function(A){if(isNaN(A))throw dr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var $=new l(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply($)},f.prototype.translate=function(A,$){if(isNaN(A)||isNaN($))throw dr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var V=new l(1,0,0,1,A,$);this.ctx.transform=this.ctx.transform.multiply(V)},f.prototype.transform=function(A,$,V,K,ee,oe){if(isNaN(A)||isNaN($)||isNaN(V)||isNaN(K)||isNaN(ee)||isNaN(oe))throw dr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new l(A,$,V,K,ee,oe);this.ctx.transform=this.ctx.transform.multiply(fe)},f.prototype.setTransform=function(A,$,V,K,ee,oe){A=isNaN(A)?1:A,$=isNaN($)?0:$,V=isNaN(V)?0:V,K=isNaN(K)?1:K,ee=isNaN(ee)?0:ee,oe=isNaN(oe)?0:oe,this.ctx.transform=new l(A,$,V,K,ee,oe)};var v=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(A,$,V,K,ee,oe,fe,ve,Ie){var Te=this.pdf.getImageProperties(A),Be=1,$e=1,ct=1,we=1;K!==void 0&&ve!==void 0&&(ct=ve/K,we=Ie/ee,Be=Te.width/K*ve/K,$e=Te.height/ee*Ie/ee),oe===void 0&&(oe=$,fe=V,$=0,V=0),K!==void 0&&ve===void 0&&(ve=K,Ie=ee),K===void 0&&ve===void 0&&(ve=Te.width,Ie=Te.height);for(var te,vt=this.ctx.transform.decompose(),Ze=G(vt.rotate.shx),je=new l,Oe=(je=(je=(je=je.multiply(vt.translate)).multiply(vt.skew)).multiply(vt.scale)).applyToRectangle(new s(oe-$*ct,fe-V*we,K*Be,ee*$e)),Ve=b.call(this,Oe),Ue=[],et=0;et<Ve.length;et+=1)Ue.indexOf(Ve[et])===-1&&Ue.push(Ve[et]);if(S(Ue),this.autoPaging)for(var mt=Ue[0],bt=Ue[Ue.length-1],St=mt;St<bt+1;St++){this.pdf.setPage(St);var At=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Gt=St===1?this.posY+this.margin[0]:this.margin[0],it=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],jt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ze=St===1?0:it+(St-2)*jt;if(this.ctx.clip_path.length!==0){var Qr=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(te,this.posX+this.margin[3],-ze+Gt+this.ctx.prevPageLastElemOffset),D.call(this,"fill",!0),this.path=Qr}var Mt=JSON.parse(JSON.stringify(Oe));Mt=C([Mt],this.posX+this.margin[3],-ze+Gt+this.ctx.prevPageLastElemOffset)[0];var fa=(St>mt||St<bt)&&v.call(this);fa&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,jt,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Mt.x,Mt.y,Mt.w,Mt.h,null,null,Ze),fa&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(A,"JPEG",Oe.x,Oe.y,Oe.w,Oe.h,null,null,Ze)};var b=function(A,$,V){var K=[];$=$||this.pdf.internal.pageSize.width,V=V||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ee=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":K.push(Math.floor((A.y+ee)/V)+1);break;case"arc":K.push(Math.floor((A.y+ee-A.radius)/V)+1),K.push(Math.floor((A.y+ee+A.radius)/V)+1);break;case"qct":var oe=Y(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);K.push(Math.floor((oe.y+ee)/V)+1),K.push(Math.floor((oe.y+oe.h+ee)/V)+1);break;case"bct":var fe=ge(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);K.push(Math.floor((fe.y+ee)/V)+1),K.push(Math.floor((fe.y+fe.h+ee)/V)+1);break;case"rect":K.push(Math.floor((A.y+ee)/V)+1),K.push(Math.floor((A.y+A.h+ee)/V)+1)}for(var ve=0;ve<K.length;ve+=1)for(;this.pdf.internal.getNumberOfPages()<K[ve];)y.call(this);return K},y=function(){var A=this.fillStyle,$=this.strokeStyle,V=this.font,K=this.lineCap,ee=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=$,this.font=V,this.lineCap=K,this.lineWidth=ee,this.lineJoin=oe},C=function(A,$,V){for(var K=0;K<A.length;K++)switch(A[K].type){case"bct":A[K].x2+=$,A[K].y2+=V;case"qct":A[K].x1+=$,A[K].y1+=V;case"mt":case"lt":case"arc":default:A[K].x+=$,A[K].y+=V}return A},S=function(A){return A.sort(function($,V){return $-V})},j=function(A,$){for(var V,K,ee=this.fillStyle,oe=this.strokeStyle,fe=this.lineCap,ve=this.lineWidth,Ie=Math.abs(ve*this.ctx.transform.scaleX),Te=this.lineJoin,Be=JSON.parse(JSON.stringify(this.path)),$e=JSON.parse(JSON.stringify(this.path)),ct=[],we=0;we<$e.length;we++)if($e[we].x!==void 0)for(var te=b.call(this,$e[we]),vt=0;vt<te.length;vt+=1)ct.indexOf(te[vt])===-1&&ct.push(te[vt]);for(var Ze=0;Ze<ct.length;Ze++)for(;this.pdf.internal.getNumberOfPages()<ct[Ze];)y.call(this);if(S(ct),this.autoPaging)for(var je=ct[0],Oe=ct[ct.length-1],Ve=je;Ve<Oe+1;Ve++){this.pdf.setPage(Ve),this.fillStyle=ee,this.strokeStyle=oe,this.lineCap=fe,this.lineWidth=Ie,this.lineJoin=Te;var Ue=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],et=Ve===1?this.posY+this.margin[0]:this.margin[0],mt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],bt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],St=Ve===1?0:mt+(Ve-2)*bt;if(this.ctx.clip_path.length!==0){var At=this.path;V=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(V,this.posX+this.margin[3],-St+et+this.ctx.prevPageLastElemOffset),D.call(this,A,!0),this.path=At}if(K=JSON.parse(JSON.stringify(Be)),this.path=C(K,this.posX+this.margin[3],-St+et+this.ctx.prevPageLastElemOffset),$===!1||Ve===0){var Gt=(Ve>je||Ve<Oe)&&v.call(this);Gt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ue,bt,null).clip().discardPath()),D.call(this,A,$),Gt&&this.pdf.restoreGraphicsState()}this.lineWidth=ve}else this.lineWidth=Ie,D.call(this,A,$),this.lineWidth=ve;this.path=Be},D=function(A,$){if((A!=="stroke"||$||!g.call(this))&&(A==="stroke"||$||!p.call(this))){for(var V,K,ee=[],oe=this.path,fe=0;fe<oe.length;fe++){var ve=oe[fe];switch(ve.type){case"begin":ee.push({begin:!0});break;case"close":ee.push({close:!0});break;case"mt":ee.push({start:ve,deltas:[],abs:[]});break;case"lt":var Ie=ee.length;if(oe[fe-1]&&!isNaN(oe[fe-1].x)&&(V=[ve.x-oe[fe-1].x,ve.y-oe[fe-1].y],Ie>0)){for(;Ie>=0;Ie--)if(ee[Ie-1].close!==!0&&ee[Ie-1].begin!==!0){ee[Ie-1].deltas.push(V),ee[Ie-1].abs.push(ve);break}}break;case"bct":V=[ve.x1-oe[fe-1].x,ve.y1-oe[fe-1].y,ve.x2-oe[fe-1].x,ve.y2-oe[fe-1].y,ve.x-oe[fe-1].x,ve.y-oe[fe-1].y],ee[ee.length-1].deltas.push(V);break;case"qct":var Te=oe[fe-1].x+2/3*(ve.x1-oe[fe-1].x),Be=oe[fe-1].y+2/3*(ve.y1-oe[fe-1].y),$e=ve.x+2/3*(ve.x1-ve.x),ct=ve.y+2/3*(ve.y1-ve.y),we=ve.x,te=ve.y;V=[Te-oe[fe-1].x,Be-oe[fe-1].y,$e-oe[fe-1].x,ct-oe[fe-1].y,we-oe[fe-1].x,te-oe[fe-1].y],ee[ee.length-1].deltas.push(V);break;case"arc":ee.push({deltas:[],abs:[],arc:!0}),Array.isArray(ee[ee.length-1].abs)&&ee[ee.length-1].abs.push(ve)}}K=$?null:A==="stroke"?"stroke":"fill";for(var vt=!1,Ze=0;Ze<ee.length;Ze++)if(ee[Ze].arc)for(var je=ee[Ze].abs,Oe=0;Oe<je.length;Oe++){var Ve=je[Oe];Ve.type==="arc"?T.call(this,Ve.x,Ve.y,Ve.radius,Ve.startAngle,Ve.endAngle,Ve.counterclockwise,void 0,$,!vt):H.call(this,Ve.x,Ve.y),vt=!0}else if(ee[Ze].close===!0)this.pdf.internal.out("h"),vt=!1;else if(ee[Ze].begin!==!0){var Ue=ee[Ze].start.x,et=ee[Ze].start.y;X.call(this,ee[Ze].deltas,Ue,et),vt=!0}K&&q.call(this,K),$&&J.call(this)}},F=function(A){var $=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,V=$*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-V;case"top":return A+$-V;case"hanging":return A+$-2*V;case"middle":return A+$/2-V;case"ideographic":return A;case"alphabetic":default:return A}},M=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function($,V){this.colorStops.push([$,V])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function(A,$,V,K,ee,oe,fe,ve,Ie){for(var Te=Q.call(this,V,K,ee,oe),Be=0;Be<Te.length;Be++){var $e=Te[Be];Be===0&&(Ie?O.call(this,$e.x1+A,$e.y1+$):H.call(this,$e.x1+A,$e.y1+$)),ce.call(this,A,$,$e.x2,$e.y2,$e.x3,$e.y3,$e.x4,$e.y4)}ve?J.call(this):q.call(this,fe)},q=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},J=function(){this.pdf.clip(),this.pdf.discardPath()},O=function(A,$){this.pdf.internal.out(t(A)+" "+n($)+" m")},k=function(A){var $;switch(A.align){case"right":case"end":$="right";break;case"center":$="center";break;case"left":case"start":default:$="left"}var V=this.pdf.getTextDimensions(A.text),K=F.call(this,A.y),ee=M.call(this,K)-V.h,oe=this.ctx.transform.applyToPoint(new o(A.x,K)),fe=this.ctx.transform.decompose(),ve=new l;ve=(ve=(ve=ve.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var Ie,Te,Be,$e=this.ctx.transform.applyToRectangle(new s(A.x,K,V.w,V.h)),ct=ve.applyToRectangle(new s(A.x,ee,V.w,V.h)),we=b.call(this,ct),te=[],vt=0;vt<we.length;vt+=1)te.indexOf(we[vt])===-1&&te.push(we[vt]);if(S(te),this.autoPaging)for(var Ze=te[0],je=te[te.length-1],Oe=Ze;Oe<je+1;Oe++){this.pdf.setPage(Oe);var Ve=Oe===1?this.posY+this.margin[0]:this.margin[0],Ue=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],et=this.pdf.internal.pageSize.height-this.margin[2],mt=et-this.margin[0],bt=this.pdf.internal.pageSize.width-this.margin[1],St=bt-this.margin[3],At=Oe===1?0:Ue+(Oe-2)*mt;if(this.ctx.clip_path.length!==0){var Gt=this.path;Ie=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(Ie,this.posX+this.margin[3],-1*At+Ve),D.call(this,"fill",!0),this.path=Gt}var it=C([JSON.parse(JSON.stringify(ct))],this.posX+this.margin[3],-At+Ve+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(Te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Te*A.scale),Be=this.lineWidth,this.lineWidth=Be*A.scale);var jt=this.autoPaging!=="text";if(jt||it.y+it.h<=et){if(jt||it.y>=Ve&&it.x<=bt){var ze=jt?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||bt-it.x)[0],Qr=C([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-At+Ve+this.ctx.prevPageLastElemOffset)[0],Mt=jt&&(Oe>Ze||Oe<je)&&v.call(this);Mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],St,mt,null).clip().discardPath()),this.pdf.text(ze,Qr.x,Qr.y,{angle:A.angle,align:$,renderingMode:A.renderingMode}),Mt&&this.pdf.restoreGraphicsState()}}else it.y<et&&(this.ctx.prevPageLastElemOffset+=et-it.y);A.scale>=.01&&(this.pdf.setFontSize(Te),this.lineWidth=Be)}else A.scale>=.01&&(Te=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Te*A.scale),Be=this.lineWidth,this.lineWidth=Be*A.scale),this.pdf.text(A.text,oe.x+this.posX,oe.y+this.posY,{angle:A.angle,align:$,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(Te),this.lineWidth=Be)},H=function(A,$,V,K){V=V||0,K=K||0,this.pdf.internal.out(t(A+V)+" "+n($+K)+" l")},X=function(A,$,V){return this.pdf.lines(A,$,V,null,null)},ce=function(A,$,V,K,ee,oe,fe,ve){this.pdf.internal.out([e(a(V+A)),e(i(K+$)),e(a(ee+A)),e(i(oe+$)),e(a(fe+A)),e(i(ve+$)),"c"].join(" "))},Q=function(A,$,V,K){for(var ee=2*Math.PI,oe=Math.PI/2;$>V;)$-=ee;var fe=Math.abs(V-$);fe<ee&&K&&(fe=ee-fe);for(var ve=[],Ie=K?-1:1,Te=$;fe>1e-5;){var Be=Te+Ie*Math.min(fe,oe);ve.push(re.call(this,A,Te,Be)),fe-=Math.abs(Be-Te),Te=Be}return ve},re=function(A,$,V){var K=(V-$)/2,ee=A*Math.cos(K),oe=A*Math.sin(K),fe=ee,ve=-oe,Ie=fe*fe+ve*ve,Te=Ie+fe*ee+ve*oe,Be=4/3*(Math.sqrt(2*Ie*Te)-Te)/(fe*oe-ve*ee),$e=fe-Be*ve,ct=ve+Be*fe,we=$e,te=-ct,vt=K+$,Ze=Math.cos(vt),je=Math.sin(vt);return{x1:A*Math.cos($),y1:A*Math.sin($),x2:$e*Ze-ct*je,y2:$e*je+ct*Ze,x3:we*Ze-te*je,y3:we*je+te*Ze,x4:A*Math.cos(V),y4:A*Math.sin(V)}},G=function(A){return 180*A/Math.PI},Y=function(A,$,V,K,ee,oe){var fe=A+.5*(V-A),ve=$+.5*(K-$),Ie=ee+.5*(V-ee),Te=oe+.5*(K-oe),Be=Math.min(A,ee,fe,Ie),$e=Math.max(A,ee,fe,Ie),ct=Math.min($,oe,ve,Te),we=Math.max($,oe,ve,Te);return new s(Be,ct,$e-Be,we-ct)},ge=function(A,$,V,K,ee,oe,fe,ve){var Ie,Te,Be,$e,ct,we,te,vt,Ze,je,Oe,Ve,Ue,et,mt=V-A,bt=K-$,St=ee-V,At=oe-K,Gt=fe-ee,it=ve-oe;for(Te=0;Te<41;Te++)Ze=(te=(Be=A+(Ie=Te/40)*mt)+Ie*((ct=V+Ie*St)-Be))+Ie*(ct+Ie*(ee+Ie*Gt-ct)-te),je=(vt=($e=$+Ie*bt)+Ie*((we=K+Ie*At)-$e))+Ie*(we+Ie*(oe+Ie*it-we)-vt),Te==0?(Oe=Ze,Ve=je,Ue=Ze,et=je):(Oe=Math.min(Oe,Ze),Ve=Math.min(Ve,je),Ue=Math.max(Ue,Ze),et=Math.max(et,je));return new s(Math.round(Oe),Math.round(Ve),Math.round(Ue-Oe),Math.round(et-Ve))},ye=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,$,V=(A=this.ctx.lineDash,$=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:$}));this.prevLineDash!==V&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=V)}}})(ft.API),function(r){var e=function(i){var o,s,l,u,d,f,h,p,g,v;for(s=[],l=0,u=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;u>l;l+=4)(d=(i.charCodeAt(l)<<24)+(i.charCodeAt(l+1)<<16)+(i.charCodeAt(l+2)<<8)+i.charCodeAt(l+3))!==0?(f=(d=((d=((d=((d=(d-(v=d%85))/85)-(g=d%85))/85)-(p=d%85))/85)-(h=d%85))/85)%85,s.push(f+33,h+33,p+33,g+33,v+33)):s.push(122);return function(b,y){for(var C=y;C>0;C--)b.pop()}(s,o.length),String.fromCharCode.apply(String,s)+"~>"},t=function(i){var o,s,l,u,d,f=String,h="length",p=255,g="charCodeAt",v="slice",b="replace";for(i[v](-2),i=i[v](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),l=[],u=0,d=(i+=o="uuuuu"[v](i[h]%5||5))[h];d>u;u+=5)s=52200625*(i[g](u)-33)+614125*(i[g](u+1)-33)+7225*(i[g](u+2)-33)+85*(i[g](u+3)-33)+(i[g](u+4)-33),l.push(p&s>>24,p&s>>16,p&s>>8,p&s);return function(y,C){for(var S=C;S>0;S--)y.pop()}(l,o[h]),f.fromCharCode.apply(f,l)},n=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var s="",l=0;l<i.length;l+=2)s+=String.fromCharCode("0x"+(i[l]+i[l+1]));return s},a=function(i){for(var o=new Uint8Array(i.length),s=i.length;s--;)o[s]=i.charCodeAt(s);return i=(o=xp(o)).reduce(function(l,u){return l+String.fromCharCode(u)},"")};r.processDataByFilters=function(i,o){var s=0,l=i||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),s=0;s<o.length;s+=1)switch(o[s]){case"ASCII85Decode":case"/ASCII85Decode":l=t(l),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=e(l),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=a(l),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[s]+'" is not implemented')}return{data:l,reverseChain:u.reverse().join(" ")}}}(ft.API),function(r){r.loadFile=function(e,t,n){return function(a,i,o){i=i!==!1,o=typeof o=="function"?o:function(){};var s=void 0;try{s=function(l,u,d){var f=new XMLHttpRequest,h=0,p=function(g){var v=g.length,b=[],y=String.fromCharCode;for(h=0;h<v;h+=1)b.push(y(255&g.charCodeAt(h)));return b.join("")};if(f.open("GET",l,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(p(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return p(f.responseText)}(a,i,o)}catch{}return s}(e,t,n)},r.loadImageFile=r.loadFile}(ft.API),function(r){function e(){return(ht.html2canvas?Promise.resolve(ht.html2canvas):$1(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function t(){return(ht.DOMPurify?Promise.resolve(ht.DOMPurify):$1(()=>import("./purify.es-BFmuJLeH.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var s=ir(o);return s==="undefined"?"undefined":s==="string"||o instanceof String?"string":s==="number"||o instanceof Number?"number":s==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":s==="object"?"object":"unknown"},a=function(o,s){var l=document.createElement(o);for(var u in s.className&&(l.className=s.className),s.innerHTML&&s.dompurify&&(l.innerHTML=s.dompurify.sanitize(s.innerHTML)),s.style)l.style[u]=s.style[u];return l},i=function o(s){var l=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),l);return u=(u=u.setProgress(1,o,1,[o])).set(s)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,s){return o.__proto__=s||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,s){return this.then(function(){switch(s=s||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(t).then(function(l){return this.set({src:a("div",{innerHTML:o,dompurify:l})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},s=function l(u,d){for(var f=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),h=u.firstChild;h;h=h.nextSibling)d!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||f.appendChild(l(h,d));return u.nodeType===1&&(u.nodeName==="CANVAS"?(f.width=u.width,f.height=u.height,f.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(f.value=u.value),f.addEventListener("load",function(){f.scrollTop=u.scrollTop,f.scrollLeft=u.scrollLeft},!0)),f}(this.prop.src,this.opt.html2canvas.javascriptEnabled);s.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(s),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(s){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,s(this.prop.container,l)}).then(function(s){(this.opt.html2canvas.onrendered||function(){})(s),this.prop.canvas=s,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(s){var l=this.opt.jsPDF,u=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,f=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete f.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=u,u)for(var h=0;h<u.length;++h){var p=u[h],g=p.src.find(function(v){return v.format==="truetype"});g&&l.addFont(g.url,p.ref.name,p.ref.style)}return f.windowHeight=f.windowHeight||0,f.windowHeight=f.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):f.windowHeight,l.context2d.save(!0),s(this.prop.container,f)}).then(function(s){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(s),this.prop.canvas=s,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,s,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(o,s):this.outputPdf(o,s)},i.prototype.outputPdf=function(o,s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,s)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(n(o)!=="object")return this;var s=Object.keys(o||{}).map(function(l){if(l in i.template.prop)return function(){this.prop[l]=o[l]};switch(l){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[l]=o[l]}}},this);return this.then(function(){return this.thenList(s)})},i.prototype.get=function(o,s){return this.then(function(){var l=o in i.template.prop?this.prop[o]:this.opt[o];return s?s(l):l})},i.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function s(l,u){return Math.floor(l*u/72*96)}return this.then(function(){(o=o||ft.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:s(o.inner.width,o.k),height:s(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,s,l,u){return o!=null&&(this.progress.val=o),s!=null&&(this.progress.state=s),l!=null&&(this.progress.n=l),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,s,l,u){return this.setProgress(o?this.progress.val+o:null,s||null,l?this.progress.n+l:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(o,s){var l=this;return this.thenCore(o,s,function(u,d){return l.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(f){return l.updateProgress(null,u),f}).then(u,d).then(function(f){return l.updateProgress(1),f})})},i.prototype.thenCore=function(o,s,l){l=l||Promise.prototype.then,o&&(o=o.bind(this)),s&&(s=s.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:i.convert(Object.assign({},this),Promise.prototype),d=l.call(u,o,s);return i.convert(d,this.__proto__)},i.prototype.thenExternal=function(o,s){return Promise.prototype.then.call(this,o,s)},i.prototype.thenList=function(o){var s=this;return o.forEach(function(l){s=s.thenCore(l)}),s},i.prototype.catch=function(o){o&&(o=o.bind(this));var s=Promise.prototype.catch.call(this,o);return i.convert(s,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,ft.getPageSize=function(o,s,l){if(ir(o)==="object"){var u=o;o=u.orientation,s=u.unit||s,l=u.format||l}s=s||"mm",l=l||"a4",o=(""+(o||"P")).toLowerCase();var d,f=(""+l).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(s){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+s}var p,g=0,v=0;if(h.hasOwnProperty(f))g=h[f][1]/d,v=h[f][0]/d;else try{g=l[1],v=l[0]}catch{throw new Error("Invalid format: "+l)}if(o==="p"||o==="portrait")o="p",v>g&&(p=v,v=g,g=p);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>v&&(p=v,v=g,g=p)}return{width:v,height:g,unit:s,k:d,orientation:o}},r.html=function(o,s){(s=s||{}).callback=s.callback||function(){},s.html2canvas=s.html2canvas||{},s.html2canvas.canvas=s.html2canvas.canvas||this.canvas,s.jsPDF=s.jsPDF||this,s.fontFaces=s.fontFaces?s.fontFaces.map(Np):null;var l=new i(s);return s.worker?l:l.from(o).doCallback()}}(ft.API),ft.API.addJS=function(r){return G2=r,this.internal.events.subscribe("postPutResources",function(){nf=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(nf+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),W2=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+G2+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){nf!==void 0&&W2!==void 0&&this.internal.out("/Names <</JavaScript "+nf+" 0 R>>")}),this},function(r){var e;r.events.push(["postPutResources",function(){var t=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=t.outline.render().split(/\r\n/),i=0;i<a.length;i++){var o=a[i],s=n.exec(o);if(s!=null){var l=s[1];t.internal.newObjectDeferredBegin(l,!1)}t.internal.write(o)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(i=0;i<u;i++){var f=t.internal.newObject();d.push(f);var h=t.internal.getPageInfo(i+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),i=0;i<d.length;i++)t.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),r.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),r.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(n,a,i){var o={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(o),o},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(n){n.id=t.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},t.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},t.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var o=n.children[i];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var s=this.count=this.count_r({count:0},o);if(s>0&&this.line("/Count "+s),o.options&&o.options.pageNumber){var l=t.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},t.outline.line=function(n){this.ctx.val+=n+`\r
`},t.outline.makeRef=function(n){return n.id+" 0 R"},t.outline.makeString=function(n){return"("+t.internal.pdfEscape(n)+")"},t.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(ft.API),function(r){var e=[192,193,194,195,196,197,198,199];r.processJPEG=function(t,n,a,i,o,s){var l,u=this.decode.DCT_DECODE,d=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=o||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(l=function(f){for(var h,p=256*f.charCodeAt(4)+f.charCodeAt(5),g=f.length,v={width:0,height:0,numcomponents:1},b=4;b<g;b+=2){if(b+=p,e.indexOf(f.charCodeAt(b+1))!==-1){h=256*f.charCodeAt(b+5)+f.charCodeAt(b+6),v={width:256*f.charCodeAt(b+7)+f.charCodeAt(b+8),height:h,numcomponents:f.charCodeAt(b+9)};break}p=256*f.charCodeAt(b+2)+f.charCodeAt(b+3)}return v}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:s=this.color_spaces.DEVICE_GRAY;break;case 4:s=this.color_spaces.DEVICE_CMYK;break;case 3:s=this.color_spaces.DEVICE_RGB}d={data:t,width:l.width,height:l.height,colorSpace:s,bitsPerComponent:8,filter:u,index:n,alias:a}}return d}}(ft.API);var Ic,af,Y2,K2,X2,Rk=function(){var r,e,t;function n(i){var o,s,l,u,d,f,h,p,g,v,b,y,C,S;for(this.data=i,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},f=null;;){switch(o=this.readUInt32(),g=function(){var j,D;for(D=[],j=0;j<4;++j)D.push(String.fromCharCode(this.data[this.pos++]));return D}.call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":f&&this.animation.frames.push(f),this.pos+=4,f={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),u=this.readUInt16()||100,f.delay=1e3*d/u,f.disposeOp=this.data[this.pos++],f.blendOp=this.data[this.pos++],f.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,o-=4),i=f?.data||this.imgData,y=0;0<=o?y<o:y>o;0<=o?++y:--y)i.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((v=l-this.transparency.indexed.length)>0)for(C=0;0<=v?C<v:C>v;0<=v?++C:--C)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":h=(b=this.read(o)).indexOf(0),p=String.fromCharCode.apply(String,b.slice(0,h)),this.text[p]=String.fromCharCode.apply(String,b.slice(h+1));break;case"IEND":return f&&this.animation.frames.push(f),this.colors=function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}.call(this),this.hasAlphaChannel=(S=this.colorType)===4||S===6,s=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*s,this.colorSpace=function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}.call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(i){var o,s;for(s=[],o=0;0<=i?o<i:o>i;0<=i?++o:--o)s.push(this.data[this.pos++]);return s},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(i){var o=this.pixelBitlength/8,s=new Uint8Array(this.width*this.height*o),l=0,u=this;if(i==null&&(i=this.imgData),i.length===0)return new Uint8Array(0);function d(f,h,p,g){var v,b,y,C,S,j,D,F,M,T,q,J,O,k,H,X,ce,Q,re,G,Y,ge=Math.ceil((u.width-f)/p),ye=Math.ceil((u.height-h)/g),A=u.width==ge&&u.height==ye;for(k=o*ge,J=A?s:new Uint8Array(k*ye),j=i.length,O=0,b=0;O<ye&&l<j;){switch(i[l++]){case 0:for(C=ce=0;ce<k;C=ce+=1)J[b++]=i[l++];break;case 1:for(C=Q=0;Q<k;C=Q+=1)v=i[l++],S=C<o?0:J[b-o],J[b++]=(v+S)%256;break;case 2:for(C=re=0;re<k;C=re+=1)v=i[l++],y=(C-C%o)/o,H=O&&J[(O-1)*k+y*o+C%o],J[b++]=(H+v)%256;break;case 3:for(C=G=0;G<k;C=G+=1)v=i[l++],y=(C-C%o)/o,S=C<o?0:J[b-o],H=O&&J[(O-1)*k+y*o+C%o],J[b++]=(v+Math.floor((S+H)/2))%256;break;case 4:for(C=Y=0;Y<k;C=Y+=1)v=i[l++],y=(C-C%o)/o,S=C<o?0:J[b-o],O===0?H=X=0:(H=J[(O-1)*k+y*o+C%o],X=y&&J[(O-1)*k+(y-1)*o+C%o]),D=S+H-X,F=Math.abs(D-S),T=Math.abs(D-H),q=Math.abs(D-X),M=F<=T&&F<=q?S:T<=q?H:X,J[b++]=(v+M)%256;break;default:throw new Error("Invalid filter algorithm: "+i[l-1])}if(!A){var $=((h+O*g)*u.width+f)*o,V=O*k;for(C=0;C<ge;C+=1){for(var K=0;K<o;K+=1)s[$++]=J[V++];$+=(p-1)*o}}O++}}return i=pk(i),u.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),s},n.prototype.decodePalette=function(){var i,o,s,l,u,d,f,h,p;for(s=this.palette,d=this.transparency.indexed||[],u=new Uint8Array((d.length||0)+s.length),l=0,i=0,o=f=0,h=s.length;f<h;o=f+=3)u[l++]=s[o],u[l++]=s[o+1],u[l++]=s[o+2],u[l++]=(p=d[i++])!=null?p:255;return u},n.prototype.copyToImageData=function(i,o){var s,l,u,d,f,h,p,g,v,b,y;if(l=this.colors,v=null,s=this.hasAlphaChannel,this.palette.length&&(v=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),l=4,s=!0),g=(u=i.data||i).length,f=v||o,d=h=0,l===1)for(;d<g;)p=v?4*o[d/4]:h,b=f[p++],u[d++]=b,u[d++]=b,u[d++]=b,u[d++]=s?f[p++]:255,h=p;else for(;d<g;)p=v?4*o[d/4]:h,u[d++]=f[p++],u[d++]=f[p++],u[d++]=f[p++],u[d++]=s?f[p++]:255,h=p},n.prototype.decode=function(){var i;return i=new Uint8Array(this.width*this.height*4),this.copyToImageData(i,this.decodePixels()),i};var a=function(){if(Object.prototype.toString.call(ht)==="[object Window]"){try{e=ht.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return a(),r=function(i){var o;if(a()===!0)return t.width=i.width,t.height=i.height,t.clearRect(0,0,i.width,i.height),t.putImageData(i,0,0),(o=new Image).src=e.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(i){var o,s,l,u,d,f,h,p;if(this.animation){for(p=[],s=d=0,f=(h=this.animation.frames).length;d<f;s=++d)o=h[s],l=i.createImageData(o.width,o.height),u=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(l,u),o.imageData=l,p.push(o.image=r(l));return p}},n.prototype.renderFrame=function(i,o){var s,l,u;return s=(l=this.animation.frames)[o],u=l[o-1],o===0&&i.clearRect(0,0,this.width,this.height),u?.disposeOp===1?i.clearRect(u.xOffset,u.yOffset,u.width,u.height):u?.disposeOp===2&&i.putImageData(u.imageData,u.xOffset,u.yOffset),s.blendOp===0&&i.clearRect(s.xOffset,s.yOffset,s.width,s.height),i.drawImage(s.image,s.xOffset,s.yOffset)},n.prototype.animate=function(i){var o,s,l,u,d,f,h=this;return s=0,f=this.animation,u=f.numFrames,l=f.frames,d=f.numPlays,(o=function(){var p,g;if(p=s++%u,g=l[p],h.renderFrame(i,p),u>1&&s/u<d)return h.animation._timeout=setTimeout(o,g.delay)})()},n.prototype.stopAnimation=function(){var i;return clearTimeout((i=this.animation)!=null?i._timeout:void 0)},n.prototype.render=function(i){var o,s;return i._png&&i._png.stopAnimation(),i._png=this,i.width=this.width,i.height=this.height,o=i.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(s=o.createImageData(this.width,this.height),this.copyToImageData(s,this.decodePixels()),o.putImageData(s,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function Lk(r){var e=0;if(r[e++]!==71||r[e++]!==73||r[e++]!==70||r[e++]!==56||(r[e++]+1&253)!=56||r[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=r[e++]|r[e++]<<8,n=r[e++]|r[e++]<<8,a=r[e++],i=a>>7,o=1<<(7&a)+1;r[e++],r[e++];var s=null,l=null;i&&(s=e,l=o,e+=3*o);var u=!0,d=[],f=0,h=null,p=0,g=null;for(this.width=t,this.height=n;u&&e<r.length;)switch(r[e++]){case 33:switch(r[e++]){case 255:if(r[e]!==11||r[e+1]==78&&r[e+2]==69&&r[e+3]==84&&r[e+4]==83&&r[e+5]==67&&r[e+6]==65&&r[e+7]==80&&r[e+8]==69&&r[e+9]==50&&r[e+10]==46&&r[e+11]==48&&r[e+12]==3&&r[e+13]==1&&r[e+16]==0)e+=14,g=r[e++]|r[e++]<<8,e++;else for(e+=12;;){if(!((O=r[e++])>=0))throw Error("Invalid block size");if(O===0)break;e+=O}break;case 249:if(r[e++]!==4||r[e+4]!==0)throw new Error("Invalid graphics extension block.");var v=r[e++];f=r[e++]|r[e++]<<8,h=r[e++],!(1&v)&&(h=null),p=v>>2&7,e++;break;case 254:for(;;){if(!((O=r[e++])>=0))throw Error("Invalid block size");if(O===0)break;e+=O}break;default:throw new Error("Unknown graphic control label: 0x"+r[e-1].toString(16))}break;case 44:var b=r[e++]|r[e++]<<8,y=r[e++]|r[e++]<<8,C=r[e++]|r[e++]<<8,S=r[e++]|r[e++]<<8,j=r[e++],D=j>>6&1,F=1<<(7&j)+1,M=s,T=l,q=!1;j>>7&&(q=!0,M=e,T=F,e+=3*F);var J=e;for(e++;;){var O;if(!((O=r[e++])>=0))throw Error("Invalid block size");if(O===0)break;e+=O}d.push({x:b,y,width:C,height:S,has_local_palette:q,palette_offset:M,palette_size:T,data_offset:J,data_length:e-J,transparent_index:h,interlaced:!!D,delay:f,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+r[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return g},this.frameInfo=function(k){if(k<0||k>=d.length)throw new Error("Frame index out of range.");return d[k]},this.decodeAndBlitFrameBGRA=function(k,H){var X=this.frameInfo(k),ce=X.width*X.height,Q=new Uint8Array(ce);Q2(r,X.data_offset,Q,ce);var re=X.palette_offset,G=X.transparent_index;G===null&&(G=256);var Y=X.width,ge=t-Y,ye=Y,A=4*(X.y*t+X.x),$=4*((X.y+X.height)*t+X.x),V=A,K=4*ge;X.interlaced===!0&&(K+=4*t*7);for(var ee=8,oe=0,fe=Q.length;oe<fe;++oe){var ve=Q[oe];if(ye===0&&(ye=Y,(V+=K)>=$&&(K=4*ge+4*t*(ee-1),V=A+(Y+ge)*(ee<<1),ee>>=1)),ve===G)V+=4;else{var Ie=r[re+3*ve],Te=r[re+3*ve+1],Be=r[re+3*ve+2];H[V++]=Be,H[V++]=Te,H[V++]=Ie,H[V++]=255}--ye}},this.decodeAndBlitFrameRGBA=function(k,H){var X=this.frameInfo(k),ce=X.width*X.height,Q=new Uint8Array(ce);Q2(r,X.data_offset,Q,ce);var re=X.palette_offset,G=X.transparent_index;G===null&&(G=256);var Y=X.width,ge=t-Y,ye=Y,A=4*(X.y*t+X.x),$=4*((X.y+X.height)*t+X.x),V=A,K=4*ge;X.interlaced===!0&&(K+=4*t*7);for(var ee=8,oe=0,fe=Q.length;oe<fe;++oe){var ve=Q[oe];if(ye===0&&(ye=Y,(V+=K)>=$&&(K=4*ge+4*t*(ee-1),V=A+(Y+ge)*(ee<<1),ee>>=1)),ve===G)V+=4;else{var Ie=r[re+3*ve],Te=r[re+3*ve+1],Be=r[re+3*ve+2];H[V++]=Ie,H[V++]=Te,H[V++]=Be,H[V++]=255}--ye}}}function Q2(r,e,t,n){for(var a=r[e++],i=1<<a,o=i+1,s=o+1,l=a+1,u=(1<<l)-1,d=0,f=0,h=0,p=r[e++],g=new Int32Array(4096),v=null;;){for(;d<16&&p!==0;)f|=r[e++]<<d,d+=8,p===1?p=r[e++]:--p;if(d<l)break;var b=f&u;if(f>>=l,d-=l,b!==i){if(b===o)break;for(var y=b<s?b:v,C=0,S=y;S>i;)S=g[S]>>8,++C;var j=S;if(h+C+(y!==b?1:0)>n)return void dr.log("Warning, gif stream longer than expected.");t[h++]=j;var D=h+=C;for(y!==b&&(t[h++]=j),S=y;C--;)S=g[S],t[--D]=255&S,S>>=8;v!==null&&s<4096&&(g[s++]=v<<8|j,s>=u+1&&l<12&&(++l,u=u<<1|1)),v=b}else s=o+1,u=(1<<(l=a+1))-1,v=null}return h!==n&&dr.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function x1(r){var e,t,n,a,i,o=Math.floor,s=new Array(64),l=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),h=new Array(65535),p=new Array(64),g=new Array(64),v=[],b=0,y=7,C=new Array(64),S=new Array(64),j=new Array(64),D=new Array(256),F=new Array(2048),M=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],J=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],O=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],k=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Q(A,$){for(var V=0,K=0,ee=new Array,oe=1;oe<=16;oe++){for(var fe=1;fe<=A[oe];fe++)ee[$[K]]=[],ee[$[K]][0]=V,ee[$[K]][1]=oe,K++,V++;V*=2}return ee}function re(A){for(var $=A[0],V=A[1]-1;V>=0;)$&1<<V&&(b|=1<<y),V--,--y<0&&(b==255?(G(255),G(0)):G(b),y=7,b=0)}function G(A){v.push(A)}function Y(A){G(A>>8&255),G(255&A)}function ge(A,$,V,K,ee){for(var oe,fe=ee[0],ve=ee[240],Ie=function(je,Oe){var Ve,Ue,et,mt,bt,St,At,Gt,it,jt,ze=0;for(it=0;it<8;++it){Ve=je[ze],Ue=je[ze+1],et=je[ze+2],mt=je[ze+3],bt=je[ze+4],St=je[ze+5],At=je[ze+6];var Qr=Ve+(Gt=je[ze+7]),Mt=Ve-Gt,fa=Ue+At,Yt=Ue-At,$t=et+St,Aa=et-St,Ye=mt+bt,Ut=mt-bt,dt=Qr+Ye,Er=Qr-Ye,Fr=fa+$t,lr=fa-$t;je[ze]=dt+Fr,je[ze+4]=dt-Fr;var gt=.707106781*(lr+Er);je[ze+2]=Er+gt,je[ze+6]=Er-gt;var Zt=.382683433*((dt=Ut+Aa)-(lr=Yt+Mt)),os=.5411961*dt+Zt,wn=1.306562965*lr+Zt,yi=.707106781*(Fr=Aa+Yt),bi=Mt+yi,ut=Mt-yi;je[ze+5]=ut+os,je[ze+3]=ut-os,je[ze+1]=bi+wn,je[ze+7]=bi-wn,ze+=8}for(ze=0,it=0;it<8;++it){Ve=je[ze],Ue=je[ze+8],et=je[ze+16],mt=je[ze+24],bt=je[ze+32],St=je[ze+40],At=je[ze+48];var Xa=Ve+(Gt=je[ze+56]),wi=Ve-Gt,Xn=Ue+At,Zr=Ue-At,Br=et+St,ha=et-St,Xs=mt+bt,Hi=mt-bt,Qa=Xa+Xs,Za=Xa-Xs,Ja=Xn+Br,_i=Xn-Br;je[ze]=Qa+Ja,je[ze+32]=Qa-Ja;var ja=.707106781*(_i+Za);je[ze+16]=Za+ja,je[ze+48]=Za-ja;var Ci=.382683433*((Qa=Hi+ha)-(_i=Zr+wi)),ss=.5411961*Qa+Ci,Qs=1.306562965*_i+Ci,Zs=.707106781*(Ja=ha+Zr),Js=wi+Zs,ec=wi-Zs;je[ze+40]=ec+ss,je[ze+24]=ec-ss,je[ze+8]=Js+Qs,je[ze+56]=Js-Qs,ze++}for(it=0;it<64;++it)jt=je[it]*Oe[it],p[it]=jt>0?jt+.5|0:jt-.5|0;return p}(A,$),Te=0;Te<64;++Te)g[M[Te]]=Ie[Te];var Be=g[0]-V;V=g[0],Be==0?re(K[0]):(re(K[h[oe=32767+Be]]),re(f[oe]));for(var $e=63;$e>0&&g[$e]==0;)$e--;if($e==0)return re(fe),V;for(var ct,we=1;we<=$e;){for(var te=we;g[we]==0&&we<=$e;)++we;var vt=we-te;if(vt>=16){ct=vt>>4;for(var Ze=1;Ze<=ct;++Ze)re(ve);vt&=15}oe=32767+g[we],re(ee[(vt<<4)+h[oe]]),re(f[oe]),we++}return $e!=63&&re(fe),V}function ye(A){A=Math.min(Math.max(A,1),100),i!=A&&(function($){for(var V=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],K=0;K<64;K++){var ee=o((V[K]*$+50)/100);ee=Math.min(Math.max(ee,1),255),s[M[K]]=ee}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var ve=o((oe[fe]*$+50)/100);ve=Math.min(Math.max(ve,1),255),l[M[fe]]=ve}for(var Ie=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Te=0,Be=0;Be<8;Be++)for(var $e=0;$e<8;$e++)u[Te]=1/(s[M[Te]]*Ie[Be]*Ie[$e]*8),d[Te]=1/(l[M[Te]]*Ie[Be]*Ie[$e]*8),Te++}(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),i=A)}this.encode=function(A,$){$&&ye($),v=new Array,b=0,y=7,Y(65496),Y(65504),Y(16),G(74),G(70),G(73),G(70),G(0),G(1),G(1),G(0),Y(1),Y(1),G(0),G(0),function(){Y(65499),Y(132),G(0);for(var Ue=0;Ue<64;Ue++)G(s[Ue]);G(1);for(var et=0;et<64;et++)G(l[et])}(),function(Ue,et){Y(65472),Y(17),G(8),Y(et),Y(Ue),G(3),G(1),G(17),G(0),G(2),G(17),G(1),G(3),G(17),G(1)}(A.width,A.height),function(){Y(65476),Y(418),G(0);for(var Ue=0;Ue<16;Ue++)G(T[Ue+1]);for(var et=0;et<=11;et++)G(q[et]);G(16);for(var mt=0;mt<16;mt++)G(J[mt+1]);for(var bt=0;bt<=161;bt++)G(O[bt]);G(1);for(var St=0;St<16;St++)G(k[St+1]);for(var At=0;At<=11;At++)G(H[At]);G(17);for(var Gt=0;Gt<16;Gt++)G(X[Gt+1]);for(var it=0;it<=161;it++)G(ce[it])}(),Y(65498),Y(12),G(3),G(1),G(0),G(2),G(17),G(3),G(17),G(0),G(63),G(0);var V=0,K=0,ee=0;b=0,y=7,this.encode.displayName="_encode_";for(var oe,fe,ve,Ie,Te,Be,$e,ct,we,te=A.data,vt=A.width,Ze=A.height,je=4*vt,Oe=0;Oe<Ze;){for(oe=0;oe<je;){for(Te=je*Oe+oe,$e=-1,ct=0,we=0;we<64;we++)Be=Te+(ct=we>>3)*je+($e=4*(7&we)),Oe+ct>=Ze&&(Be-=je*(Oe+1+ct-Ze)),oe+$e>=je&&(Be-=oe+$e-je+4),fe=te[Be++],ve=te[Be++],Ie=te[Be++],C[we]=(F[fe]+F[ve+256>>0]+F[Ie+512>>0]>>16)-128,S[we]=(F[fe+768>>0]+F[ve+1024>>0]+F[Ie+1280>>0]>>16)-128,j[we]=(F[fe+1280>>0]+F[ve+1536>>0]+F[Ie+1792>>0]>>16)-128;V=ge(C,u,V,e,n),K=ge(S,d,K,t,a),ee=ge(j,d,ee,t,a),oe+=32}Oe+=8}if(y>=0){var Ve=[];Ve[1]=y+1,Ve[0]=(1<<y+1)-1,re(Ve)}return Y(65497),new Uint8Array(v)},r=r||50,function(){for(var A=String.fromCharCode,$=0;$<256;$++)D[$]=A($)}(),e=Q(T,q),t=Q(k,H),n=Q(J,O),a=Q(X,ce),function(){for(var A=1,$=2,V=1;V<=15;V++){for(var K=A;K<$;K++)h[32767+K]=V,f[32767+K]=[],f[32767+K][1]=V,f[32767+K][0]=K;for(var ee=-($-1);ee<=-A;ee++)h[32767+ee]=V,f[32767+ee]=[],f[32767+ee][1]=V,f[32767+ee][0]=$-1+ee;A<<=1,$<<=1}}(),function(){for(var A=0;A<256;A++)F[A]=19595*A,F[A+256>>0]=38470*A,F[A+512>>0]=7471*A+32768,F[A+768>>0]=-11059*A,F[A+1024>>0]=-21709*A,F[A+1280>>0]=32768*A+8421375,F[A+1536>>0]=-27439*A,F[A+1792>>0]=-5329*A}(),ye(r)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function oi(r,e){if(this.pos=0,this.buffer=r,this.datav=new DataView(r.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Z2(r){function e(T){if(!T)throw Error("assert :P")}function t(T,q,J){for(var O=0;4>O;O++)if(T[q+O]!=J.charCodeAt(O))return!0;return!1}function n(T,q,J,O,k){for(var H=0;H<k;H++)T[q+H]=J[O+H]}function a(T,q,J,O){for(var k=0;k<O;k++)T[q+k]=J}function i(T){return new Int32Array(T)}function o(T,q){for(var J=[],O=0;O<T;O++)J.push(new q);return J}function s(T,q){var J=[];return function O(k,H,X){for(var ce=X[H],Q=0;Q<ce&&(k.push(X.length>H+1?[]:new q),!(X.length<H+1));Q++)O(k[Q],H+1,X)}(J,0,T),J}var l=function(){var T=this;function q(m,x){for(var N=1<<x-1>>>0;m&N;)N>>>=1;return N?(m&N-1)+N:m}function J(m,x,N,E,P){e(!(E%N));do m[x+(E-=N)]=P;while(0<E)}function O(m,x,N,E,P){if(e(2328>=P),512>=P)var R=i(512);else if((R=i(P))==null)return 0;return function(L,B,U,W,ae,he){var pe,ue,Ae=B,be=1<<U,ie=i(16),le=i(16);for(e(ae!=0),e(W!=null),e(L!=null),e(0<U),ue=0;ue<ae;++ue){if(15<W[ue])return 0;++ie[W[ue]]}if(ie[0]==ae)return 0;for(le[1]=0,pe=1;15>pe;++pe){if(ie[pe]>1<<pe)return 0;le[pe+1]=le[pe]+ie[pe]}for(ue=0;ue<ae;++ue)pe=W[ue],0<W[ue]&&(he[le[pe]++]=ue);if(le[15]==1)return(W=new k).g=0,W.value=he[0],J(L,Ae,1,be,W),be;var Se,Pe=-1,Ee=be-1,Xe=0,Fe=1,lt=1,qe=1<<U;for(ue=0,pe=1,ae=2;pe<=U;++pe,ae<<=1){if(Fe+=lt<<=1,0>(lt-=ie[pe]))return 0;for(;0<ie[pe];--ie[pe])(W=new k).g=pe,W.value=he[ue++],J(L,Ae+Xe,ae,qe,W),Xe=q(Xe,pe)}for(pe=U+1,ae=2;15>=pe;++pe,ae<<=1){if(Fe+=lt<<=1,0>(lt-=ie[pe]))return 0;for(;0<ie[pe];--ie[pe]){if(W=new k,(Xe&Ee)!=Pe){for(Ae+=qe,Se=1<<(Pe=pe)-U;15>Pe&&!(0>=(Se-=ie[Pe]));)++Pe,Se<<=1;be+=qe=1<<(Se=Pe-U),L[B+(Pe=Xe&Ee)].g=Se+U,L[B+Pe].value=Ae-B-Pe}W.g=pe-U,W.value=he[ue++],J(L,Ae+(Xe>>U),ae,qe,W),Xe=q(Xe,pe)}}return Fe!=2*le[15]-1?0:be}(m,x,N,E,P,R)}function k(){this.value=this.g=0}function H(){this.value=this.g=0}function X(){this.G=o(5,k),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(_n,H)}function ce(m,x,N,E){e(m!=null),e(x!=null),e(2147483648>E),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=x,m.pa=N,m.Jd=x,m.Yc=N+E,m.Zc=4<=E?N+E-4+1:N,oe(m)}function Q(m,x){for(var N=0;0<x--;)N|=ve(m,128)<<x;return N}function re(m,x){var N=Q(m,x);return fe(m)?-N:N}function G(m,x,N,E){var P,R=0;for(e(m!=null),e(x!=null),e(4294967288>E),m.Sb=E,m.Ra=0,m.u=0,m.h=0,4<E&&(E=4),P=0;P<E;++P)R+=x[N+P]<<8*P;m.Ra=R,m.bb=E,m.oa=x,m.pa=N}function Y(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<mc-8>>>0,++m.bb,m.u-=8;V(m)&&(m.h=1,m.u=0)}function ge(m,x){if(e(0<=x),!m.h&&x<=pc){var N=$(m)&hc[x];return m.u+=x,Y(m),N}return m.h=1,m.u=0}function ye(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function A(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function $(m){return m.Ra>>>(m.u&mc-1)>>>0}function V(m){return e(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>mc}function K(m,x){m.u=x,m.h=V(m)}function ee(m){m.u>=Ll&&(e(m.u>=Ll),Y(m))}function oe(m){e(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(e(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function fe(m){return Q(m,1)}function ve(m,x){var N=m.Ca;0>m.b&&oe(m);var E=m.b,P=N*x>>>8,R=(m.I>>>E>P)+0;for(R?(N-=P,m.I-=P+1<<E>>>0):N=P+1,E=N,P=0;256<=E;)P+=8,E>>=8;return E=7^P+Zn[E],m.b-=E,m.Ca=(N<<E)-1,R}function Ie(m,x,N){m[x+0]=N>>24&255,m[x+1]=N>>16&255,m[x+2]=N>>8&255,m[x+3]=N>>0&255}function Te(m,x){return m[x+0]<<0|m[x+1]<<8}function Be(m,x){return Te(m,x)|m[x+2]<<16}function $e(m,x){return Te(m,x)|Te(m,x+2)<<16}function ct(m,x){var N=1<<x;return e(m!=null),e(0<x),m.X=i(N),m.X==null?0:(m.Mb=32-x,m.Xa=x,1)}function we(m,x){e(m!=null),e(x!=null),e(m.Xa==x.Xa),n(x.X,0,m.X,0,1<<x.Xa)}function te(){this.X=[],this.Xa=this.Mb=0}function vt(m,x,N,E){e(N!=null),e(E!=null);var P=N[0],R=E[0];return P==0&&(P=(m*R+x/2)/x),R==0&&(R=(x*P+m/2)/m),0>=P||0>=R?0:(N[0]=P,E[0]=R,1)}function Ze(m,x){return m+(1<<x)-1>>>x}function je(m,x){return((4278255360&m)+(4278255360&x)>>>0&4278255360)+((16711935&m)+(16711935&x)>>>0&16711935)>>>0}function Oe(m,x){T[x]=function(N,E,P,R,L,B,U){var W;for(W=0;W<L;++W){var ae=T[m](B[U+W-1],P,R+W);B[U+W]=je(N[E+W],ae)}}}function Ve(){this.ud=this.hd=this.jd=0}function Ue(m,x){return((4278124286&(m^x))>>>1)+(m&x)>>>0}function et(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function mt(m,x){return et(m+(m-x+.5>>1))}function bt(m,x,N){return Math.abs(x-N)-Math.abs(m-N)}function St(m,x,N,E,P,R,L){for(E=R[L-1],N=0;N<P;++N)R[L+N]=E=je(m[x+N],E)}function At(m,x,N,E,P){var R;for(R=0;R<N;++R){var L=m[x+R],B=L>>8&255,U=16711935&(U=(U=16711935&L)+((B<<16)+B));E[P+R]=(4278255360&L)+U>>>0}}function Gt(m,x){x.jd=m>>0&255,x.hd=m>>8&255,x.ud=m>>16&255}function it(m,x,N,E,P,R){var L;for(L=0;L<E;++L){var B=x[N+L],U=B>>>8,W=B,ae=255&(ae=(ae=B>>>16)+((m.jd<<24>>24)*(U<<24>>24)>>>5));W=255&(W=(W=W+((m.hd<<24>>24)*(U<<24>>24)>>>5))+((m.ud<<24>>24)*(ae<<24>>24)>>>5)),P[R+L]=(4278255360&B)+(ae<<16)+W}}function jt(m,x,N,E,P){T[x]=function(R,L,B,U,W,ae,he,pe,ue){for(U=he;U<pe;++U)for(he=0;he<ue;++he)W[ae++]=P(B[E(R[L++])])},T[m]=function(R,L,B,U,W,ae,he){var pe=8>>R.b,ue=R.Ea,Ae=R.K[0],be=R.w;if(8>pe)for(R=(1<<R.b)-1,be=(1<<pe)-1;L<B;++L){var ie,le=0;for(ie=0;ie<ue;++ie)ie&R||(le=E(U[W++])),ae[he++]=P(Ae[le&be]),le>>=pe}else T["VP8LMapColor"+N](U,W,Ae,be,ae,he,L,B,ue)}}function ze(m,x,N,E,P){for(N=x+N;x<N;){var R=m[x++];E[P++]=R>>16&255,E[P++]=R>>8&255,E[P++]=R>>0&255}}function Qr(m,x,N,E,P){for(N=x+N;x<N;){var R=m[x++];E[P++]=R>>16&255,E[P++]=R>>8&255,E[P++]=R>>0&255,E[P++]=R>>24&255}}function Mt(m,x,N,E,P){for(N=x+N;x<N;){var R=(L=m[x++])>>16&240|L>>12&15,L=L>>0&240|L>>28&15;E[P++]=R,E[P++]=L}}function fa(m,x,N,E,P){for(N=x+N;x<N;){var R=(L=m[x++])>>16&248|L>>13&7,L=L>>5&224|L>>3&31;E[P++]=R,E[P++]=L}}function Yt(m,x,N,E,P){for(N=x+N;x<N;){var R=m[x++];E[P++]=R>>0&255,E[P++]=R>>8&255,E[P++]=R>>16&255}}function $t(m,x,N,E,P,R){if(R==0)for(N=x+N;x<N;)Ie(E,((R=m[x++])[0]>>24|R[1]>>8&65280|R[2]<<8&16711680|R[3]<<24)>>>0),P+=32;else n(E,P,m,x,N)}function Aa(m,x){T[x][0]=T[m+"0"],T[x][1]=T[m+"1"],T[x][2]=T[m+"2"],T[x][3]=T[m+"3"],T[x][4]=T[m+"4"],T[x][5]=T[m+"5"],T[x][6]=T[m+"6"],T[x][7]=T[m+"7"],T[x][8]=T[m+"8"],T[x][9]=T[m+"9"],T[x][10]=T[m+"10"],T[x][11]=T[m+"11"],T[x][12]=T[m+"12"],T[x][13]=T[m+"13"],T[x][14]=T[m+"0"],T[x][15]=T[m+"0"]}function Ye(m){return m==_0||m==C0||m==Pd||m==N0}function Ut(){this.eb=[],this.size=this.A=this.fb=0}function dt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Er(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ut,this.f.kb=new dt,this.sd=null}function Fr(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function lr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function gt(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function Zt(m,x){var N=m.T,E=x.ba.f.RGBA,P=E.eb,R=E.fb+m.ka*E.A,L=ka[x.ba.S],B=m.y,U=m.O,W=m.f,ae=m.N,he=m.ea,pe=m.W,ue=x.cc,Ae=x.dc,be=x.Mc,ie=x.Nc,le=m.ka,Se=m.ka+m.T,Pe=m.U,Ee=Pe+1>>1;for(le==0?L(B,U,null,null,W,ae,he,pe,W,ae,he,pe,P,R,null,null,Pe):(L(x.ec,x.fc,B,U,ue,Ae,be,ie,W,ae,he,pe,P,R-E.A,P,R,Pe),++N);le+2<Se;le+=2)ue=W,Ae=ae,be=he,ie=pe,ae+=m.Rc,pe+=m.Rc,R+=2*E.A,L(B,(U+=2*m.fa)-m.fa,B,U,ue,Ae,be,ie,W,ae,he,pe,P,R-E.A,P,R,Pe);return U+=m.fa,m.j+Se<m.o?(n(x.ec,x.fc,B,U,Pe),n(x.cc,x.dc,W,ae,Ee),n(x.Mc,x.Nc,he,pe,Ee),N--):1&Se||L(B,U,null,null,W,ae,he,pe,W,ae,he,pe,P,R+E.A,null,null,Pe),N}function os(m,x,N){var E=m.F,P=[m.J];if(E!=null){var R=m.U,L=x.ba.S,B=L==jd||L==Pd;x=x.ba.f.RGBA;var U=[0],W=m.ka;U[0]=m.T,m.Kb&&(W==0?--U[0]:(--W,P[0]-=m.width),m.j+m.ka+m.T==m.o&&(U[0]=m.o-m.j-W));var ae=x.eb;W=x.fb+W*x.A,m=hr(E,P[0],m.width,R,U,ae,W+(B?0:3),x.A),e(N==U),m&&Ye(L)&&Ta(ae,W,B,R,U,x.A)}return 0}function wn(m){var x=m.ma,N=x.ba.S,E=11>N,P=N==Ed||N==Ad||N==jd||N==w0||N==12||Ye(N);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!Ml(x.Oa,m,P?11:12))return 0;if(P&&Ye(N)&&De(),m.da)alert("todo:use_scaling");else{if(E){if(x.Ib=gt,m.Kb){if(N=m.U+1>>1,x.memory=i(m.U+2*N),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+m.U,x.Mc=x.cc,x.Nc=x.dc+N,x.Ib=Zt,De()}}else alert("todo:EmitYUV");P&&(x.Jb=os,E&&de())}if(E&&!dv){for(m=0;256>m;++m)xC[m]=89858*(m-128)+Id>>Dd,wC[m]=-22014*(m-128)+Id,bC[m]=-45773*(m-128),yC[m]=113618*(m-128)+Id>>Dd;for(m=zl;m<A0;++m)x=76283*(m-16)+Id>>Dd,_C[m-zl]=pa(x,255),CC[m-zl]=pa(x+8>>4,15);dv=1}return 1}function yi(m){var x=m.ma,N=m.U,E=m.T;return e(!(1&m.ka)),0>=N||0>=E?0:(N=x.Ib(m,x),x.Jb!=null&&x.Jb(m,x,N),x.Dc+=N,1)}function bi(m){m.ma.memory=null}function ut(m,x,N,E){return ge(m,8)!=47?0:(x[0]=ge(m,14)+1,N[0]=ge(m,14)+1,E[0]=ge(m,1),ge(m,3)!=0?0:!m.h)}function Xa(m,x){if(4>m)return m+1;var N=m-2>>1;return(2+(1&m)<<N)+ge(x,N)+1}function wi(m,x){return 120<x?x-120:1<=(N=((N=aC[x-1])>>4)*m+(8-(15&N)))?N:1;var N}function Xn(m,x,N){var E=$(N),P=m[x+=255&E].g-8;return 0<P&&(K(N,N.u+8),E=$(N),x+=m[x].value,x+=E&(1<<P)-1),K(N,N.u+m[x].g),m[x].value}function Zr(m,x,N){return N.g+=m.g,N.value+=m.value<<x>>>0,e(8>=N.g),m.g}function Br(m,x,N){var E=m.xc;return e((x=E==0?0:m.vc[m.md*(N>>E)+(x>>E)])<m.Wb),m.Ya[x]}function ha(m,x,N,E){var P=m.ab,R=m.c*x,L=m.C;x=L+x;var B=N,U=E;for(E=m.Ta,N=m.Ua;0<P--;){var W=m.gc[P],ae=L,he=x,pe=B,ue=U,Ae=(U=E,B=N,W.Ea);switch(e(ae<he),e(he<=W.nc),W.hc){case 2:yd(pe,ue,(he-ae)*Ae,U,B);break;case 0:var be=ae,ie=he,le=U,Se=B,Pe=(qe=W).Ea;be==0&&(y0(pe,ue,null,null,1,le,Se),St(pe,ue+1,0,0,Pe-1,le,Se+1),ue+=Pe,Se+=Pe,++be);for(var Ee=1<<qe.b,Xe=Ee-1,Fe=Ze(Pe,qe.b),lt=qe.K,qe=qe.w+(be>>qe.b)*Fe;be<ie;){var Kt=lt,tr=qe,qt=1;for(Fl(pe,ue,le,Se-Pe,1,le,Se);qt<Pe;){var kt=(qt&~Xe)+Ee;kt>Pe&&(kt=Pe),(0,mo[Kt[tr++]>>8&15])(pe,ue+ +qt,le,Se+qt-Pe,kt-qt,le,Se+qt),qt=kt}ue+=Pe,Se+=Pe,++be&Xe||(qe+=Fe)}he!=W.nc&&n(U,B-Ae,U,B+(he-ae-1)*Ae,Ae);break;case 1:for(Ae=pe,ie=ue,Pe=(pe=W.Ea)-(Se=pe&~(le=(ue=1<<W.b)-1)),be=Ze(pe,W.b),Ee=W.K,W=W.w+(ae>>W.b)*be;ae<he;){for(Xe=Ee,Fe=W,lt=new Ve,qe=ie+Se,Kt=ie+pe;ie<qe;)Gt(Xe[Fe++],lt),fs(lt,Ae,ie,ue,U,B),ie+=ue,B+=ue;ie<Kt&&(Gt(Xe[Fe++],lt),fs(lt,Ae,ie,Pe,U,B),ie+=Pe,B+=Pe),++ae&le||(W+=be)}break;case 3:if(pe==U&&ue==B&&0<W.b){for(ie=U,pe=Ae=B+(he-ae)*Ae-(Se=(he-ae)*Ze(W.Ea,W.b)),ue=U,le=B,be=[],Se=(Pe=Se)-1;0<=Se;--Se)be[Se]=ue[le+Se];for(Se=Pe-1;0<=Se;--Se)ie[pe+Se]=be[Se];Pa(W,ae,he,U,Ae,U,B)}else Pa(W,ae,he,pe,ue,U,B)}B=E,U=N}U!=N&&n(E,N,B,U,R)}function Xs(m,x){var N=m.V,E=m.Ba+m.c*m.C,P=x-m.C;if(e(x<=m.l.o),e(16>=P),0<P){var R=m.l,L=m.Ta,B=m.Ua,U=R.width;if(ha(m,P,N,E),P=B=[B],e((N=m.C)<(E=x)),e(R.v<R.va),E>R.o&&(E=R.o),N<R.j){var W=R.j-N;N=R.j,P[0]+=W*U}if(N>=E?N=0:(P[0]+=4*R.v,R.ka=N-R.j,R.U=R.va-R.v,R.T=E-N,N=1),N){if(B=B[0],11>(N=m.ca).S){var ae=N.f.RGBA,he=(E=N.S,P=R.U,R=R.T,W=ae.eb,ae.A),pe=R;for(ae=ae.fb+m.Ma*ae.A;0<pe--;){var ue=L,Ae=B,be=P,ie=W,le=ae;switch(E){case Sd:Jn(ue,Ae,be,ie,le);break;case Ed:Un(ue,Ae,be,ie,le);break;case _0:Un(ue,Ae,be,ie,le),Ta(ie,le,0,be,1,0);break;case tv:Ki(ue,Ae,be,ie,le);break;case Ad:$t(ue,Ae,be,ie,le,1);break;case C0:$t(ue,Ae,be,ie,le,1),Ta(ie,le,0,be,1,0);break;case jd:$t(ue,Ae,be,ie,le,0);break;case Pd:$t(ue,Ae,be,ie,le,0),Ta(ie,le,1,be,1,0);break;case w0:go(ue,Ae,be,ie,le);break;case N0:go(ue,Ae,be,ie,le),fr(ie,le,be,1,0);break;case rv:Yi(ue,Ae,be,ie,le);break;default:e(0)}B+=U,ae+=he}m.Ma+=R}else alert("todo:EmitRescaledRowsYUVA");e(m.Ma<=N.height)}}m.C=x,e(m.C<=m.i)}function Hi(m){var x;if(0<m.ua)return 0;for(x=0;x<m.Wb;++x){var N=m.Ya[x].G,E=m.Ya[x].H;if(0<N[1][E[1]+0].g||0<N[2][E[2]+0].g||0<N[3][E[3]+0].g)return 0}return 1}function Qa(m,x,N,E,P,R){if(m.Z!=0){var L=m.qd,B=m.rd;for(e(bo[m.Z]!=null);x<N;++x)bo[m.Z](L,B,E,P,E,P,R),L=E,B=P,P+=R;m.qd=L,m.rd=B}}function Za(m,x){var N=m.l.ma,E=N.Z==0||N.Z==1?m.l.j:m.C;if(E=m.C<E?E:m.C,e(x<=m.l.o),x>E){var P=m.l.width,R=N.ca,L=N.tb+P*E,B=m.V,U=m.Ba+m.c*E,W=m.gc;e(m.ab==1),e(W[0].hc==3),bd(W[0],E,x,B,U,R,L),Qa(N,E,x,R,L,P)}m.C=m.Ma=x}function Ja(m,x,N,E,P,R,L){var B=m.$/E,U=m.$%E,W=m.m,ae=m.s,he=N+m.$,pe=he;P=N+E*P;var ue=N+E*R,Ae=280+ae.ua,be=m.Pb?B:16777216,ie=0<ae.ua?ae.Wa:null,le=ae.wc,Se=he<ue?Br(ae,U,B):null;e(m.C<R),e(ue<=P);var Pe=!1;e:for(;;){for(;Pe||he<ue;){var Ee=0;if(B>=be){var Xe=he-N;e((be=m).Pb),be.wd=be.m,be.xd=Xe,0<be.s.ua&&we(be.s.Wa,be.s.vb),be=B+oC}if(U&le||(Se=Br(ae,U,B)),e(Se!=null),Se.Qb&&(x[he]=Se.qb,Pe=!0),!Pe)if(ee(W),Se.jc){Ee=W,Xe=x;var Fe=he,lt=Se.pd[$(Ee)&_n-1];e(Se.jc),256>lt.g?(K(Ee,Ee.u+lt.g),Xe[Fe]=lt.value,Ee=0):(K(Ee,Ee.u+lt.g-256),e(256<=lt.value),Ee=lt.value),Ee==0&&(Pe=!0)}else Ee=Xn(Se.G[0],Se.H[0],W);if(W.h)break;if(Pe||256>Ee){if(!Pe)if(Se.nd)x[he]=(Se.qb|Ee<<8)>>>0;else{if(ee(W),Pe=Xn(Se.G[1],Se.H[1],W),ee(W),Xe=Xn(Se.G[2],Se.H[2],W),Fe=Xn(Se.G[3],Se.H[3],W),W.h)break;x[he]=(Fe<<24|Pe<<16|Ee<<8|Xe)>>>0}if(Pe=!1,++he,++U>=E&&(U=0,++B,L!=null&&B<=R&&!(B%16)&&L(m,B),ie!=null))for(;pe<he;)Ee=x[pe++],ie.X[(506832829*Ee&4294967295)>>>ie.Mb]=Ee}else if(280>Ee){if(Ee=Xa(Ee-256,W),Xe=Xn(Se.G[4],Se.H[4],W),ee(W),Xe=wi(E,Xe=Xa(Xe,W)),W.h)break;if(he-N<Xe||P-he<Ee)break e;for(Fe=0;Fe<Ee;++Fe)x[he+Fe]=x[he+Fe-Xe];for(he+=Ee,U+=Ee;U>=E;)U-=E,++B,L!=null&&B<=R&&!(B%16)&&L(m,B);if(e(he<=P),U&le&&(Se=Br(ae,U,B)),ie!=null)for(;pe<he;)Ee=x[pe++],ie.X[(506832829*Ee&4294967295)>>>ie.Mb]=Ee}else{if(!(Ee<Ae))break e;for(Pe=Ee-280,e(ie!=null);pe<he;)Ee=x[pe++],ie.X[(506832829*Ee&4294967295)>>>ie.Mb]=Ee;Ee=he,e(!(Pe>>>(Xe=ie).Xa)),x[Ee]=Xe.X[Pe],Pe=!0}Pe||e(W.h==V(W))}if(m.Pb&&W.h&&he<P)e(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&we(m.s.vb,m.s.Wa);else{if(W.h)break e;L?.(m,B>R?R:B),m.a=0,m.$=he-N}return 1}return m.a=3,0}function _i(m){e(m!=null),m.vc=null,m.yc=null,m.Ya=null;var x=m.Wa;x!=null&&(x.X=null),m.vb=null,e(m!=null)}function ja(){var m=new x0;return m==null?null:(m.a=0,m.xb=iv,Aa("Predictor","VP8LPredictors"),Aa("Predictor","VP8LPredictors_C"),Aa("PredictorAdd","VP8LPredictorsAdd"),Aa("PredictorAdd","VP8LPredictorsAdd_C"),yd=At,fs=it,Jn=ze,Un=Qr,go=Mt,Yi=fa,Ki=Yt,T.VP8LMapColor32b=gc,T.VP8LMapColor8b=wd,m)}function Ci(m,x,N,E,P){var R=1,L=[m],B=[x],U=E.m,W=E.s,ae=null,he=0;e:for(;;){if(N)for(;R&&ge(U,1);){var pe=L,ue=B,Ae=E,be=1,ie=Ae.m,le=Ae.gc[Ae.ab],Se=ge(ie,2);if(Ae.Oc&1<<Se)R=0;else{switch(Ae.Oc|=1<<Se,le.hc=Se,le.Ea=pe[0],le.nc=ue[0],le.K=[null],++Ae.ab,e(4>=Ae.ab),Se){case 0:case 1:le.b=ge(ie,3)+2,be=Ci(Ze(le.Ea,le.b),Ze(le.nc,le.b),0,Ae,le.K),le.K=le.K[0];break;case 3:var Pe,Ee=ge(ie,8)+1,Xe=16<Ee?0:4<Ee?1:2<Ee?2:3;if(pe[0]=Ze(le.Ea,Xe),le.b=Xe,Pe=be=Ci(Ee,1,0,Ae,le.K)){var Fe,lt=Ee,qe=le,Kt=1<<(8>>qe.b),tr=i(Kt);if(tr==null)Pe=0;else{var qt=qe.K[0],kt=qe.w;for(tr[0]=qe.K[0][0],Fe=1;Fe<1*lt;++Fe)tr[Fe]=je(qt[kt+Fe],tr[Fe-1]);for(;Fe<4*Kt;++Fe)tr[Fe]=0;qe.K[0]=null,qe.K[0]=tr,Pe=1}}be=Pe;break;case 2:break;default:e(0)}R=be}}if(L=L[0],B=B[0],R&&ge(U,1)&&!(R=1<=(he=ge(U,4))&&11>=he)){E.a=3;break e}var ur;if(ur=R)t:{var or,Et,Ur,ea=E,qr=L,ta=B,rr=he,ga=N,va=ea.m,fn=ea.s,Cn=[null],Vn=1,Ma=0,Ai=iC[rr];r:for(;;){if(ga&&ge(va,1)){var hn=ge(va,3)+2,Ji=Ze(qr,hn),vs=Ze(ta,hn),wc=Ji*vs;if(!Ci(Ji,vs,0,ea,Cn))break r;for(Cn=Cn[0],fn.xc=hn,or=0;or<wc;++or){var wo=Cn[or]>>8&65535;Cn[or]=wo,wo>=Vn&&(Vn=wo+1)}}if(va.h)break r;for(Et=0;5>Et;++Et){var jr=nv[Et];!Et&&0<rr&&(jr+=1<<rr),Ma<jr&&(Ma=jr)}var j0=o(Vn*Ai,k),pv=Vn,mv=o(pv,X);if(mv==null)var Od=null;else e(65536>=pv),Od=mv;var Hl=i(Ma);if(Od==null||Hl==null||j0==null){ea.a=1;break r}var kd=j0;for(or=Ur=0;or<Vn;++or){var ai=Od[or],_c=ai.G,Cc=ai.H,gv=0,Md=1,vv=0;for(Et=0;5>Et;++Et){jr=nv[Et],_c[Et]=kd,Cc[Et]=Ur,!Et&&0<rr&&(jr+=1<<rr);a:{var Rd,P0=jr,Ld=ea,Wl=Hl,EC=kd,AC=Ur,D0=0,_o=Ld.m,jC=ge(_o,1);if(a(Wl,0,0,P0),jC){var PC=ge(_o,1)+1,DC=ge(_o,1),xv=ge(_o,DC==0?1:8);Wl[xv]=1,PC==2&&(Wl[xv=ge(_o,8)]=1);var Fd=1}else{var yv=i(19),bv=ge(_o,4)+4;if(19<bv){Ld.a=3;var Bd=0;break a}for(Rd=0;Rd<bv;++Rd)yv[nC[Rd]]=ge(_o,3);var I0=void 0,Gl=void 0,wv=Ld,IC=yv,$d=P0,_v=Wl,T0=0,Co=wv.m,Cv=8,Nv=o(128,k);n:for(;O(Nv,0,7,IC,19);){if(ge(Co,1)){var TC=2+2*ge(Co,3);if((I0=2+ge(Co,TC))>$d)break n}else I0=$d;for(Gl=0;Gl<$d&&I0--;){ee(Co);var Sv=Nv[0+(127&$(Co))];K(Co,Co.u+Sv.g);var Nc=Sv.value;if(16>Nc)_v[Gl++]=Nc,Nc!=0&&(Cv=Nc);else{var OC=Nc==16,Ev=Nc-16,kC=tC[Ev],Av=ge(Co,eC[Ev])+kC;if(Gl+Av>$d)break n;for(var MC=OC?Cv:0;0<Av--;)_v[Gl++]=MC}}T0=1;break n}T0||(wv.a=3),Fd=T0}(Fd=Fd&&!_o.h)&&(D0=O(EC,AC,8,Wl,P0)),Fd&&D0!=0?Bd=D0:(Ld.a=3,Bd=0)}if(Bd==0)break r;if(Md&&rC[Et]==1&&(Md=kd[Ur].g==0),gv+=kd[Ur].g,Ur+=Bd,3>=Et){var Yl,O0=Hl[0];for(Yl=1;Yl<jr;++Yl)Hl[Yl]>O0&&(O0=Hl[Yl]);vv+=O0}}if(ai.nd=Md,ai.Qb=0,Md&&(ai.qb=(_c[3][Cc[3]+0].value<<24|_c[1][Cc[1]+0].value<<16|_c[2][Cc[2]+0].value)>>>0,gv==0&&256>_c[0][Cc[0]+0].value&&(ai.Qb=1,ai.qb+=_c[0][Cc[0]+0].value<<8)),ai.jc=!ai.Qb&&6>vv,ai.jc){var Ud,eo=ai;for(Ud=0;Ud<_n;++Ud){var No=Ud,So=eo.pd[No],qd=eo.G[0][eo.H[0]+No];256<=qd.value?(So.g=qd.g+256,So.value=qd.value):(So.g=0,So.value=0,No>>=Zr(qd,8,So),No>>=Zr(eo.G[1][eo.H[1]+No],16,So),No>>=Zr(eo.G[2][eo.H[2]+No],0,So),Zr(eo.G[3][eo.H[3]+No],24,So))}}}fn.vc=Cn,fn.Wb=Vn,fn.Ya=Od,fn.yc=j0,ur=1;break t}ur=0}if(!(R=ur)){E.a=3;break e}if(0<he){if(W.ua=1<<he,!ct(W.Wa,he)){E.a=1,R=0;break e}}else W.ua=0;var k0=E,jv=L,RC=B,M0=k0.s,R0=M0.xc;if(k0.c=jv,k0.i=RC,M0.md=Ze(jv,R0),M0.wc=R0==0?-1:(1<<R0)-1,N){E.xb=hC;break e}if((ae=i(L*B))==null){E.a=1,R=0;break e}R=(R=Ja(E,ae,0,L,B,B,null))&&!U.h;break e}return R?(P!=null?P[0]=ae:(e(ae==null),e(N)),E.$=0,N||_i(W)):_i(W),R}function ss(m,x){var N=m.c*m.i,E=N+x+16*x;return e(m.c<=x),m.V=i(E),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+N+x,1)}function Qs(m,x){var N=m.C,E=x-N,P=m.V,R=m.Ba+m.c*N;for(e(x<=m.l.o);0<E;){var L=16<E?16:E,B=m.l.ma,U=m.l.width,W=U*L,ae=B.ca,he=B.tb+U*N,pe=m.Ta,ue=m.Ua;ha(m,L,P,R),Or(pe,ue,ae,he,W),Qa(B,N,N+L,ae,he,U),E-=L,P+=L*m.c,N+=L}e(N==x),m.C=m.Ma=x}function Zs(){this.ub=this.yd=this.td=this.Rb=0}function Js(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ec(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Ju(){this.Yb=function(){var m=[];return function x(N,E,P){for(var R=P[E],L=0;L<R&&(N.push(P.length>E+1?[]:0),!(P.length<E+1));L++)x(N[L],E+1,P)}(m,0,[3,11]),m}()}function Kh(){this.jb=i(3),this.Wc=s([4,8],Ju),this.Xc=s([4,17],Ju)}function Xh(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function tc(){this.ld=this.La=this.dd=this.tc=0}function ed(){this.Na=this.la=0}function Qh(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function yl(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Zh(){this.uc=this.M=this.Nb=0,this.wa=Array(new tc),this.Y=0,this.ya=Array(new yl),this.aa=0,this.l=new rc}function td(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Jh(){this.cb=this.a=0,this.sc="",this.m=new ye,this.Od=new Zs,this.Kc=new Js,this.ed=new Xh,this.Qa=new ec,this.Ic=this.$c=this.Aa=0,this.D=new Zh,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,ye),this.ia=0,this.pb=o(4,Qh),this.Pa=new Kh,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new td),this.Hd=0,this.rb=Array(new ed),this.sb=0,this.wa=Array(new tc),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new yl),this.L=this.aa=0,this.gd=s([4,2],tc),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function rc(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function e0(){var m=new Jh;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,Vl||(Vl=ad)),m}function Ir(m,x,N){return m.a==0&&(m.a=x,m.sc=N,m.cb=0),0}function rd(m,x,N){return 3<=N&&m[x+0]==157&&m[x+1]==1&&m[x+2]==42}function nd(m,x){if(m==null)return 0;if(m.a=0,m.sc="OK",x==null)return Ir(m,2,"null VP8Io passed to VP8GetHeaders()");var N=x.data,E=x.w,P=x.ha;if(4>P)return Ir(m,7,"Truncated header.");var R=N[E+0]|N[E+1]<<8|N[E+2]<<16,L=m.Od;if(L.Rb=!(1&R),L.td=R>>1&7,L.yd=R>>4&1,L.ub=R>>5,3<L.td)return Ir(m,3,"Incorrect keyframe parameters.");if(!L.yd)return Ir(m,4,"Frame not displayable.");E+=3,P-=3;var B=m.Kc;if(L.Rb){if(7>P)return Ir(m,7,"cannot parse picture header");if(!rd(N,E,P))return Ir(m,3,"Bad code word");B.c=16383&(N[E+4]<<8|N[E+3]),B.Td=N[E+4]>>6,B.i=16383&(N[E+6]<<8|N[E+5]),B.Ud=N[E+6]>>6,E+=7,P-=7,m.za=B.c+15>>4,m.Ub=B.i+15>>4,x.width=B.c,x.height=B.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,a((R=m.Pa).jb,0,255,R.jb.length),e((R=m.Qa)!=null),R.Cb=0,R.Bb=0,R.Fb=1,a(R.Zb,0,0,R.Zb.length),a(R.Lb,0,0,R.Lb)}if(L.ub>P)return Ir(m,7,"bad partition length");ce(R=m.m,N,E,L.ub),E+=L.ub,P-=L.ub,L.Rb&&(B.Ld=fe(R),B.Kd=fe(R)),B=m.Qa;var U,W=m.Pa;if(e(R!=null),e(B!=null),B.Cb=fe(R),B.Cb){if(B.Bb=fe(R),fe(R)){for(B.Fb=fe(R),U=0;4>U;++U)B.Zb[U]=fe(R)?re(R,7):0;for(U=0;4>U;++U)B.Lb[U]=fe(R)?re(R,6):0}if(B.Bb)for(U=0;3>U;++U)W.jb[U]=fe(R)?Q(R,8):255}else B.Bb=0;if(R.Ka)return Ir(m,3,"cannot parse segment header");if((B=m.ed).zd=fe(R),B.Tb=Q(R,6),B.wb=Q(R,3),B.Pc=fe(R),B.Pc&&fe(R)){for(W=0;4>W;++W)fe(R)&&(B.vd[W]=re(R,6));for(W=0;4>W;++W)fe(R)&&(B.od[W]=re(R,6))}if(m.L=B.Tb==0?0:B.zd?1:2,R.Ka)return Ir(m,3,"cannot parse filter header");var ae=P;if(P=U=E,E=U+ae,B=ae,m.Xb=(1<<Q(m.m,2))-1,ae<3*(W=m.Xb))N=7;else{for(U+=3*W,B-=3*W,ae=0;ae<W;++ae){var he=N[P+0]|N[P+1]<<8|N[P+2]<<16;he>B&&(he=B),ce(m.Jc[+ae],N,U,he),U+=he,B-=he,P+=3}ce(m.Jc[+W],N,U,B),N=U<E?0:5}if(N!=0)return Ir(m,N,"cannot parse partitions");for(N=Q(U=m.m,7),P=fe(U)?re(U,4):0,E=fe(U)?re(U,4):0,B=fe(U)?re(U,4):0,W=fe(U)?re(U,4):0,U=fe(U)?re(U,4):0,ae=m.Qa,he=0;4>he;++he){if(ae.Cb){var pe=ae.Zb[he];ae.Fb||(pe+=N)}else{if(0<he){m.pb[he]=m.pb[0];continue}pe=N}var ue=m.pb[he];ue.Sc[0]=S0[pa(pe+P,127)],ue.Sc[1]=E0[pa(pe+0,127)],ue.Eb[0]=2*S0[pa(pe+E,127)],ue.Eb[1]=101581*E0[pa(pe+B,127)]>>16,8>ue.Eb[1]&&(ue.Eb[1]=8),ue.Qc[0]=S0[pa(pe+W,117)],ue.Qc[1]=E0[pa(pe+U,127)],ue.lc=pe+U}if(!L.Rb)return Ir(m,4,"Not a key frame.");for(fe(R),L=m.Pa,N=0;4>N;++N){for(P=0;8>P;++P)for(E=0;3>E;++E)for(B=0;11>B;++B)W=ve(R,dC[N][P][E][B])?Q(R,8):lC[N][P][E][B],L.Wc[N][P].Yb[E][B]=W;for(P=0;17>P;++P)L.Xc[N][P]=L.Wc[N][fC[P]]}return m.kc=fe(R),m.kc&&(m.Bd=Q(R,8)),m.cb=1}function ad(m,x,N,E,P,R,L){var B=x[P].Yb[N];for(N=0;16>P;++P){if(!ve(m,B[N+0]))return P;for(;!ve(m,B[N+1]);)if(B=x[++P].Yb[0],N=0,P==16)return 16;var U=x[P+1].Yb;if(ve(m,B[N+2])){var W=m,ae=0;if(ve(W,(pe=B)[(he=N)+3]))if(ve(W,pe[he+6])){for(B=0,he=2*(ae=ve(W,pe[he+8]))+(pe=ve(W,pe[he+9+ae])),ae=0,pe=sC[he];pe[B];++B)ae+=ae+ve(W,pe[B]);ae+=3+(8<<he)}else ve(W,pe[he+7])?(ae=7+2*ve(W,165),ae+=ve(W,145)):ae=5+ve(W,159);else ae=ve(W,pe[he+4])?3+ve(W,pe[he+5]):2;B=U[2]}else ae=1,B=U[1];U=L+cC[P],0>(W=m).b&&oe(W);var he,pe=W.b,ue=(he=W.Ca>>1)-(W.I>>pe)>>31;--W.b,W.Ca+=ue,W.Ca|=1,W.I-=(he+1&ue)<<pe,R[U]=((ae^ue)-ue)*E[(0<P)+0]}return 16}function bl(m){var x=m.rb[m.sb-1];x.la=0,x.Na=0,a(m.zc,0,0,m.zc.length),m.ja=0}function t0(m,x){if(m==null)return 0;if(x==null)return Ir(m,2,"NULL VP8Io parameter in VP8Decode().");if(!m.cb&&!nd(m,x))return 0;if(e(m.cb),x.ac==null||x.ac(x)){x.ob&&(m.L=0);var N=Td[m.L];if(m.L==2?(m.yb=0,m.zb=0):(m.yb=x.v-N>>4,m.zb=x.j-N>>4,0>m.yb&&(m.yb=0),0>m.zb&&(m.zb=0)),m.Va=x.o+15+N>>4,m.Hb=x.va+15+N>>4,m.Hb>m.za&&(m.Hb=m.za),m.Va>m.Ub&&(m.Va=m.Ub),0<m.L){var E=m.ed;for(N=0;4>N;++N){var P;if(m.Qa.Cb){var R=m.Qa.Lb[N];m.Qa.Fb||(R+=E.Tb)}else R=E.Tb;for(P=0;1>=P;++P){var L=m.gd[N][P],B=R;if(E.Pc&&(B+=E.vd[0],P&&(B+=E.od[0])),0<(B=0>B?0:63<B?63:B)){var U=B;0<E.wb&&(U=4<E.wb?U>>2:U>>1)>9-E.wb&&(U=9-E.wb),1>U&&(U=1),L.dd=U,L.tc=2*B+U,L.ld=40<=B?2:15<=B?1:0}else L.tc=0;L.La=P}}}N=0}else Ir(m,6,"Frame setup failed"),N=m.a;if(N=N==0){if(N){m.$c=0,0<m.Aa||(m.Ic=SC);e:{N=m.Ic,E=4*(U=m.za);var W=32*U,ae=U+1,he=0<m.L?U*(0<m.Aa?2:1):0,pe=(m.Aa==2?2:1)*U;if((L=E+832+(P=3*(16*N+Td[m.L])/2*W)+(R=m.Fa!=null&&0<m.Fa.length?m.Kc.c*m.Kc.i:0))!=L)N=0;else{if(L>m.Vb){if(m.Vb=0,m.Ec=i(L),m.Fc=0,m.Ec==null){N=Ir(m,1,"no memory during frame initialization.");break e}m.Vb=L}L=m.Ec,B=m.Fc,m.Ac=L,m.Bc=B,B+=E,m.Gd=o(W,td),m.Hd=0,m.rb=o(ae+1,ed),m.sb=1,m.wa=he?o(he,tc):null,m.Y=0,m.D.Nb=0,m.D.wa=m.wa,m.D.Y=m.Y,0<m.Aa&&(m.D.Y+=U),e(!0),m.oc=L,m.pc=B,B+=832,m.ya=o(pe,yl),m.aa=0,m.D.ya=m.ya,m.D.aa=m.aa,m.Aa==2&&(m.D.aa+=U),m.R=16*U,m.B=8*U,U=(W=Td[m.L])*m.R,W=W/2*m.B,m.sa=L,m.ta=B+U,m.qa=m.sa,m.ra=m.ta+16*N*m.R+W,m.Ha=m.qa,m.Ia=m.ra+8*N*m.B+W,m.$c=0,B+=P,m.mb=R?L:null,m.nb=R?B:null,e(B+R<=m.Fc+m.Vb),bl(m),a(m.Ac,m.Bc,0,E),N=1}}if(N){if(x.ka=0,x.y=m.sa,x.O=m.ta,x.f=m.qa,x.N=m.ra,x.ea=m.Ha,x.Vd=m.Ia,x.fa=m.R,x.Rc=m.B,x.F=null,x.J=0,!Cd){for(N=-255;255>=N;++N)Jr[255+N]=0>N?-N:N;for(N=-1020;1020>=N;++N)Qi[1020+N]=-128>N?-128:127<N?127:N;for(N=-112;112>=N;++N)ql[112+N]=-16>N?-16:15<N?15:N;for(N=-255;510>=N;++N)bc[255+N]=0>N?0:255<N?255:N;Cd=1}vc=a0,Xi=r0,Bl=od,qn=n0,Da=sd,Tr=id,xc=El,_d=us,$l=v0,hs=Al,ps=g0,vo=cc,ms=jl,yc=gd,gs=md,xo=Si,Ul=Gi,Ia=m0,ni[0]=Ni,ni[1]=i0,ni[2]=l0,ni[3]=u0,ni[4]=ud,ni[5]=oc,ni[6]=dd,ni[7]=Cl,ni[8]=f0,ni[9]=d0,yo[0]=cd,yo[1]=s0,yo[2]=Wi,yo[3]=ac,yo[4]=An,yo[5]=c0,yo[6]=ld,Zi[0]=fo,Zi[1]=o0,Zi[2]=h0,Zi[3]=Nl,Zi[4]=ls,Zi[5]=p0,Zi[6]=Sl,N=1}else N=0}N&&(N=function(ue,Ae){for(ue.M=0;ue.M<ue.Va;++ue.M){var be,ie=ue.Jc[ue.M&ue.Xb],le=ue.m,Se=ue;for(be=0;be<Se.za;++be){var Pe=le,Ee=Se,Xe=Ee.Ac,Fe=Ee.Bc+4*be,lt=Ee.zc,qe=Ee.ya[Ee.aa+be];if(Ee.Qa.Bb?qe.$b=ve(Pe,Ee.Pa.jb[0])?2+ve(Pe,Ee.Pa.jb[2]):ve(Pe,Ee.Pa.jb[1]):qe.$b=0,Ee.kc&&(qe.Ad=ve(Pe,Ee.Bd)),qe.Za=!ve(Pe,145)+0,qe.Za){var Kt=qe.Ob,tr=0;for(Ee=0;4>Ee;++Ee){var qt,kt=lt[0+Ee];for(qt=0;4>qt;++qt){kt=uC[Xe[Fe+qt]][kt];for(var ur=av[ve(Pe,kt[0])];0<ur;)ur=av[2*ur+ve(Pe,kt[ur])];kt=-ur,Xe[Fe+qt]=kt}n(Kt,tr,Xe,Fe,4),tr+=4,lt[0+Ee]=kt}}else kt=ve(Pe,156)?ve(Pe,128)?1:3:ve(Pe,163)?2:0,qe.Ob[0]=kt,a(Xe,Fe,kt,4),a(lt,0,kt,4);qe.Dd=ve(Pe,142)?ve(Pe,114)?ve(Pe,183)?1:3:2:0}if(Se.m.Ka)return Ir(ue,7,"Premature end-of-partition0 encountered.");for(;ue.ja<ue.za;++ue.ja){if(Se=ie,Pe=(le=ue).rb[le.sb-1],Xe=le.rb[le.sb+le.ja],be=le.ya[le.aa+le.ja],Fe=le.kc?be.Ad:0)Pe.la=Xe.la=0,be.Za||(Pe.Na=Xe.Na=0),be.Hc=0,be.Gc=0,be.ia=0;else{var or,Et;if(Pe=Xe,Xe=Se,Fe=le.Pa.Xc,lt=le.ya[le.aa+le.ja],qe=le.pb[lt.$b],Ee=lt.ad,Kt=0,tr=le.rb[le.sb-1],kt=qt=0,a(Ee,Kt,0,384),lt.Za)var Ur=0,ea=Fe[3];else{ur=i(16);var qr=Pe.Na+tr.Na;if(qr=Vl(Xe,Fe[1],qr,qe.Eb,0,ur,0),Pe.Na=tr.Na=(0<qr)+0,1<qr)vc(ur,0,Ee,Kt);else{var ta=ur[0]+3>>3;for(ur=0;256>ur;ur+=16)Ee[Kt+ur]=ta}Ur=1,ea=Fe[0]}var rr=15&Pe.la,ga=15&tr.la;for(ur=0;4>ur;++ur){var va=1&ga;for(ta=Et=0;4>ta;++ta)rr=rr>>1|(va=(qr=Vl(Xe,ea,qr=va+(1&rr),qe.Sc,Ur,Ee,Kt))>Ur)<<7,Et=Et<<2|(3<qr?3:1<qr?2:Ee[Kt+0]!=0),Kt+=16;rr>>=4,ga=ga>>1|va<<7,qt=(qt<<8|Et)>>>0}for(ea=rr,Ur=ga>>4,or=0;4>or;or+=2){for(Et=0,rr=Pe.la>>4+or,ga=tr.la>>4+or,ur=0;2>ur;++ur){for(va=1&ga,ta=0;2>ta;++ta)qr=va+(1&rr),rr=rr>>1|(va=0<(qr=Vl(Xe,Fe[2],qr,qe.Qc,0,Ee,Kt)))<<3,Et=Et<<2|(3<qr?3:1<qr?2:Ee[Kt+0]!=0),Kt+=16;rr>>=2,ga=ga>>1|va<<5}kt|=Et<<4*or,ea|=rr<<4<<or,Ur|=(240&ga)<<or}Pe.la=ea,tr.la=Ur,lt.Hc=qt,lt.Gc=kt,lt.ia=43690&kt?0:qe.ia,Fe=!(qt|kt)}if(0<le.L&&(le.wa[le.Y+le.ja]=le.gd[be.$b][be.Za],le.wa[le.Y+le.ja].La|=!Fe),Se.Ka)return Ir(ue,7,"Premature end-of-file encountered.")}if(bl(ue),le=Ae,Se=1,be=(ie=ue).D,Pe=0<ie.L&&ie.M>=ie.zb&&ie.M<=ie.Va,ie.Aa==0)e:{if(be.M=ie.M,be.uc=Pe,kl(ie,be),Se=1,be=(Et=ie.D).Nb,Pe=(kt=Td[ie.L])*ie.R,Xe=kt/2*ie.B,ur=16*be*ie.R,ta=8*be*ie.B,Fe=ie.sa,lt=ie.ta-Pe+ur,qe=ie.qa,Ee=ie.ra-Xe+ta,Kt=ie.Ha,tr=ie.Ia-Xe+ta,ga=(rr=Et.M)==0,qt=rr>=ie.Va-1,ie.Aa==2&&kl(ie,Et),Et.uc)for(va=(qr=ie).D.M,e(qr.D.uc),Et=qr.yb;Et<qr.Hb;++Et){Ur=Et,ea=va;var fn=(Cn=(jr=qr).D).Nb;or=jr.R;var Cn=Cn.wa[Cn.Y+Ur],Vn=jr.sa,Ma=jr.ta+16*fn*or+16*Ur,Ai=Cn.dd,hn=Cn.tc;if(hn!=0)if(e(3<=hn),jr.L==1)0<Ur&&xo(Vn,Ma,or,hn+4),Cn.La&&Ia(Vn,Ma,or,hn),0<ea&&gs(Vn,Ma,or,hn+4),Cn.La&&Ul(Vn,Ma,or,hn);else{var Ji=jr.B,vs=jr.qa,wc=jr.ra+8*fn*Ji+8*Ur,wo=jr.Ha,jr=jr.Ia+8*fn*Ji+8*Ur;fn=Cn.ld,0<Ur&&(_d(Vn,Ma,or,hn+4,Ai,fn),hs(vs,wc,wo,jr,Ji,hn+4,Ai,fn)),Cn.La&&(vo(Vn,Ma,or,hn,Ai,fn),yc(vs,wc,wo,jr,Ji,hn,Ai,fn)),0<ea&&(xc(Vn,Ma,or,hn+4,Ai,fn),$l(vs,wc,wo,jr,Ji,hn+4,Ai,fn)),Cn.La&&(ps(Vn,Ma,or,hn,Ai,fn),ms(vs,wc,wo,jr,Ji,hn,Ai,fn))}}if(ie.ia&&alert("todo:DitherRow"),le.put!=null){if(Et=16*rr,rr=16*(rr+1),ga?(le.y=ie.sa,le.O=ie.ta+ur,le.f=ie.qa,le.N=ie.ra+ta,le.ea=ie.Ha,le.W=ie.Ia+ta):(Et-=kt,le.y=Fe,le.O=lt,le.f=qe,le.N=Ee,le.ea=Kt,le.W=tr),qt||(rr-=kt),rr>le.o&&(rr=le.o),le.F=null,le.J=null,ie.Fa!=null&&0<ie.Fa.length&&Et<rr&&(le.J=Tl(ie,le,Et,rr-Et),le.F=ie.mb,le.F==null&&le.F.length==0)){Se=Ir(ie,3,"Could not decode alpha data.");break e}Et<le.j&&(kt=le.j-Et,Et=le.j,e(!(1&kt)),le.O+=ie.R*kt,le.N+=ie.B*(kt>>1),le.W+=ie.B*(kt>>1),le.F!=null&&(le.J+=le.width*kt)),Et<rr&&(le.O+=le.v,le.N+=le.v>>1,le.W+=le.v>>1,le.F!=null&&(le.J+=le.v),le.ka=Et-le.j,le.U=le.va-le.v,le.T=rr-Et,Se=le.put(le))}be+1!=ie.Ic||qt||(n(ie.sa,ie.ta-Pe,Fe,lt+16*ie.R,Pe),n(ie.qa,ie.ra-Xe,qe,Ee+8*ie.B,Xe),n(ie.Ha,ie.Ia-Xe,Kt,tr+8*ie.B,Xe))}if(!Se)return Ir(ue,6,"Output aborted.")}return 1}(m,x)),x.bc!=null&&x.bc(x),N&=1}return N?(m.cb=0,N):0}function ei(m,x,N,E,P){P=m[x+N+32*E]+(P>>3),m[x+N+32*E]=-256&P?0>P?0:255:P}function nc(m,x,N,E,P,R){ei(m,x,0,N,E+P),ei(m,x,1,N,E+R),ei(m,x,2,N,E-R),ei(m,x,3,N,E-P)}function Qn(m){return(20091*m>>16)+m}function wl(m,x,N,E){var P,R=0,L=i(16);for(P=0;4>P;++P){var B=m[x+0]+m[x+8],U=m[x+0]-m[x+8],W=(35468*m[x+4]>>16)-Qn(m[x+12]),ae=Qn(m[x+4])+(35468*m[x+12]>>16);L[R+0]=B+ae,L[R+1]=U+W,L[R+2]=U-W,L[R+3]=B-ae,R+=4,x++}for(P=R=0;4>P;++P)B=(m=L[R+0]+4)+L[R+8],U=m-L[R+8],W=(35468*L[R+4]>>16)-Qn(L[R+12]),ei(N,E,0,0,B+(ae=Qn(L[R+4])+(35468*L[R+12]>>16))),ei(N,E,1,0,U+W),ei(N,E,2,0,U-W),ei(N,E,3,0,B-ae),R++,E+=32}function id(m,x,N,E){var P=m[x+0]+4,R=35468*m[x+4]>>16,L=Qn(m[x+4]),B=35468*m[x+1]>>16;nc(N,E,0,P+L,m=Qn(m[x+1]),B),nc(N,E,1,P+R,m,B),nc(N,E,2,P-R,m,B),nc(N,E,3,P-L,m,B)}function r0(m,x,N,E,P){wl(m,x,N,E),P&&wl(m,x+16,N,E+4)}function od(m,x,N,E){Xi(m,x+0,N,E,1),Xi(m,x+32,N,E+128,1)}function n0(m,x,N,E){var P;for(m=m[x+0]+4,P=0;4>P;++P)for(x=0;4>x;++x)ei(N,E,x,P,m)}function sd(m,x,N,E){m[x+0]&&qn(m,x+0,N,E),m[x+16]&&qn(m,x+16,N,E+4),m[x+32]&&qn(m,x+32,N,E+128),m[x+48]&&qn(m,x+48,N,E+128+4)}function a0(m,x,N,E){var P,R=i(16);for(P=0;4>P;++P){var L=m[x+0+P]+m[x+12+P],B=m[x+4+P]+m[x+8+P],U=m[x+4+P]-m[x+8+P],W=m[x+0+P]-m[x+12+P];R[0+P]=L+B,R[8+P]=L-B,R[4+P]=W+U,R[12+P]=W-U}for(P=0;4>P;++P)L=(m=R[0+4*P]+3)+R[3+4*P],B=R[1+4*P]+R[2+4*P],U=R[1+4*P]-R[2+4*P],W=m-R[3+4*P],N[E+0]=L+B>>3,N[E+16]=W+U>>3,N[E+32]=L-B>>3,N[E+48]=W-U>>3,E+=64}function _l(m,x,N){var E,P=x-32,R=ma,L=255-m[P-1];for(E=0;E<N;++E){var B,U=R,W=L+m[x-1];for(B=0;B<N;++B)m[x+B]=U[W+m[P+B]];x+=32}}function i0(m,x){_l(m,x,4)}function o0(m,x){_l(m,x,8)}function s0(m,x){_l(m,x,16)}function Wi(m,x){var N;for(N=0;16>N;++N)n(m,x+32*N,m,x-32,16)}function ac(m,x){var N;for(N=16;0<N;--N)a(m,x,m[x-1],16),x+=32}function ic(m,x,N){var E;for(E=0;16>E;++E)a(x,N+32*E,m,16)}function cd(m,x){var N,E=16;for(N=0;16>N;++N)E+=m[x-1+32*N]+m[x+N-32];ic(E>>5,m,x)}function An(m,x){var N,E=8;for(N=0;16>N;++N)E+=m[x-1+32*N];ic(E>>4,m,x)}function c0(m,x){var N,E=8;for(N=0;16>N;++N)E+=m[x+N-32];ic(E>>4,m,x)}function ld(m,x){ic(128,m,x)}function xt(m,x,N){return m+2*x+N+2>>2}function l0(m,x){var N,E=x-32;for(E=new Uint8Array([xt(m[E-1],m[E+0],m[E+1]),xt(m[E+0],m[E+1],m[E+2]),xt(m[E+1],m[E+2],m[E+3]),xt(m[E+2],m[E+3],m[E+4])]),N=0;4>N;++N)n(m,x+32*N,E,0,E.length)}function u0(m,x){var N=m[x-1],E=m[x-1+32],P=m[x-1+64],R=m[x-1+96];Ie(m,x+0,16843009*xt(m[x-1-32],N,E)),Ie(m,x+32,16843009*xt(N,E,P)),Ie(m,x+64,16843009*xt(E,P,R)),Ie(m,x+96,16843009*xt(P,R,R))}function Ni(m,x){var N,E=4;for(N=0;4>N;++N)E+=m[x+N-32]+m[x-1+32*N];for(E>>=3,N=0;4>N;++N)a(m,x+32*N,E,4)}function ud(m,x){var N=m[x-1+0],E=m[x-1+32],P=m[x-1+64],R=m[x-1-32],L=m[x+0-32],B=m[x+1-32],U=m[x+2-32],W=m[x+3-32];m[x+0+96]=xt(E,P,m[x-1+96]),m[x+1+96]=m[x+0+64]=xt(N,E,P),m[x+2+96]=m[x+1+64]=m[x+0+32]=xt(R,N,E),m[x+3+96]=m[x+2+64]=m[x+1+32]=m[x+0+0]=xt(L,R,N),m[x+3+64]=m[x+2+32]=m[x+1+0]=xt(B,L,R),m[x+3+32]=m[x+2+0]=xt(U,B,L),m[x+3+0]=xt(W,U,B)}function dd(m,x){var N=m[x+1-32],E=m[x+2-32],P=m[x+3-32],R=m[x+4-32],L=m[x+5-32],B=m[x+6-32],U=m[x+7-32];m[x+0+0]=xt(m[x+0-32],N,E),m[x+1+0]=m[x+0+32]=xt(N,E,P),m[x+2+0]=m[x+1+32]=m[x+0+64]=xt(E,P,R),m[x+3+0]=m[x+2+32]=m[x+1+64]=m[x+0+96]=xt(P,R,L),m[x+3+32]=m[x+2+64]=m[x+1+96]=xt(R,L,B),m[x+3+64]=m[x+2+96]=xt(L,B,U),m[x+3+96]=xt(B,U,U)}function oc(m,x){var N=m[x-1+0],E=m[x-1+32],P=m[x-1+64],R=m[x-1-32],L=m[x+0-32],B=m[x+1-32],U=m[x+2-32],W=m[x+3-32];m[x+0+0]=m[x+1+64]=R+L+1>>1,m[x+1+0]=m[x+2+64]=L+B+1>>1,m[x+2+0]=m[x+3+64]=B+U+1>>1,m[x+3+0]=U+W+1>>1,m[x+0+96]=xt(P,E,N),m[x+0+64]=xt(E,N,R),m[x+0+32]=m[x+1+96]=xt(N,R,L),m[x+1+32]=m[x+2+96]=xt(R,L,B),m[x+2+32]=m[x+3+96]=xt(L,B,U),m[x+3+32]=xt(B,U,W)}function Cl(m,x){var N=m[x+0-32],E=m[x+1-32],P=m[x+2-32],R=m[x+3-32],L=m[x+4-32],B=m[x+5-32],U=m[x+6-32],W=m[x+7-32];m[x+0+0]=N+E+1>>1,m[x+1+0]=m[x+0+64]=E+P+1>>1,m[x+2+0]=m[x+1+64]=P+R+1>>1,m[x+3+0]=m[x+2+64]=R+L+1>>1,m[x+0+32]=xt(N,E,P),m[x+1+32]=m[x+0+96]=xt(E,P,R),m[x+2+32]=m[x+1+96]=xt(P,R,L),m[x+3+32]=m[x+2+96]=xt(R,L,B),m[x+3+64]=xt(L,B,U),m[x+3+96]=xt(B,U,W)}function d0(m,x){var N=m[x-1+0],E=m[x-1+32],P=m[x-1+64],R=m[x-1+96];m[x+0+0]=N+E+1>>1,m[x+2+0]=m[x+0+32]=E+P+1>>1,m[x+2+32]=m[x+0+64]=P+R+1>>1,m[x+1+0]=xt(N,E,P),m[x+3+0]=m[x+1+32]=xt(E,P,R),m[x+3+32]=m[x+1+64]=xt(P,R,R),m[x+3+64]=m[x+2+64]=m[x+0+96]=m[x+1+96]=m[x+2+96]=m[x+3+96]=R}function f0(m,x){var N=m[x-1+0],E=m[x-1+32],P=m[x-1+64],R=m[x-1+96],L=m[x-1-32],B=m[x+0-32],U=m[x+1-32],W=m[x+2-32];m[x+0+0]=m[x+2+32]=N+L+1>>1,m[x+0+32]=m[x+2+64]=E+N+1>>1,m[x+0+64]=m[x+2+96]=P+E+1>>1,m[x+0+96]=R+P+1>>1,m[x+3+0]=xt(B,U,W),m[x+2+0]=xt(L,B,U),m[x+1+0]=m[x+3+32]=xt(N,L,B),m[x+1+32]=m[x+3+64]=xt(E,N,L),m[x+1+64]=m[x+3+96]=xt(P,E,N),m[x+1+96]=xt(R,P,E)}function h0(m,x){var N;for(N=0;8>N;++N)n(m,x+32*N,m,x-32,8)}function Nl(m,x){var N;for(N=0;8>N;++N)a(m,x,m[x-1],8),x+=32}function cs(m,x,N){var E;for(E=0;8>E;++E)a(x,N+32*E,m,8)}function fo(m,x){var N,E=8;for(N=0;8>N;++N)E+=m[x+N-32]+m[x-1+32*N];cs(E>>4,m,x)}function p0(m,x){var N,E=4;for(N=0;8>N;++N)E+=m[x+N-32];cs(E>>3,m,x)}function ls(m,x){var N,E=4;for(N=0;8>N;++N)E+=m[x-1+32*N];cs(E>>3,m,x)}function Sl(m,x){cs(128,m,x)}function sc(m,x,N){var E=m[x-N],P=m[x+0],R=3*(P-E)+b0[1020+m[x-2*N]-m[x+N]],L=Nd[112+(R+4>>3)];m[x-N]=ma[255+E+Nd[112+(R+3>>3)]],m[x+0]=ma[255+P-L]}function fd(m,x,N,E){var P=m[x+0],R=m[x+N];return Oa[255+m[x-2*N]-m[x-N]]>E||Oa[255+R-P]>E}function hd(m,x,N,E){return 4*Oa[255+m[x-N]-m[x+0]]+Oa[255+m[x-2*N]-m[x+N]]<=E}function pd(m,x,N,E,P){var R=m[x-3*N],L=m[x-2*N],B=m[x-N],U=m[x+0],W=m[x+N],ae=m[x+2*N],he=m[x+3*N];return 4*Oa[255+B-U]+Oa[255+L-W]>E?0:Oa[255+m[x-4*N]-R]<=P&&Oa[255+R-L]<=P&&Oa[255+L-B]<=P&&Oa[255+he-ae]<=P&&Oa[255+ae-W]<=P&&Oa[255+W-U]<=P}function md(m,x,N,E){var P=2*E+1;for(E=0;16>E;++E)hd(m,x+E,N,P)&&sc(m,x+E,N)}function Si(m,x,N,E){var P=2*E+1;for(E=0;16>E;++E)hd(m,x+E*N,1,P)&&sc(m,x+E*N,1)}function Gi(m,x,N,E){var P;for(P=3;0<P;--P)md(m,x+=4*N,N,E)}function m0(m,x,N,E){var P;for(P=3;0<P;--P)Si(m,x+=4,N,E)}function ho(m,x,N,E,P,R,L,B){for(R=2*R+1;0<P--;){if(pd(m,x,N,R,L))if(fd(m,x,N,B))sc(m,x,N);else{var U=m,W=x,ae=N,he=U[W-2*ae],pe=U[W-ae],ue=U[W+0],Ae=U[W+ae],be=U[W+2*ae],ie=27*(Se=b0[1020+3*(ue-pe)+b0[1020+he-Ae]])+63>>7,le=18*Se+63>>7,Se=9*Se+63>>7;U[W-3*ae]=ma[255+U[W-3*ae]+Se],U[W-2*ae]=ma[255+he+le],U[W-ae]=ma[255+pe+ie],U[W+0]=ma[255+ue-ie],U[W+ae]=ma[255+Ae-le],U[W+2*ae]=ma[255+be-Se]}x+=E}}function ti(m,x,N,E,P,R,L,B){for(R=2*R+1;0<P--;){if(pd(m,x,N,R,L))if(fd(m,x,N,B))sc(m,x,N);else{var U=m,W=x,ae=N,he=U[W-ae],pe=U[W+0],ue=U[W+ae],Ae=Nd[112+((be=3*(pe-he))+4>>3)],be=Nd[112+(be+3>>3)],ie=Ae+1>>1;U[W-2*ae]=ma[255+U[W-2*ae]+ie],U[W-ae]=ma[255+he+be],U[W+0]=ma[255+pe-Ae],U[W+ae]=ma[255+ue-ie]}x+=E}}function El(m,x,N,E,P,R){ho(m,x,N,1,16,E,P,R)}function us(m,x,N,E,P,R){ho(m,x,1,N,16,E,P,R)}function g0(m,x,N,E,P,R){var L;for(L=3;0<L;--L)ti(m,x+=4*N,N,1,16,E,P,R)}function cc(m,x,N,E,P,R){var L;for(L=3;0<L;--L)ti(m,x+=4,1,N,16,E,P,R)}function v0(m,x,N,E,P,R,L,B){ho(m,x,P,1,8,R,L,B),ho(N,E,P,1,8,R,L,B)}function Al(m,x,N,E,P,R,L,B){ho(m,x,1,P,8,R,L,B),ho(N,E,1,P,8,R,L,B)}function jl(m,x,N,E,P,R,L,B){ti(m,x+4*P,P,1,8,R,L,B),ti(N,E+4*P,P,1,8,R,L,B)}function gd(m,x,N,E,P,R,L,B){ti(m,x+4,1,P,8,R,L,B),ti(N,E+4,1,P,8,R,L,B)}function lc(){this.ba=new Er,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new lr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Pl(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Dl(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function vd(){this.ua=0,this.Wa=new te,this.vb=new te,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new X,this.yc=new k}function x0(){this.xb=this.a=0,this.l=new rc,this.ca=new Er,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new A,this.Pb=0,this.wd=new A,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new vd,this.ab=0,this.gc=o(4,Dl),this.Oc=0}function uc(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new rc,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function ds(m,x,N,E,P,R,L){for(m=m==null?0:m[x+0],x=0;x<L;++x)P[R+x]=m+N[E+x]&255,m=P[R+x]}function Il(m,x,N,E,P,R,L){var B;if(m==null)ds(null,null,N,E,P,R,L);else for(B=0;B<L;++B)P[R+B]=m[x+B]+N[E+B]&255}function po(m,x,N,E,P,R,L){if(m==null)ds(null,null,N,E,P,R,L);else{var B,U=m[x+0],W=U,ae=U;for(B=0;B<L;++B)W=ae+(U=m[x+B])-W,ae=N[E+B]+(-256&W?0>W?0:255:W)&255,W=U,P[R+B]=ae}}function Tl(m,x,N,E){var P=x.width,R=x.o;if(e(m!=null&&x!=null),0>N||0>=E||N+E>R)return null;if(!m.Cc){if(m.ga==null){var L;if(m.ga=new uc,(L=m.ga==null)||(L=x.width*x.o,e(m.Gb.length==0),m.Gb=i(L),m.Uc=0,m.Gb==null?L=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,L=1),L=!L),!L){L=m.ga;var B=m.Fa,U=m.P,W=m.qc,ae=m.mb,he=m.nb,pe=U+1,ue=W-1,Ae=L.l;if(e(B!=null&&ae!=null&&x!=null),bo[0]=null,bo[1]=ds,bo[2]=Il,bo[3]=po,L.ca=ae,L.tb=he,L.c=x.width,L.i=x.height,e(0<L.c&&0<L.i),1>=W)x=0;else if(L.$a=B[U+0]>>0&3,L.Z=B[U+0]>>2&3,L.Lc=B[U+0]>>4&3,U=B[U+0]>>6&3,0>L.$a||1<L.$a||4<=L.Z||1<L.Lc||U)x=0;else if(Ae.put=yi,Ae.ac=wn,Ae.bc=bi,Ae.ma=L,Ae.width=x.width,Ae.height=x.height,Ae.Da=x.Da,Ae.v=x.v,Ae.va=x.va,Ae.j=x.j,Ae.o=x.o,L.$a)e:{e(L.$a==1),x=ja();t:for(;;){if(x==null){x=0;break e}if(e(L!=null),L.mc=x,x.c=L.c,x.i=L.i,x.l=L.l,x.l.ma=L,x.l.width=L.c,x.l.height=L.i,x.a=0,G(x.m,B,pe,ue),!Ci(L.c,L.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&Hi(x.s)?(L.ic=1,B=x.c*x.i,x.Ta=null,x.Ua=0,x.V=i(B),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(L.ic=0,x=ss(x,L.c)),!x))break t;x=1;break e}L.mc=null,x=0}else x=ue>=L.c*L.i;L=!x}if(L)return null;m.ga.Lc!=1?m.Ga=0:E=R-N}e(m.ga!=null),e(N+E<=R);e:{if(x=(B=m.ga).c,R=B.l.o,B.$a==0){if(pe=m.rc,ue=m.Vc,Ae=m.Fa,U=m.P+1+N*x,W=m.mb,ae=m.nb+N*x,e(U<=m.P+m.qc),B.Z!=0)for(e(bo[B.Z]!=null),L=0;L<E;++L)bo[B.Z](pe,ue,Ae,U,W,ae,x),pe=W,ue=ae,ae+=x,U+=x;else for(L=0;L<E;++L)n(W,ae,Ae,U,x),pe=W,ue=ae,ae+=x,U+=x;m.rc=pe,m.Vc=ue}else{if(e(B.mc!=null),x=N+E,e((L=B.mc)!=null),e(x<=L.i),L.C>=x)x=1;else if(B.ic||de(),B.ic){B=L.V,pe=L.Ba,ue=L.c;var be=L.i,ie=(Ae=1,U=L.$/ue,W=L.$%ue,ae=L.m,he=L.s,L.$),le=ue*be,Se=ue*x,Pe=he.wc,Ee=ie<Se?Br(he,W,U):null;e(ie<=le),e(x<=be),e(Hi(he));t:for(;;){for(;!ae.h&&ie<Se;){if(W&Pe||(Ee=Br(he,W,U)),e(Ee!=null),ee(ae),256>(be=Xn(Ee.G[0],Ee.H[0],ae)))B[pe+ie]=be,++ie,++W>=ue&&(W=0,++U<=x&&!(U%16)&&Za(L,U));else{if(!(280>be)){Ae=0;break t}be=Xa(be-256,ae);var Xe,Fe=Xn(Ee.G[4],Ee.H[4],ae);if(ee(ae),!(ie>=(Fe=wi(ue,Fe=Xa(Fe,ae)))&&le-ie>=be)){Ae=0;break t}for(Xe=0;Xe<be;++Xe)B[pe+ie+Xe]=B[pe+ie+Xe-Fe];for(ie+=be,W+=be;W>=ue;)W-=ue,++U<=x&&!(U%16)&&Za(L,U);ie<Se&&W&Pe&&(Ee=Br(he,W,U))}e(ae.h==V(ae))}Za(L,U>x?x:U);break t}!Ae||ae.h&&ie<le?(Ae=0,L.a=ae.h?5:3):L.$=ie,x=Ae}else x=Ja(L,L.V,L.Ba,L.c,L.i,x,Qs);if(!x){E=0;break e}}N+E>=R&&(m.Cc=1),E=1}if(!E)return null;if(m.Cc&&((E=m.ga)!=null&&(E.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+N*P}function _(m,x,N,E,P,R){for(;0<P--;){var L,B=m,U=x+(N?1:0),W=m,ae=x+(N?0:3);for(L=0;L<E;++L){var he=W[ae+4*L];he!=255&&(he*=32897,B[U+4*L+0]=B[U+4*L+0]*he>>23,B[U+4*L+1]=B[U+4*L+1]*he>>23,B[U+4*L+2]=B[U+4*L+2]*he>>23)}x+=R}}function I(m,x,N,E,P){for(;0<E--;){var R;for(R=0;R<N;++R){var L=m[x+2*R+0],B=15&(W=m[x+2*R+1]),U=4369*B,W=(240&W|W>>4)*U>>16;m[x+2*R+0]=(240&L|L>>4)*U>>16&240|(15&L|L<<4)*U>>16>>4&15,m[x+2*R+1]=240&W|B}x+=P}}function Z(m,x,N,E,P,R,L,B){var U,W,ae=255;for(W=0;W<P;++W){for(U=0;U<E;++U){var he=m[x+U];R[L+4*U]=he,ae&=he}x+=N,L+=B}return ae!=255}function ne(m,x,N,E,P){var R;for(R=0;R<P;++R)N[E+R]=m[x+R]>>8}function de(){Ta=_,fr=I,hr=Z,Or=ne}function _e(m,x,N){T[m]=function(E,P,R,L,B,U,W,ae,he,pe,ue,Ae,be,ie,le,Se,Pe){var Ee,Xe=Pe-1>>1,Fe=B[U+0]|W[ae+0]<<16,lt=he[pe+0]|ue[Ae+0]<<16;e(E!=null);var qe=3*Fe+lt+131074>>2;for(x(E[P+0],255&qe,qe>>16,be,ie),R!=null&&(qe=3*lt+Fe+131074>>2,x(R[L+0],255&qe,qe>>16,le,Se)),Ee=1;Ee<=Xe;++Ee){var Kt=B[U+Ee]|W[ae+Ee]<<16,tr=he[pe+Ee]|ue[Ae+Ee]<<16,qt=Fe+Kt+lt+tr+524296,kt=qt+2*(Kt+lt)>>3;qe=kt+Fe>>1,Fe=(qt=qt+2*(Fe+tr)>>3)+Kt>>1,x(E[P+2*Ee-1],255&qe,qe>>16,be,ie+(2*Ee-1)*N),x(E[P+2*Ee-0],255&Fe,Fe>>16,be,ie+(2*Ee-0)*N),R!=null&&(qe=qt+lt>>1,Fe=kt+tr>>1,x(R[L+2*Ee-1],255&qe,qe>>16,le,Se+(2*Ee-1)*N),x(R[L+2*Ee+0],255&Fe,Fe>>16,le,Se+(2*Ee+0)*N)),Fe=Kt,lt=tr}1&Pe||(qe=3*Fe+lt+131074>>2,x(E[P+Pe-1],255&qe,qe>>16,be,ie+(Pe-1)*N),R!=null&&(qe=3*lt+Fe+131074>>2,x(R[L+Pe-1],255&qe,qe>>16,le,Se+(Pe-1)*N)))}}function De(){ka[Sd]=pC,ka[Ed]=ov,ka[tv]=mC,ka[Ad]=sv,ka[jd]=cv,ka[w0]=lv,ka[rv]=gC,ka[_0]=ov,ka[C0]=sv,ka[Pd]=cv,ka[N0]=lv}function Ke(m){return m&~vC?0>m?0:255:m>>uv}function nt(m,x){return Ke((19077*m>>8)+(26149*x>>8)-14234)}function Ct(m,x,N){return Ke((19077*m>>8)-(6419*x>>8)-(13320*N>>8)+8708)}function wt(m,x){return Ke((19077*m>>8)+(33050*x>>8)-17685)}function Ft(m,x,N,E,P){E[P+0]=nt(m,N),E[P+1]=Ct(m,x,N),E[P+2]=wt(m,x)}function _r(m,x,N,E,P){E[P+0]=wt(m,x),E[P+1]=Ct(m,x,N),E[P+2]=nt(m,N)}function Ar(m,x,N,E,P){var R=Ct(m,x,N);x=R<<3&224|wt(m,x)>>3,E[P+0]=248&nt(m,N)|R>>5,E[P+1]=x}function $r(m,x,N,E,P){var R=240&wt(m,x)|15;E[P+0]=240&nt(m,N)|Ct(m,x,N)>>4,E[P+1]=R}function jn(m,x,N,E,P){E[P+0]=255,Ft(m,x,N,E,P+1)}function dn(m,x,N,E,P){_r(m,x,N,E,P),E[P+3]=255}function ri(m,x,N,E,P){Ft(m,x,N,E,P),E[P+3]=255}function pa(m,x){return 0>m?0:m>x?x:m}function Ei(m,x,N){T[m]=function(E,P,R,L,B,U,W,ae,he){for(var pe=ae+(-2&he)*N;ae!=pe;)x(E[P+0],R[L+0],B[U+0],W,ae),x(E[P+1],R[L+0],B[U+0],W,ae+N),P+=2,++L,++U,ae+=2*N;1&he&&x(E[P+0],R[L+0],B[U+0],W,ae)}}function xd(m,x,N){return N==0?m==0?x==0?6:5:x==0?4:0:N}function Ol(m,x,N,E,P){switch(m>>>30){case 3:Xi(x,N,E,P,0);break;case 2:Tr(x,N,E,P);break;case 1:qn(x,N,E,P)}}function kl(m,x){var N,E,P=x.M,R=x.Nb,L=m.oc,B=m.pc+40,U=m.oc,W=m.pc+584,ae=m.oc,he=m.pc+600;for(N=0;16>N;++N)L[B+32*N-1]=129;for(N=0;8>N;++N)U[W+32*N-1]=129,ae[he+32*N-1]=129;for(0<P?L[B-1-32]=U[W-1-32]=ae[he-1-32]=129:(a(L,B-32-1,127,21),a(U,W-32-1,127,9),a(ae,he-32-1,127,9)),E=0;E<m.za;++E){var pe=x.ya[x.aa+E];if(0<E){for(N=-1;16>N;++N)n(L,B+32*N-4,L,B+32*N+12,4);for(N=-1;8>N;++N)n(U,W+32*N-4,U,W+32*N+4,4),n(ae,he+32*N-4,ae,he+32*N+4,4)}var ue=m.Gd,Ae=m.Hd+E,be=pe.ad,ie=pe.Hc;if(0<P&&(n(L,B-32,ue[Ae].y,0,16),n(U,W-32,ue[Ae].f,0,8),n(ae,he-32,ue[Ae].ea,0,8)),pe.Za){var le=L,Se=B-32+16;for(0<P&&(E>=m.za-1?a(le,Se,ue[Ae].y[15],4):n(le,Se,ue[Ae+1].y,0,4)),N=0;4>N;N++)le[Se+128+N]=le[Se+256+N]=le[Se+384+N]=le[Se+0+N];for(N=0;16>N;++N,ie<<=2)le=L,Se=B+fv[N],ni[pe.Ob[N]](le,Se),Ol(ie,be,16*+N,le,Se)}else if(le=xd(E,P,pe.Ob[0]),yo[le](L,B),ie!=0)for(N=0;16>N;++N,ie<<=2)Ol(ie,be,16*+N,L,B+fv[N]);for(N=pe.Gc,le=xd(E,P,pe.Dd),Zi[le](U,W),Zi[le](ae,he),ie=be,le=U,Se=W,255&(pe=N>>0)&&(170&pe?Bl(ie,256,le,Se):Da(ie,256,le,Se)),pe=ae,ie=he,255&(N>>=8)&&(170&N?Bl(be,320,pe,ie):Da(be,320,pe,ie)),P<m.Ub-1&&(n(ue[Ae].y,0,L,B+480,16),n(ue[Ae].f,0,U,W+224,8),n(ue[Ae].ea,0,ae,he+224,8)),N=8*R*m.B,ue=m.sa,Ae=m.ta+16*E+16*R*m.R,be=m.qa,pe=m.ra+8*E+N,ie=m.Ha,le=m.Ia+8*E+N,N=0;16>N;++N)n(ue,Ae+N*m.R,L,B+32*N,16);for(N=0;8>N;++N)n(be,pe+N*m.B,U,W+32*N,8),n(ie,le+N*m.B,ae,he+32*N,8)}}function dc(m,x,N,E,P,R,L,B,U){var W=[0],ae=[0],he=0,pe=U!=null?U.kd:0,ue=U??new Pl;if(m==null||12>N)return 7;ue.data=m,ue.w=x,ue.ha=N,x=[x],N=[N],ue.gb=[ue.gb];e:{var Ae=x,be=N,ie=ue.gb;if(e(m!=null),e(be!=null),e(ie!=null),ie[0]=0,12<=be[0]&&!t(m,Ae[0],"RIFF")){if(t(m,Ae[0]+8,"WEBP")){ie=3;break e}var le=$e(m,Ae[0]+4);if(12>le||4294967286<le){ie=3;break e}if(pe&&le>be[0]-8){ie=7;break e}ie[0]=le,Ae[0]+=12,be[0]-=12}ie=0}if(ie!=0)return ie;for(le=0<ue.gb[0],N=N[0];;){e:{var Se=m;be=x,ie=N;var Pe=W,Ee=ae,Xe=Ae=[0];if((qe=he=[he])[0]=0,8>ie[0])ie=7;else{if(!t(Se,be[0],"VP8X")){if($e(Se,be[0]+4)!=10){ie=3;break e}if(18>ie[0]){ie=7;break e}var Fe=$e(Se,be[0]+8),lt=1+Be(Se,be[0]+12);if(2147483648<=lt*(Se=1+Be(Se,be[0]+15))){ie=3;break e}Xe!=null&&(Xe[0]=Fe),Pe!=null&&(Pe[0]=lt),Ee!=null&&(Ee[0]=Se),be[0]+=18,ie[0]-=18,qe[0]=1}ie=0}}if(he=he[0],Ae=Ae[0],ie!=0)return ie;if(be=!!(2&Ae),!le&&he)return 3;if(R!=null&&(R[0]=!!(16&Ae)),L!=null&&(L[0]=be),B!=null&&(B[0]=0),L=W[0],Ae=ae[0],he&&be&&U==null){ie=0;break}if(4>N){ie=7;break}if(le&&he||!le&&!he&&!t(m,x[0],"ALPH")){N=[N],ue.na=[ue.na],ue.P=[ue.P],ue.Sa=[ue.Sa];e:{Fe=m,ie=x,le=N;var qe=ue.gb;Pe=ue.na,Ee=ue.P,Xe=ue.Sa,lt=22,e(Fe!=null),e(le!=null),Se=ie[0];var Kt=le[0];for(e(Pe!=null),e(Xe!=null),Pe[0]=null,Ee[0]=null,Xe[0]=0;;){if(ie[0]=Se,le[0]=Kt,8>Kt){ie=7;break e}var tr=$e(Fe,Se+4);if(4294967286<tr){ie=3;break e}var qt=8+tr+1&-2;if(lt+=qt,0<qe&&lt>qe){ie=3;break e}if(!t(Fe,Se,"VP8 ")||!t(Fe,Se,"VP8L")){ie=0;break e}if(Kt[0]<qt){ie=7;break e}t(Fe,Se,"ALPH")||(Pe[0]=Fe,Ee[0]=Se+8,Xe[0]=tr),Se+=qt,Kt-=qt}}if(N=N[0],ue.na=ue.na[0],ue.P=ue.P[0],ue.Sa=ue.Sa[0],ie!=0)break}N=[N],ue.Ja=[ue.Ja],ue.xa=[ue.xa];e:if(qe=m,ie=x,le=N,Pe=ue.gb[0],Ee=ue.Ja,Xe=ue.xa,Fe=ie[0],Se=!t(qe,Fe,"VP8 "),lt=!t(qe,Fe,"VP8L"),e(qe!=null),e(le!=null),e(Ee!=null),e(Xe!=null),8>le[0])ie=7;else{if(Se||lt){if(qe=$e(qe,Fe+4),12<=Pe&&qe>Pe-12){ie=3;break e}if(pe&&qe>le[0]-8){ie=7;break e}Ee[0]=qe,ie[0]+=8,le[0]-=8,Xe[0]=lt}else Xe[0]=5<=le[0]&&qe[Fe+0]==47&&!(qe[Fe+4]>>5),Ee[0]=le[0];ie=0}if(N=N[0],ue.Ja=ue.Ja[0],ue.xa=ue.xa[0],x=x[0],ie!=0)break;if(4294967286<ue.Ja)return 3;if(B==null||be||(B[0]=ue.xa?2:1),L=[L],Ae=[Ae],ue.xa){if(5>N){ie=7;break}B=L,pe=Ae,be=R,m==null||5>N?m=0:5<=N&&m[x+0]==47&&!(m[x+4]>>5)?(le=[0],qe=[0],Pe=[0],G(Ee=new A,m,x,N),ut(Ee,le,qe,Pe)?(B!=null&&(B[0]=le[0]),pe!=null&&(pe[0]=qe[0]),be!=null&&(be[0]=Pe[0]),m=1):m=0):m=0}else{if(10>N){ie=7;break}B=Ae,m==null||10>N||!rd(m,x+3,N-3)?m=0:(pe=m[x+0]|m[x+1]<<8|m[x+2]<<16,be=16383&(m[x+7]<<8|m[x+6]),m=16383&(m[x+9]<<8|m[x+8]),1&pe||3<(pe>>1&7)||!(pe>>4&1)||pe>>5>=ue.Ja||!be||!m?m=0:(L&&(L[0]=be),B&&(B[0]=m),m=1))}if(!m||(L=L[0],Ae=Ae[0],he&&(W[0]!=L||ae[0]!=Ae)))return 3;U!=null&&(U[0]=ue,U.offset=x-U.w,e(4294967286>x-U.w),e(U.offset==U.ha-N));break}return ie==0||ie==7&&he&&U==null?(R!=null&&(R[0]|=ue.na!=null&&0<ue.na.length),E!=null&&(E[0]=L),P!=null&&(P[0]=Ae),0):ie}function Ml(m,x,N){var E=x.width,P=x.height,R=0,L=0,B=E,U=P;if(x.Da=m!=null&&0<m.Da,x.Da&&(B=m.cd,U=m.bd,R=m.v,L=m.j,11>N||(R&=-2,L&=-2),0>R||0>L||0>=B||0>=U||R+B>E||L+U>P))return 0;if(x.v=R,x.j=L,x.va=R+B,x.o=L+U,x.U=B,x.T=U,x.da=m!=null&&0<m.da,x.da){if(!vt(B,U,N=[m.ib],R=[m.hb]))return 0;x.ib=N[0],x.hb=R[0]}return x.ob=m!=null&&m.ob,x.Kb=m==null||!m.Sd,x.da&&(x.ob=x.ib<3*E/4&&x.hb<3*P/4,x.Kb=0),1}function Rl(m){if(m==null)return 2;if(11>m.S){var x=m.f.RGBA;x.fb+=(m.height-1)*x.A,x.A=-x.A}else x=m.f.kb,m=m.height,x.O+=(m-1)*x.fa,x.fa=-x.fa,x.N+=(m-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(m-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(m-1)*x.lb,x.lb=-x.lb);return 0}function fc(m,x,N,E){if(E==null||0>=m||0>=x)return 2;if(N!=null){if(N.Da){var P=N.cd,R=N.bd,L=-2&N.v,B=-2&N.j;if(0>L||0>B||0>=P||0>=R||L+P>m||B+R>x)return 2;m=P,x=R}if(N.da){if(!vt(m,x,P=[N.ib],R=[N.hb]))return 2;m=P[0],x=R[0]}}E.width=m,E.height=x;e:{var U=E.width,W=E.height;if(m=E.S,0>=U||0>=W||!(m>=Sd&&13>m))m=2;else{if(0>=E.Rd&&E.sd==null){L=R=P=x=0;var ae=(B=U*hv[m])*W;if(11>m||(R=(W+1)/2*(x=(U+1)/2),m==12&&(L=(P=U)*W)),(W=i(ae+2*R+L))==null){m=1;break e}E.sd=W,11>m?((U=E.f.RGBA).eb=W,U.fb=0,U.A=B,U.size=ae):((U=E.f.kb).y=W,U.O=0,U.fa=B,U.Fd=ae,U.f=W,U.N=0+ae,U.Ab=x,U.Cd=R,U.ea=W,U.W=0+ae+R,U.Db=x,U.Ed=R,m==12&&(U.F=W,U.J=0+ae+2*R),U.Tc=L,U.lb=P)}if(x=1,P=E.S,R=E.width,L=E.height,P>=Sd&&13>P)if(11>P)m=E.f.RGBA,x&=(B=Math.abs(m.A))*(L-1)+R<=m.size,x&=B>=R*hv[P],x&=m.eb!=null;else{m=E.f.kb,B=(R+1)/2,ae=(L+1)/2,U=Math.abs(m.fa),W=Math.abs(m.Ab);var he=Math.abs(m.Db),pe=Math.abs(m.lb),ue=pe*(L-1)+R;x&=U*(L-1)+R<=m.Fd,x&=W*(ae-1)+B<=m.Cd,x=(x&=he*(ae-1)+B<=m.Ed)&U>=R&W>=B&he>=B,x&=m.y!=null,x&=m.f!=null,x&=m.ea!=null,P==12&&(x&=pe>=R,x&=ue<=m.Tc,x&=m.F!=null)}else x=0;m=x?0:2}}return m!=0||N!=null&&N.fd&&(m=Rl(E)),m}var _n=64,hc=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],pc=24,mc=32,Ll=8,Zn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Oe("Predictor0","PredictorAdd0"),T.Predictor0=function(){return 4278190080},T.Predictor1=function(m){return m},T.Predictor2=function(m,x,N){return x[N+0]},T.Predictor3=function(m,x,N){return x[N+1]},T.Predictor4=function(m,x,N){return x[N-1]},T.Predictor5=function(m,x,N){return Ue(Ue(m,x[N+1]),x[N+0])},T.Predictor6=function(m,x,N){return Ue(m,x[N-1])},T.Predictor7=function(m,x,N){return Ue(m,x[N+0])},T.Predictor8=function(m,x,N){return Ue(x[N-1],x[N+0])},T.Predictor9=function(m,x,N){return Ue(x[N+0],x[N+1])},T.Predictor10=function(m,x,N){return Ue(Ue(m,x[N-1]),Ue(x[N+0],x[N+1]))},T.Predictor11=function(m,x,N){var E=x[N+0];return 0>=bt(E>>24&255,m>>24&255,(x=x[N-1])>>24&255)+bt(E>>16&255,m>>16&255,x>>16&255)+bt(E>>8&255,m>>8&255,x>>8&255)+bt(255&E,255&m,255&x)?E:m},T.Predictor12=function(m,x,N){var E=x[N+0];return(et((m>>24&255)+(E>>24&255)-((x=x[N-1])>>24&255))<<24|et((m>>16&255)+(E>>16&255)-(x>>16&255))<<16|et((m>>8&255)+(E>>8&255)-(x>>8&255))<<8|et((255&m)+(255&E)-(255&x)))>>>0},T.Predictor13=function(m,x,N){var E=x[N-1];return(mt((m=Ue(m,x[N+0]))>>24&255,E>>24&255)<<24|mt(m>>16&255,E>>16&255)<<16|mt(m>>8&255,E>>8&255)<<8|mt(m>>0&255,E>>0&255))>>>0};var y0=T.PredictorAdd0;T.PredictorAdd1=St,Oe("Predictor2","PredictorAdd2"),Oe("Predictor3","PredictorAdd3"),Oe("Predictor4","PredictorAdd4"),Oe("Predictor5","PredictorAdd5"),Oe("Predictor6","PredictorAdd6"),Oe("Predictor7","PredictorAdd7"),Oe("Predictor8","PredictorAdd8"),Oe("Predictor9","PredictorAdd9"),Oe("Predictor10","PredictorAdd10"),Oe("Predictor11","PredictorAdd11"),Oe("Predictor12","PredictorAdd12"),Oe("Predictor13","PredictorAdd13");var Fl=T.PredictorAdd2;jt("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),jt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var yd,Pa=T.ColorIndexInverseTransform,gc=T.MapARGB,bd=T.VP8LColorIndexInverseTransformAlpha,wd=T.MapAlpha,mo=T.VP8LPredictorsAdd=[];mo.length=16,(T.VP8LPredictors=[]).length=16,(T.VP8LPredictorsAdd_C=[]).length=16,(T.VP8LPredictors_C=[]).length=16;var fs,Jn,Un,go,Yi,Ki,vc,Xi,Tr,Bl,qn,Da,xc,_d,$l,hs,ps,vo,ms,yc,gs,xo,Ul,Ia,Ta,fr,hr,Or,Jr=i(511),Qi=i(2041),ql=i(225),bc=i(767),Cd=0,b0=Qi,Nd=ql,ma=bc,Oa=Jr,Sd=0,Ed=1,tv=2,Ad=3,jd=4,w0=5,rv=6,_0=7,C0=8,Pd=9,N0=10,eC=[2,3,7],tC=[3,3,11],nv=[280,256,256,256,40],rC=[0,1,1,1,0],nC=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],aC=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],iC=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],oC=8,S0=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],E0=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Vl=null,sC=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],cC=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],av=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],lC=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],uC=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],dC=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],fC=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],yo=[],ni=[],Zi=[],hC=1,iv=2,bo=[],ka=[];_e("UpsampleRgbLinePair",Ft,3),_e("UpsampleBgrLinePair",_r,3),_e("UpsampleRgbaLinePair",ri,4),_e("UpsampleBgraLinePair",dn,4),_e("UpsampleArgbLinePair",jn,4),_e("UpsampleRgba4444LinePair",$r,2),_e("UpsampleRgb565LinePair",Ar,2);var pC=T.UpsampleRgbLinePair,mC=T.UpsampleBgrLinePair,ov=T.UpsampleRgbaLinePair,sv=T.UpsampleBgraLinePair,cv=T.UpsampleArgbLinePair,lv=T.UpsampleRgba4444LinePair,gC=T.UpsampleRgb565LinePair,Dd=16,Id=1<<Dd-1,zl=-227,A0=482,uv=6,vC=(256<<uv)-1,dv=0,xC=i(256),yC=i(256),bC=i(256),wC=i(256),_C=i(A0-zl),CC=i(A0-zl);Ei("YuvToRgbRow",Ft,3),Ei("YuvToBgrRow",_r,3),Ei("YuvToRgbaRow",ri,4),Ei("YuvToBgraRow",dn,4),Ei("YuvToArgbRow",jn,4),Ei("YuvToRgba4444Row",$r,2),Ei("YuvToRgb565Row",Ar,2);var fv=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Td=[0,2,8],NC=[8,7,6,4,4,2,2,2,1,1,1,1],SC=1;this.WebPDecodeRGBA=function(m,x,N,E,P){var R=Ed,L=new lc,B=new Er;L.ba=B,B.S=R,B.width=[B.width],B.height=[B.height];var U=B.width,W=B.height,ae=new Fr;if(ae==null||m==null)var he=2;else e(ae!=null),he=dc(m,x,N,ae.width,ae.height,ae.Pd,ae.Qd,ae.format,null);if(he!=0?U=0:(U!=null&&(U[0]=ae.width[0]),W!=null&&(W[0]=ae.height[0]),U=1),U){B.width=B.width[0],B.height=B.height[0],E!=null&&(E[0]=B.width),P!=null&&(P[0]=B.height);e:{if(E=new rc,(P=new Pl).data=m,P.w=x,P.ha=N,P.kd=1,x=[0],e(P!=null),((m=dc(P.data,P.w,P.ha,null,null,null,x,null,P))==0||m==7)&&x[0]&&(m=4),(x=m)==0){if(e(L!=null),E.data=P.data,E.w=P.w+P.offset,E.ha=P.ha-P.offset,E.put=yi,E.ac=wn,E.bc=bi,E.ma=L,P.xa){if((m=ja())==null){L=1;break e}if(function(pe,ue){var Ae=[0],be=[0],ie=[0];t:for(;;){if(pe==null)return 0;if(ue==null)return pe.a=2,0;if(pe.l=ue,pe.a=0,G(pe.m,ue.data,ue.w,ue.ha),!ut(pe.m,Ae,be,ie)){pe.a=3;break t}if(pe.xb=iv,ue.width=Ae[0],ue.height=be[0],!Ci(Ae[0],be[0],1,pe,null))break t;return 1}return e(pe.a!=0),0}(m,E)){if(E=(x=fc(E.width,E.height,L.Oa,L.ba))==0){t:{E=m;r:for(;;){if(E==null){E=0;break t}if(e(E.s.yc!=null),e(E.s.Ya!=null),e(0<E.s.Wb),e((N=E.l)!=null),e((P=N.ma)!=null),E.xb!=0){if(E.ca=P.ba,E.tb=P.tb,e(E.ca!=null),!Ml(P.Oa,N,Ad)){E.a=2;break r}if(!ss(E,N.width)||N.da)break r;if((N.da||Ye(E.ca.S))&&de(),11>E.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),E.ca.f.kb.F!=null&&de()),E.Pb&&0<E.s.ua&&E.s.vb.X==null&&!ct(E.s.vb,E.s.Wa.Xa)){E.a=1;break r}E.xb=0}if(!Ja(E,E.V,E.Ba,E.c,E.i,N.o,Xs))break r;P.Dc=E.Ma,E=1;break t}e(E.a!=0),E=0}E=!E}E&&(x=m.a)}else x=m.a}else{if((m=new e0)==null){L=1;break e}if(m.Fa=P.na,m.P=P.P,m.qc=P.Sa,nd(m,E)){if((x=fc(E.width,E.height,L.Oa,L.ba))==0){if(m.Aa=0,N=L.Oa,e((P=m)!=null),N!=null){if(0<(U=0>(U=N.Md)?0:100<U?255:255*U/100)){for(W=ae=0;4>W;++W)12>(he=P.pb[W]).lc&&(he.ia=U*NC[0>he.lc?0:he.lc]>>3),ae|=he.ia;ae&&(alert("todo:VP8InitRandom"),P.ia=1)}P.Ga=N.Id,100<P.Ga?P.Ga=100:0>P.Ga&&(P.Ga=0)}t0(m,E)||(x=m.a)}}else x=m.a}x==0&&L.Oa!=null&&L.Oa.fd&&(x=Rl(L.ba))}L=x}R=L!=0?null:11>R?B.f.RGBA.eb:B.f.kb.y}else R=null;return R};var hv=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(T,q){for(var J="",O=0;O<4;O++)J+=String.fromCharCode(T[q++]);return J}function d(T,q){return(T[q+0]<<0|T[q+1]<<8|T[q+2]<<16)>>>0}function f(T,q){return(T[q+0]<<0|T[q+1]<<8|T[q+2]<<16|T[q+3]<<24)>>>0}new l;var h=[0],p=[0],g=[],v=new l,b=r,y=function(T,q){var J={},O=0,k=!1,H=0,X=0;if(J.frames=[],!function($,V,K,ee){for(var oe=0;oe<ee;oe++)if($[V+oe]!=K.charCodeAt(oe))return!0;return!1}(T,q,"RIFF",4)){for(f(T,q+=4),q+=8;q<T.length;){var ce=u(T,q),Q=f(T,q+=4);q+=4;var re=Q+(1&Q);switch(ce){case"VP8 ":case"VP8L":J.frames[O]===void 0&&(J.frames[O]={}),(ge=J.frames[O]).src_off=k?X:q-8,ge.src_size=H+Q+8,O++,k&&(k=!1,H=0,X=0);break;case"VP8X":(ge=J.header={}).feature_flags=T[q];var G=q+4;ge.canvas_width=1+d(T,G),G+=3,ge.canvas_height=1+d(T,G),G+=3;break;case"ALPH":k=!0,H=re+8,X=q-8;break;case"ANIM":(ge=J.header).bgcolor=f(T,q),G=q+4,ge.loop_count=(ye=T)[(A=G)+0]<<0|ye[A+1]<<8,G+=2;break;case"ANMF":var Y,ge;(ge=J.frames[O]={}).offset_x=2*d(T,q),q+=3,ge.offset_y=2*d(T,q),q+=3,ge.width=1+d(T,q),q+=3,ge.height=1+d(T,q),q+=3,ge.duration=d(T,q),q+=3,Y=T[q++],ge.dispose=1&Y,ge.blend=Y>>1&1}ce!="ANMF"&&(q+=re)}var ye,A;return J}}(b,0);y.response=b,y.rgbaoutput=!0,y.dataurl=!1;var C=y.header?y.header:null,S=y.frames?y.frames:null;if(C){C.loop_counter=C.loop_count,h=[C.canvas_height],p=[C.canvas_width];for(var j=0;j<S.length&&S[j].blend!=0;j++);}var D=S[0],F=v.WebPDecodeRGBA(b,D.src_off,D.src_size,p,h);D.rgba=F,D.imgwidth=p[0],D.imgheight=h[0];for(var M=0;M<p[0]*h[0]*4;M++)g[M]=F[M];return this.width=p,this.height=h,this.data=g,this}(function(r){var e=function(){return typeof xp=="function"},t=function(h,p,g,v){var b=4,y=o;switch(v){case r.image_compression.FAST:b=1,y=i;break;case r.image_compression.MEDIUM:b=6,y=s;break;case r.image_compression.SLOW:b=9,y=l}h=n(h,p,g,y);var C=xp(h,{level:b});return r.__addimage__.arrayBufferToBinaryString(C)},n=function(h,p,g,v){for(var b,y,C,S=h.length/p,j=new Uint8Array(h.length+S),D=d(),F=0;F<S;F+=1){if(C=F*p,b=h.subarray(C,C+p),v)j.set(v(b,g,y),C+F);else{for(var M,T=D.length,q=[];M<T;M+=1)q[M]=D[M](b,g,y);var J=f(q.concat());j.set(q[J],C+F)}y=b}return j},a=function(h){var p=Array.apply([],h);return p.unshift(0),p},i=function(h,p){var g,v=[],b=h.length;v[0]=1;for(var y=0;y<b;y+=1)g=h[y-p]||0,v[y+1]=h[y]-g+256&255;return v},o=function(h,p,g){var v,b=[],y=h.length;b[0]=2;for(var C=0;C<y;C+=1)v=g&&g[C]||0,b[C+1]=h[C]-v+256&255;return b},s=function(h,p,g){var v,b,y=[],C=h.length;y[0]=3;for(var S=0;S<C;S+=1)v=h[S-p]||0,b=g&&g[S]||0,y[S+1]=h[S]+256-(v+b>>>1)&255;return y},l=function(h,p,g){var v,b,y,C,S=[],j=h.length;S[0]=4;for(var D=0;D<j;D+=1)v=h[D-p]||0,b=g&&g[D]||0,y=g&&g[D-p]||0,C=u(v,b,y),S[D+1]=h[D]-C+256&255;return S},u=function(h,p,g){if(h===p&&p===g)return h;var v=Math.abs(p-g),b=Math.abs(h-g),y=Math.abs(h+p-g-g);return v<=b&&v<=y?h:b<=y?p:g},d=function(){return[a,i,o,s,l]},f=function(h){var p=h.map(function(g){return g.reduce(function(v,b){return v+Math.abs(b)},0)});return p.indexOf(Math.min.apply(null,p))};r.processPNG=function(h,p,g,v){var b,y,C,S,j,D,F,M,T,q,J,O,k,H,X,ce=this.decode.FLATE_DECODE,Q="";if(this.__addimage__.isArrayBuffer(h)&&(h=new Uint8Array(h)),this.__addimage__.isArrayBufferView(h)){if(h=(C=new Rk(h)).imgData,y=C.bits,b=C.colorSpace,j=C.colors,[4,6].indexOf(C.colorType)!==-1){if(C.bits===8){T=(M=C.pixelBitlength==32?new Uint32Array(C.decodePixels().buffer):C.pixelBitlength==16?new Uint16Array(C.decodePixels().buffer):new Uint8Array(C.decodePixels().buffer)).length,J=new Uint8Array(T*C.colors),q=new Uint8Array(T);var re,G=C.pixelBitlength-C.bits;for(H=0,X=0;H<T;H++){for(k=M[H],re=0;re<G;)J[X++]=k>>>re&255,re+=C.bits;q[H]=k>>>re&255}}if(C.bits===16){T=(M=new Uint32Array(C.decodePixels().buffer)).length,J=new Uint8Array(T*(32/C.pixelBitlength)*C.colors),q=new Uint8Array(T*(32/C.pixelBitlength)),O=C.colors>1,H=0,X=0;for(var Y=0;H<T;)k=M[H++],J[X++]=k>>>0&255,O&&(J[X++]=k>>>16&255,k=M[H++],J[X++]=k>>>0&255),q[Y++]=k>>>16&255;y=8}v!==r.image_compression.NONE&&e()?(h=t(J,C.width*C.colors,C.colors,v),F=t(q,C.width,1,v)):(h=J,F=q,ce=void 0)}if(C.colorType===3&&(b=this.color_spaces.INDEXED,D=C.palette,C.transparency.indexed)){var ge=C.transparency.indexed,ye=0;for(H=0,T=ge.length;H<T;++H)ye+=ge[H];if((ye/=255)===T-1&&ge.indexOf(0)!==-1)S=[ge.indexOf(0)];else if(ye!==T){for(M=C.decodePixels(),q=new Uint8Array(M.length),H=0,T=M.length;H<T;H++)q[H]=ge[M[H]];F=t(q,C.width,1)}}var A=function($){var V;switch($){case r.image_compression.FAST:V=11;break;case r.image_compression.MEDIUM:V=13;break;case r.image_compression.SLOW:V=14;break;default:V=12}return V}(v);return ce===this.decode.FLATE_DECODE&&(Q="/Predictor "+A+" "),Q+="/Colors "+j+" /BitsPerComponent "+y+" /Columns "+C.width,(this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),(F&&this.__addimage__.isArrayBuffer(F)||this.__addimage__.isArrayBufferView(F))&&(F=this.__addimage__.arrayBufferToBinaryString(F)),{alias:g,data:h,index:p,filter:ce,decodeParameters:Q,transparency:S,palette:D,sMask:F,predictor:A,width:C.width,height:C.height,bitsPerComponent:y,colorSpace:b}}}})(ft.API),function(r){r.processGIF89A=function(e,t,n,a){var i=new Lk(e),o=i.width,s=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var u={data:l,width:o,height:s},d=new x1(100).encode(u,100);return r.processJPEG.call(this,d,t,n,a)},r.processGIF87A=r.processGIF89A}(ft.API),oi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var r=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(r);for(var e=0;e<r;e++){var t=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:a,green:n,blue:t,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},oi.prototype.parseBGR=function(){this.pos=this.offset;try{var r="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[r]()}catch(t){dr.log("bit decode error:"+t)}},oi.prototype.bit1=function(){var r,e=Math.ceil(this.width/8),t=e%4;for(r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++)for(var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*a*4,s=0;s<8&&8*a+s<this.width;s++){var l=this.palette[i>>7-s&1];this.data[o+4*s]=l.blue,this.data[o+4*s+1]=l.green,this.data[o+4*s+2]=l.red,this.data[o+4*s+3]=255}t!==0&&(this.pos+=4-t)}},oi.prototype.bit4=function(){for(var r=Math.ceil(this.width/2),e=r%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<r;a++){var i=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*a*4,s=i>>4,l=15&i,u=this.palette[s];if(this.data[o]=u.blue,this.data[o+1]=u.green,this.data[o+2]=u.red,this.data[o+3]=255,2*a+1>=this.width)break;u=this.palette[l],this.data[o+4]=u.blue,this.data[o+4+1]=u.green,this.data[o+4+2]=u.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},oi.prototype.bit8=function(){for(var r=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*n;if(a<this.palette.length){var o=this.palette[a];this.data[i]=o.red,this.data[i+1]=o.green,this.data[i+2]=o.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}r!==0&&(this.pos+=4-r)}},oi.prototype.bit15=function(){for(var r=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&e)/e*255|0,s=(i>>5&e)/e*255|0,l=(i>>10&e)/e*255|0,u=i>>15?255:0,d=n*this.width*4+4*a;this.data[d]=l,this.data[d+1]=s,this.data[d+2]=o,this.data[d+3]=u}this.pos+=r}},oi.prototype.bit16=function(){for(var r=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(o&e)/e*255|0,l=(o>>5&t)/t*255|0,u=(o>>11)/e*255|0,d=a*this.width*4+4*i;this.data[d]=u,this.data[d+1]=l,this.data[d+2]=s,this.data[d+3]=255}this.pos+=r}},oi.prototype.bit24=function(){for(var r=this.height-1;r>=0;r--){for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*t;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},oi.prototype.bit32=function(){for(var r=this.height-1;r>=0;r--)for(var e=this.bottom_up?r:this.height-1-r,t=0;t<this.width;t++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=e*this.width*4+4*t;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=o}},oi.prototype.getData=function(){return this.data},function(r){r.processBMP=function(e,t,n,a){var i=new oi(e,!1),o=i.width,s=i.height,l={data:i.getData(),width:o,height:s},u=new x1(100).encode(l,100);return r.processJPEG.call(this,u,t,n,a)}}(ft.API),Z2.prototype.getData=function(){return this.data},function(r){r.processWEBP=function(e,t,n,a){var i=new Z2(e),o=i.width,s=i.height,l={data:i.getData(),width:o,height:s},u=new x1(100).encode(l,100);return r.processJPEG.call(this,u,t,n,a)}}(ft.API),ft.API.processRGBA=function(r,e,t){for(var n=r.data,a=n.length,i=new Uint8Array(a/4*3),o=new Uint8Array(a/4),s=0,l=0,u=0;u<a;u+=4){var d=n[u],f=n[u+1],h=n[u+2],p=n[u+3];i[s++]=d,i[s++]=f,i[s++]=h,o[l++]=p}var g=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:g,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:r.width,height:r.height}},ft.API.setLanguage=function(r){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[r]!==void 0&&(this.internal.languageSettings.languageCode=r,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ic=ft.API,af=Ic.getCharWidthsArray=function(r,e){var t,n,a=(e=e||{}).font||this.internal.getFont(),i=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),s=e.widths?e.widths:a.metadata.Unicode.widths,l=s.fof?s.fof:1,u=e.kerning?e.kerning:a.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=e.doKerning!==!1,h=0,p=r.length,g=0,v=s[0]||l,b=[];for(t=0;t<p;t++)n=r.charCodeAt(t),typeof a.metadata.widthOfString=="function"?b.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+o*(1e3/i)||0)/1e3):(h=f&&ir(u[n])==="object"&&!isNaN(parseInt(u[n][g],10))?u[n][g]/d:0,b.push((s[n]||v)/l+h)),g=n;return b},Y2=Ic.getStringUnitWidth=function(r,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),a=e.charSpace||this.internal.getCharSpace();return Ic.processArabic&&(r=Ic.processArabic(r)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(r,t,a)/t:af.apply(this,arguments).reduce(function(i,o){return i+o},0)},K2=function(r,e,t,n){for(var a=[],i=0,o=r.length,s=0;i!==o&&s+e[i]<t;)s+=e[i],i++;a.push(r.slice(0,i));var l=i;for(s=0;i!==o;)s+e[i]>n&&(a.push(r.slice(l,i)),s=0,l=i),s+=e[i],i++;return l!==i&&a.push(r.slice(l,i)),a},X2=function(r,e,t){t||(t={});var n,a,i,o,s,l,u,d=[],f=[d],h=t.textIndent||0,p=0,g=0,v=r.split(" "),b=af.apply(this,[" ",t])[0];if(l=t.lineIndent===-1?v[0].length+2:t.lineIndent||0){var y=Array(l).join(" "),C=[];v.map(function(j){(j=j.split(/\s*\n/)).length>1?C=C.concat(j.map(function(D,F){return(F&&D.length?`
`:"")+D})):C.push(j[0])}),v=C,l=Y2.apply(this,[y,t])}for(i=0,o=v.length;i<o;i++){var S=0;if(n=v[i],l&&n[0]==`
`&&(n=n.substr(1),S=1),h+p+(g=(a=af.apply(this,[n,t])).reduce(function(j,D){return j+D},0))>e||S){if(g>e){for(s=K2.apply(this,[n,a,e-(h+p),e]),d.push(s.shift()),d=[s.pop()];s.length;)f.push([s.shift()]);g=a.slice(n.length-(d[0]?d[0].length:0)).reduce(function(j,D){return j+D},0)}else d=[n];f.push(d),h=g+l,p=b}else d.push(n),h+=p+g,p=b}return u=l?function(j,D){return(D?y:"")+j.join(" ")}:function(j){return j.join(" ")},f.map(u)},Ic.splitTextToSize=function(r,e,t){var n,a=(t=t||{}).fontSize||this.internal.getFontSize(),i=function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle);return f.metadata.Unicode?{widths:f.metadata.Unicode.widths||{0:1},kerning:f.metadata.Unicode.kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,t);n=Array.isArray(r)?r:String(r).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/a;i.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=t.lineIndent;var s,l,u=[];for(s=0,l=n.length;s<l;s++)u=u.concat(X2.apply(this,[n[s],o,i]));return u},function(r){r.__fontmetrics__=r.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},n={},a=0;a<e.length;a++)t[e[a]]="0123456789abcdef"[a],n["0123456789abcdef"[a]]=e[a];var i=function(f){return"0x"+parseInt(f,10).toString(16)},o=r.__fontmetrics__.compress=function(f){var h,p,g,v,b=["{"];for(var y in f){if(h=f[y],isNaN(parseInt(y,10))?p="'"+y+"'":(y=parseInt(y,10),p=(p=i(y).slice(2)).slice(0,-1)+n[p.slice(-1)]),typeof h=="number")h<0?(g=i(h).slice(3),v="-"):(g=i(h).slice(2),v=""),g=v+g.slice(0,-1)+n[g.slice(-1)];else{if(ir(h)!=="object")throw new Error("Don't know what to do with value type "+ir(h)+".");g=o(h)}b.push(p+g)}return b.push("}"),b.join("")},s=r.__fontmetrics__.uncompress=function(f){if(typeof f!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,p,g,v,b={},y=1,C=b,S=[],j="",D="",F=f.length-1,M=1;M<F;M+=1)(v=f[M])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(v):v=="{"?(S.push([C,g]),C={},g=void 0):v=="}"?((p=S.pop())[0][p[1]]=C,g=void 0,C=p[0]):v=="-"?y=-1:g===void 0?t.hasOwnProperty(v)?(j+=t[v],g=parseInt(j,16)*y,y=1,j=""):j+=v:t.hasOwnProperty(v)?(D+=t[v],C[g]=parseInt(D,16)*y,y=1,g=void 0,D=""):D+=v;return b},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:s("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},d={Unicode:{"Courier-Oblique":s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":s("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":s("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":s("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:s("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:s("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":s("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:s("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":s("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":s("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":s("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":s("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};r.events.push(["addFont",function(f){var h=f.font,p=d.Unicode[h.postScriptName];p&&(h.metadata.Unicode={},h.metadata.Unicode.widths=p.widths,h.metadata.Unicode.kerning=p.kerning);var g=u.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(ft.API),function(r){var e=function(t){for(var n=t.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=t.charCodeAt(i);return a};r.API.events.push(["addFont",function(t){var n=void 0,a=t.font,i=t.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(o,s){s=/^\x00\x01\x00\x00/.test(s)?e(s):e(vu(s)),o.metadata=r.API.TTFFont.open(s),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(a,n)}}])}(ft),function(r){function e(){return(ht.canvg?Promise.resolve(ht.canvg):$1(()=>import("./index.es-C8t41uN7.js"),__vite__mapDeps([0,1,2,3,4]))).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}ft.API.addSvgAsImage=function(t,n,a,i,o,s,l,u){if(isNaN(n)||isNaN(a))throw dr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(i)||isNaN(o))throw dr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=i,d.height=o;var f=d.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,d.width,d.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return e().then(function(g){return g.fromString(f,t,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(h)}).then(function(){p.addImage(d.toDataURL("image/jpeg",1),n,a,i,o,l,u)})}}(),ft.API.putTotalPages=function(r){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(r,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(r,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(e,t);return this},ft.API.viewerPreferences=function(r,e){var t;r=r||{},e=e||!1;var n,a,i,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},s=Object.keys(o),l=[],u=0,d=0,f=0;function h(g,v){var b,y=!1;for(b=0;b<g.length;b+=1)g[b]===v&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,r==="reset"||e===!0){var p=s.length;for(f=0;f<p;f+=1)t[s[f]].value=t[s[f]].defaultValue,t[s[f]].explicitSet=!1}if(ir(r)==="object"){for(a in r)if(i=r[a],h(s,a)&&i!==void 0){if(t[a].type==="boolean"&&typeof i=="boolean")t[a].value=i;else if(t[a].type==="name"&&h(t[a].valueSet,i))t[a].value=i;else if(t[a].type==="integer"&&Number.isInteger(i))t[a].value=i;else if(t[a].type==="array"){for(u=0;u<i.length;u+=1)if(n=!0,i[u].length===1&&typeof i[u][0]=="number")l.push(String(i[u]-1));else if(i[u].length>1){for(d=0;d<i[u].length;d+=1)typeof i[u][d]!="number"&&(n=!1);n===!0&&l.push([i[u][0]-1,i[u][1]-1].join(" "))}t[a].value="["+l.join(" ")+"]"}else t[a].value=t[a].defaultValue;t[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,v=[];for(g in t)t[g].explicitSet===!0&&(t[g].type==="name"?v.push("/"+g+" /"+t[g].value):v.push("/"+g+" "+t[g].value));v.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+v.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(r){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),s=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+o.length+s.length+a.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+i+o+s+l),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};r.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(ft.API),function(r){var e=r.API,t=e.pdfEscape16=function(i,o){for(var s,l=o.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,h=i.length;f<h;++f){if(s=o.metadata.characterToGlyph(i.charCodeAt(f)),o.metadata.glyIdsUsed.push(s),o.metadata.toUnicode[s]=i.charCodeAt(f),l.indexOf(s)==-1&&(l.push(s),l.push([parseInt(o.metadata.widthOfGlyph(s),10)])),s=="0")return d.join("");s=s.toString(16),d.push(u[4-s.length],s)}return d.join("")},n=function(i){var o,s,l,u,d,f,h;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,h=(s=Object.keys(i).sort(function(p,g){return p-g})).length;f<h;f++)o=s[f],l.length>=100&&(d+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[o]!==void 0&&i[o]!==null&&typeof i[o].toString=="function"&&(u=("0000"+i[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),l.push("<"+o+"><"+u+">"));return l.length&&(d+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(i){(function(o){var s=o.font,l=o.out,u=o.newObject,d=o.putStream;if(s.metadata instanceof r.API.TTFFont&&s.encoding==="Identity-H"){for(var f=s.metadata.Unicode.widths,h=s.metadata.subset.encode(s.metadata.glyIdsUsed,1),p="",g=0;g<h.length;g++)p+=String.fromCharCode(h[g]);var v=u();d({data:p,addLength1:!0,objectId:v}),l("endobj");var b=u();d({data:n(s.metadata.toUnicode),addLength1:!0,objectId:b}),l("endobj");var y=u();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Lc(s.fontName)),l("/FontFile2 "+v+" 0 R"),l("/FontBBox "+r.API.PDFObject.convert(s.metadata.bbox)),l("/Flags "+s.metadata.flags),l("/StemV "+s.metadata.stemV),l("/ItalicAngle "+s.metadata.italicAngle),l("/Ascent "+s.metadata.ascender),l("/Descent "+s.metadata.decender),l("/CapHeight "+s.metadata.capHeight),l(">>"),l("endobj");var C=u();l("<<"),l("/Type /Font"),l("/BaseFont /"+Lc(s.fontName)),l("/FontDescriptor "+y+" 0 R"),l("/W "+r.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+s.encoding+")"),l(">>"),l(">>"),l("endobj"),s.objectNumber=u(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+b+" 0 R"),l("/BaseFont /"+Lc(s.fontName)),l("/Encoding /"+s.encoding),l("/DescendantFonts ["+C+" 0 R]"),l(">>"),l("endobj"),s.isAlreadyPutted=!0}})(i)}]),e.events.push(["putFont",function(i){(function(o){var s=o.font,l=o.out,u=o.newObject,d=o.putStream;if(s.metadata instanceof r.API.TTFFont&&s.encoding==="WinAnsiEncoding"){for(var f=s.metadata.rawData,h="",p=0;p<f.length;p++)h+=String.fromCharCode(f[p]);var g=u();d({data:h,addLength1:!0,objectId:g}),l("endobj");var v=u();d({data:n(s.metadata.toUnicode),addLength1:!0,objectId:v}),l("endobj");var b=u();l("<<"),l("/Descent "+s.metadata.decender),l("/CapHeight "+s.metadata.capHeight),l("/StemV "+s.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+g+" 0 R"),l("/Flags 96"),l("/FontBBox "+r.API.PDFObject.convert(s.metadata.bbox)),l("/FontName /"+Lc(s.fontName)),l("/ItalicAngle "+s.metadata.italicAngle),l("/Ascent "+s.metadata.ascender),l(">>"),l("endobj"),s.objectNumber=u();for(var y=0;y<s.metadata.hmtx.widths.length;y++)s.metadata.hmtx.widths[y]=parseInt(s.metadata.hmtx.widths[y]*(1e3/s.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+v+" 0 R/BaseFont/"+Lc(s.fontName)+"/FontDescriptor "+b+" 0 R/Encoding/"+s.encoding+" /FirstChar 29 /LastChar 255 /Widths "+r.API.PDFObject.convert(s.metadata.hmtx.widths)+">>"),l("endobj"),s.isAlreadyPutted=!0}})(i)}]);var a=function(i){var o,s=i.text||"",l=i.x,u=i.y,d=i.options||{},f=i.mutex||{},h=f.pdfEscape,p=f.activeFontKey,g=f.fonts,v=p,b="",y=0,C="",S=g[v].encoding;if(g[v].encoding!=="Identity-H")return{text:s,x:l,y:u,options:d,mutex:f};for(C=s,v=p,Array.isArray(s)&&(C=s[0]),y=0;y<C.length;y+=1)g[v].metadata.hasOwnProperty("cmap")&&(o=g[v].metadata.cmap.unicode.codeMap[C[y].charCodeAt(0)]),o||C[y].charCodeAt(0)<256&&g[v].metadata.hasOwnProperty("Unicode")?b+=C[y]:b+="";var j="";return parseInt(v.slice(1))<14||S==="WinAnsiEncoding"?j=h(b,v).split("").map(function(D){return D.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(j=t(b,g[v])),f.isHex=!0,{text:j,x:l,y:u,options:d,mutex:f}};e.events.push(["postProcessText",function(i){var o=i.text||"",s=[],l={text:o,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(o)){var u=0;for(u=0;u<o.length;u+=1)Array.isArray(o[u])&&o[u].length===3?s.push([a(Object.assign({},l,{text:o[u][0]})).text,o[u][1],o[u][2]]):s.push(a(Object.assign({},l,{text:o[u]})).text);i.text=s}else i.text=a(Object.assign({},l,{text:o})).text}])}(ft),function(r){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};r.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},r.addFileToVFS=function(t,n){return e.call(this),this.internal.vFS[t]=n,this},r.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(ft.API),function(r){r.__bidiEngine__=r.prototype.__bidiEngine__=function(n){var a,i,o,s,l,u,d,f=e,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},v={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},b=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),C=!1,S=0;this.__bidiEngine__={};var j=function(O){var k=O.charCodeAt(),H=k>>8,X=v[H];return X!==void 0?f[256*X+(255&k)]:H===252||H===253?"AL":y.test(H)?"L":H===8?"R":"N"},D=function(O){for(var k,H=0;H<O.length;H++){if((k=j(O.charAt(H)))==="L")return!1;if(k==="R")return!0}return!1},F=function(O,k,H,X){var ce,Q,re,G,Y=k[X];switch(Y){case"L":case"R":C=!1;break;case"N":case"AN":break;case"EN":C&&(Y="AN");break;case"AL":C=!0,Y="R";break;case"WS":Y="N";break;case"CS":X<1||X+1>=k.length||(ce=H[X-1])!=="EN"&&ce!=="AN"||(Q=k[X+1])!=="EN"&&Q!=="AN"?Y="N":C&&(Q="AN"),Y=Q===ce?Q:"N";break;case"ES":Y=(ce=X>0?H[X-1]:"B")==="EN"&&X+1<k.length&&k[X+1]==="EN"?"EN":"N";break;case"ET":if(X>0&&H[X-1]==="EN"){Y="EN";break}if(C){Y="N";break}for(re=X+1,G=k.length;re<G&&k[re]==="ET";)re++;Y=re<G&&k[re]==="EN"?"EN":"N";break;case"NSM":if(o&&!s){for(G=k.length,re=X+1;re<G&&k[re]==="NSM";)re++;if(re<G){var ge=O[X],ye=ge>=1425&&ge<=2303||ge===64286;if(ce=k[re],ye&&(ce==="R"||ce==="AL")){Y="R";break}}}Y=X<1||(ce=k[X-1])==="B"?"N":H[X-1];break;case"B":C=!1,a=!0,Y=S;break;case"S":i=!0,Y="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":C=!1;break;case"BN":Y="N"}return Y},M=function(O,k,H){var X=O.split("");return H&&T(X,H,{hiLevel:S}),X.reverse(),k&&k.reverse(),X.join("")},T=function(O,k,H){var X,ce,Q,re,G,Y=-1,ge=O.length,ye=0,A=[],$=S?p:h,V=[];for(C=!1,a=!1,i=!1,ce=0;ce<ge;ce++)V[ce]=j(O[ce]);for(Q=0;Q<ge;Q++){if(G=ye,A[Q]=F(O,V,A,Q),X=240&(ye=$[G][g[A[Q]]]),ye&=15,k[Q]=re=$[ye][5],X>0)if(X===16){for(ce=Y;ce<Q;ce++)k[ce]=1;Y=-1}else Y=-1;if($[ye][6])Y===-1&&(Y=Q);else if(Y>-1){for(ce=Y;ce<Q;ce++)k[ce]=re;Y=-1}V[Q]==="B"&&(k[Q]=0),H.hiLevel|=re}i&&function(K,ee,oe){for(var fe=0;fe<oe;fe++)if(K[fe]==="S"){ee[fe]=S;for(var ve=fe-1;ve>=0&&K[ve]==="WS";ve--)ee[ve]=S}}(V,k,ge)},q=function(O,k,H,X,ce){if(!(ce.hiLevel<O)){if(O===1&&S===1&&!a)return k.reverse(),void(H&&H.reverse());for(var Q,re,G,Y,ge=k.length,ye=0;ye<ge;){if(X[ye]>=O){for(G=ye+1;G<ge&&X[G]>=O;)G++;for(Y=ye,re=G-1;Y<re;Y++,re--)Q=k[Y],k[Y]=k[re],k[re]=Q,H&&(Q=H[Y],H[Y]=H[re],H[re]=Q);ye=G}ye++}}},J=function(O,k,H){var X=O.split(""),ce={hiLevel:S};return H||(H=[]),T(X,H,ce),function(Q,re,G){if(G.hiLevel!==0&&d)for(var Y,ge=0;ge<Q.length;ge++)re[ge]===1&&(Y=b.indexOf(Q[ge]))>=0&&(Q[ge]=b[Y+1])}(X,H,ce),q(2,X,k,H,ce),q(1,X,k,H,ce),X.join("")};return this.__bidiEngine__.doBidiReorder=function(O,k,H){if(function(ce,Q){if(Q)for(var re=0;re<ce.length;re++)Q[re]=re;s===void 0&&(s=D(ce)),u===void 0&&(u=D(ce))}(O,k),o||!l||u)if(o&&l&&s^u)S=s?1:0,O=M(O,k,H);else if(!o&&l&&u)S=s?1:0,O=J(O,k,H),O=M(O,k);else if(!o||s||l||u){if(o&&!l&&s^u)O=M(O,k),s?(S=0,O=J(O,k,H)):(S=1,O=J(O,k,H),O=M(O,k));else if(o&&s&&!l&&u)S=1,O=J(O,k,H),O=M(O,k);else if(!o&&!l&&s^u){var X=d;s?(S=1,O=J(O,k,H),S=0,d=!1,O=J(O,k,H),d=X):(S=0,O=J(O,k,H),O=M(O,k),S=1,d=!1,O=J(O,k,H),d=X,O=M(O,k))}}else S=0,O=J(O,k,H);else S=s?1:0,O=J(O,k,H);return O},this.__bidiEngine__.setOptions=function(O){O&&(o=O.isInputVisual,l=O.isOutputVisual,s=O.isInputRtl,u=O.isOutputRtl,d=O.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new r.__bidiEngine__({isInputVisual:!0});r.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var o=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,t.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var s=0;for(o=[],s=0;s<a.length;s+=1)Object.prototype.toString.call(a[s])==="[object Array]"?o.push([t.doBidiReorder(a[s][0]),a[s][1],a[s][2]]):o.push([t.doBidiReorder(a[s])]);n.text=o}else n.text=t.doBidiReorder(a);t.setOptions({isInputVisual:!0})}])}(ft),ft.API.TTFFont=function(){function r(e){var t;if(this.rawData=e,t=this.contents=new Zo(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new Zk(this),this.registerTTF()}return r.open=function(e){return new r(e)},r.prototype.parse=function(){return this.directory=new Fk(this.contents),this.head=new $k(this),this.name=new Hk(this),this.cmap=new M3(this),this.toUnicode={},this.hhea=new Uk(this),this.maxp=new Wk(this),this.hmtx=new Gk(this),this.post=new Vk(this),this.os2=new qk(this),this.loca=new Qk(this),this.glyf=new Yk(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},r.prototype.registerTTF=function(){var e,t,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var o,s,l,u;for(u=[],o=0,s=(l=this.bbox).length;o<s;o++)e=l[o],u.push(Math.round(e*this.scaleFactor));return u}.call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(t=a>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},r.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},r.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},r.prototype.widthOfString=function(e,t,n){var a,i,o,s;for(o=0,i=0,s=(e=""+e).length;0<=s?i<s:i>s;i=0<=s?++i:--i)a=e.charCodeAt(i),o+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/t)||0;return o*(t/1e3)},r.prototype.lineHeight=function(e,t){var n;return t==null&&(t=!1),n=t?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},r}();var xi,Zo=function(){function r(e){this.data=e??[],this.pos=0,this.length=this.data.length}return r.prototype.readByte=function(){return this.data[this.pos++]},r.prototype.writeByte=function(e){return this.data[this.pos++]=e},r.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},r.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},r.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},r.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},r.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},r.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},r.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},r.prototype.readString=function(e){var t,n;for(n=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)n[t]=String.fromCharCode(this.readByte());return n.join("")},r.prototype.writeString=function(e){var t,n,a;for(a=[],t=0,n=e.length;0<=n?t<n:t>n;t=0<=n?++t:--t)a.push(this.writeByte(e.charCodeAt(t)));return a},r.prototype.readShort=function(){return this.readInt16()},r.prototype.writeShort=function(e){return this.writeInt16(e)},r.prototype.readLongLong=function(){var e,t,n,a,i,o,s,l;return e=this.readByte(),t=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),s=this.readByte(),l=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^o)+256*(255^s)+(255^l)+1):72057594037927940*e+281474976710656*t+1099511627776*n+4294967296*a+16777216*i+65536*o+256*s+l},r.prototype.writeLongLong=function(e){var t,n;return t=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},r.prototype.readInt=function(){return this.readInt32()},r.prototype.writeInt=function(e){return this.writeInt32(e)},r.prototype.read=function(e){var t,n;for(t=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)t.push(this.readByte());return t},r.prototype.write=function(e){var t,n,a,i;for(i=[],n=0,a=e.length;n<a;n++)t=e[n],i.push(this.writeByte(t));return i},r}(),Fk=function(){var r;function e(t){var n,a,i;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(t){var n,a,i,o,s,l,u,d,f,h,p,g,v;for(v in p=Object.keys(t).length,l=Math.log(2),f=16*Math.floor(Math.log(p)/l),o=Math.floor(f/l),d=16*p-f,(a=new Zo).writeInt(this.scalarType),a.writeShort(p),a.writeShort(f),a.writeShort(o),a.writeShort(d),i=16*p,u=a.pos+i,s=null,g=[],t)for(h=t[v],a.writeString(v),a.writeInt(r(h)),a.writeInt(u),a.writeInt(h.length),g=g.concat(h),v==="head"&&(s=u),u+=h.length;u%4;)g.push(0),u++;return a.write(g),n=2981146554-r(a.data),a.pos=s+8,a.writeUInt32(n),a.data},r=function(t){var n,a,i,o;for(t=R3.call(t);t.length%4;)t.push(0);for(i=new Zo(t),a=0,n=0,o=t.length;n<o;n=n+=4)a+=i.readUInt32();return 4294967295&a},e}(),Bk={}.hasOwnProperty,Vi=function(r,e){for(var t in e)Bk.call(e,t)&&(r[t]=e[t]);function n(){this.constructor=r}return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};xi=function(){function r(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return r.prototype.parse=function(){},r.prototype.encode=function(){},r.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},r}();var $k=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new Zo).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e}(),J2=function(){function r(e,t){var n,a,i,o,s,l,u,d,f,h,p,g,v,b,y,C,S;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),f=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=e.readByte();break;case 4:for(p=e.readUInt16(),h=p/2,e.pos+=6,i=function(){var j,D;for(D=[],l=j=0;0<=h?j<h:j>h;l=0<=h?++j:--j)D.push(e.readUInt16());return D}(),e.pos+=2,v=function(){var j,D;for(D=[],l=j=0;0<=h?j<h:j>h;l=0<=h?++j:--j)D.push(e.readUInt16());return D}(),u=function(){var j,D;for(D=[],l=j=0;0<=h?j<h:j>h;l=0<=h?++j:--j)D.push(e.readUInt16());return D}(),d=function(){var j,D;for(D=[],l=j=0;0<=h?j<h:j>h;l=0<=h?++j:--j)D.push(e.readUInt16());return D}(),a=(this.length-e.pos+this.offset)/2,s=function(){var j,D;for(D=[],l=j=0;0<=a?j<a:j>a;l=0<=a?++j:--j)D.push(e.readUInt16());return D}(),l=y=0,S=i.length;y<S;l=++y)for(b=i[l],n=C=g=v[l];g<=b?C<=b:C>=b;n=g<=b?++C:--C)d[l]===0?o=n+u[l]:(o=s[d[l]/2+(n-g)-(h-l)]||0)!==0&&(o+=u[l]),this.codeMap[n]=65535&o}e.pos=f}return r.encode=function(e,t){var n,a,i,o,s,l,u,d,f,h,p,g,v,b,y,C,S,j,D,F,M,T,q,J,O,k,H,X,ce,Q,re,G,Y,ge,ye,A,$,V,K,ee,oe,fe,ve,Ie,Te,Be;switch(X=new Zo,o=Object.keys(e).sort(function($e,ct){return $e-ct}),t){case"macroman":for(v=0,b=function(){var $e=[];for(g=0;g<256;++g)$e.push(0);return $e}(),C={0:0},i={},ce=0,Y=o.length;ce<Y;ce++)C[ve=e[a=o[ce]]]==null&&(C[ve]=++v),i[a]={old:e[a],new:C[e[a]]},b[a]=C[e[a]];return X.writeUInt16(1),X.writeUInt16(0),X.writeUInt32(12),X.writeUInt16(0),X.writeUInt16(262),X.writeUInt16(0),X.write(b),{charMap:i,subtable:X.data,maxGlyphID:v+1};case"unicode":for(k=[],f=[],S=0,C={},n={},y=u=null,Q=0,ge=o.length;Q<ge;Q++)C[D=e[a=o[Q]]]==null&&(C[D]=++S),n[a]={old:D,new:C[D]},s=C[D]-a,y!=null&&s===u||(y&&f.push(y),k.push(a),u=s),y=a;for(y&&f.push(y),f.push(65535),k.push(65535),J=2*(q=k.length),T=2*Math.pow(Math.log(q)/Math.LN2,2),h=Math.log(T/2)/Math.LN2,M=2*q-T,l=[],F=[],p=[],g=re=0,ye=k.length;re<ye;g=++re){if(O=k[g],d=f[g],O===65535){l.push(0),F.push(0);break}if(O-(H=n[O].new)>=32768)for(l.push(0),F.push(2*(p.length+q-g)),a=G=O;O<=d?G<=d:G>=d;a=O<=d?++G:--G)p.push(n[a].new);else l.push(H-O),F.push(0)}for(X.writeUInt16(3),X.writeUInt16(1),X.writeUInt32(12),X.writeUInt16(4),X.writeUInt16(16+8*q+2*p.length),X.writeUInt16(0),X.writeUInt16(J),X.writeUInt16(T),X.writeUInt16(h),X.writeUInt16(M),oe=0,A=f.length;oe<A;oe++)a=f[oe],X.writeUInt16(a);for(X.writeUInt16(0),fe=0,$=k.length;fe<$;fe++)a=k[fe],X.writeUInt16(a);for(Ie=0,V=l.length;Ie<V;Ie++)s=l[Ie],X.writeUInt16(s);for(Te=0,K=F.length;Te<K;Te++)j=F[Te],X.writeUInt16(j);for(Be=0,ee=p.length;Be<ee;Be++)v=p[Be],X.writeUInt16(v);return{charMap:n,subtable:X.data,maxGlyphID:S+1}}},r}(),M3=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,a,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,a=0;0<=i?a<i:a>i;a=0<=i?++a:--a)n=new J2(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var a,i;return n==null&&(n="macroman"),a=J2.encode(t,n),(i=new Zo).writeUInt16(0),i.writeUInt16(1),a.table=i.data.concat(a.subtable),a},e}(),Uk=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),qk=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,a;for(a=[],n=0;n<10;++n)a.push(t.readByte());return a}(),this.charRange=function(){var n,a;for(a=[],n=0;n<4;++n)a.push(t.readInt());return a}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,a;for(a=[],n=0;n<2;n=++n)a.push(t.readInt());return a}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),Vk=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="post",e.prototype.parse=function(t){var n,a,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var o;for(a=t.readUInt16(),this.glyphNameIndex=[],o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)n=t.readByte(),i.push(this.names.push(t.readString(n)));return i;case 151552:return a=t.readUInt16(),this.offsets=t.read(a);case 196608:break;case 262144:return this.map=function(){var s,l,u;for(u=[],o=s=0,l=this.file.maxp.numGlyphs;0<=l?s<l:s>l;o=0<=l?++s:--s)u.push(t.readUInt32());return u}.call(this)}},e}(),zk=function(r,e){this.raw=r,this.length=r.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},Hk=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="name",e.prototype.parse=function(t){var n,a,i,o,s,l,u,d,f,h,p;for(t.pos=this.offset,t.readShort(),n=t.readShort(),l=t.readShort(),a=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)a.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+l+t.readShort()});for(u={},o=f=0,h=a.length;f<h;o=++f)i=a[o],t.pos=i.offset,d=t.readString(i.length),s=new zk(d,i),u[p=i.nameID]==null&&(u[p]=[]),u[i.nameID].push(s);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},e}(),Wk=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),Gk=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,a,i,o,s,l,u;for(t.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,f;for(f=[],n=d=0;0<=i?d<i:d>i;n=0<=i?++d:--d)f.push(t.readInt16());return f}(),this.widths=function(){var d,f,h,p;for(p=[],d=0,f=(h=this.metrics).length;d<f;d++)o=h[d],p.push(o.advance);return p}.call(this),a=this.widths[this.widths.length-1],u=[],n=s=0;0<=i?s<i:s>i;n=0<=i?++s:--s)u.push(this.widths.push(a));return u},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),R3=[].slice,Yk=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,a,i,o,s,l,u,d,f,h;return t in this.cache?this.cache[t]:(o=this.file.loca,n=this.file.contents,a=o.indexOf(t),(i=o.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+a,s=(l=new Zo(n.read(i))).readShort(),d=l.readShort(),h=l.readShort(),u=l.readShort(),f=l.readShort(),this.cache[t]=s===-1?new Xk(l,d,h,u,f):new Kk(l,s,d,h,u,f),this.cache[t]))},e.prototype.encode=function(t,n,a){var i,o,s,l,u;for(s=[],o=[],l=0,u=n.length;l<u;l++)i=t[n[l]],o.push(s.length),i&&(s=s.concat(i.encode(a)));return o.push(s.length),{table:s,offsets:o}},e}(),Kk=function(){function r(e,t,n,a,i,o){this.raw=e,this.numberOfContours=t,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=o,this.compound=!1}return r.prototype.encode=function(){return this.raw.data},r}(),Xk=function(){function r(e,t,n,a,i){var o,s;for(this.raw=e,this.xMin=t,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;s=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&s;)o.pos+=1&s?4:2,128&s?o.pos+=8:64&s?o.pos+=4:8&s&&(o.pos+=2)}return r.prototype.encode=function(){var e,t,n;for(t=new Zo(R3.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)t.pos=this.glyphOffsets[e];return t.data},r}(),Qk=function(r){function e(){return e.__super__.constructor.apply(this,arguments)}return Vi(e,xi),e.prototype.tag="loca",e.prototype.parse=function(t){var n,a;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?function(){var i,o;for(o=[],a=0,i=this.length;a<i;a+=2)o.push(2*t.readUInt16());return o}.call(this):function(){var i,o;for(o=[],a=0,i=this.length;a<i;a+=4)o.push(t.readUInt32());return o}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var a=new Uint32Array(this.offsets.length),i=0,o=0,s=0;s<a.length;++s)if(a[s]=i,o<n.length&&n[o]==s){++o,a[s]=i;var l=this.offsets[s],u=this.offsets[s+1]-l;u>0&&(i+=u)}for(var d=new Array(4*a.length),f=0;f<a.length;++f)d[4*f+3]=255&a[f],d[4*f+2]=(65280&a[f])>>8,d[4*f+1]=(16711680&a[f])>>16,d[4*f]=(4278190080&a[f])>>24;return d},e}(),Zk=function(){function r(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return r.prototype.generateCmap=function(){var e,t,n,a,i;for(t in a=this.font.cmap.tables[0].codeMap,e={},i=this.subset)n=i[t],e[t]=a[n];return e},r.prototype.glyphsFor=function(e){var t,n,a,i,o,s,l;for(a={},o=0,s=e.length;o<s;o++)a[i=e[o]]=this.font.glyf.glyphFor(i);for(i in t=[],a)(n=a[i])!=null&&n.compound&&t.push.apply(t,n.glyphIDs);if(t.length>0)for(i in l=this.glyphsFor(t))n=l[i],a[i]=n;return a},r.prototype.encode=function(e,t){var n,a,i,o,s,l,u,d,f,h,p,g,v,b,y;for(a in n=M3.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),p={0:0},y=n.charMap)p[(l=y[a]).old]=l.new;for(g in h=n.maxGlyphID,o)g in p||(p[g]=h++);return d=function(C){var S,j;for(S in j={},C)j[C[S]]=S;return j}(p),f=Object.keys(d).sort(function(C,S){return C-S}),v=function(){var C,S,j;for(j=[],C=0,S=f.length;C<S;C++)s=f[C],j.push(d[s]);return j}(),i=this.font.glyf.encode(o,v,p),u=this.font.loca.encode(i.offsets,v),b={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(b["OS/2"]=this.font.os2.raw()),this.font.directory.encode(b)},r}();ft.API.PDFObject=function(){var r;function e(){}return r=function(t,n){return(Array(n+1).join("0")+t).slice(-n)},e.convert=function(t){var n,a,i,o;if(Array.isArray(t))return"["+function(){var s,l,u;for(u=[],s=0,l=t.length;s<l;s++)n=t[s],u.push(e.convert(n));return u}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t?.isString)return"("+t+")";if(t instanceof Date)return"(D:"+r(t.getUTCFullYear(),4)+r(t.getUTCMonth(),2)+r(t.getUTCDate(),2)+r(t.getUTCHours(),2)+r(t.getUTCMinutes(),2)+r(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(a in i=["<<"],t)o=t[a],i.push("/"+a+" "+e.convert(o));return i.push(">>"),i.join(`
`)}return""+t},e}();function Jk(){const r=(i,o)=>new Intl.NumberFormat("es-CO",{minimumFractionDigits:0,maximumFractionDigits:0}).format(i),e=i=>i==="AWG"?"ƒ":"$",t=i=>{const o=new Date(i),l=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][o.getMonth()],u=o.getDate(),d=o.getFullYear().toString().slice(-2);return`${l} ${u}/${d}`},n=w.useCallback(async(i,o)=>{console.log("📄 Iniciando generación de PDF con",i.length,"etiquetas");const s=new ft({orientation:"portrait",unit:"mm",format:[102,152]});let l=!0;for(let u=0;u<i.length;u++){const d=i[u],f=o.get(d.id);if(console.log(`📄 Procesando etiqueta ${u+1}/${i.length} para paquete ${d.id}`),!f){console.error(`❌ No se encontraron datos de etiqueta para el paquete ${d.id}`);continue}l||s.addPage(),l=!1,s.setFont("helvetica");const h=96,p=146,g=3,v=3;s.setLineWidth(.5),s.setDrawColor(180,180,180),s.rect(g,v,h,p);let b=v+10;s.setFontSize(12),s.setFont("helvetica","bold"),s.setTextColor(0,0,0),s.text("ENVIOS OJITO",g+3,b);const y=d.tracking_number,C=s.getTextWidth(y);s.text(y,g+h-C-3,b),b+=5,s.setFontSize(8),s.setFont("helvetica","normal"),s.setTextColor(100,100,100),s.text(d.customers?.name||"Cliente",g+3,b);const S=t(d.created_at),j=s.getTextWidth(S);s.text(S,g+h-j-3,b),b+=8;const D=45,F=3,M=g+(h-D)/2;s.setFillColor(249,249,249),s.setDrawColor(220,220,220),s.setLineWidth(.3),s.roundedRect(M-F,b-F,D+F*2,D+F*2,1,1,"FD");try{s.addImage(f.qrCodeDataUrl,"PNG",M,b,D,D)}catch(K){console.error("Error agregando QR code:",K)}b+=D+F+8,s.setFontSize(10),s.setTextColor(0,0,0),s.setFont("helvetica","bold");const T=`Peso: ${d.weight?`${d.weight}kg`:"3kg"}`;s.text(T,g+3,b);const q=d.amount_to_collect?r(d.amount_to_collect,d.currency):"34.354.435",O=`Total: ${e(d.currency)}${q}`,k=s.getTextWidth(O);s.text(O,g+h-k-3,b),b+=8,s.setFontSize(9),s.setFont("helvetica","bold"),s.setTextColor(0,0,0);const H="Toda encomienda debe ser verificada en el local al",X="momento de la entrega. Una vez entregada, no se",ce="aceptan reclamos.";let Q=s.getTextWidth(H);s.text(H,g+(h-Q)/2,b),b+=3,Q=s.getTextWidth(X),s.text(X,g+(h-Q)/2,b),b+=3,Q=s.getTextWidth(ce),s.text(ce,g+(h-Q)/2,b),b+=8,s.setFontSize(8),s.setTextColor(0,0,0),s.setFont("helvetica","bold");let re="Dirección en B/QUILLA: Calle 45B # 22 - 124",G=s.getTextWidth(re);s.text(re,g+(h-G)/2,b),b+=3,s.setFont("helvetica","normal");let Y="Tel: +5731272717446",ge=s.getTextWidth(Y);s.text(Y,g+(h-ge)/2,b),b+=5,s.setFont("helvetica","bold"),re="Dirección Curacao: Jo corsenstraat 48 brievengat",G=s.getTextWidth(re),s.text(re,g+(h-G)/2,b),b+=3,s.setFont("helvetica","normal"),Y="Tel: +599 9 6964306",ge=s.getTextWidth(Y),s.text(Y,g+(h-ge)/2,b),b+=8;const ye=70,A=15,$=g+(h-ye)/2;s.setLineWidth(.2),s.setDrawColor(200,200,200),s.line(g+10,b,g+h-10,b),b+=5;try{s.addImage(f.barcodeDataUrl,"PNG",$,b,ye,A)}catch(K){console.error("Error agregando código de barras:",K)}b+=A+2,s.setFontSize(7),s.setFont("helvetica","normal"),s.setTextColor(100,100,100);const V=s.getTextWidth(d.tracking_number);s.text(d.tracking_number,g+(h-V)/2,b),console.log(`✅ Etiqueta ${u+1} agregada al PDF con código de barras`)}return console.log("📄 PDF generado con",i.length,"páginas"),s},[]),a=w.useCallback(async(i,o)=>{try{console.log("🖨️ Iniciando impresión de PDF con",i.length,"etiquetas");const l=(await n(i,o)).output("blob"),u=URL.createObjectURL(l),d=window.open(u,"_blank");d&&(d.onload=()=>{setTimeout(()=>{d.print(),setTimeout(()=>{URL.revokeObjectURL(u)},1e3)},500)}),console.log("✅ PDF abierto para impresión")}catch(s){throw console.error("❌ Error al generar PDF para impresión:",s),s}},[n]);return{generatePDFFromLabels:n,printMultipleLabelsAsPDF:a}}function eM({packages:r}){const[e,t]=w.useState(new Map),[n,a]=w.useState(!0),[i,o]=w.useState(!1),{printMultipleLabelsAsPDF:s}=Jk();console.log("🏷️ MultiplePackageLabels - Packages received:",r.length),console.log("🏷️ MultiplePackageLabels - Package IDs:",r.map(u=>u.id)),w.useEffect(()=>{const u=async()=>{console.log("🔄 Generating labels data for",r.length,"packages"),a(!0);try{const d=await tk(r);console.log("✅ Generated labels data:",d.size,"labels"),console.log("🗂️ Labels data keys:",Array.from(d.keys())),t(d)}catch(d){console.error("❌ Error generating labels data:",d)}finally{a(!1)}};r.length>0&&u()},[r]);const l=async()=>{if(console.log("🖨️ Starting PDF print process for",r.length,"labels"),n){console.log("⏳ Still generating codes, waiting...");return}if(i){console.log("⏳ PDF generation in progress...");return}const u=r.filter(d=>!e.has(d.id));if(u.length>0){console.error("❌ Missing label data for packages:",u.map(d=>d.id));return}try{o(!0),await s(r,e),console.log("✅ PDF print process completed")}catch(d){console.error("❌ Error printing PDF:",d)}finally{o(!1)}};return n?c.jsx("div",{className:"flex items-center justify-center py-8",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{children:"Generando códigos QR y de barras..."})]})}):i?c.jsx("div",{className:"flex items-center justify-center py-8",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto mb-4"}),c.jsxs("p",{children:["Generando PDF con ",r.length," etiquetas..."]}),c.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Esto puede tomar unos segundos"})]})}):(console.log("🎨 Rendering MultiplePackageLabels with",r.length,"packages"),c.jsxs("div",{className:"multiple-labels-container",children:[c.jsx(Ij,{packages:r,labelsData:e,onPrint:l,isPDFMode:!0}),c.jsx(Tj,{})]}))}function L3({open:r,onOpenChange:e,packages:t}){const[n,a]=w.useState([]),[i,o]=w.useState(!1);console.log("MultipleLabelsDialog - Total packages received:",t.length),console.log("MultipleLabelsDialog - Selected packages:",n.length),console.log("MultipleLabelsDialog - Show labels:",i),w.useEffect(()=>{r&&t.length>0&&(console.log("MultipleLabelsDialog - Auto-selecting pre-selected packages:",t.length),a(t),o(!0))},[r,t]);const s=d=>{console.log("MultipleLabelsDialog - handlePrintSelected called with packages:",d.length),a(d),o(!0)},l=()=>{o(!1),a([])},u=d=>{d||(o(!1),a([])),e(d)};return c.jsx(un,{open:r,onOpenChange:u,children:c.jsxs(Yr,{className:"sm:max-w-[800px] max-h-[80vh] overflow-auto",children:[c.jsxs(Kr,{children:[c.jsx(Xr,{children:i?"Etiquetas para Imprimir":"Seleccionar Etiquetas"}),c.jsx(sa,{children:i?`Vista previa de ${n.length} etiqueta${n.length!==1?"s":""} seleccionada${n.length!==1?"s":""}`:"Selecciona las encomiendas para las que deseas imprimir etiquetas"})]}),i?c.jsxs("div",{children:[t.length===0&&c.jsx("button",{onClick:l,className:"mb-4 text-blue-600 hover:text-blue-800 underline",children:"← Volver a la selección"}),c.jsx(eM,{packages:n})]}):c.jsx(Pj,{packages:t,onPrintSelected:s})]})})}function tM({packagesCount:r,onPrintMultiple:e}){return c.jsx(yt,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx(Nt,{children:"Encomiendas Recientes"}),c.jsx(Hr,{children:"Últimas encomiendas registradas en el sistema. Haz click en una encomienda para editarla."})]}),c.jsxs(Ne,{onClick:e,variant:"outline",className:"flex items-center gap-2",disabled:r===0,children:[c.jsx(fi,{className:"h-4 w-4"}),"Imprimir Múltiples"]})]})})}var Sp=["Enter"," "],rM=["ArrowDown","PageUp","Home"],F3=["ArrowUp","PageDown","End"],nM=[...rM,...F3],aM={ltr:[...Sp,"ArrowRight"],rtl:[...Sp,"ArrowLeft"]},iM={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Gu="Menu",[Du,oM,sM]=my(Gu),[Ys,B3]=Ui(Gu,[sM,ll,xh]),$h=ll(),$3=xh(),[cM,Ks]=Ys(Gu),[lM,Yu]=Ys(Gu),U3=r=>{const{__scopeMenu:e,open:t=!1,children:n,dir:a,onOpenChange:i,modal:o=!0}=r,s=$h(e),[l,u]=w.useState(null),d=w.useRef(!1),f=di(i),h=ih(a);return w.useEffect(()=>{const p=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),c.jsx(Dy,{...s,children:c.jsx(cM,{scope:e,open:t,onOpenChange:f,content:l,onContentChange:u,children:c.jsx(lM,{scope:e,onClose:w.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:d,dir:h,modal:o,children:n})})})};U3.displayName=Gu;var uM="MenuAnchor",vg=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,a=$h(t);return c.jsx(ah,{...a,...n,ref:e})});vg.displayName=uM;var xg="MenuPortal",[dM,q3]=Ys(xg,{forceMount:void 0}),V3=r=>{const{__scopeMenu:e,forceMount:t,children:n,container:a}=r,i=Ks(xg,e);return c.jsx(dM,{scope:e,forceMount:t,children:c.jsx(Sa,{present:t||i.open,children:c.jsx(Py,{asChild:!0,container:a,children:n})})})};V3.displayName=xg;var qa="MenuContent",[fM,yg]=Ys(qa),z3=w.forwardRef((r,e)=>{const t=q3(qa,r.__scopeMenu),{forceMount:n=t.forceMount,...a}=r,i=Ks(qa,r.__scopeMenu),o=Yu(qa,r.__scopeMenu);return c.jsx(Du.Provider,{scope:r.__scopeMenu,children:c.jsx(Sa,{present:n||i.open,children:c.jsx(Du.Slot,{scope:r.__scopeMenu,children:o.modal?c.jsx(hM,{...a,ref:e}):c.jsx(pM,{...a,ref:e})})})})}),hM=w.forwardRef((r,e)=>{const t=Ks(qa,r.__scopeMenu),n=w.useRef(null),a=Wr(e,n);return w.useEffect(()=>{const i=n.current;if(i)return Gp(i)},[]),c.jsx(bg,{...r,ref:a,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:rt(r.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),pM=w.forwardRef((r,e)=>{const t=Ks(qa,r.__scopeMenu);return c.jsx(bg,{...r,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),bg=w.forwardRef((r,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:a,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:s,onEntryFocus:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:h,onDismiss:p,disableOutsideScroll:g,...v}=r,b=Ks(qa,t),y=Yu(qa,t),C=$h(t),S=$3(t),j=oM(t),[D,F]=w.useState(null),M=w.useRef(null),T=Wr(e,M,b.onContentChange),q=w.useRef(0),J=w.useRef(""),O=w.useRef(0),k=w.useRef(null),H=w.useRef("right"),X=w.useRef(0),ce=g?Ey:w.Fragment,Q=g?{as:Up,allowPinchZoom:!0}:void 0,re=Y=>{const ge=J.current+Y,ye=j().filter(oe=>!oe.disabled),A=document.activeElement,$=ye.find(oe=>oe.ref.current===A)?.textValue,V=ye.map(oe=>oe.textValue),K=EM(V,ge,$),ee=ye.find(oe=>oe.textValue===K)?.ref.current;(function oe(fe){J.current=fe,window.clearTimeout(q.current),fe!==""&&(q.current=window.setTimeout(()=>oe(""),1e3))})(ge),ee&&setTimeout(()=>ee.focus())};w.useEffect(()=>()=>window.clearTimeout(q.current),[]),Ay();const G=w.useCallback(Y=>H.current===k.current?.side&&jM(Y,k.current?.area),[]);return c.jsx(fM,{scope:t,searchRef:J,onItemEnter:w.useCallback(Y=>{G(Y)&&Y.preventDefault()},[G]),onItemLeave:w.useCallback(Y=>{G(Y)||(M.current?.focus(),F(null))},[G]),onTriggerLeave:w.useCallback(Y=>{G(Y)&&Y.preventDefault()},[G]),pointerGraceTimerRef:O,onPointerGraceIntentChange:w.useCallback(Y=>{k.current=Y},[]),children:c.jsx(ce,{...Q,children:c.jsx(jy,{asChild:!0,trapped:a,onMountAutoFocus:rt(i,Y=>{Y.preventDefault(),M.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:c.jsx(Fp,{asChild:!0,disableOutsidePointerEvents:s,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:f,onInteractOutside:h,onDismiss:p,children:c.jsx(zb,{asChild:!0,...S,dir:y.dir,orientation:"vertical",loop:n,currentTabStopId:D,onCurrentTabStopIdChange:F,onEntryFocus:rt(l,Y=>{y.isUsingKeyboardRef.current||Y.preventDefault()}),preventScrollOnEntryFocus:!0,children:c.jsx(Bp,{role:"menu","aria-orientation":"vertical","data-state":o_(b.open),"data-radix-menu-content":"",dir:y.dir,...C,...v,ref:T,style:{outline:"none",...v.style},onKeyDown:rt(v.onKeyDown,Y=>{const ye=Y.target.closest("[data-radix-menu-content]")===Y.currentTarget,A=Y.ctrlKey||Y.altKey||Y.metaKey,$=Y.key.length===1;ye&&(Y.key==="Tab"&&Y.preventDefault(),!A&&$&&re(Y.key));const V=M.current;if(Y.target!==V||!nM.includes(Y.key))return;Y.preventDefault();const ee=j().filter(oe=>!oe.disabled).map(oe=>oe.ref.current);F3.includes(Y.key)&&ee.reverse(),NM(ee)}),onBlur:rt(r.onBlur,Y=>{Y.currentTarget.contains(Y.target)||(window.clearTimeout(q.current),J.current="")}),onPointerMove:rt(r.onPointerMove,Iu(Y=>{const ge=Y.target,ye=X.current!==Y.clientX;if(Y.currentTarget.contains(ge)&&ye){const A=Y.clientX>X.current?"right":"left";H.current=A,X.current=Y.clientX}}))})})})})})})});z3.displayName=qa;var mM="MenuGroup",wg=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return c.jsx(cr.div,{role:"group",...n,ref:e})});wg.displayName=mM;var gM="MenuLabel",H3=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return c.jsx(cr.div,{...n,ref:e})});H3.displayName=gM;var Vf="MenuItem",ex="menu.itemSelect",Uh=w.forwardRef((r,e)=>{const{disabled:t=!1,onSelect:n,...a}=r,i=w.useRef(null),o=Yu(Vf,r.__scopeMenu),s=yg(Vf,r.__scopeMenu),l=Wr(e,i),u=w.useRef(!1),d=()=>{const f=i.current;if(!t&&f){const h=new CustomEvent(ex,{bubbles:!0,cancelable:!0});f.addEventListener(ex,p=>n?.(p),{once:!0}),rN(f,h),h.defaultPrevented?u.current=!1:o.onClose()}};return c.jsx(W3,{...a,ref:l,disabled:t,onClick:rt(r.onClick,d),onPointerDown:f=>{r.onPointerDown?.(f),u.current=!0},onPointerUp:rt(r.onPointerUp,f=>{u.current||f.currentTarget?.click()}),onKeyDown:rt(r.onKeyDown,f=>{const h=s.searchRef.current!=="";t||h&&f.key===" "||Sp.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});Uh.displayName=Vf;var W3=w.forwardRef((r,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:a,...i}=r,o=yg(Vf,t),s=$3(t),l=w.useRef(null),u=Wr(e,l),[d,f]=w.useState(!1),[h,p]=w.useState("");return w.useEffect(()=>{const g=l.current;g&&p((g.textContent??"").trim())},[i.children]),c.jsx(Du.ItemSlot,{scope:t,disabled:n,textValue:a??h,children:c.jsx(Hb,{asChild:!0,...s,focusable:!n,children:c.jsx(cr.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:u,onPointerMove:rt(r.onPointerMove,Iu(g=>{n?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:rt(r.onPointerLeave,Iu(g=>o.onItemLeave(g))),onFocus:rt(r.onFocus,()=>f(!0)),onBlur:rt(r.onBlur,()=>f(!1))})})})}),vM="MenuCheckboxItem",G3=w.forwardRef((r,e)=>{const{checked:t=!1,onCheckedChange:n,...a}=r;return c.jsx(Z3,{scope:r.__scopeMenu,checked:t,children:c.jsx(Uh,{role:"menuitemcheckbox","aria-checked":zf(t)?"mixed":t,...a,ref:e,"data-state":Cg(t),onSelect:rt(a.onSelect,()=>n?.(zf(t)?!0:!t),{checkForDefaultPrevented:!1})})})});G3.displayName=vM;var Y3="MenuRadioGroup",[xM,yM]=Ys(Y3,{value:void 0,onValueChange:()=>{}}),K3=w.forwardRef((r,e)=>{const{value:t,onValueChange:n,...a}=r,i=di(n);return c.jsx(xM,{scope:r.__scopeMenu,value:t,onValueChange:i,children:c.jsx(wg,{...a,ref:e})})});K3.displayName=Y3;var X3="MenuRadioItem",Q3=w.forwardRef((r,e)=>{const{value:t,...n}=r,a=yM(X3,r.__scopeMenu),i=t===a.value;return c.jsx(Z3,{scope:r.__scopeMenu,checked:i,children:c.jsx(Uh,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":Cg(i),onSelect:rt(n.onSelect,()=>a.onValueChange?.(t),{checkForDefaultPrevented:!1})})})});Q3.displayName=X3;var _g="MenuItemIndicator",[Z3,bM]=Ys(_g,{checked:!1}),J3=w.forwardRef((r,e)=>{const{__scopeMenu:t,forceMount:n,...a}=r,i=bM(_g,t);return c.jsx(Sa,{present:n||zf(i.checked)||i.checked===!0,children:c.jsx(cr.span,{...a,ref:e,"data-state":Cg(i.checked)})})});J3.displayName=_g;var wM="MenuSeparator",e_=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r;return c.jsx(cr.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});e_.displayName=wM;var _M="MenuArrow",t_=w.forwardRef((r,e)=>{const{__scopeMenu:t,...n}=r,a=$h(t);return c.jsx($p,{...a,...n,ref:e})});t_.displayName=_M;var CM="MenuSub",[hH,r_]=Ys(CM),cu="MenuSubTrigger",n_=w.forwardRef((r,e)=>{const t=Ks(cu,r.__scopeMenu),n=Yu(cu,r.__scopeMenu),a=r_(cu,r.__scopeMenu),i=yg(cu,r.__scopeMenu),o=w.useRef(null),{pointerGraceTimerRef:s,onPointerGraceIntentChange:l}=i,u={__scopeMenu:r.__scopeMenu},d=w.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return w.useEffect(()=>d,[d]),w.useEffect(()=>{const f=s.current;return()=>{window.clearTimeout(f),l(null)}},[s,l]),c.jsx(vg,{asChild:!0,...u,children:c.jsx(W3,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":a.contentId,"data-state":o_(t.open),...r,ref:ky(e,a.onTriggerChange),onClick:f=>{r.onClick?.(f),!(r.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:rt(r.onPointerMove,Iu(f=>{i.onItemEnter(f),!f.defaultPrevented&&!r.disabled&&!t.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{t.onOpenChange(!0),d()},100))})),onPointerLeave:rt(r.onPointerLeave,Iu(f=>{d();const h=t.content?.getBoundingClientRect();if(h){const p=t.content?.dataset.side,g=p==="right",v=g?-5:5,b=h[g?"left":"right"],y=h[g?"right":"left"];i.onPointerGraceIntentChange({area:[{x:f.clientX+v,y:f.clientY},{x:b,y:h.top},{x:y,y:h.top},{x:y,y:h.bottom},{x:b,y:h.bottom}],side:p}),window.clearTimeout(s.current),s.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(f),f.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:rt(r.onKeyDown,f=>{const h=i.searchRef.current!=="";r.disabled||h&&f.key===" "||aM[n.dir].includes(f.key)&&(t.onOpenChange(!0),t.content?.focus(),f.preventDefault())})})})});n_.displayName=cu;var a_="MenuSubContent",i_=w.forwardRef((r,e)=>{const t=q3(qa,r.__scopeMenu),{forceMount:n=t.forceMount,...a}=r,i=Ks(qa,r.__scopeMenu),o=Yu(qa,r.__scopeMenu),s=r_(a_,r.__scopeMenu),l=w.useRef(null),u=Wr(e,l);return c.jsx(Du.Provider,{scope:r.__scopeMenu,children:c.jsx(Sa,{present:n||i.open,children:c.jsx(Du.Slot,{scope:r.__scopeMenu,children:c.jsx(bg,{id:s.contentId,"aria-labelledby":s.triggerId,...a,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{o.isUsingKeyboardRef.current&&l.current?.focus(),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:rt(r.onFocusOutside,d=>{d.target!==s.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:rt(r.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:rt(r.onKeyDown,d=>{const f=d.currentTarget.contains(d.target),h=iM[o.dir].includes(d.key);f&&h&&(i.onOpenChange(!1),s.trigger?.focus(),d.preventDefault())})})})})})});i_.displayName=a_;function o_(r){return r?"open":"closed"}function zf(r){return r==="indeterminate"}function Cg(r){return zf(r)?"indeterminate":r?"checked":"unchecked"}function NM(r){const e=document.activeElement;for(const t of r)if(t===e||(t.focus(),document.activeElement!==e))return}function SM(r,e){return r.map((t,n)=>r[(e+n)%r.length])}function EM(r,e,t){const a=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=t?r.indexOf(t):-1;let o=SM(r,Math.max(i,0));a.length===1&&(o=o.filter(u=>u!==t));const l=o.find(u=>u.toLowerCase().startsWith(a.toLowerCase()));return l!==t?l:void 0}function AM(r,e){const{x:t,y:n}=r;let a=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const s=e[i].x,l=e[i].y,u=e[o].x,d=e[o].y;l>n!=d>n&&t<(u-s)*(n-l)/(d-l)+s&&(a=!a)}return a}function jM(r,e){if(!e)return!1;const t={x:r.clientX,y:r.clientY};return AM(t,e)}function Iu(r){return e=>e.pointerType==="mouse"?r(e):void 0}var PM=U3,DM=vg,IM=V3,TM=z3,OM=wg,kM=H3,MM=Uh,RM=G3,LM=K3,FM=Q3,BM=J3,$M=e_,UM=t_,qM=n_,VM=i_,Ng="DropdownMenu",[zM,pH]=Ui(Ng,[B3]),Kn=B3(),[HM,s_]=zM(Ng),c_=r=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:a,defaultOpen:i,onOpenChange:o,modal:s=!0}=r,l=Kn(e),u=w.useRef(null),[d=!1,f]=ul({prop:a,defaultProp:i,onChange:o});return c.jsx(HM,{scope:e,triggerId:xu(),triggerRef:u,contentId:xu(),open:d,onOpenChange:f,onOpenToggle:w.useCallback(()=>f(h=>!h),[f]),modal:s,children:c.jsx(PM,{...l,open:d,onOpenChange:f,dir:n,modal:s,children:t})})};c_.displayName=Ng;var l_="DropdownMenuTrigger",u_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...a}=r,i=s_(l_,t),o=Kn(t);return c.jsx(DM,{asChild:!0,...o,children:c.jsx(cr.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...a,ref:ky(e,i.triggerRef),onPointerDown:rt(r.onPointerDown,s=>{!n&&s.button===0&&s.ctrlKey===!1&&(i.onOpenToggle(),i.open||s.preventDefault())}),onKeyDown:rt(r.onKeyDown,s=>{n||(["Enter"," "].includes(s.key)&&i.onOpenToggle(),s.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(s.key)&&s.preventDefault())})})})});u_.displayName=l_;var WM="DropdownMenuPortal",d_=r=>{const{__scopeDropdownMenu:e,...t}=r,n=Kn(e);return c.jsx(IM,{...n,...t})};d_.displayName=WM;var f_="DropdownMenuContent",h_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=s_(f_,t),i=Kn(t),o=w.useRef(!1);return c.jsx(TM,{id:a.contentId,"aria-labelledby":a.triggerId,...i,...n,ref:e,onCloseAutoFocus:rt(r.onCloseAutoFocus,s=>{o.current||a.triggerRef.current?.focus(),o.current=!1,s.preventDefault()}),onInteractOutside:rt(r.onInteractOutside,s=>{const l=s.detail.originalEvent,u=l.button===0&&l.ctrlKey===!0,d=l.button===2||u;(!a.modal||d)&&(o.current=!0)}),style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});h_.displayName=f_;var GM="DropdownMenuGroup",YM=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(OM,{...a,...n,ref:e})});YM.displayName=GM;var KM="DropdownMenuLabel",p_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(kM,{...a,...n,ref:e})});p_.displayName=KM;var XM="DropdownMenuItem",m_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(MM,{...a,...n,ref:e})});m_.displayName=XM;var QM="DropdownMenuCheckboxItem",g_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(RM,{...a,...n,ref:e})});g_.displayName=QM;var ZM="DropdownMenuRadioGroup",JM=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(LM,{...a,...n,ref:e})});JM.displayName=ZM;var eR="DropdownMenuRadioItem",v_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(FM,{...a,...n,ref:e})});v_.displayName=eR;var tR="DropdownMenuItemIndicator",x_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(BM,{...a,...n,ref:e})});x_.displayName=tR;var rR="DropdownMenuSeparator",y_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx($M,{...a,...n,ref:e})});y_.displayName=rR;var nR="DropdownMenuArrow",aR=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(UM,{...a,...n,ref:e})});aR.displayName=nR;var iR="DropdownMenuSubTrigger",b_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(qM,{...a,...n,ref:e})});b_.displayName=iR;var oR="DropdownMenuSubContent",w_=w.forwardRef((r,e)=>{const{__scopeDropdownMenu:t,...n}=r,a=Kn(t);return c.jsx(VM,{...a,...n,ref:e,style:{...r.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});w_.displayName=oR;var sR=c_,cR=u_,lR=d_,__=h_,C_=p_,N_=m_,S_=g_,E_=v_,A_=x_,j_=y_,P_=b_,D_=w_;const uR=sR,dR=cR,fR=w.forwardRef(({className:r,inset:e,children:t,...n},a)=>c.jsxs(P_,{ref:a,className:Le("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",r),...n,children:[t,c.jsx(Ky,{className:"ml-auto h-4 w-4"})]}));fR.displayName=P_.displayName;const hR=w.forwardRef(({className:r,...e},t)=>c.jsx(D_,{ref:t,className:Le("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 max-h-[80vh] overflow-y-auto",r),...e}));hR.displayName=D_.displayName;const I_=w.forwardRef(({className:r,sideOffset:e=4,...t},n)=>c.jsx(lR,{children:c.jsx(__,{ref:n,sideOffset:e,className:Le("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 max-h-[80vh] overflow-y-auto",r),...t})}));I_.displayName=__.displayName;const Fc=w.forwardRef(({className:r,inset:e,...t},n)=>c.jsx(N_,{ref:n,className:Le("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",r),...t}));Fc.displayName=N_.displayName;const pR=w.forwardRef(({className:r,children:e,checked:t,...n},a)=>c.jsxs(S_,{ref:a,className:Le("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:t,...n,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(A_,{children:c.jsx(es,{className:"h-4 w-4"})})}),e]}));pR.displayName=S_.displayName;const mR=w.forwardRef(({className:r,children:e,...t},n)=>c.jsxs(E_,{ref:n,className:Le("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...t,children:[c.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:c.jsx(A_,{children:c.jsx(FN,{className:"h-2 w-2 fill-current"})})}),e]}));mR.displayName=E_.displayName;const gR=w.forwardRef(({className:r,inset:e,...t},n)=>c.jsx(C_,{ref:n,className:Le("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",r),...t}));gR.displayName=C_.displayName;const vR=w.forwardRef(({className:r,...e},t)=>c.jsx(j_,{ref:t,className:Le("-mx-1 my-1 h-px bg-muted",r),...e}));vR.displayName=j_.displayName;function xR({open:r,onOpenChange:e,package:t,onSuccess:n}){const[a,i]=w.useState(t.trip_id||""),{reschedulePackage:o,isRescheduling:s}=Pm(),l=async d=>{if(d.preventDefault(),!a||a===t.trip_id)return;await o(t.id,a)&&(e(!1),n(),i(""))},u=()=>{e(!1),i(t.trip_id||"")};return c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[425px] max-h-[90vh] flex flex-col px-[24px] my-0",children:[c.jsxs(Kr,{className:"flex-shrink-0",children:[c.jsx(Xr,{children:"Reprogramar Encomienda"}),c.jsxs(sa,{children:["Cambiar el viaje para la encomienda ",t.tracking_number]})]}),c.jsxs("form",{onSubmit:l,className:"flex-1 flex flex-col min-h-0",children:[c.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4",children:[c.jsxs("div",{children:[c.jsx(at,{htmlFor:"current-status",children:"Estado actual"}),c.jsx("div",{className:"text-sm text-gray-600 mt-1",children:t.status==="pending"?"Pendiente":t.status==="in_transit"?"En Tránsito":t.status==="delivered"?"Entregado":t.status==="delayed"?"Retrasado":t.status==="arrived"?"Llegado":t.status})]}),c.jsx(wm,{selectedTripId:a,onTripChange:i})]}),c.jsxs(rs,{className:"flex-shrink-0",children:[c.jsx(Ne,{type:"button",variant:"outline",onClick:u,children:"Cancelar"}),c.jsx(Ne,{type:"submit",disabled:s||!a||a===t.trip_id,children:s?"Reprogramando...":"Reprogramar"})]})]})]})})}function yR(r){const e=w.useRef(null),[t,n]=w.useState(""),[a,i]=w.useState("");return w.useEffect(()=>{const o=async()=>{try{const l={id:r.id,tracking:r.tracking_number,customer:r.customers?.name||"N/A",status:r.status,action:"package_scan"},u=JSON.stringify(l),d=await Vs.toDataURL(u,{width:120,margin:1,color:{dark:"#000000",light:"#FFFFFF"}});n(d)}catch(l){console.error("Error generating QR code:",l)}},s=()=>{try{if(e.current){m3(e.current,r.tracking_number,{format:"CODE128",width:2,height:60,displayValue:!0,fontSize:12,margin:0});const l=e.current.toDataURL();i(l)}}catch(l){console.error("Error generating barcode:",l)}};o(),s()},[r]),{barcodeCanvasRef:e,qrCodeDataUrl:t,barcodeDataUrl:a}}function bR({package:r,qrCodeDataUrl:e,barcodeDataUrl:t}){return c.jsx("div",{className:"label-preview border-2 border-gray-300 bg-white p-3",style:{width:"200px",height:"300px",transform:"scale(0.67)",transformOrigin:"top left"},children:c.jsxs("div",{className:"h-full flex flex-col border border-black",children:[c.jsx("div",{className:"bg-white p-2 border-b border-black",children:c.jsxs("div",{className:"flex justify-between items-start text-xs",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-2xl font-bold",children:"E"}),c.jsx("div",{className:"font-bold",children:"ENCOMIENDA"}),c.jsxs("div",{className:"text-xs",children:["ZONA: ",r.origin.substring(0,1)]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-xs",children:["#",r.tracking_number.substring(0,12)]}),c.jsx("div",{className:"text-xs",children:pt(new Date(r.created_at),"dd/MM/yy")}),c.jsxs("div",{className:"text-xs",children:["DE: ",r.origin.substring(0,6)]})]})]})}),c.jsx("div",{className:"bg-white p-2 border-b border-black",children:c.jsx("div",{className:"text-sm font-bold",children:"ENCOMIENDA EXPRESS"})}),c.jsxs("div",{className:"bg-white p-2 border-b border-black flex-1",children:[c.jsxs("div",{className:"mb-2",children:[c.jsx("div",{className:"text-xs font-bold",children:"DESDE:"}),c.jsx("div",{className:"text-xs",children:r.origin})]}),c.jsxs("div",{className:"mb-2",children:[c.jsx("div",{className:"text-xs font-bold",children:"PARA:"}),c.jsx("div",{className:"text-sm font-bold",children:r.customers?.name||"CLIENTE"}),c.jsx("div",{className:"text-xs",children:r.destination})]}),c.jsxs("div",{className:"mb-2",children:[c.jsx("div",{className:"text-xs font-bold",children:"DESCRIPCIÓN:"}),c.jsx("div",{className:"text-xs",children:r.description})]}),r.weight&&c.jsxs("div",{className:"text-xs",children:[c.jsx("span",{className:"font-bold",children:"PESO:"})," ",r.weight," kg"]})]}),c.jsx("div",{className:"bg-white p-2 border-b border-black",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-xs font-bold mb-1",children:"TRACKING #"}),t&&c.jsx("img",{src:t,alt:"Barcode",className:"w-full h-12 object-contain"})]})}),c.jsx("div",{className:"bg-white p-2 flex justify-center items-center",children:e&&c.jsxs("div",{className:"text-center",children:[c.jsx("img",{src:e,alt:"QR Code",className:"w-16 h-16 mx-auto mb-1"}),c.jsx("div",{className:"text-xs",children:"Gestión digital"})]})})]})})}function wR({package:r,qrCodeDataUrl:e,barcodeDataUrl:t}){return c.jsxs("div",{className:"label-print",style:{width:"10cm",height:"15cm",backgroundColor:"white",color:"black",fontSize:"12px",fontFamily:"Arial, sans-serif",display:"flex",flexDirection:"column",border:"2px solid #000"},children:[c.jsxs("div",{style:{backgroundColor:"white",padding:"8px",borderBottom:"2px solid #000",display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[c.jsxs("div",{children:[c.jsx("div",{style:{fontSize:"24px",fontWeight:"bold",lineHeight:"1"},children:"E"}),c.jsx("div",{style:{fontSize:"12px",fontWeight:"bold"},children:"ENCOMIENDA"}),c.jsxs("div",{style:{fontSize:"10px"},children:["ZONA: ",r.origin.substring(0,1)]})]}),c.jsxs("div",{style:{textAlign:"right",fontSize:"10px"},children:[c.jsxs("div",{children:["#",r.tracking_number.substring(0,12)]}),c.jsx("div",{children:pt(new Date(r.created_at),"dd/MM/yy")}),c.jsxs("div",{children:["DE: ",r.origin.substring(0,6)]})]})]}),c.jsx("div",{style:{backgroundColor:"white",padding:"8px",borderBottom:"2px solid #000"},children:c.jsx("div",{style:{fontSize:"14px",fontWeight:"bold"},children:"ENCOMIENDA EXPRESS"})}),c.jsxs("div",{style:{backgroundColor:"white",padding:"8px",borderBottom:"2px solid #000",flexGrow:1},children:[c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("div",{style:{fontSize:"10px",fontWeight:"bold"},children:"DESDE:"}),c.jsx("div",{style:{fontSize:"11px"},children:r.origin})]}),c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("div",{style:{fontSize:"10px",fontWeight:"bold"},children:"PARA:"}),c.jsx("div",{style:{fontSize:"13px",fontWeight:"bold"},children:r.customers?.name||"CLIENTE"}),c.jsx("div",{style:{fontSize:"11px"},children:r.destination})]}),c.jsxs("div",{style:{marginBottom:"8px"},children:[c.jsx("div",{style:{fontSize:"10px",fontWeight:"bold"},children:"DESCRIPCIÓN:"}),c.jsx("div",{style:{fontSize:"10px"},children:r.description})]}),r.weight&&c.jsxs("div",{style:{fontSize:"10px"},children:[c.jsx("span",{style:{fontWeight:"bold"},children:"PESO:"})," ",r.weight," kg"]})]}),c.jsxs("div",{style:{backgroundColor:"white",padding:"8px",borderBottom:"2px solid #000",textAlign:"center"},children:[c.jsx("div",{style:{fontSize:"10px",fontWeight:"bold",marginBottom:"4px"},children:"TRACKING #"}),t&&c.jsx("img",{src:t,alt:"Barcode",style:{width:"100%",height:"50px",objectFit:"contain"}})]}),c.jsx("div",{style:{backgroundColor:"white",padding:"8px",display:"flex",justifyContent:"center",alignItems:"center"},children:e&&c.jsxs("div",{style:{textAlign:"center"},children:[c.jsx("img",{src:e,alt:"QR Code",style:{width:"60px",height:"60px",marginBottom:"4px"}}),c.jsx("div",{style:{fontSize:"8px"},children:"Gestión digital"})]})})]})}function _R({package:r}){const{barcodeCanvasRef:e,qrCodeDataUrl:t,barcodeDataUrl:n}=yR(r),a=()=>{window.print()};return c.jsxs("div",{className:"package-label-container",children:[c.jsx("canvas",{ref:e,style:{display:"none"}}),c.jsxs("div",{className:"mb-4 p-4 border rounded-lg bg-white",children:[c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Vista Previa de la Etiqueta"}),c.jsx("div",{className:"text-sm text-gray-600 mb-4",children:"Dimensiones: 10cm x 15cm (aproximadamente)"}),c.jsx(bR,{package:r,qrCodeDataUrl:t,barcodeDataUrl:n}),c.jsx("button",{onClick:a,className:"mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Imprimir Etiqueta"})]}),c.jsx("div",{className:"print-only",children:c.jsx(wR,{package:r,qrCodeDataUrl:t,barcodeDataUrl:n})}),c.jsx("style",{children:`
        @media print {
          body * {
            visibility: hidden;
          }
          .print-only, .print-only * {
            visibility: visible;
          }
          .print-only {
            position: absolute;
            left: 0;
            top: 0;
          }
          @page {
            size: 10cm 15cm;
            margin: 0;
          }
        }
        .package-label-container {
          max-width: 400px;
        }
        .label-preview {
          font-size: 8px;
        }
      `})]})}function T_({open:r,onOpenChange:e,package:t}){return t?c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[500px]",children:[c.jsxs(Kr,{children:[c.jsx(Xr,{children:"Etiqueta de Encomienda"}),c.jsxs(sa,{children:["Etiqueta para imprimir de la encomienda ",t.tracking_number]})]}),c.jsx(_R,{package:t})]})}):null}function CR({package:r,onUpdate:e,onOpenChat:t,previewRole:n,disableChat:a=!1}){const[i,o]=w.useState(!1),[s,l]=w.useState(!1),[u,d]=w.useState(!1),{moveToWarehouse:f,isMovingToWarehouse:h}=Pm(),{data:p}=Ru(n),g=async()=>{await f(r.id),e()},v=()=>{t&&!a&&p?.role==="admin"&&t(r.customer_id,r.customers?.name)},b=r.status!=="delivered"&&r.status!=="bodega",y=r.status!=="delivered"&&r.status!=="bodega",C=r.status!=="delivered",S=!a&&p?.role==="admin"&&t;return c.jsxs(c.Fragment,{children:[c.jsxs(uR,{children:[c.jsx(dR,{asChild:!0,children:c.jsxs(Ne,{variant:"ghost",className:"h-8 w-8 p-0",children:[c.jsx("span",{className:"sr-only",children:"Abrir menú"}),c.jsx($N,{className:"h-4 w-4"})]})}),c.jsxs(I_,{align:"end",children:[S&&c.jsxs(Fc,{onClick:v,children:[c.jsx(Mi,{className:"mr-2 h-4 w-4"}),"Abrir chat"]}),c.jsxs(Fc,{onClick:()=>d(!0),children:[c.jsx(fi,{className:"mr-2 h-4 w-4"}),"Imprimir etiqueta"]}),C&&c.jsxs(Fc,{onClick:()=>l(!0),children:[c.jsx(rm,{className:"mr-2 h-4 w-4"}),"Editar encomienda"]}),b&&c.jsxs(Fc,{onClick:()=>o(!0),children:[c.jsx(Li,{className:"mr-2 h-4 w-4"}),"Reprogramar viaje"]}),y&&c.jsxs(Fc,{onClick:g,disabled:h,children:[c.jsx(eb,{className:"mr-2 h-4 w-4"}),"Mover a bodega"]})]})]}),c.jsx(T_,{open:u,onOpenChange:d,package:r}),c.jsx(Dm,{open:s,onOpenChange:l,package:r,onSuccess:e}),c.jsx(xR,{open:i,onOpenChange:o,package:r,onSuccess:e})]})}function NR({status:r}){const e=n=>{switch(n){case"recibido":return"bg-blue-100 text-blue-800";case"bodega":return"bg-gray-100 text-gray-800";case"procesado":return"bg-orange-100 text-orange-800";case"transito":return"bg-purple-100 text-purple-800";case"en_destino":return"bg-yellow-100 text-yellow-800";case"delivered":return"bg-green-100 text-green-800";case"in_transit":return"bg-purple-100 text-purple-800";case"pending":return"bg-blue-100 text-blue-800";case"delayed":return"bg-red-100 text-red-800";case"arrived":return"bg-yellow-100 text-yellow-800";case"warehouse":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},t=n=>{switch(n){case"recibido":return"Recibido";case"bodega":return"Bodega";case"procesado":return"Procesado";case"transito":return"Tránsito";case"en_destino":return"En Destino";case"delivered":return"Entregado";case"in_transit":return"En Tránsito";case"pending":return"Pendiente";case"delayed":return"Retrasado";case"arrived":return"Llegado";case"warehouse":return"En Bodega";default:return n}};return c.jsx(Ot,{className:e(r),children:t(r)})}function SR({status:r,origin:e,destination:t}){return r==="warehouse"?c.jsx("span",{className:"text-sm text-gray-500",children:"En Bodega"}):c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-sm",children:e}),c.jsx("span",{className:"mx-2",children:"→"}),c.jsx("span",{className:"text-sm",children:t})]})}function ER(r){if(!r)return"";const e=r.split(/[,;\n]/).map(a=>a.trim()).filter(a=>a.length>0);if(e.length===0)return"";if(e.length===1)return e[0];const t=e[0],n=e[1].substring(0,4);return`${t}, ${n}...`}const oo=(r,e)=>r?`${e==="AWG"?"ƒ":"$"}${r.toLocaleString("es-CO")} ${e}`:"N/A",AR=r=>r==="AWG"?"ƒ":"$";function jR({package:r,onRowClick:e,onActionsClick:t,onUpdate:n,onOpenChat:a,previewRole:i,disableChat:o=!1,showChatInSeparateColumn:s=!1}){const{data:l}=Ru(i),u=(h,p)=>h?`${AR(p)}${h.toLocaleString("es-CO")} ${p}`:"N/A",d=h=>{h.stopPropagation(),a&&!o&&l?.role==="admin"&&a(r.customer_id,r.customers?.name)},f=!o&&l?.role==="admin"&&a;return c.jsxs(Sr,{className:`hover:bg-gray-50 ${r.status!=="delivered"?"cursor-pointer transition-colors":"cursor-default"}`,onClick:()=>e(r),children:[c.jsx(Re,{className:"font-medium",children:r.tracking_number}),c.jsx(Re,{children:r.customers?.name||"N/A"}),c.jsx(Re,{children:c.jsx(SR,{status:r.status,origin:r.origin,destination:r.destination})}),c.jsx(Re,{children:c.jsx(NR,{status:r.status})}),c.jsx(Re,{children:pt(new Date(r.created_at),"dd/MM/yyyy")}),c.jsx(Re,{className:"max-w-xs truncate",children:ER(r.description)}),c.jsx(Re,{children:u(r.amount_to_collect,r.currency)}),c.jsx(Re,{onClick:t,children:c.jsx(Ot,{variant:"outline",className:"font-medium text-xs",children:r.currency})}),s&&c.jsx(Re,{onClick:t,children:f?c.jsx(Ne,{variant:"ghost",size:"sm",onClick:d,className:"h-8 w-8 p-0",children:c.jsx(Mi,{className:"h-4 w-4"})}):c.jsx("div",{className:"h-8 w-8"})}),c.jsx(Re,{onClick:t,children:c.jsx(CR,{package:r,onUpdate:n,onOpenChat:s?void 0:a,previewRole:i,disableChat:s?!0:o})})]})}function PR({trackingNumber:r,amountToCollect:e,currency:t,freight:n,weight:a}){const i=s=>s==="AWG"?"ƒ":"$",o=s=>({AWG:"Florín Arubano",COP:"Peso Colombiano"})[s];return c.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"font-semibold text-lg",children:"Detalles del Paquete"}),c.jsx("span",{className:"text-sm text-gray-500",children:r})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Moneda:"}),c.jsxs(Ot,{variant:"outline",className:"font-medium",children:[t," - ",o(t)]})]}),e&&e>0&&c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Monto a cobrar:"}),c.jsxs("span",{className:"font-bold text-green-600",children:[i(t),e.toLocaleString("es-CO")," ",t]})]})]}),c.jsxs("div",{className:"space-y-2",children:[n&&n>0&&c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Flete:"}),c.jsxs("span",{children:[i(t),n.toLocaleString("es-CO")," ",t]})]}),a&&c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-gray-600",children:"Peso:"}),c.jsxs("span",{children:[a," kg"]})]})]})]})]})}function DR(r,e){return w.useReducer((t,n)=>e[t][n]??t,r)}var Sg="ScrollArea",[O_,mH]=Ui(Sg),[IR,Ka]=O_(Sg),k_=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:a,scrollHideDelay:i=600,...o}=r,[s,l]=w.useState(null),[u,d]=w.useState(null),[f,h]=w.useState(null),[p,g]=w.useState(null),[v,b]=w.useState(null),[y,C]=w.useState(0),[S,j]=w.useState(0),[D,F]=w.useState(!1),[M,T]=w.useState(!1),q=Wr(e,O=>l(O)),J=ih(a);return c.jsx(IR,{scope:t,type:n,dir:J,scrollHideDelay:i,scrollArea:s,viewport:u,onViewportChange:d,content:f,onContentChange:h,scrollbarX:p,onScrollbarXChange:g,scrollbarXEnabled:D,onScrollbarXEnabledChange:F,scrollbarY:v,onScrollbarYChange:b,scrollbarYEnabled:M,onScrollbarYEnabledChange:T,onCornerWidthChange:C,onCornerHeightChange:j,children:c.jsx(cr.div,{dir:J,...o,ref:q,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":S+"px",...r.style}})})});k_.displayName=Sg;var M_="ScrollAreaViewport",R_=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,children:n,asChild:a,nonce:i,...o}=r,s=Ka(M_,t),l=w.useRef(null),u=Wr(e,l,s.onViewportChange);return c.jsxs(c.Fragment,{children:[c.jsx("style",{dangerouslySetInnerHTML:{__html:`
[data-radix-scroll-area-viewport] {
  scrollbar-width: none;
  -ms-overflow-style: none;
  -webkit-overflow-scrolling: touch;
}
[data-radix-scroll-area-viewport]::-webkit-scrollbar {
  display: none;
}
:where([data-radix-scroll-area-viewport]) {
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
:where([data-radix-scroll-area-content]) {
  flex-grow: 1;
}
`},nonce:i}),c.jsx(cr.div,{"data-radix-scroll-area-viewport":"",...o,asChild:a,ref:u,style:{overflowX:s.scrollbarXEnabled?"scroll":"hidden",overflowY:s.scrollbarYEnabled?"scroll":"hidden",...r.style},children:UR({asChild:a,children:n},d=>c.jsx("div",{"data-radix-scroll-area-content":"",ref:s.onContentChange,style:{minWidth:s.scrollbarXEnabled?"fit-content":void 0},children:d}))})]})});R_.displayName=M_;var zi="ScrollAreaScrollbar",Eg=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,a=Ka(zi,r.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=a,s=r.orientation==="horizontal";return w.useEffect(()=>(s?i(!0):o(!0),()=>{s?i(!1):o(!1)}),[s,i,o]),a.type==="hover"?c.jsx(TR,{...n,ref:e,forceMount:t}):a.type==="scroll"?c.jsx(OR,{...n,ref:e,forceMount:t}):a.type==="auto"?c.jsx(L_,{...n,ref:e,forceMount:t}):a.type==="always"?c.jsx(Ag,{...n,ref:e}):null});Eg.displayName=zi;var TR=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,a=Ka(zi,r.__scopeScrollArea),[i,o]=w.useState(!1);return w.useEffect(()=>{const s=a.scrollArea;let l=0;if(s){const u=()=>{window.clearTimeout(l),o(!0)},d=()=>{l=window.setTimeout(()=>o(!1),a.scrollHideDelay)};return s.addEventListener("pointerenter",u),s.addEventListener("pointerleave",d),()=>{window.clearTimeout(l),s.removeEventListener("pointerenter",u),s.removeEventListener("pointerleave",d)}}},[a.scrollArea,a.scrollHideDelay]),c.jsx(Sa,{present:t||i,children:c.jsx(L_,{"data-state":i?"visible":"hidden",...n,ref:e})})}),OR=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,a=Ka(zi,r.__scopeScrollArea),i=r.orientation==="horizontal",o=Vh(()=>l("SCROLL_END"),100),[s,l]=DR("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return w.useEffect(()=>{if(s==="idle"){const u=window.setTimeout(()=>l("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(u)}},[s,a.scrollHideDelay,l]),w.useEffect(()=>{const u=a.viewport,d=i?"scrollLeft":"scrollTop";if(u){let f=u[d];const h=()=>{const p=u[d];f!==p&&(l("SCROLL"),o()),f=p};return u.addEventListener("scroll",h),()=>u.removeEventListener("scroll",h)}},[a.viewport,i,l,o]),c.jsx(Sa,{present:t||s!=="hidden",children:c.jsx(Ag,{"data-state":s==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:rt(r.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:rt(r.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),L_=w.forwardRef((r,e)=>{const t=Ka(zi,r.__scopeScrollArea),{forceMount:n,...a}=r,[i,o]=w.useState(!1),s=r.orientation==="horizontal",l=Vh(()=>{if(t.viewport){const u=t.viewport.offsetWidth<t.viewport.scrollWidth,d=t.viewport.offsetHeight<t.viewport.scrollHeight;o(s?u:d)}},10);return ol(t.viewport,l),ol(t.content,l),c.jsx(Sa,{present:n||i,children:c.jsx(Ag,{"data-state":i?"visible":"hidden",...a,ref:e})})}),Ag=w.forwardRef((r,e)=>{const{orientation:t="vertical",...n}=r,a=Ka(zi,r.__scopeScrollArea),i=w.useRef(null),o=w.useRef(0),[s,l]=w.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=q_(s.viewport,s.content),d={...n,sizes:s,onSizesChange:l,hasThumb:u>0&&u<1,onThumbChange:h=>i.current=h,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:h=>o.current=h};function f(h,p){return BR(h,o.current,s,p)}return t==="horizontal"?c.jsx(kR,{...d,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const h=a.viewport.scrollLeft,p=tx(h,s,a.dir);i.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:h=>{a.viewport&&(a.viewport.scrollLeft=h)},onDragScroll:h=>{a.viewport&&(a.viewport.scrollLeft=f(h,a.dir))}}):t==="vertical"?c.jsx(MR,{...d,ref:e,onThumbPositionChange:()=>{if(a.viewport&&i.current){const h=a.viewport.scrollTop,p=tx(h,s);i.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:h=>{a.viewport&&(a.viewport.scrollTop=h)},onDragScroll:h=>{a.viewport&&(a.viewport.scrollTop=f(h))}}):null}),kR=w.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...a}=r,i=Ka(zi,r.__scopeScrollArea),[o,s]=w.useState(),l=w.useRef(null),u=Wr(e,l,i.onScrollbarXChange);return w.useEffect(()=>{l.current&&s(getComputedStyle(l.current))},[l]),c.jsx(B_,{"data-orientation":"horizontal",...a,ref:u,sizes:t,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":qh(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.x),onDragScroll:d=>r.onDragScroll(d.x),onWheelScroll:(d,f)=>{if(i.viewport){const h=i.viewport.scrollLeft+d.deltaX;r.onWheelScroll(h),z_(h,f)&&d.preventDefault()}},onResize:()=>{l.current&&i.viewport&&o&&n({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:Wf(o.paddingLeft),paddingEnd:Wf(o.paddingRight)}})}})}),MR=w.forwardRef((r,e)=>{const{sizes:t,onSizesChange:n,...a}=r,i=Ka(zi,r.__scopeScrollArea),[o,s]=w.useState(),l=w.useRef(null),u=Wr(e,l,i.onScrollbarYChange);return w.useEffect(()=>{l.current&&s(getComputedStyle(l.current))},[l]),c.jsx(B_,{"data-orientation":"vertical",...a,ref:u,sizes:t,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":qh(t)+"px",...r.style},onThumbPointerDown:d=>r.onThumbPointerDown(d.y),onDragScroll:d=>r.onDragScroll(d.y),onWheelScroll:(d,f)=>{if(i.viewport){const h=i.viewport.scrollTop+d.deltaY;r.onWheelScroll(h),z_(h,f)&&d.preventDefault()}},onResize:()=>{l.current&&i.viewport&&o&&n({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:Wf(o.paddingTop),paddingEnd:Wf(o.paddingBottom)}})}})}),[RR,F_]=O_(zi),B_=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:a,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:s,onThumbPositionChange:l,onDragScroll:u,onWheelScroll:d,onResize:f,...h}=r,p=Ka(zi,t),[g,v]=w.useState(null),b=Wr(e,q=>v(q)),y=w.useRef(null),C=w.useRef(""),S=p.viewport,j=n.content-n.viewport,D=di(d),F=di(l),M=Vh(f,10);function T(q){if(y.current){const J=q.clientX-y.current.left,O=q.clientY-y.current.top;u({x:J,y:O})}}return w.useEffect(()=>{const q=J=>{const O=J.target;g?.contains(O)&&D(J,j)};return document.addEventListener("wheel",q,{passive:!1}),()=>document.removeEventListener("wheel",q,{passive:!1})},[S,g,j,D]),w.useEffect(F,[n,F]),ol(g,M),ol(p.content,M),c.jsx(RR,{scope:t,scrollbar:g,hasThumb:a,onThumbChange:di(i),onThumbPointerUp:di(o),onThumbPositionChange:F,onThumbPointerDown:di(s),children:c.jsx(cr.div,{...h,ref:b,style:{position:"absolute",...h.style},onPointerDown:rt(r.onPointerDown,q=>{q.button===0&&(q.target.setPointerCapture(q.pointerId),y.current=g.getBoundingClientRect(),C.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),T(q))}),onPointerMove:rt(r.onPointerMove,T),onPointerUp:rt(r.onPointerUp,q=>{const J=q.target;J.hasPointerCapture(q.pointerId)&&J.releasePointerCapture(q.pointerId),document.body.style.webkitUserSelect=C.current,p.viewport&&(p.viewport.style.scrollBehavior=""),y.current=null})})})}),Hf="ScrollAreaThumb",$_=w.forwardRef((r,e)=>{const{forceMount:t,...n}=r,a=F_(Hf,r.__scopeScrollArea);return c.jsx(Sa,{present:t||a.hasThumb,children:c.jsx(LR,{ref:e,...n})})}),LR=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,style:n,...a}=r,i=Ka(Hf,t),o=F_(Hf,t),{onThumbPositionChange:s}=o,l=Wr(e,f=>o.onThumbChange(f)),u=w.useRef(),d=Vh(()=>{u.current&&(u.current(),u.current=void 0)},100);return w.useEffect(()=>{const f=i.viewport;if(f){const h=()=>{if(d(),!u.current){const p=$R(f,s);u.current=p,s()}};return s(),f.addEventListener("scroll",h),()=>f.removeEventListener("scroll",h)}},[i.viewport,d,s]),c.jsx(cr.div,{"data-state":o.hasThumb?"visible":"hidden",...a,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:rt(r.onPointerDownCapture,f=>{const p=f.target.getBoundingClientRect(),g=f.clientX-p.left,v=f.clientY-p.top;o.onThumbPointerDown({x:g,y:v})}),onPointerUp:rt(r.onPointerUp,o.onThumbPointerUp)})});$_.displayName=Hf;var jg="ScrollAreaCorner",U_=w.forwardRef((r,e)=>{const t=Ka(jg,r.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?c.jsx(FR,{...r,ref:e}):null});U_.displayName=jg;var FR=w.forwardRef((r,e)=>{const{__scopeScrollArea:t,...n}=r,a=Ka(jg,t),[i,o]=w.useState(0),[s,l]=w.useState(0),u=!!(i&&s);return ol(a.scrollbarX,()=>{const d=a.scrollbarX?.offsetHeight||0;a.onCornerHeightChange(d),l(d)}),ol(a.scrollbarY,()=>{const d=a.scrollbarY?.offsetWidth||0;a.onCornerWidthChange(d),o(d)}),u?c.jsx(cr.div,{...n,ref:e,style:{width:i,height:s,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...r.style}}):null});function Wf(r){return r?parseInt(r,10):0}function q_(r,e){const t=r/e;return isNaN(t)?0:t}function qh(r){const e=q_(r.viewport,r.content),t=r.scrollbar.paddingStart+r.scrollbar.paddingEnd,n=(r.scrollbar.size-t)*e;return Math.max(n,18)}function BR(r,e,t,n="ltr"){const a=qh(t),i=a/2,o=e||i,s=a-o,l=t.scrollbar.paddingStart+o,u=t.scrollbar.size-t.scrollbar.paddingEnd-s,d=t.content-t.viewport,f=n==="ltr"?[0,d]:[d*-1,0];return V_([l,u],f)(r)}function tx(r,e,t="ltr"){const n=qh(e),a=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-a,o=e.content-e.viewport,s=i-n,l=t==="ltr"?[0,o]:[o*-1,0],u=nN(r,l);return V_([0,o],[0,s])(u)}function V_(r,e){return t=>{if(r[0]===r[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(r[1]-r[0]);return e[0]+n*(t-r[0])}}function z_(r,e){return r>0&&r<e}var $R=(r,e=()=>{})=>{let t={left:r.scrollLeft,top:r.scrollTop},n=0;return function a(){const i={left:r.scrollLeft,top:r.scrollTop},o=t.left!==i.left,s=t.top!==i.top;(o||s)&&e(),t=i,n=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(n)};function Vh(r,e){const t=di(r),n=w.useRef(0);return w.useEffect(()=>()=>window.clearTimeout(n.current),[]),w.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function ol(r,e){const t=di(e);Yp(()=>{let n=0;if(r){const a=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return a.observe(r),()=>{window.cancelAnimationFrame(n),a.unobserve(r)}}},[r,t])}function UR(r,e){const{asChild:t,children:n}=r;if(!t)return typeof e=="function"?e(n):e;const a=w.Children.only(n);return w.cloneElement(a,{children:typeof e=="function"?e(a.props.children):e})}var H_=k_,qR=R_,VR=U_;const Pg=w.forwardRef(({className:r,children:e,...t},n)=>c.jsxs(H_,{ref:n,className:Le("relative overflow-hidden",r),...t,children:[c.jsx(qR,{className:"h-full w-full rounded-[inherit]",children:e}),c.jsx(W_,{}),c.jsx(VR,{})]}));Pg.displayName=H_.displayName;const W_=w.forwardRef(({className:r,orientation:e="vertical",...t},n)=>c.jsx(Eg,{ref:n,orientation:e,className:Le("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...t,children:c.jsx($_,{className:"relative flex-1 rounded-full bg-border"})}));W_.displayName=Eg.displayName;const zR={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},HR=(r,e,t)=>{let n;const a=zR[r];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"en "+n:"hace "+n:n},WR={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},GR={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},YR={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},KR={date:L0({formats:WR,defaultWidth:"full"}),time:L0({formats:GR,defaultWidth:"full"}),dateTime:L0({formats:YR,defaultWidth:"full"})},XR={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},QR={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},ZR=(r,e,t,n)=>e.getHours()!==1?QR[r]:XR[r],JR={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},eL={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},tL={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},rL={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},nL={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},aL={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},iL=(r,e)=>Number(r)+"º",oL={ordinalNumber:iL,era:Kl({values:JR,defaultWidth:"wide"}),quarter:Kl({values:eL,defaultWidth:"wide",argumentCallback:r=>Number(r)-1}),month:Kl({values:tL,defaultWidth:"wide"}),day:Kl({values:rL,defaultWidth:"wide"}),dayPeriod:Kl({values:nL,defaultWidth:"wide",formattingValues:aL,defaultFormattingWidth:"wide"})},sL=/^(\d+)(º)?/i,cL=/\d+/i,lL={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},uL={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},dL={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},fL={any:[/1/i,/2/i,/3/i,/4/i]},hL={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},pL={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},mL={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},gL={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},vL={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},xL={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},yL={ordinalNumber:fN({matchPattern:sL,parsePattern:cL,valueCallback:function(r){return parseInt(r,10)}}),era:Xl({matchPatterns:lL,defaultMatchWidth:"wide",parsePatterns:uL,defaultParseWidth:"any"}),quarter:Xl({matchPatterns:dL,defaultMatchWidth:"wide",parsePatterns:fL,defaultParseWidth:"any",valueCallback:r=>r+1}),month:Xl({matchPatterns:hL,defaultMatchWidth:"wide",parsePatterns:pL,defaultParseWidth:"any"}),day:Xl({matchPatterns:mL,defaultMatchWidth:"wide",parsePatterns:gL,defaultParseWidth:"any"}),dayPeriod:Xl({matchPatterns:vL,defaultMatchWidth:"any",parsePatterns:xL,defaultParseWidth:"any"})},Bn={code:"es",formatDistance:HR,formatLong:KR,formatRelative:ZR,localize:oL,match:yL,options:{weekStartsOn:1,firstWeekContainsDate:1}};function bL({content:r,timestamp:e,type:t,messageType:n,imageUrl:a}){const i=o=>{switch(o){case"text":return"bg-blue-100 text-blue-800";case"image":return"bg-green-100 text-green-800";case"audio":return"bg-purple-100 text-purple-800";case"video":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return c.jsx("div",{className:`flex ${t==="outgoing"?"justify-end":"justify-start"} mb-4`,children:c.jsxs("div",{className:`max-w-xs lg:max-w-md rounded-lg p-3 ${t==="incoming"?"bg-white border border-gray-200":"bg-blue-500 text-white"}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx(Ot,{className:t==="incoming"?i(n||"text"):"bg-blue-600 text-white",variant:"secondary",children:t==="incoming"?n||"text":"enviado"}),c.jsx("span",{className:`text-xs ${t==="incoming"?"text-gray-500":"text-blue-100"}`,children:pt(new Date(e),"HH:mm",{locale:Bn})})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"text-sm",children:r}),a&&c.jsx("img",{src:a,alt:"Imagen enviada",className:"max-w-48 rounded border cursor-pointer",onClick:()=>window.open(a,"_blank")})]})]})})}function wL({onImageSelect:r,selectedImage:e,onImageRemove:t}){const[n,a]=w.useState(!1),i=w.useRef(null),{toast:o}=Lt(),s=d=>{if(!d.type.startsWith("image/")){o({title:"Error",description:"Solo se permiten archivos de imagen",variant:"destructive"});return}if(d.size>5*1024*1024){o({title:"Error",description:"La imagen debe ser menor a 5MB",variant:"destructive"});return}r(d)},l=d=>{d.preventDefault(),d.stopPropagation(),d.type==="dragenter"||d.type==="dragover"?a(!0):d.type==="dragleave"&&a(!1)},u=d=>{d.preventDefault(),d.stopPropagation(),a(!1),d.dataTransfer.files&&d.dataTransfer.files[0]&&s(d.dataTransfer.files[0])};return c.jsx("div",{className:"space-y-2",children:e?c.jsxs("div",{className:"relative inline-block",children:[c.jsx("img",{src:URL.createObjectURL(e),alt:"Imagen seleccionada",className:"h-20 w-20 object-cover rounded border"}),c.jsx(Ne,{type:"button",variant:"destructive",size:"sm",className:"absolute -top-2 -right-2 h-6 w-6 rounded-full p-0",onClick:t,children:c.jsx(lo,{className:"h-3 w-3"})})]}):c.jsxs("div",{className:`border-2 border-dashed rounded-lg p-4 text-center cursor-pointer transition-colors ${n?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,onDragEnter:l,onDragLeave:l,onDragOver:l,onDrop:u,onClick:()=>i.current?.click(),children:[c.jsx(UN,{className:"h-8 w-8 mx-auto mb-2 text-gray-400"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Arrastra una imagen aquí o haz clic para seleccionar"}),c.jsx(It,{ref:i,type:"file",accept:"image/*",className:"hidden",onChange:d=>d.target.files?.[0]&&s(d.target.files[0])})]})})}function _L({onSendMessage:r,isLoading:e,disabled:t}){const[n,a]=w.useState(""),[i,o]=w.useState(null),[s,l]=w.useState(!1),[u,d]=w.useState(!1),f=w.useRef(null),h=yn(),p=async()=>{if(!(u||!n.trim()&&!i)){console.log("📤 ChatInput: Sending message:",{message:n.substring(0,50),hasImage:!!i}),d(!0);try{await r(n.trim(),i||void 0),a(""),o(null),l(!1),f.current?.focus(),console.log("✅ ChatInput: Message sent successfully")}catch(C){console.error("❌ ChatInput: Error sending message:",C)}finally{d(!1)}}},g=C=>{C.key==="Enter"&&!C.shiftKey&&!u&&(C.preventDefault(),p())},v=C=>{o(C),console.log("🖼️ Image selected:",C.name)},b=()=>{o(null),console.log("🗑️ Image removed")},y=t||u||e||!n.trim()&&!i;return c.jsxs("div",{className:`border-t border-gray-200 ${h?"p-3":"p-4"} bg-white`,children:[i&&c.jsxs("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg flex items-center gap-3",children:[c.jsxs("span",{className:"text-sm text-gray-700 font-medium",children:["📎 ",i.name]}),c.jsx(Ne,{type:"button",variant:"ghost",size:"sm",onClick:b,className:"h-8 w-8 p-0 hover:bg-gray-200",children:c.jsx(lo,{className:"h-4 w-4"})})]}),s&&c.jsx("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg",children:c.jsx(wL,{onImageSelect:v,selectedImage:i,onImageRemove:b})}),c.jsxs("div",{className:"flex items-end gap-3",children:[c.jsx(Ne,{type:"button",variant:"secondary",size:h?"sm":"default",onClick:()=>l(!s),className:"flex-shrink-0 uber-button-secondary",disabled:u,children:c.jsx(HN,{className:`${h?"h-4 w-4":"h-5 w-5"}`})}),c.jsx(Uu,{ref:f,placeholder:h?"Escribir mensaje...":"Escribir mensaje... (Enter para enviar)",value:n,onChange:C=>a(C.target.value),onKeyPress:g,className:`min-h-[48px] max-h-32 resize-none flex-1 uber-input ${h?"text-sm":""}`,disabled:t||u}),c.jsx(Ne,{onClick:p,disabled:y,size:h?"sm":"default",className:"flex-shrink-0 uber-button-primary",children:u?c.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full"}):c.jsx(dl,{className:`${h?"h-4 w-4":"h-5 w-5"}`})})]}),u&&c.jsx("div",{className:"mt-3 text-sm text-gray-600 text-center font-medium",children:"Enviando mensaje..."})]})}var Dg="Avatar",[CL,gH]=Ui(Dg),[NL,G_]=CL(Dg),Y_=w.forwardRef((r,e)=>{const{__scopeAvatar:t,...n}=r,[a,i]=w.useState("idle");return c.jsx(NL,{scope:t,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:c.jsx(cr.span,{...n,ref:e})})});Y_.displayName=Dg;var K_="AvatarImage",X_=w.forwardRef((r,e)=>{const{__scopeAvatar:t,src:n,onLoadingStatusChange:a=()=>{},...i}=r,o=G_(K_,t),s=SL(n,i.referrerPolicy),l=di(u=>{a(u),o.onImageLoadingStatusChange(u)});return Yp(()=>{s!=="idle"&&l(s)},[s,l]),s==="loaded"?c.jsx(cr.img,{...i,ref:e,src:n}):null});X_.displayName=K_;var Q_="AvatarFallback",Z_=w.forwardRef((r,e)=>{const{__scopeAvatar:t,delayMs:n,...a}=r,i=G_(Q_,t),[o,s]=w.useState(n===void 0);return w.useEffect(()=>{if(n!==void 0){const l=window.setTimeout(()=>s(!0),n);return()=>window.clearTimeout(l)}},[n]),o&&i.imageLoadingStatus!=="loaded"?c.jsx(cr.span,{...a,ref:e}):null});Z_.displayName=Q_;function SL(r,e){const[t,n]=w.useState("idle");return Yp(()=>{if(!r){n("error");return}let a=!0;const i=new window.Image,o=s=>()=>{a&&n(s)};return n("loading"),i.onload=o("loaded"),i.onerror=o("error"),i.src=r,e&&(i.referrerPolicy=e),()=>{a=!1}},[r,e]),t}var J_=Y_,e4=X_,t4=Z_;const r4=w.forwardRef(({className:r,...e},t)=>c.jsx(J_,{ref:t,className:Le("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...e}));r4.displayName=J_.displayName;const n4=w.forwardRef(({className:r,...e},t)=>c.jsx(e4,{ref:t,className:Le("aspect-square h-full w-full",r),...e}));n4.displayName=e4.displayName;const a4=w.forwardRef(({className:r,...e},t)=>c.jsx(t4,{ref:t,className:Le("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...e}));a4.displayName=t4.displayName;function i4({customerName:r,profileImageUrl:e,size:t="md"}){const n={sm:"h-8 w-8",md:"h-10 w-10",lg:"h-16 w-16"},a=o=>{if(!o)return"C";const s=o.split(" ");return s.length>=2?(s[0][0]+s[1][0]).toUpperCase():s[0][0].toUpperCase()},i=e&&typeof e=="string"&&e.trim()!=="";return c.jsxs(r4,{className:n[t],children:[i&&c.jsx(n4,{src:e,alt:r||"Cliente",onLoad:()=>console.log("Avatar image loaded successfully:",e),onError:o=>{console.log("Avatar image failed to load:",e),console.error("Image error:",o)},crossOrigin:"anonymous"}),c.jsx(a4,{className:"bg-blue-100 text-blue-600",children:r?a(r):c.jsx(ts,{className:"h-4 w-4"})})]})}const EL=Tu("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Fi=w.forwardRef(({className:r,variant:e,...t},n)=>c.jsx("div",{ref:n,role:"alert",className:Le(EL({variant:e}),r),...t}));Fi.displayName="Alert";const o4=w.forwardRef(({className:r,...e},t)=>c.jsx("h5",{ref:t,className:Le("mb-1 font-medium leading-none tracking-tight",r),...e}));o4.displayName="AlertTitle";const Bi=w.forwardRef(({className:r,...e},t)=>c.jsx("div",{ref:t,className:Le("text-sm [&_p]:leading-relaxed",r),...e}));Bi.displayName="AlertDescription";function AL(){const[r,e]=w.useState(!1),[t,n]=w.useState(""),[a,i]=w.useState(!1),{toast:o}=Lt(),s=()=>{window.open("https://developers.facebook.com/apps","_blank")},l=async()=>{if(!t.trim()){o({title:"Error",description:"Por favor ingrese el nuevo token",variant:"destructive"});return}i(!0);try{const{error:u}=await xe.functions.invoke("update-meta-token",{body:{token:t.trim()}});if(u)throw u;o({title:"Token actualizado",description:"El token de WhatsApp ha sido actualizado correctamente"}),e(!1),n(""),setTimeout(()=>{window.location.reload()},1e3)}catch(u){console.error("Error updating token:",u),o({title:"Error",description:"No se pudo actualizar el token: "+(u.message||"Error desconocido"),variant:"destructive"})}finally{i(!1)}};return c.jsxs(c.Fragment,{children:[c.jsxs(Fi,{className:"border-red-200 bg-red-50",children:[c.jsx(XN,{className:"h-4 w-4 text-red-600"}),c.jsx(o4,{className:"text-red-800",children:"Token de WhatsApp Expirado"}),c.jsxs(Bi,{className:"text-red-700 space-y-3",children:[c.jsx("p",{children:"El token de acceso de Meta WhatsApp ha expirado. Los mensajes no se pueden enviar hasta que se renueve el token."}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium",children:"Para renovar el token:"}),c.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[c.jsx("li",{children:"Vaya a Meta Developer Console"}),c.jsx("li",{children:"Seleccione su aplicación de WhatsApp"}),c.jsxs("li",{children:["Vaya a WhatsApp ","->"," API Setup"]}),c.jsx("li",{children:"Genere un nuevo token temporal o configure un token permanente"}),c.jsx("li",{children:"Copie el nuevo token y úselo en el botón de abajo"})]})]}),c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsxs(Ne,{onClick:s,className:"bg-blue-600 hover:bg-blue-700",size:"sm",children:[c.jsx(Xy,{className:"h-4 w-4 mr-2"}),"Abrir Meta Developer Console"]}),c.jsxs(Ne,{onClick:()=>e(!0),className:"bg-green-600 hover:bg-green-700",size:"sm",children:[c.jsx(tm,{className:"h-4 w-4 mr-2"}),"Actualizar Token Aquí"]})]})]})]}),c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-md",children:[c.jsxs(Kr,{children:[c.jsx(Xr,{children:"Actualizar Token de WhatsApp"}),c.jsx(sa,{children:"Pegue el nuevo token de acceso que obtuvo de Meta Developer Console."})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"token",children:"Nuevo Token de Acceso"}),c.jsx(It,{id:"token",type:"password",placeholder:"Pegue aquí el nuevo token...",value:t,onChange:u=>n(u.target.value),className:"font-mono text-sm"})]}),c.jsxs("div",{className:"text-sm text-gray-600",children:[c.jsx("p",{className:"mb-2",children:"Asegúrese de que el token:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[c.jsx("li",{children:"Sea un token de producción (no temporal)"}),c.jsx("li",{children:"Tenga los permisos necesarios para WhatsApp Business"}),c.jsx("li",{children:"Esté asociado a la aplicación correcta"})]})]})]}),c.jsxs(rs,{children:[c.jsx(Ne,{variant:"outline",onClick:()=>{e(!1),n("")},disabled:a,children:"Cancelar"}),c.jsx(Ne,{onClick:l,disabled:a||!t.trim(),children:a?"Actualizando...":"Actualizar Token"})]})]})})]})}function Ep({phone:r,customerName:e,customerId:t,messages:n,isRegistered:a,onSendMessage:i,isLoading:o,profileImageUrl:s}){const l=yn(),[u,d]=w.useState(!1),f=w.useRef(null),h=w.useRef(null),p=y=>y?y.startsWith("57")?`+${y.slice(0,2)} ${y.slice(2,5)} ${y.slice(5,8)} ${y.slice(8)}`:`+${y}`:"Sin teléfono";w.useEffect(()=>{const C=setTimeout(()=>{h.current&&h.current.scrollIntoView({behavior:"smooth"})},100);return()=>clearTimeout(C)},[n]),w.useEffect(()=>{h.current&&n.length>0&&h.current.scrollIntoView({behavior:"auto"})},[]);const g=async(y,C)=>{try{await i(y,C),d(!1)}catch(S){throw S.message&&S.message.includes("Token de WhatsApp expirado")&&d(!0),S}},v=n.length>0,b=!!r;return c.jsxs("div",{className:"h-full flex flex-col bg-white",children:[!l&&c.jsx("div",{className:"p-4 border-b border-gray-200 bg-white",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(i4,{customerName:e,profileImageUrl:s,size:"md"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-semibold",children:e||"Cliente"}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[c.jsx(uh,{className:"h-3 w-3"}),p(r),c.jsx(Ot,{variant:a?"default":"secondary",className:"text-xs",children:a?"Registrado":"No registrado"})]})]})]})}),u&&c.jsx("div",{className:"p-4 border-b border-gray-200",children:c.jsx(AL,{})}),c.jsx("div",{className:"flex-1 min-h-0",children:c.jsx(Pg,{ref:f,className:"h-full",children:c.jsx("div",{className:`${l?"p-3":"p-4"} bg-gray-50 min-h-full flex flex-col justify-end`,children:v?c.jsxs("div",{className:"space-y-2",children:[n.map(y=>c.jsx(bL,{id:y.id,content:y.content,timestamp:y.timestamp,type:y.type,messageType:y.messageType,imageUrl:y.imageUrl},y.id)),c.jsx("div",{ref:h})]}):c.jsx("div",{className:"text-center text-gray-500 py-8",children:b?c.jsxs("div",{children:[c.jsx("p",{className:"mb-2",children:"Nueva conversación"}),c.jsx("p",{className:"text-sm",children:"Escribe el primer mensaje para iniciar la conversación por WhatsApp"})]}):c.jsx("p",{children:"No se encontró número de teléfono para este cliente"})})})})}),b&&c.jsx("div",{className:"border-t border-gray-200",children:c.jsx(_L,{onSendMessage:g,isLoading:o})})]})}function s4(){const{toast:r}=Lt(),e=Gr(),{data:t=[],isLoading:n}=Rt({queryKey:["sent-messages"],queryFn:async()=>{console.log("Fetching sent messages...");const{data:i,error:o}=await xe.from("sent_messages").select("*").order("sent_at",{ascending:!1}).limit(500);if(o)throw console.error("Error fetching sent messages:",o),o;return console.log("Sent messages fetched:",i?.length||0),i||[]},refetchInterval:5e3}),a=ln({mutationFn:async({customerId:i,phone:o,message:s,imageUrl:l})=>{console.log("Saving sent message:",{customerId:i,phone:o,message:s,imageUrl:l});const{data:u,error:d}=await xe.from("sent_messages").insert({customer_id:i,phone:o,message:s,image_url:l,status:"sent"}).select().single();if(d)throw console.error("Error saving sent message:",d),d;return console.log("Sent message saved successfully:",u),u},onSuccess:()=>{console.log("Invalidating sent messages query..."),e.invalidateQueries({queryKey:["sent-messages"]}),e.invalidateQueries({queryKey:["chat-messages"]})},onError:i=>{console.error("Error saving sent message:",i),r({title:"Error",description:"No se pudo guardar el mensaje enviado",variant:"destructive"})}});return{sentMessages:t,isLoading:n,saveSentMessage:a.mutateAsync,isSaving:a.isPending}}function c4(){const{sentMessages:r}=s4(),{data:e=[],isLoading:t,refetch:n}=Rt({queryKey:["chat-messages"],queryFn:async()=>{console.log("Fetching incoming messages...");const{data:s,error:l}=await xe.from("incoming_messages").select(`
          *,
          customers (
            name,
            profile_image_url
          )
        `).order("timestamp",{ascending:!1}).limit(100);if(l)throw console.error("Error fetching chat messages:",l),l;const u=(s||[]).map(d=>({id:d.id,whatsapp_message_id:d.whatsapp_message_id,from_phone:d.from_phone,customer_id:d.customer_id,message_type:d.message_type,message_content:d.message_content,message_timestamp:d.timestamp,customers:d.customers}));return console.log("Processed incoming messages:",u.length),u},refetchInterval:5e3}),a=e.reduce((s,l)=>{const u=l.from_phone;return s[u]||(s[u]=[]),s[u].push(l),s},{}),i=Object.keys(a).reduce((s,l)=>{const u=a[l],d=r.filter(g=>{const v=g.phone.replace(/[\s\-\(\)\+]/g,""),b=l.replace(/[\s\-\(\)\+]/g,"");return v===b||v.endsWith(b)||b.endsWith(v)}),f=[...u.map(g=>({id:g.id,content:g.message_content||"(Sin contenido de texto)",timestamp:g.message_timestamp,type:"incoming",messageType:g.message_type})),...d.map(g=>({id:g.id,content:g.message,timestamp:g.sent_at,type:"outgoing",imageUrl:g.image_url}))].sort((g,v)=>new Date(g.timestamp).getTime()-new Date(v.timestamp).getTime()),h=u[0],p=h?.customers?.profile_image_url||null;return s[l]={messages:f,latestIncoming:h,customerName:h?.customers?.name,customerId:h?.customer_id,profileImageUrl:typeof p=="string"?p:null},s},{});r.forEach(s=>{const l=s.phone,u=l.replace(/[\s\-\(\)\+]/g,"");Object.keys(i).find(f=>{const h=f.replace(/[\s\-\(\)\+]/g,"");return h===u||h.endsWith(u)||u.endsWith(h)})||(i[l]={messages:[{id:s.id,content:s.message,timestamp:s.sent_at,type:"outgoing",imageUrl:s.image_url}],latestIncoming:null,customerName:void 0,customerId:s.customer_id,profileImageUrl:null})});const o=Object.entries(i).map(([s,l])=>({phone:s,customerName:l.customerName,lastMessage:l.messages[l.messages.length-1]?.content||"Sin mensajes",lastMessageTime:l.messages[l.messages.length-1]?.timestamp||new Date().toISOString(),isRegistered:!!l.customerId,unreadCount:0,profileImageUrl:l.profileImageUrl})).sort((s,l)=>new Date(l.lastMessageTime).getTime()-new Date(s.lastMessageTime).getTime());return console.log("Chat list processed:",o.length,"conversations"),{chatList:o,conversationsByPhone:i,isLoading:t,refetch:n}}function jL(){Lt();const r=Gr(),e=ln({mutationFn:async t=>{if(console.log("Sending manual notification:",t),!t.customerId||!t.phone||!t.message)throw new Error("Datos incompletos para enviar notificación");const{data:n,error:a}=await xe.from("notification_log").insert({customer_id:t.customerId,package_id:t.packageId||null,notification_type:"manual_reply",message:t.message,status:"pending"}).select().single();if(a)throw console.error("Error creating notification log:",a),new Error("Error al crear registro de notificación");console.log("Notification log created:",n.id);const{data:i,error:o}=await xe.functions.invoke("send-whatsapp-notification",{body:{notificationId:n.id,phone:t.phone,message:t.message,imageUrl:t.imageUrl}});if(o)throw console.error("Error sending notification:",o),o.message&&o.message.includes("Session has expired")?new Error("Token de WhatsApp expirado. Necesita renovar el token de acceso en la configuración de Meta."):new Error("Error al enviar notificación: "+o.message);if(i&&!i.success&&i.error)throw i.error.includes("Session has expired")||i.error.includes("access token")?new Error("Token de WhatsApp expirado. Necesita renovar el token de acceso en la configuración de Meta."):new Error("Error de WhatsApp: "+i.error);return console.log("Manual notification sent successfully:",i),i},onSuccess:()=>{r.invalidateQueries({queryKey:["notification-log"]}),r.invalidateQueries({queryKey:["chat-messages"]})},onError:t=>{console.error("Error sending manual notification:",t)}});return{sendManualNotification:e.mutateAsync,isManualSending:e.isPending}}function PL(){const{toast:r}=Lt();return{validateMessage:(t,n,a)=>!t.trim()&&!n?(r({title:"Error",description:"Debe escribir un mensaje o adjuntar una imagen",variant:"destructive"}),!1):a?!0:(r({title:"Error",description:"No se ha seleccionado un número de teléfono",variant:"destructive"}),!1)}}async function DL(){try{const{data:r}=await xe.storage.listBuckets();if(!r?.some(t=>t.name==="chat-images")){const{error:t}=await xe.functions.invoke("create-chat-storage");if(t)throw console.error("Error creating chat storage bucket:",t),t;console.log("Chat storage bucket created successfully")}}catch(r){throw console.error("Error ensuring chat storage bucket:",r),r}}async function IL(r){console.log("📸 Uploading image..."),await DL();const e=r.name.split(".").pop(),t=`${Date.now()}.${e}`,{data:n,error:a}=await xe.storage.from("chat-images").upload(t,r,{cacheControl:"3600",upsert:!1});if(a)throw console.error("❌ Image upload failed:",a),new Error("Error al subir la imagen: "+a.message);const{data:{publicUrl:i}}=xe.storage.from("chat-images").getPublicUrl(n.path);return console.log("✅ Image uploaded successfully:",i),i}async function TL({selectedPhone:r,customerId:e,message:t,imageUrl:n,sendManualNotification:a}){if(console.log("📱 Sending WhatsApp message..."),e)console.log("👤 Sending to registered customer"),await a({customerId:e,packageId:"",message:t,phone:r,imageUrl:n});else{console.log("👤 Sending to unregistered customer");const{data:i,error:o}=await xe.from("notification_log").insert({package_id:null,customer_id:null,notification_type:"manual_reply",message:t,status:"pending"}).select().single();if(o)throw console.error("❌ Error creating notification log:",o),new Error("Error al crear registro de notificación");const{data:s,error:l}=await xe.functions.invoke("send-whatsapp-notification",{body:{notificationId:i.id,phone:r,message:t,imageUrl:n}});if(l)throw console.error("❌ WhatsApp function error:",l),l.message&&l.message.includes("Session has expired")?new Error("Token de WhatsApp expirado. Necesita renovar el token de acceso en la configuración de Meta."):new Error("Error al enviar mensaje por WhatsApp: "+l.message);if(s&&s.error)throw console.error("❌ WhatsApp API error:",s.error),s.error.includes("Session has expired")||s.error.includes("access token")||s.error.includes("token")?new Error("Token de WhatsApp expirado. Necesita renovar el token de acceso en la configuración de Meta."):new Error("Error de WhatsApp: "+s.error);console.log("✅ WhatsApp message sent successfully")}}function OL(){const{toast:r}=Lt();return{handleError:t=>{console.error("❌ Error in message send process:",t);let n="No se pudo enviar el mensaje";throw t instanceof Error&&(t.message.includes("Token de WhatsApp expirado")?n=t.message:t.message.includes("row-level security policy")?n="Error de permisos. Intente nuevamente.":t.message.includes("Bucket not found")?n="Error de configuración de almacenamiento.":n=t.message),r({title:"Error al enviar mensaje",description:n,variant:"destructive"}),t}}}function l4(){const{toast:r}=Lt(),{sendManualNotification:e,isManualSending:t}=jL(),{saveSentMessage:n}=s4(),{validateMessage:a}=PL(),{handleError:i}=OL();return{handleSendMessage:async(s,l,u,d)=>{console.log("🚀 Starting message send process:",{selectedPhone:s,customerId:l,message:u.substring(0,50)+"...",hasImage:!!d});try{if(!a(u,d,s))return;const f=s.replace(/[\s\-\(\)\+]/g,"");console.log("📞 Phone cleaned:",{original:s,cleaned:f});let h;d&&(h=await IL(d));const p=u.trim()||(h?"📷 Imagen":"");console.log("💬 Final message prepared:",p),console.log("💾 Saving sent message to database..."),await n({customerId:l,phone:s,message:p,imageUrl:h}),console.log("✅ Message saved to database"),await TL({selectedPhone:s,customerId:l,message:p,imageUrl:h,sendManualNotification:e}),console.log("🎉 Message sent successfully!"),r({title:"¡Mensaje enviado!",description:"Su mensaje ha sido enviado por WhatsApp correctamente"})}catch(f){i(f)}},isManualSending:t}}function kL(r){const{data:e,isLoading:t,refetch:n}=Rt({queryKey:["customer",r],queryFn:async()=>{if(!r)return null;console.log("Fetching customer data for ID:",r);const{data:i,error:o}=await xe.from("customers").select("id, name, phone, whatsapp_number, email, profile_image_url").eq("id",r).single();return o?(console.error("Error fetching customer:",o),null):(console.log("Customer data fetched:",i),console.log("Profile image URL from customer data:",i?.profile_image_url),i&&await a(i),i)},enabled:!!r,refetchInterval:3e4}),a=async i=>{const o=i.whatsapp_number||i.phone;if(!o)return;const s=o.replace(/[\s\-\(\)\+]/g,"");console.log("Checking for unlinked messages with phone:",o);const{data:l,error:u}=await xe.from("incoming_messages").select("id, from_phone").is("customer_id",null);if(u){console.error("Error fetching unlinked messages:",u);return}const d=l.filter(f=>{const h=f.from_phone.replace(/[\s\-\(\)\+]/g,"");return h===s||h.endsWith(s)||s.endsWith(h)});if(d.length>0){console.log(`Linking ${d.length} messages to customer ${i.name}`);const{error:f}=await xe.from("incoming_messages").update({customer_id:i.id}).in("id",d.map(h=>h.id));f?console.error("Error linking messages to customer:",f):console.log("Successfully linked messages to customer")}};return{customer:e,isLoading:t,refetch:n,getPhoneNumber:()=>e?.whatsapp_number||e?.phone||null}}function u4({open:r,onOpenChange:e,customerId:t,customerName:n,phone:a}){const{conversationsByPhone:i,isLoading:o,refetch:s}=c4(),{customer:l,isLoading:u,getPhoneNumber:d}=kL(t),{handleSendMessage:f,isManualSending:h}=l4(),[p,g]=w.useState(null);w.useEffect(()=>{l&&(console.log("ChatDialog - Customer data:",l),console.log("ChatDialog - Profile image URL:",l.profile_image_url))},[l]),w.useEffect(()=>{if(r&&t){const j=d();if(j){const D=j.replace(/[\s\-\(\)\+]/g,""),F=Object.keys(i||{}).find(M=>{const T=M.replace(/[\s\-\(\)\+]/g,"");return T===D||T.endsWith(D)||D.endsWith(T)});F?(console.log("Found existing conversation for phone:",F),g(F)):(console.log("No existing conversation found, using customer phone:",j),g(j))}}},[r,t,i,d]),w.useEffect(()=>{l&&r&&setTimeout(()=>{s()},1e3)},[l,r,s]);const v=async(j,D)=>{if(!t)return;const F=p||d();if(!F){console.error("No se pudo obtener el teléfono del cliente");return}await f(F,t,j,D),s()};if(!r||!t)return null;const b=p&&i&&i[p],y=o||u,C=n||l?.name||"Cliente",S=p||d()||"";return c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"max-w-4xl max-h-[80vh] p-0",children:[c.jsx(Kr,{className:"p-6 pb-0",children:c.jsxs(Xr,{className:"flex items-center gap-2",children:[c.jsx(Mi,{className:"h-5 w-5"}),"Chat con ",C]})}),c.jsx("div",{className:"flex-1 overflow-hidden",children:y?c.jsx("div",{className:"flex justify-center items-center py-12",children:c.jsx("div",{className:"text-gray-500",children:"Cargando información del cliente..."})}):c.jsx("div",{className:"h-[500px]",children:c.jsx(Ep,{phone:S,customerName:C,customerId:t,messages:b?.messages||[],isRegistered:!0,onSendMessage:v,isLoading:h,profileImageUrl:l?.profile_image_url})})})]})})}function ML({packages:r,filteredPackages:e,isLoading:t,onUpdate:n,disableChat:a=!1,previewRole:i}){const[o,s]=w.useState(null),[l,u]=w.useState(!1),[d,f]=w.useState(!1),[h,p]=w.useState(!1),[g,v]=w.useState(null),[b,y]=w.useState(void 0),[C,S]=w.useState(""),j=e||[],D=C?j.filter(H=>H.tracking_number.toLowerCase().includes(C.toLowerCase())):j,F=()=>{n&&n("",{})},M=H=>{H.status!=="delivered"&&(s(H),u(!0))},T=H=>{H.stopPropagation()},q=()=>{u(!1),s(null),F()},J=()=>{f(!0)},O=(H,X)=>{v(H),y(X),p(!0)},k=C&&D.length===1?D[0]:null;return c.jsxs(c.Fragment,{children:[c.jsxs(He,{children:[c.jsx(tM,{packagesCount:D.length,onPrintMultiple:J}),c.jsxs(We,{children:[c.jsx("div",{className:"mb-4",children:c.jsxs("div",{className:"relative",children:[c.jsx(fh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),c.jsx("input",{type:"text",placeholder:"Buscar por número de tracking (ej: EO-2025-3424)...",value:C,onChange:H=>S(H.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})}),k&&c.jsxs("div",{className:"mb-6",children:[c.jsx(Fi,{children:c.jsxs(Bi,{children:["Encomienda encontrada: ",k.tracking_number]})}),c.jsx("div",{className:"mt-4",children:c.jsx(PR,{trackingNumber:k.tracking_number,amountToCollect:k.amount_to_collect,currency:k.currency,freight:k.freight,weight:k.weight})})]}),t?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500",children:"Cargando..."})}):c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"Tracking"}),c.jsx(Me,{children:"Cliente"}),c.jsx(Me,{children:"Ruta"}),c.jsx(Me,{children:"Estado"}),c.jsx(Me,{children:"Fecha"}),c.jsx(Me,{children:"Descripción"}),c.jsx(Me,{children:"A Cobrar"}),c.jsx(Me,{children:"Moneda"}),c.jsx(Me,{children:"Chat"}),c.jsx(Me,{children:"Acciones"})]})}),c.jsx(Wa,{children:D.map(H=>c.jsx(jR,{package:H,onRowClick:M,onActionsClick:T,onUpdate:F,onOpenChat:O,previewRole:i,disableChat:a,showChatInSeparateColumn:!0},H.id))})]})]})]}),c.jsx(Dm,{open:l,onOpenChange:u,package:o,onSuccess:q}),c.jsx(L3,{open:d,onOpenChange:f,packages:D}),c.jsx(u4,{open:h,onOpenChange:p,customerId:g,customerName:b})]})}function RL(){const[r,e]=w.useState(""),t={id:"test-package-didier-001",tracking:"ENC-TEST-001",customer:"Didier Ojito",status:"en_destino",action:"package_scan"};w.useEffect(()=>{(async()=>{try{const o=JSON.stringify(t),s=await Vs.toDataURL(o,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}});e(s)}catch(o){console.error("Error generating test QR code:",o)}})()},[]);const n=()=>{const i=JSON.stringify(t,null,2);navigator.clipboard.writeText(i),alert("Datos del QR copiados al portapapeles")},a=()=>{if(r){const i=document.createElement("a");i.download="test-qr-didier-ojito.png",i.href=r,i.click()}};return c.jsxs(He,{className:"max-w-md mx-auto",children:[c.jsxs(yt,{children:[c.jsx(Nt,{className:"text-center",children:"Código QR de Prueba"}),c.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Paquete para: ",c.jsx("strong",{children:"Didier Ojito"})]})]}),c.jsxs(We,{className:"space-y-4",children:[r&&c.jsx("div",{className:"flex justify-center",children:c.jsx("img",{src:r,alt:"QR Code de prueba",className:"border border-gray-300 rounded"})}),c.jsxs("div",{className:"text-xs text-gray-500 space-y-1",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Tracking:"})," ",t.tracking]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Cliente:"})," ",t.customer]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Estado:"})," ",t.status]}),c.jsxs("p",{children:[c.jsx("strong",{children:"ID:"})," ",t.id]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs(Ne,{onClick:n,variant:"outline",size:"sm",className:"flex-1",children:[c.jsx(em,{className:"h-4 w-4 mr-2"}),"Copiar Datos"]}),c.jsxs(Ne,{onClick:a,variant:"outline",size:"sm",className:"flex-1",disabled:!r,children:[c.jsx(BN,{className:"h-4 w-4 mr-2"}),"Descargar"]})]}),c.jsxs("div",{className:"text-xs text-blue-600 bg-blue-50 p-2 rounded",children:[c.jsx("p",{children:c.jsx("strong",{children:"Para probar:"})}),c.jsxs("ol",{className:"list-decimal list-inside space-y-1 mt-1",children:[c.jsx("li",{children:"Abre la vista móvil en tu dispositivo"}),c.jsx("li",{children:'Haz clic en "Escanear Código QR"'}),c.jsx("li",{children:"Apunta la cámara a este código QR"}),c.jsx("li",{children:"El sistema debería reconocer el paquete"})]})]})]})]})}function Ig({packageStats:r,customersCount:e,onNewPackage:t,onNewTrip:n,onViewNotifications:a,onMobileDelivery:i,packages:o,filteredPackages:s,isLoading:l,onUpdate:u,disableChat:d=!1,previewRole:f}){return c.jsxs(xn,{value:"dashboard",className:"space-y-4 sm:space-y-6",children:[c.jsx(FA,{packageStats:r,customersCount:e}),c.jsx(BA,{onNewPackage:t,onNewTrip:n,onViewNotifications:a,onMobileDelivery:i}),c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4 text-center",children:"QR de Prueba para Móvil"}),c.jsx(RL,{})]}),c.jsx(ML,{packages:o,filteredPackages:s,isLoading:l,onUpdate:u,disableChat:!1,previewRole:f})]})}function rx({currentDate:r,onPreviousMonth:e,onNextMonth:t}){return c.jsxs("div",{className:"w-full",children:[c.jsxs("div",{className:"w-full mb-4",children:[c.jsx(Nt,{className:"text-black w-full",children:"Calendario de Viajes"}),c.jsx(Hr,{className:"text-gray-600 w-full",children:"Vista de calendario de todos los viajes programados"})]}),c.jsxs("div",{className:"flex items-center justify-center gap-3",children:[c.jsx(Ne,{variant:"secondary",size:"icon",onClick:e,className:"uber-button-secondary",children:c.jsx(MN,{className:"h-4 w-4"})}),c.jsx("h2",{className:"text-xl font-bold text-black min-w-[200px] text-center",children:pt(r,"MMMM yyyy",{locale:Bn}).toUpperCase()}),c.jsx(Ne,{variant:"secondary",size:"icon",onClick:t,className:"uber-button-secondary",children:c.jsx(Ky,{className:"h-4 w-4"})})]})]})}function LL({trips:r,onShowPopover:e}){console.log("TripIndicator rendering with trips:",r);const t=r.reduce((a,i)=>(a[i.status]||(a[i.status]=[]),a[i.status].push(i),a),{}),n=a=>{switch(a){case"completed":return"bg-green-500";case"in_progress":return"bg-blue-500";case"scheduled":return"bg-yellow-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}};return c.jsxs("div",{className:"space-y-1",children:[c.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(t).map(([a,i])=>i.map((o,s)=>c.jsx("button",{onClick:e,className:`w-3 h-3 rounded-full ${n(a)} hover:scale-110 transition-transform cursor-pointer`,title:`${o.flight_number||"Sin vuelo"} - ${o.origin} → ${o.destination} (${a})`},`${a}-${o.id}-${s}`)))}),r.length>6&&c.jsxs("button",{onClick:e,className:"text-xs text-gray-600 hover:text-black transition-colors",children:["+",r.length-6," más"]})]})}const FL=r=>{switch(r){case"completed":return"bg-green-100 text-green-800 border-green-200";case"in_progress":return"bg-blue-100 text-blue-800 border-blue-200";case"scheduled":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},BL=r=>{switch(r){case"completed":return"Completado";case"in_progress":return"En Progreso";case"scheduled":return"Programado";case"cancelled":return"Cancelado";default:return r}};function $L(r){return Rt({queryKey:["packages-by-trip",r],queryFn:async()=>{const{data:e,error:t}=await xe.from("packages").select("*").eq("trip_id",r).order("created_at",{ascending:!1});if(t)throw t;return!e||e.length===0?[]:await Promise.all(e.map(async a=>{const{data:i}=await xe.from("customers").select("name, email").eq("id",a.customer_id).single();return{...a,customers:i||{name:"N/A",email:"N/A"}}}))},enabled:!!r})}function UL({trips:r,open:e,onOpenChange:t,onAddPackage:n,onViewPackagesByDate:a,selectedDate:i}){const[o,s]=w.useState("trips"),[l,u]=w.useState(null),{data:d=[],isLoading:f}=$L(l||""),h=y=>{n(y),t(!1)},p=()=>{a&&(a(i),t(!1))},g=()=>{s("trips"),u(null)},v=y=>{y||(s("trips"),u(null)),t(y)},b=r.find(y=>y.id===l);return c.jsx(un,{open:e,onOpenChange:v,children:c.jsxs(Yr,{className:"sm:max-w-md max-h-[90vh] flex flex-col",children:[c.jsxs(Kr,{className:"flex-shrink-0",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[o==="packages"&&c.jsx(Ne,{variant:"ghost",size:"sm",onClick:g,className:"p-2 h-auto",children:c.jsx(Jo,{className:"h-4 w-4"})}),c.jsx(Xr,{children:o==="trips"?"Viajes del día":"Encomiendas del viaje"})]}),o==="packages"&&b&&c.jsx("div",{className:"text-sm text-gray-600 mt-2",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ts,{className:"h-4 w-4"}),b.origin," → ",b.destination,b.flight_number&&c.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:b.flight_number})]})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto space-y-3 min-h-0",children:[o==="trips"&&c.jsxs(c.Fragment,{children:[a&&r.length>0&&c.jsx("div",{className:"border-b pb-3 mb-3",children:c.jsxs(Ne,{variant:"outline",onClick:p,className:"w-full text-sm h-10",children:[c.jsx(Li,{className:"h-4 w-4 mr-2"}),"Ver Todas las Encomiendas del Día"]})}),r.map(y=>c.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 border",children:[c.jsx("div",{className:"flex items-center justify-between mb-2",children:c.jsx(Ot,{className:`${FL(y.status)} text-xs px-2 py-1 font-medium border rounded-full`,children:BL(y.status)})}),c.jsxs("div",{className:"font-bold text-black text-sm mb-2",children:[y.origin," → ",y.destination]}),y.flight_number&&c.jsxs("div",{className:"text-gray-600 text-xs mb-3 font-medium",children:["Vuelo: ",y.flight_number]}),c.jsx("div",{className:"space-y-2",children:c.jsxs(Ne,{size:"sm",onClick:()=>h(y.id),className:"w-full uber-button-primary text-xs h-8",children:[c.jsx(ao,{className:"h-3 w-3 mr-1"}),"Agregar Encomienda"]})})]},y.id))]}),o==="packages"&&c.jsx(c.Fragment,{children:f?c.jsx("div",{className:"text-center py-4 text-gray-500",children:"Cargando encomiendas..."}):d.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(Dr,{className:"h-12 w-12 mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"No hay encomiendas en este viaje"}),c.jsxs(Ne,{size:"sm",onClick:()=>l&&h(l),className:"uber-button-primary",children:[c.jsx(ao,{className:"h-4 w-4 mr-1"}),"Agregar Primera Encomienda"]})]}):c.jsxs(c.Fragment,{children:[d.map(y=>c.jsxs("div",{className:"bg-white rounded-lg p-3 border shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("div",{className:"font-medium text-sm",children:y.tracking_number}),c.jsx(Ot,{variant:"outline",className:"text-xs",children:y.status})]}),c.jsxs("div",{className:"text-sm text-gray-600 mb-1",children:["Cliente: ",y.customers?.name||"N/A"]}),c.jsxs("div",{className:"text-xs text-gray-500 mb-2",children:[y.origin," → ",y.destination]}),y.description&&c.jsx("div",{className:"text-xs text-gray-600 bg-gray-50 p-2 rounded",children:y.description})]},y.id)),c.jsxs(Ne,{size:"sm",onClick:()=>l&&h(l),className:"w-full uber-button-primary text-xs h-8 mt-3",children:[c.jsx(ao,{className:"h-3 w-3 mr-1"}),"Agregar Otra Encomienda"]})]})})]})]})})}function qL({day:r,currentDate:e,trips:t,onAddPackage:n,onCreateTrip:a,onViewPackagesByDate:i}){const[o,s]=w.useState(!1),l=My(r,e),u=hN(r),d=pt(r,"d"),f=yu(new Date),h=yu(r),p=Wo(h,f),g=()=>{t.length>0?s(!0):p||a(r)},v=()=>{s(!0)};return c.jsxs(c.Fragment,{children:[c.jsxs("div",{onClick:g,className:`
          relative min-h-[60px] md:min-h-[80px] p-1 md:p-2 border rounded-lg 
          ${p?"cursor-default":"cursor-pointer"}
          ${!u&&l?"bg-white border-gray-200 hover:bg-gray-50":""}
          ${!u&&!l?"bg-gray-50 border-gray-100 hover:bg-gray-100":""}
          ${!u&&t.length>0?"hover:bg-gray-50 transition-colors":""}
          ${u?"bg-black border-black hover:bg-gray-900":""}
          ${p&&!t.length?"opacity-50":""}
          transition-colors
        `,children:[c.jsx("div",{className:`text-xs md:text-sm font-medium 
          ${l&&!u?"text-black":""}
          ${!l&&!u?"text-gray-400":""}
          ${u?"text-white":""}
          ${p?"text-gray-400":""}
        `,children:d}),t.length>0&&c.jsx("div",{className:"mt-1",children:c.jsx(LL,{trips:t,onShowPopover:v})}),t.length===0&&l&&!p&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:c.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"+ Crear viaje"})})]}),c.jsx(UL,{trips:t,open:o,onOpenChange:s,onAddPackage:n,onViewPackagesByDate:i,selectedDate:r})]})}function VL({calendarDays:r,currentDate:e,trips:t,onAddPackage:n,onCreateTrip:a,onViewPackagesByDate:i}){const o=["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"];console.log("CalendarGrid total trips:",t.length);const s=l=>{const u=t.filter(d=>{const f=Go(d.trip_date);return Ry(f,l)});return u.length>0&&console.log(`Found ${u.length} trips for date ${l.toDateString()}:`,u),u};return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"grid grid-cols-7 gap-1 md:gap-2 mb-4",children:o.map(l=>c.jsx("div",{className:"p-2 md:p-3 text-center font-bold text-black text-xs md:text-sm bg-gray-100 rounded-lg",children:l},l))}),c.jsx("div",{className:"grid grid-cols-7 gap-1 md:gap-2",children:r.map(l=>{const u=s(l);return c.jsx(qL,{day:l,currentDate:e,trips:u,onAddPackage:n,onCreateTrip:a,onViewPackagesByDate:i},l.toISOString())})})]})}function zL({trips:r,isLoading:e,onAddPackage:t,onCreateTrip:n,onViewPackagesByDate:a}){const[i,o]=w.useState(new Date);console.log("CalendarView received trips:",r);const s=sh(i),l=ch(i),u=Ly(s,{weekStartsOn:0}),d=Fy(l,{weekStartsOn:0}),f=pN({start:u,end:d}),h=()=>{o(Ro(i,1))},p=()=>{o(co(i,1))};return e?c.jsxs(He,{className:"uber-card",children:[c.jsx(yt,{className:"px-3 sm:px-6",children:c.jsx(rx,{currentDate:i,onPreviousMonth:h,onNextMonth:p})}),c.jsx(We,{className:"px-3 sm:px-6",children:c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500 text-sm",children:"Cargando..."})})})]}):c.jsxs(He,{className:"uber-card",children:[c.jsx(yt,{className:"px-3 sm:px-6 pb-3 sm:pb-6",children:c.jsx(rx,{currentDate:i,onPreviousMonth:h,onNextMonth:p})}),c.jsx(We,{className:"px-2 sm:px-6 pb-3 sm:pb-6",children:c.jsx(VL,{calendarDays:f,currentDate:i,trips:r,onAddPackage:t,onCreateTrip:n,onViewPackagesByDate:a})})]})}const Gf=r=>{const e=r.getFullYear(),t=String(r.getMonth()+1).padStart(2,"0"),n=String(r.getDate()).padStart(2,"0");return`${e}-${t}-${n}`};function HL(r){const e=Gf(r);return Rt({queryKey:["packages-by-date",e],queryFn:async()=>{console.log("🔍 Fetching packages for date:",e);const{data:t,error:n}=await xe.from("trips").select(`
          id,
          origin,
          destination,
          flight_number,
          status,
          traveler_id,
          travelers (
            first_name,
            last_name
          )
        `).eq("trip_date",e).order("created_at",{ascending:!1});if(n)throw console.error("❌ Error fetching trips:",n),n;if(!t||t.length===0)return console.log("📭 No trips found for date:",e),{trips:[],dispatches:[]};const a=t.map(d=>d.id),{data:i,error:o}=await xe.from("packages").select(`
          id,
          tracking_number,
          customer_id,
          description,
          weight,
          freight,
          amount_to_collect,
          currency,
          status,
          trip_id,
          customers (
            name,
            email
          )
        `).in("trip_id",a).order("created_at",{ascending:!1});if(o)throw console.error("❌ Error fetching packages:",o),o;const s=t.map(d=>({...d,packages:(i||[]).filter(f=>f.trip_id===d.id)})),{data:l,error:u}=await xe.from("dispatch_relations").select("*").eq("dispatch_date",e).order("created_at",{ascending:!1});return u&&console.error("❌ Error fetching dispatches:",u),console.log("✅ Packages by date loaded:",{trips:s.length,totalPackages:(i||[]).length,dispatches:l?.length||0}),{trips:s,dispatches:l||[]}},refetchOnWindowFocus:!0,refetchInterval:3e4,staleTime:1e4})}function WL(r){return Rt({queryKey:["dispatch-packages",r],queryFn:async()=>{const{data:e,error:t}=await xe.from("dispatch_packages").select("package_id").eq("dispatch_id",r);if(t)throw t;if(!e||e.length===0)return[];const n=e.map(s=>s.package_id),{data:a,error:i}=await xe.from("packages").select(`
          id,
          tracking_number,
          origin,
          destination,
          status,
          description,
          weight,
          freight,
          amount_to_collect,
          currency,
          trip_id,
          customer_id
        `).in("id",n);if(i)throw i;return await Promise.all((a||[]).map(async s=>{const{data:l}=await xe.from("customers").select("name, email").eq("id",s.customer_id).single();return{...s,customers:l||{name:"N/A",email:"N/A"}}}))},enabled:!!r,refetchOnWindowFocus:!0,refetchInterval:2e4,staleTime:5e3})}function GL(){const r=Gr();return ln({mutationFn:async({date:e,packageIds:t,notes:n})=>{const{data:a,error:i}=await xe.from("packages").select("weight, freight, amount_to_collect").in("id",t);if(i)throw i;const o=a.reduce((g,v)=>({weight:g.weight+(v.weight||0),freight:g.freight+(v.freight||0),amount_to_collect:g.amount_to_collect+(v.amount_to_collect||0)}),{weight:0,freight:0,amount_to_collect:0}),{data:s,error:l}=await xe.from("dispatch_relations").insert({dispatch_date:Gf(e),total_packages:t.length,total_weight:o.weight,total_freight:o.freight,total_amount_to_collect:o.amount_to_collect,status:"procesado",notes:n||null}).select().single();if(l)throw l;const u=t.map(g=>({dispatch_id:s.id,package_id:g})),{error:d}=await xe.from("dispatch_packages").insert(u);if(d)throw d;const{error:f}=await xe.from("packages").update({status:"procesado",updated_at:new Date().toISOString()}).in("id",t);f&&console.error("Error updating package status:",f);const h=t.map(g=>({package_id:g,event_type:"processed",description:"Encomienda procesada para despacho",location:"Centro de procesamiento"})),{error:p}=await xe.from("tracking_events").insert(h);return p&&console.error("Error creating tracking events:",p),{dispatch:s,date:e}},onSuccess:e=>{const t=pt(e.date,"yyyy-MM-dd");r.invalidateQueries({queryKey:["dispatch-relations"]}),r.invalidateQueries({queryKey:["dispatch-relations",t]}),r.invalidateQueries({queryKey:["packages-by-date"]}),r.invalidateQueries({queryKey:["packages-by-date",t]}),r.invalidateQueries({queryKey:["packages"]}),r.invalidateQueries({queryKey:["trips"]}),r.refetchQueries({queryKey:["dispatch-relations"]}),r.refetchQueries({queryKey:["packages-by-date",t]}),r.refetchQueries({queryKey:["packages"]})}})}function Tg(r){return Rt({queryKey:["dispatch-relations",r?Gf(r):"all"],queryFn:async()=>{console.log("🔍 Fecha recibida en useDispatchRelations:",r),console.log("🔍 Fecha original (getDate):",r?r.getDate():"undefined"),console.log("🔍 Fecha original (getMonth):",r?r.getMonth()+1:"undefined"),console.log("🔍 Fecha original (getFullYear):",r?r.getFullYear():"undefined");let e=xe.from("dispatch_relations").select("*").order("created_at",{ascending:!1});if(r){const a=Gf(r);console.log("📅 Fecha formateada para consulta (nueva función):",a),e=e.eq("dispatch_date",a)}const{data:t,error:n}=await e;if(n)throw console.error("❌ Error en consulta de despachos:",n),n;return console.log("📦 Despachos encontrados:",t),console.log("📊 Número de despachos:",t?.length||0),t&&t.length>0&&console.log("🗓️ Fechas de despacho en los datos:",t.map(a=>a.dispatch_date)),t||[]},refetchOnWindowFocus:!0,refetchInterval:15e3,staleTime:3e3})}function YL(r){const{data:e,isLoading:t}=HL(r),{data:n=[]}=Tg(r),[a,i]=w.useState(null),[o,s]=w.useState(""),[l,u]=w.useState(!1),[d,f]=w.useState(!1),[h,p]=w.useState(""),[g,v]=w.useState(""),[b,y]=w.useState(!1),[C,S]=w.useState(!1),j=Gr(),D=e?.trips||[],F=Array.isArray(D)?D:[];console.log("🔍 [usePackagesByDateView] Data validation:",{hasData:!!e,dataTrips:e?.trips,tripsDataType:typeof D,isArray:Array.isArray(D),safeTripsLength:F.length});const M=F.map(G=>({id:G.id,origin:G.origin,destination:G.destination,flight_number:G.flight_number,packages:G.packages.map(Y=>({id:Y.id,tracking_number:Y.tracking_number,customer_id:Y.customer_id,description:Y.description,weight:Y.weight,freight:Y.freight,amount_to_collect:Y.amount_to_collect,currency:Y.currency,status:Y.status,customers:Y.customers||void 0}))})),T=(G,Y)=>{console.log("🎯 [usePackagesByDateView] Package clicked with trip ID:",{packageId:G.id,tripId:Y,packageTripId:G.trip_id}),i(G),s(Y),u(!0)},q=(G,Y)=>{p(G),v(Y||"Cliente"),f(!0)},J=()=>{u(!1),i(null),s("");const G=pt(r,"yyyy-MM-dd");j.invalidateQueries({queryKey:["packages-by-date",G]}),j.invalidateQueries({queryKey:["packages"]}),j.invalidateQueries({queryKey:["trips"]})},O=()=>{console.log("Create dispatch for date:",r),y(!0)},k=()=>{console.log("Open labels dialog for date:",r),S(!0)},H=()=>{y(!1);const G=pt(r,"yyyy-MM-dd");j.invalidateQueries({queryKey:["packages-by-date",G]}),j.invalidateQueries({queryKey:["dispatch-relations",G]}),j.invalidateQueries({queryKey:["packages"]}),j.invalidateQueries({queryKey:["trips"]})},X=M.reduce((G,Y)=>G+Y.packages.length,0),ce=M.reduce((G,Y)=>G+Y.packages.reduce((ge,ye)=>ge+(ye.weight||0),0),0),Q=M.reduce((G,Y)=>G+Y.packages.reduce((ge,ye)=>ge+(ye.freight||0),0),0),re=M.reduce((G,Y)=>G+Y.packages.reduce((ge,ye)=>ge+(ye.amount_to_collect||0),0),0);return{trips:M,dispatches:n,isLoading:t,selectedPackage:a,selectedTripId:o,editDialogOpen:l,setEditDialogOpen:u,chatDialogOpen:d,setChatDialogOpen:f,selectedCustomerId:h,selectedCustomerName:g,createDispatchDialogOpen:b,setCreateDispatchDialogOpen:y,labelsDialogOpen:C,setLabelsDialogOpen:S,totalPackages:X,totalWeight:ce,totalFreight:Q,totalAmountToCollect:re,handlePackageClick:T,handleOpenChat:q,handlePackageEditSuccess:J,handleCreateDispatch:O,handleOpenLabelsDialog:k,handleCreateDispatchSuccess:H,queryClient:j}}function KL({selectedDate:r,totalPackages:e,totalTrips:t,dispatchCount:n,onBack:a,onCreateDispatch:i,onOpenLabelsDialog:o}){const s=yn();return c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsxs(Ne,{variant:"outline",size:"sm",onClick:a,className:"flex items-center gap-2",children:[c.jsx(Jo,{className:"h-4 w-4"}),c.jsx("span",{className:s?"text-xs":"",children:"Volver al Calendario"})]})}),c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("div",{children:[c.jsxs("h2",{className:"text-xl sm:text-2xl font-bold",children:["Encomiendas - ",pt(r,"d 'de' MMMM 'de' yyyy",{locale:Bn})]}),c.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mt-1",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Dr,{className:"h-4 w-4"}),e," encomiendas"]}),c.jsx("span",{children:"•"}),c.jsxs("span",{children:[t," viajes"]}),n>0&&c.jsxs(c.Fragment,{children:[c.jsx("span",{children:"•"}),c.jsxs("span",{children:[n," despachos"]})]})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs(Ne,{onClick:o,className:"flex items-center gap-2",variant:"outline",children:[c.jsx(fi,{className:"h-4 w-4"}),c.jsx("span",{className:s?"text-xs":"",children:"Gestionar Etiquetas"})]}),c.jsxs(Ne,{onClick:i,className:"flex items-center gap-2",children:[c.jsx(Rn,{className:"h-4 w-4"}),c.jsx("span",{className:s?"text-xs":"",children:"Crear Despacho"})]})]})]})]})}function XL({selectedDate:r}){const e=t=>pt(t,"EEEE, d 'de' MMMM 'de' yyyy",{locale:Bn});return c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Dr,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay viajes programados"}),c.jsxs("p",{className:"text-gray-500",children:["No se encontraron viajes para el ",e(r)]})]})}function QL({trip:r,onAddPackage:e}){const t=yn();return c.jsx(yt,{className:`${t?"px-4 pb-3":"px-6 pb-4"}`,children:c.jsxs("div",{className:`${t?"space-y-3":"flex items-center justify-between"}`,children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs(Nt,{className:`${t?"text-sm":"text-lg"} flex items-center gap-2 mb-2`,children:[c.jsx(gi,{className:"h-4 w-4 text-gray-500"}),c.jsxs("span",{className:"truncate",children:[r.origin," → ",r.destination]})]}),r.flight_number&&c.jsxs("p",{className:`${t?"text-xs":"text-sm"} text-gray-600 flex items-center gap-2`,children:[c.jsx(Ts,{className:"h-3 w-3"}),"Vuelo: ",r.flight_number]})]}),c.jsxs(Ne,{onClick:()=>e(r.id),size:t?"sm":"default",className:`${t?"w-full text-xs":"text-sm"} flex items-center gap-2`,children:[c.jsx(ao,{className:"h-3 w-3"}),"Agregar Encomienda"]})]})})}function ZL({package:r,onClick:e,onOpenChat:t,previewRole:n,disableChat:a=!1}){const{data:i}=Ru(n),o=u=>{switch(u){case"delivered":return"bg-green-100 text-green-800";case"in_transit":return"bg-blue-100 text-blue-800";case"arrived":return"bg-orange-100 text-orange-800";case"bodega":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},s=u=>{u.stopPropagation(),t&&!a&&i?.role==="admin"&&t(r.customer_id,r.customers?.name)},l=!a&&i?.role==="admin"&&t;return c.jsx("div",{className:"p-4 border rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",onClick:e,children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"font-semibold text-lg",children:r.customers?.name||"Cliente no especificado"}),c.jsx(Ot,{className:o(r.status),children:r.status})]}),c.jsx("span",{className:"font-semibold text-lg",children:r.tracking_number})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Peso:"})," ",r.weight?`${r.weight} kg`:"N/A"]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Flete:"})," ",oo(r.freight,r.currency||"COP")]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"A Cobrar:"})," ",oo(r.amount_to_collect,r.currency||"COP")]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Moneda:"})," ",r.currency||"COP"]})]}),c.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:[c.jsx("span",{className:"font-medium",children:"Descripción:"})," ",r.description]})]}),l&&c.jsx("div",{className:"ml-4",children:c.jsxs(Ne,{variant:"outline",size:"sm",onClick:s,className:"flex items-center gap-2",children:[c.jsx(Mi,{className:"h-4 w-4"}),"Chat"]})})]})})}function JL({packages:r,onPackageClick:e,onOpenChat:t,previewRole:n,disableChat:a=!1}){const i=yn();return c.jsx(We,{className:`${i?"px-4 pb-3":"px-6 pb-4"}`,children:r.length===0?c.jsxs("div",{className:`text-center ${i?"py-4":"py-6"} text-gray-500`,children:[c.jsx(Dr,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),c.jsx("p",{className:"text-sm",children:"No hay encomiendas en este viaje"})]}):c.jsx("div",{className:"space-y-2",children:r.map(o=>c.jsx(ZL,{package:o,onClick:()=>e(o),onOpenChat:t,previewRole:n,disableChat:a},o.id))})})}function e9({trip:r,onAddPackage:e,onPackageClick:t,onOpenChat:n,previewRole:a,disableChat:i=!1,tripDate:o,showSummary:s=!0}){const{data:l}=Ru(a),u=Gr(),d=!i&&l?.role==="admin"&&n,f=p=>{e(p),setTimeout(()=>{if(u.invalidateQueries({queryKey:["packages-by-trip",p]}),o){const g=pt(o,"yyyy-MM-dd");u.invalidateQueries({queryKey:["packages-by-date",g]})}u.invalidateQueries({queryKey:["packages"]}),u.invalidateQueries({queryKey:["trips"]})},500)},h=p=>{t(p,r.id),setTimeout(()=>{if(u.invalidateQueries({queryKey:["packages-by-trip",r.id]}),o){const g=pt(o,"yyyy-MM-dd");u.invalidateQueries({queryKey:["packages-by-date",g]})}u.invalidateQueries({queryKey:["packages"]})},500)};return c.jsxs(He,{className:"border border-gray-200",children:[c.jsx(QL,{trip:r,onAddPackage:f}),c.jsx(JL,{packages:r.packages,onPackageClick:h,onOpenChat:d?n:void 0,previewRole:a,disableChat:i})]})}function t9({packageCount:r,totalWeight:e,totalFreight:t,pendingAmountByCurrency:n,collectedAmountByCurrency:a}){const i=yn(),o=(f,h=!1)=>{const p=Object.entries(f).filter(([g,v])=>v>0);return p.length===0?h?c.jsx("div",{children:oo(0,"COP")}):c.jsx("div",{className:"text-gray-400",children:"-"}):p.map(([g,v])=>c.jsx("div",{children:oo(v,g)},g))},s=n||{},l=a||{},u=Object.values(s).some(f=>f>0),d=Object.values(l).some(f=>f>0);return console.log("📊 Summary rendering data:",{pendingAmountByCurrency:n,collectedAmountByCurrency:a,safePendingAmounts:s,safeCollectedAmounts:l,hasPendingAmounts:u,hasCollectedAmounts:d}),c.jsx("div",{className:"w-full bg-white py-5 px-5",children:c.jsxs("div",{className:`${i?"grid grid-cols-2 gap-2":"grid grid-cols-5 gap-4"}`,children:[c.jsxs("div",{className:`flex items-center gap-2 ${i?"p-2":"p-3"} bg-blue-50 rounded-lg`,children:[c.jsx(Dr,{className:"h-4 w-4 text-blue-600"}),c.jsxs("div",{children:[c.jsx("div",{className:`${i?"text-sm":"text-lg"} font-bold text-blue-800`,children:r}),c.jsx("div",{className:"text-xs text-blue-600",children:"Paquetes"})]})]}),c.jsxs("div",{className:`flex items-center gap-2 ${i?"p-2":"p-3"} bg-purple-50 rounded-lg`,children:[c.jsx(Ko,{className:"h-4 w-4 text-purple-600"}),c.jsxs("div",{children:[c.jsxs("div",{className:`${i?"text-sm":"text-lg"} font-bold text-purple-800`,children:[e," kg"]}),c.jsx("div",{className:"text-xs text-purple-600",children:"Peso"})]})]}),c.jsxs("div",{className:`flex items-center gap-2 ${i?"p-2":"p-3"} bg-orange-50 rounded-lg`,children:[c.jsx(_a,{className:"h-4 w-4 text-orange-600"}),c.jsxs("div",{children:[c.jsx("div",{className:`${i?"text-xs":"text-sm"} font-bold text-orange-800`,children:oo(t,"COP")}),c.jsx("div",{className:"text-xs text-orange-600",children:"Flete"})]})]}),c.jsxs("div",{className:`flex items-center gap-2 ${i?"p-2":"p-3"} bg-red-50 rounded-lg`,children:[c.jsx(_a,{className:"h-4 w-4 text-red-600"}),c.jsxs("div",{children:[c.jsx("div",{className:`${i?"text-xs":"text-sm"} font-bold text-red-800`,children:o(s,!0)}),c.jsx("div",{className:"text-xs text-red-600",children:"A Cobrar"})]})]}),c.jsxs("div",{className:`flex items-center gap-2 ${i?"p-2":"p-3"} bg-green-50 rounded-lg`,children:[c.jsx(Fn,{className:"h-4 w-4 text-green-600"}),c.jsxs("div",{children:[c.jsx("div",{className:`${i?"text-xs":"text-sm"} font-bold text-green-800`,children:o(l)}),c.jsx("div",{className:"text-xs text-green-600",children:"Cobrado"})]})]})]})})}function r9(r){return Rt({queryKey:["package-payments-by-trip",r],queryFn:async()=>{console.log("🔍 Fetching package payments for trip:",r);const{data:e,error:t}=await xe.from("packages").select("id, amount_to_collect, currency").eq("trip_id",r);if(t)throw console.error("❌ Error fetching packages:",t),t;if(console.log("📦 Packages found:",e?.length||0,e),!e||e.length===0)return console.log("📭 No packages found for trip"),{collected:{COP:0,AWG:0},pending:{COP:0,AWG:0}};const n=e.map(h=>h.id);console.log("🔍 Package IDs to search:",n);const{data:a,error:i}=await xe.from("package_deliveries").select(`
          package_id,
          total_amount_collected,
          delivery_payments (
            amount,
            currency
          )
        `).in("package_id",n);if(i)throw console.error("❌ Error fetching deliveries:",i),i;console.log("🚚 Package deliveries found:",a?.length||0,a);const{data:o,error:s}=await xe.from("package_payments").select("amount, package_id").in("package_id",n);if(s)throw console.error("❌ Error fetching package payments:",s),s;console.log("💰 Package payments found:",o?.length||0,o);const l={COP:0,AWG:0},u={COP:0,AWG:0};e.forEach(h=>{const p=h.currency||"COP",g=h.amount_to_collect||0;console.log(`📝 Processing package ${h.id}: amount_to_collect=${g}, currency=${p}`);let v=0;const b=a?.find(C=>C.package_id===h.id);if(b?.delivery_payments&&Array.isArray(b.delivery_payments)&&b.delivery_payments.forEach(C=>{const S=Number(C.amount)||0,j=C.currency||p;v+=S,l[j]=(l[j]||0)+S,console.log(`💳 Delivery payment: ${S} ${j} for package ${h.id}`)}),b?.total_amount_collected){const C=Number(b.total_amount_collected)||0;(!b.delivery_payments||b.delivery_payments.length===0)&&(v+=C,l[p]=(l[p]||0)+C,console.log(`💰 Total delivery amount: ${C} ${p} for package ${h.id}`))}if((o?.filter(C=>C.package_id===h.id)||[]).forEach(C=>{const S=Number(C.amount)||0;v+=S,l[p]=(l[p]||0)+S,console.log(`💰 Package payment: ${S} ${p} for package ${h.id}`)}),g>0){if(u[p]=(u[p]||0)+g,v>0){const C=Math.min(v,g);u[p]=Math.max(0,u[p]-C)}console.log(`📊 Package ${h.id}: amount_to_collect=${g}, paid=${v}, pending=${u[p]}`)}});const d=Object.fromEntries(Object.entries(l).filter(([h,p])=>p>0)),f=Object.fromEntries(Object.entries(u).filter(([h,p])=>p>0));return console.log("✅ Package payments calculated:",{collected:d,pending:f,totalDeliveries:a?.length||0,totalPackagePayments:o?.length||0}),{collected:d,pending:f}},enabled:!!r,refetchOnWindowFocus:!1,staleTime:3e4})}function n9({trip:r,children:e}){const{data:t,error:n,isLoading:a}=r9(r.id),i=r.packages.reduce((u,d)=>u+(d.weight||0),0),o=r.packages.reduce((u,d)=>u+(d.freight||0),0),s=t?.pending||{},l=t?.collected||{};return console.log("🔍 TripSummaryContainer data:",{tripId:r.id,paymentData:t,paymentError:n,isLoading:a,pendingAmountByCurrency:s,collectedAmountByCurrency:l}),n&&console.error("❌ Error loading payment data for trip:",r.id,n),c.jsxs("div",{className:"space-y-4",children:[n&&c.jsx(Fi,{variant:"destructive",children:c.jsxs(Bi,{children:["Error cargando datos de pagos: ",n.message]})}),c.jsx(t9,{packageCount:r.packages.length,totalWeight:i,totalFreight:o,pendingAmountByCurrency:s,collectedAmountByCurrency:l}),e]})}function a9({selectedDate:r,trips:e,dispatches:t,totalPackages:n,totalWeight:a,totalFreight:i,totalAmountToCollect:o,onBack:s,onAddPackage:l,onPackageClick:u,onOpenChat:d,onCreateDispatch:f,onOpenLabelsDialog:h,previewRole:p,disableChat:g=!1}){const v=Gr(),b=y=>{l(y),setTimeout(()=>{const C=pt(r,"yyyy-MM-dd");v.invalidateQueries({queryKey:["packages-by-date",C]}),v.invalidateQueries({queryKey:["packages-by-trip",y]}),v.invalidateQueries({queryKey:["package-payments-by-trip",y]}),v.invalidateQueries({queryKey:["packages"]}),v.invalidateQueries({queryKey:["trips"]})},500)};return e.flatMap(y=>y.packages.map(C=>({id:C.id,tracking_number:C.tracking_number,origin:y.origin,destination:y.destination,status:C.status,description:C.description,weight:C.weight,freight:C.freight,amount_to_collect:C.amount_to_collect,customers:C.customers}))),c.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[c.jsx(KL,{selectedDate:r,totalPackages:n,totalTrips:e.length,dispatchCount:t.length,onBack:s,onCreateDispatch:f,onOpenLabelsDialog:h}),e.length===0?c.jsx(XL,{selectedDate:r}):c.jsx("div",{className:"space-y-4 sm:space-y-6",children:e.map(y=>c.jsx(n9,{trip:y,children:c.jsx(e9,{trip:y,onAddPackage:b,onPackageClick:u,onOpenChat:d,previewRole:p,disableChat:g,tripDate:r,showSummary:!1})},y.id))})]})}function i9({editDialogOpen:r,setEditDialogOpen:e,selectedPackage:t,selectedTripId:n,onPackageEditSuccess:a,chatDialogOpen:i,setChatDialogOpen:o,selectedCustomerId:s,selectedCustomerName:l}){return console.log("🔍 [PackagesByDateDialogs] Rendering with trip ID:",{selectedTripId:n,hasPackage:!!t,packageTripId:t?.trip_id}),c.jsxs(c.Fragment,{children:[c.jsx(Dm,{open:r,onOpenChange:e,package:t,tripId:n,onSuccess:a}),c.jsx(u4,{open:i,onOpenChange:o,customerId:s,customerName:l})]})}const o9=["procesado","delivered","in_transit"];function s9(r=[]){const e=w.useMemo(()=>r.flatMap(n=>n.packages.map(a=>a.id)),[r]),{data:t=[]}=Rt({queryKey:["dispatched-packages",e],queryFn:async()=>{if(e.length===0)return[];const{data:n,error:a}=await xe.from("dispatch_packages").select("package_id").in("package_id",e);return a?(console.error("❌ Error fetching dispatched packages:",a),[]):n||[]},enabled:e.length>0});return w.useMemo(()=>{if(console.log("🔍 Filtering dispatch-eligible packages..."),!r||!Array.isArray(r))return console.log("⚠️ No trips provided or trips is not an array"),[];const n=new Set(t.map(i=>i.package_id)),a=r.flatMap(i=>i.packages.filter(o=>{if(n.has(o.id))return console.log(`⚠️ Package ${o.tracking_number} excluded (already dispatched)`),!1;const s=!o9.includes(o.status);return s||console.log(`⚠️ Package ${o.tracking_number} excluded (status: ${o.status})`),s}).map(o=>({id:o.id,tracking_number:o.tracking_number,origin:i.origin,destination:i.destination,status:o.status,description:o.description,weight:o.weight,freight:o.freight,amount_to_collect:o.amount_to_collect,customers:o.customers})));return console.log(`✅ Found ${a.length} dispatch-eligible packages`),a},[r,t])}function c9({currentDate:r,tripDate:e}){return c.jsxs(Kr,{children:[c.jsxs(Xr,{className:"flex items-center gap-2",children:[c.jsx(Rn,{className:"h-5 w-5"}),"Crear Despacho - ",pt(r,"d 'de' MMMM 'de' yyyy",{locale:Bn})]}),c.jsxs("div",{className:"text-sm text-gray-600",children:["Encomiendas del viaje: ",pt(e,"d 'de' MMMM 'de' yyyy",{locale:Bn})]})]})}function l9({currentDate:r}){return c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Fecha del despacho:"})," ",pt(r,"d 'de' MMMM 'de' yyyy",{locale:Bn})," (Fecha actual)"]}),c.jsx("div",{className:"text-xs text-blue-600 mt-1",children:"El despacho se registrará automáticamente con la fecha actual del sistema"})]})}function u9({packages:r,selectedPackages:e,onPackageToggle:t,onSelectAll:n}){return c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs(at,{className:"text-base font-medium",children:["Seleccionar Encomiendas (",r.length," disponibles)"]}),c.jsx(Ne,{type:"button",variant:"outline",size:"sm",onClick:n,children:e.length===r.length?"Deseleccionar Todo":"Seleccionar Todo"})]}),c.jsx("div",{className:"border rounded-lg max-h-60 overflow-y-auto",children:r.length===0?c.jsx("div",{className:"p-6 text-center text-gray-500",children:"No hay encomiendas disponibles para este día"}):c.jsx("div",{className:"space-y-2 p-3",children:r.map(a=>c.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-lg hover:bg-gray-50",children:[c.jsx(js,{id:a.id,checked:e.includes(a.id),onCheckedChange:i=>t(a.id,i)}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"font-medium text-sm",children:a.tracking_number}),c.jsx("div",{className:"text-xs text-gray-500",children:a.customers?.name||"Sin cliente"})]}),c.jsxs("div",{className:"flex items-center gap-4 mt-1 text-xs text-gray-600",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Ko,{className:"h-3 w-3"}),a.weight||0," kg"]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Rn,{className:"h-3 w-3"}),"$",a.freight||0]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(_a,{className:"h-3 w-3"}),"$",a.amount_to_collect||0]})]})]})]},a.id))})})]})}function d9({selectedPackages:r,packages:e}){const n=e.filter(i=>r.includes(i.id)).reduce((i,o)=>({weight:i.weight+(o.weight||0),freight:i.freight+(o.freight||0),amount_to_collect:i.amount_to_collect+(o.amount_to_collect||0)}),{weight:0,freight:0,amount_to_collect:0}),a=i=>`$${i.toLocaleString("es-CO")}`;return r.length===0?null:c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[c.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Resumen del Despacho"}),c.jsxs("div",{className:"grid grid-cols-4 gap-4 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Dr,{className:"h-4 w-4 text-blue-600"}),c.jsxs("div",{children:[c.jsx("div",{className:"text-blue-600",children:"Paquetes"}),c.jsx("div",{className:"font-bold",children:r.length})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ko,{className:"h-4 w-4 text-blue-600"}),c.jsxs("div",{children:[c.jsx("div",{className:"text-blue-600",children:"Peso Total"}),c.jsxs("div",{className:"font-bold",children:[n.weight," kg"]})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Rn,{className:"h-4 w-4 text-blue-600"}),c.jsxs("div",{children:[c.jsx("div",{className:"text-blue-600",children:"Flete Total"}),c.jsx("div",{className:"font-bold",children:a(n.freight)})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(_a,{className:"h-4 w-4 text-green-600"}),c.jsxs("div",{children:[c.jsx("div",{className:"text-green-600",children:"A Cobrar"}),c.jsx("div",{className:"font-bold text-green-700",children:a(n.amount_to_collect)})]})]})]})]})}function f9({notes:r,onNotesChange:e}){return c.jsxs("div",{children:[c.jsx(at,{htmlFor:"notes",children:"Notas (Opcional)"}),c.jsx(Uu,{id:"notes",value:r,onChange:t=>e(t.target.value),placeholder:"Agregar notas sobre este despacho...",rows:3})]})}function h9({open:r,onOpenChange:e,tripDate:t,trips:n,onSuccess:a}){const[i,o]=w.useState([]),[s,l]=w.useState(""),u=GL(),d=s9(n),f=(v,b)=>{o(b?y=>[...y,v]:y=>y.filter(C=>C!==v))},h=()=>{i.length===d.length?o([]):o(d.map(v=>v.id))},p=async v=>{if(v.preventDefault(),i.length!==0)try{const b=new Date;console.log("📅 Creando despacho con fecha actual:",b),console.log("📦 Paquetes seleccionados:",i.length),await u.mutateAsync({date:b,packageIds:i,notes:s.trim()||void 0}),o([]),l(""),e(!1),a?.()}catch(b){console.error("❌ Error creating dispatch:",b)}},g=new Date;return c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[c.jsx(c9,{currentDate:g,tripDate:t}),c.jsxs("form",{onSubmit:p,className:"space-y-6",children:[c.jsx(l9,{currentDate:g}),d.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx("p",{className:"text-lg font-medium mb-2",children:"No hay encomiendas disponibles para despacho"}),c.jsx("p",{className:"text-sm",children:"Las encomiendas pueden no estar disponibles porque ya fueron despachadas, entregadas o están en tránsito."})]}):c.jsxs(c.Fragment,{children:[c.jsx(u9,{packages:d,selectedPackages:i,onPackageToggle:f,onSelectAll:h}),c.jsx(d9,{selectedPackages:i,packages:d}),c.jsx(f9,{notes:s,onNotesChange:l})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx(Ne,{type:"button",variant:"outline",onClick:()=>e(!1),children:"Cancelar"}),c.jsx(Ne,{type:"submit",disabled:i.length===0||u.isPending,children:u.isPending?"Creando...":"Crear Despacho"})]})]})]})})}function p9({open:r,onOpenChange:e,tripDate:t,trips:n}){const a=yn(),[i,o]=w.useState(new Set),[s,l]=w.useState(new Set),[u,d]=w.useState(!1),[f,h]=w.useState(!1),[p,g]=w.useState(null),[v,b]=w.useState([]),y=n.flatMap(Q=>Q.packages.map(re=>({...re,origin:Q.origin,destination:Q.destination,flight_number:Q.flight_number,created_at:new Date().toISOString()})));console.log("PackageLabelsDialog - All packages count:",y.length),console.log("PackageLabelsDialog - Selected package IDs:",i.size),console.log("PackageLabelsDialog - Selected printed package IDs:",s.size);const C=y.filter(Q=>Q.status==="recibido"||Q.status==="procesado"),S=y.filter(Q=>Q.status==="transito"||Q.status==="en_destino"||Q.status==="delivered"),j=Q=>{switch(Q){case"delivered":return"bg-green-100 text-green-800";case"en_destino":case"arrived":return"bg-blue-100 text-blue-800";case"transito":case"in_transit":return"bg-yellow-100 text-yellow-800";case"procesado":return"bg-purple-100 text-purple-800";case"bodega":return"bg-gray-100 text-gray-800";case"recibido":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},D=Q=>{switch(Q){case"delivered":return"Entregado";case"en_destino":case"arrived":return"En Destino";case"transito":case"in_transit":return"En Tránsito";case"procesado":return"Procesado";case"bodega":return"En Bodega";case"recibido":return"Recibido";default:return Q}},F=(Q,re="COP")=>Q?new Intl.NumberFormat("es-CO",{style:"currency",currency:re,minimumFractionDigits:0}).format(Q):"-",M=Q=>{g(Q),d(!0)},T=Q=>{const re=new Set(i);re.has(Q)?re.delete(Q):re.add(Q),console.log("PackageLabelsDialog - Package toggled:",Q,"New selection size:",re.size),o(re)},q=Q=>{const re=new Set(s);re.has(Q)?re.delete(Q):re.add(Q),console.log("PackageLabelsDialog - Printed package toggled:",Q,"New selection size:",re.size),l(re)},J=Q=>{const re=Q.map(G=>G.id);if(re.every(G=>i.has(G))){const G=new Set(i);re.forEach(Y=>G.delete(Y)),o(G)}else{const G=new Set(i);re.forEach(Y=>G.add(Y)),o(G)}},O=Q=>{const re=Q.map(G=>G.id);if(re.every(G=>s.has(G))){const G=new Set(s);re.forEach(Y=>G.delete(Y)),l(G)}else{const G=new Set(s);re.forEach(Y=>G.add(Y)),l(G)}},k=()=>{const Q=y.filter(re=>i.has(re.id));console.log("PackageLabelsDialog - handlePrintSelected - Selected packages count:",Q.length),console.log("PackageLabelsDialog - handlePrintSelected - Selected package IDs:",Array.from(i)),console.log("PackageLabelsDialog - handlePrintSelected - Filtered packages:",Q.map(re=>re.id)),Q.length>0&&(b(Q),h(!0))},H=()=>{const Q=y.filter(re=>s.has(re.id));console.log("PackageLabelsDialog - handleReprintSelected - Selected packages count:",Q.length),Q.length>0&&(b(Q),h(!0))},X=(Q,re=!1,G=!1)=>c.jsx("div",{className:"space-y-3",children:Q.map(Y=>c.jsx(He,{className:"border border-gray-200",children:c.jsx(We,{className:"p-4",children:c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[re&&c.jsx(js,{checked:G?s.has(Y.id):i.has(Y.id),onCheckedChange:()=>G?q(Y.id):T(Y.id)}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-sm mb-1",children:Y.tracking_number}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(ts,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-sm",children:Y.customers?.name||"N/A"})]}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(gi,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-sm",children:Y.origin}),c.jsx("span",{className:"text-xs text-gray-400",children:"→"}),c.jsx("span",{className:"text-sm",children:Y.destination})]}),c.jsxs("div",{className:"text-sm text-gray-600",children:["Peso: ",Y.weight||0," kg | Flete: ",F(Y.freight)]}),Y.amount_to_collect&&c.jsxs("div",{className:"text-sm text-orange-600",children:["A cobrar: ",F(Y.amount_to_collect,Y.currency)]})]})]}),c.jsxs("div",{className:"flex flex-col items-end gap-2",children:[c.jsx(Ot,{className:`${j(Y.status)} text-xs`,children:D(Y.status)}),re&&c.jsxs(Ne,{size:"sm",onClick:()=>M(Y),className:"flex items-center gap-1",children:[c.jsx(fi,{className:"h-3 w-3"}),c.jsx("span",{className:"text-xs",children:G?"Re-imprimir":"Imprimir"})]})]})]})})})},Y.id))}),ce=(Q,re=!1,G=!1)=>c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[re&&c.jsx(Me,{className:"w-12",children:c.jsx(js,{checked:Q.length>0&&Q.every(Y=>G?s.has(Y.id):i.has(Y.id)),onCheckedChange:()=>G?O(Q):J(Q)})}),c.jsx(Me,{children:"N° Seguimiento"}),c.jsx(Me,{children:"Cliente"}),c.jsx(Me,{children:"Ruta"}),c.jsx(Me,{children:"Estado"}),c.jsx(Me,{children:"Peso"}),c.jsx(Me,{children:"Flete"}),c.jsx(Me,{children:"A Cobrar"}),re&&c.jsx(Me,{children:"Acciones"})]})}),c.jsx(Wa,{children:Q.map(Y=>c.jsxs(Sr,{className:"hover:bg-gray-50",children:[re&&c.jsx(Re,{children:c.jsx(js,{checked:G?s.has(Y.id):i.has(Y.id),onCheckedChange:()=>G?q(Y.id):T(Y.id)})}),c.jsx(Re,{className:"font-medium",children:Y.tracking_number}),c.jsx(Re,{children:Y.customers?.name||"N/A"}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-sm",children:Y.origin}),c.jsx("span",{className:"mx-2",children:"→"}),c.jsx("span",{className:"text-sm",children:Y.destination})]})}),c.jsx(Re,{children:c.jsx(Ot,{className:j(Y.status),children:D(Y.status)})}),c.jsxs(Re,{children:[Y.weight||0," kg"]}),c.jsx(Re,{children:F(Y.freight)}),c.jsx(Re,{children:Y.amount_to_collect?F(Y.amount_to_collect,Y.currency):"-"}),re&&c.jsx(Re,{children:c.jsxs(Ne,{size:"sm",onClick:()=>M(Y),className:"flex items-center gap-1",children:[c.jsx(fi,{className:"h-3 w-3"}),G?"Re-imprimir":"Imprimir"]})})]},Y.id))})]});return c.jsxs(c.Fragment,{children:[c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"max-w-6xl max-h-[90vh] overflow-hidden",children:[c.jsxs(Kr,{children:[c.jsxs(Xr,{className:"flex items-center gap-2",children:[c.jsx(Dr,{className:"h-5 w-5"}),"Gestión de Etiquetas - ",pt(t,"dd/MM/yyyy")]}),c.jsx(sa,{children:"Gestiona las etiquetas de las encomiendas del viaje"})]}),c.jsxs(Us,{defaultValue:"pending",className:"w-full",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs(Mu,{className:"grid w-full max-w-md grid-cols-2",children:[c.jsxs(kn,{value:"pending",className:"flex items-center gap-2",children:[c.jsx(fi,{className:"h-4 w-4"}),"Pendientes (",C.length,")"]}),c.jsxs(kn,{value:"printed",className:"flex items-center gap-2",children:[c.jsx(es,{className:"h-4 w-4"}),"Impresas (",S.length,")"]})]}),c.jsxs("div",{className:"flex gap-2",children:[i.size>0&&c.jsxs(Ne,{onClick:k,className:"flex items-center gap-2",children:[c.jsx(fi,{className:"h-4 w-4"}),"Imprimir Seleccionadas (",i.size,")"]}),s.size>0&&c.jsxs(Ne,{onClick:H,className:"flex items-center gap-2",variant:"outline",children:[c.jsx(fi,{className:"h-4 w-4"}),"Re-imprimir Seleccionadas (",s.size,")"]})]})]}),c.jsx(xn,{value:"pending",className:"mt-4 overflow-auto max-h-96",children:C.length===0?c.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay encomiendas pendientes de imprimir etiqueta"}):c.jsx(c.Fragment,{children:a?X(C,!0,!1):ce(C,!0,!1)})}),c.jsx(xn,{value:"printed",className:"mt-4 overflow-auto max-h-96",children:S.length===0?c.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay encomiendas con etiquetas impresas"}):c.jsx(c.Fragment,{children:a?X(S,!0,!0):ce(S,!0,!0)})})]})]})}),c.jsx(T_,{open:u,onOpenChange:d,package:p}),c.jsx(L3,{open:f,onOpenChange:h,packages:v})]})}function m9({selectedDate:r,onBack:e,onAddPackage:t,disableChat:n=!1,previewRole:a}){const{trips:i,dispatches:o,isLoading:s,selectedPackage:l,selectedTripId:u,editDialogOpen:d,setEditDialogOpen:f,chatDialogOpen:h,setChatDialogOpen:p,selectedCustomerId:g,selectedCustomerName:v,createDispatchDialogOpen:b,setCreateDispatchDialogOpen:y,labelsDialogOpen:C,setLabelsDialogOpen:S,totalPackages:j,totalWeight:D,totalFreight:F,totalAmountToCollect:M,handlePackageClick:T,handleOpenChat:q,handlePackageEditSuccess:J,handleCreateDispatch:O,handleOpenLabelsDialog:k,handleCreateDispatchSuccess:H}=YL(r);return s?c.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsxs(Ne,{variant:"outline",size:"sm",onClick:e,className:"flex items-center gap-2",children:[c.jsx(Jo,{className:"h-4 w-4"}),"Volver al Calendario"]})}),c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500",children:"Cargando encomiendas..."})})]}):c.jsxs(c.Fragment,{children:[c.jsx(a9,{selectedDate:r,trips:i,dispatches:o,totalPackages:j,totalWeight:D,totalFreight:F,totalAmountToCollect:M,onBack:e,onAddPackage:t,onPackageClick:T,onOpenChat:q,onCreateDispatch:O,onOpenLabelsDialog:k,previewRole:a,disableChat:n}),c.jsx(i9,{editDialogOpen:d,setEditDialogOpen:f,selectedPackage:l,selectedTripId:u,onPackageEditSuccess:J,chatDialogOpen:h,setChatDialogOpen:p,selectedCustomerId:g,selectedCustomerName:v}),c.jsx(h9,{open:b,onOpenChange:y,tripDate:r,trips:i,onSuccess:H}),c.jsx(p9,{open:C,onOpenChange:S,tripDate:r,trips:i})]})}function g9(){return Rt({queryKey:["trips-with-flights"],queryFn:async()=>{const{data:r,error:e}=await xe.from("trips").select("*").order("trip_date",{ascending:!1});if(e)throw e;const t=r.filter(s=>s.flight_number);if(t.length===0)return r.map(s=>({...s,flight_data:null}));const n=t.map(s=>s.flight_number),{data:a,error:i}=await xe.from("flight_data").select("*").in("flight_number",n);if(i)throw i;return r.map(s=>{const l=s.flight_number?a?.find(u=>u.flight_number===s.flight_number):null;return{...s,flight_data:l||null}})},refetchInterval:10*60*1e3,staleTime:5*60*1e3})}function v9({departureAirport:r,arrivalAirport:e,scheduledDeparture:t,scheduledArrival:n,apiDepartureCity:a,apiArrivalCity:i,apiDepartureIata:o,apiArrivalIata:s}){const u=(()=>{if(!t||!n)return null;try{const g=Go(t),v=Go(n),b=Math.round((v.getTime()-g.getTime())/(1e3*60*60)),y=Math.floor(b),C=Math.round((b-y)*60);return`${y}h ${C}m`}catch{return null}})(),d=o||a||r,f=s||i||e,h=a&&a!==o?a:null,p=i&&i!==s?i:null;return console.log("FlightRouteDisplay - Datos de ruta completos:",{departureAirport:r,arrivalAirport:e,apiDepartureCity:a,apiArrivalCity:i,apiDepartureIata:o,apiArrivalIata:s,displayDeparture:d,displayArrival:f,departureDetail:h,arrivalDetail:p}),c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:d}),h&&c.jsx("div",{className:"text-sm text-gray-600 mt-1",children:h})]}),c.jsxs("div",{className:"flex-1 mx-4 relative",children:[c.jsx("div",{className:"h-0.5 bg-green-500 w-full"}),c.jsx("div",{className:"absolute right-0 top-0 transform -translate-y-1/2",children:c.jsx("div",{className:"text-green-600",children:"✈️"})}),u&&c.jsx("div",{className:"text-center text-sm text-gray-600 mt-2",children:u})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:f}),p&&c.jsx("div",{className:"text-sm text-gray-600 mt-1",children:p})]})]})}function x9({apiFlightStatus:r,apiAirlineName:e,apiAircraftRegistration:t}){return!r&&!e&&!t?null:c.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-4",children:[c.jsx("div",{className:"flex flex-col",children:r&&c.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["Estado: ",r]})}),c.jsx("div",{className:"flex flex-col text-center",children:e&&c.jsx("span",{className:"text-lg font-semibold text-red-600",children:e})}),c.jsx("div",{className:"flex flex-col text-right",children:t&&c.jsxs("span",{className:"text-sm text-gray-600",children:["Aeronave: ",t]})})]})}function Yf({dateTime:r,className:e=""}){const t=n=>{if(!n)return"-";try{const a=new Date(n),i=a.getUTCHours(),o=a.getUTCMinutes(),s=i>=12?"PM":"AM",l=i===0?12:i>12?i-12:i,u=o.toString().padStart(2,"0");return`${l}:${u} ${s}`}catch{return"-"}};return c.jsx("span",{className:e,children:t(r)})}function d4({dateTime:r,className:e=""}){const t=n=>{if(!n)return"-";try{const a=new Date(n),i=a.getUTCFullYear(),o=(a.getUTCMonth()+1).toString().padStart(2,"0");return`${a.getUTCDate().toString().padStart(2,"0")}/${o}/${i}`}catch(a){return console.error("Error formatting date:",a),"-"}};return c.jsx("span",{className:e,children:t(r)})}function y9({departureDate:r,actualDeparture:e,departureTime:t,scheduledDeparture:n}){const i=((o,s)=>{if(!o||!s)return null;try{const l=new Date(o),u=new Date(s),d=Math.round((u.getTime()-l.getTime())/(1e3*60));return{minutes:Math.abs(d),isDelay:d>0,isEarly:d<0}}catch{return null}})(n,e);return c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"border-b pb-2",children:c.jsx("h3",{className:"font-semibold text-lg",children:"Salida"})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-gray-500",children:"Fecha"}),c.jsx("div",{className:"font-medium",children:c.jsx(d4,{dateTime:r})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-gray-500",children:e?"Hora Real de Salida":"Hora Programada"}),c.jsx("div",{className:`text-2xl font-bold ${e?"text-green-600":"text-gray-900"}`,children:c.jsx(Yf,{dateTime:e||t})}),n&&e&&n!==e&&c.jsxs("div",{className:"flex flex-col mt-1",children:[c.jsxs("div",{className:"text-sm text-gray-500 line-through",children:["Programado: ",c.jsx(Yf,{dateTime:n})]}),i&&c.jsx("div",{className:`text-xs ${i.isDelay?"text-red-500":"text-green-500"}`,children:i.isDelay?`+${i.minutes} min retraso`:`-${i.minutes} min adelanto`})]})]})]})}function b9({arrivalDate:r,actualArrival:e,arrivalTime:t,scheduledArrival:n}){const i=((o,s)=>{if(!o||!s)return null;try{const l=new Date(o),u=new Date(s),d=Math.round((u.getTime()-l.getTime())/(1e3*60));return{minutes:Math.abs(d),isDelay:d>0,isEarly:d<0}}catch{return null}})(n,e);return c.jsxs("div",{className:"space-y-3",children:[c.jsx("div",{className:"border-b pb-2",children:c.jsx("h3",{className:"font-semibold text-lg",children:"Llegada"})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-gray-500",children:"Fecha"}),c.jsx("div",{className:"font-medium",children:c.jsx(d4,{dateTime:r})})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-gray-500",children:e?"Hora Real de Llegada":"Hora Programada"}),c.jsx("div",{className:`text-2xl font-bold ${e?"text-green-600":"text-gray-900"}`,children:c.jsx(Yf,{dateTime:e||t})}),n&&e&&n!==e&&c.jsxs("div",{className:"flex flex-col mt-1",children:[c.jsxs("div",{className:"text-sm text-gray-500 line-through",children:["Programado: ",c.jsx(Yf,{dateTime:n})]}),i&&c.jsx("div",{className:`text-xs ${i.isDelay?"text-red-500":"text-green-500"}`,children:i.isDelay?`+${i.minutes} min retraso`:`-${i.minutes} min adelanto`})]})]})]})}function w9({lastUpdated:r}){const e=()=>{const t=new Date,n=Go(r),a=Math.round((t.getTime()-n.getTime())/(1e3*60));if(a<60)return`${a} min`;{const i=Math.floor(a/60),o=a%60;return`${i} h ${o} min`}};return c.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["Se actualizó hace ",e()]})}function _9({departureAirport:r,arrivalAirport:e,departureTime:t,arrivalTime:n,departureDate:a,arrivalDate:i,actualDeparture:o,actualArrival:s,scheduledDeparture:l,scheduledArrival:u,lastUpdated:d,apiDepartureCity:f,apiArrivalCity:h,apiDepartureAirport:p,apiArrivalAirport:g,apiDepartureGate:v,apiArrivalGate:b,apiDepartureTerminal:y,apiArrivalTerminal:C,apiDepartureIata:S,apiArrivalIata:j,apiAirlineName:D,apiAircraftRegistration:F,apiFlightStatus:M}){return console.log("FlightDetailsGrid - TODOS los datos de la API:",{apiDepartureCity:f,apiArrivalCity:h,apiDepartureIata:S,apiArrivalIata:j,apiDepartureGate:v,apiArrivalGate:b,apiDepartureTerminal:y,apiArrivalTerminal:C,apiAirlineName:D,apiAircraftRegistration:F,apiFlightStatus:M}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(x9,{apiFlightStatus:M,apiAirlineName:D,apiAircraftRegistration:F}),c.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[c.jsx(y9,{departureDate:a,actualDeparture:o,departureTime:t,scheduledDeparture:l}),c.jsx(b9,{arrivalDate:i,actualArrival:s,arrivalTime:n,scheduledArrival:u})]}),c.jsx(w9,{lastUpdated:d})]})}function C9({status:r,hasLanded:e}){const n=((a,i)=>{if(i||a==="arrived")return{label:"LLEGÓ",bgColor:"bg-green-100",textColor:"text-green-800",borderColor:"border-green-300"};switch(a){case"in_flight":return{label:"EN VUELO",bgColor:"bg-blue-100",textColor:"text-blue-800",borderColor:"border-blue-300"};case"delayed":return{label:"RETRASADO",bgColor:"bg-red-100",textColor:"text-red-800",borderColor:"border-red-300"};case"scheduled":return{label:"PROGRAMADO",bgColor:"bg-yellow-100",textColor:"text-yellow-800",borderColor:"border-yellow-300"};case"cancelled":return{label:"CANCELADO",bgColor:"bg-gray-100",textColor:"text-gray-800",borderColor:"border-gray-300"};default:return{label:"PROGRAMADO",bgColor:"bg-yellow-100",textColor:"text-yellow-800",borderColor:"border-yellow-300"}}})(r,e);return c.jsx(Ot,{className:`${n.bgColor} ${n.textColor} ${n.borderColor} border font-medium px-3 py-1`,children:n.label})}function nx({gate:r,terminal:e}){return!r&&!e?null:c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-gray-500",children:"Terminal y Puerta"}),c.jsxs("div",{className:"font-medium",children:[e&&`Terminal ${e}`,e&&r&&" - ",r&&`Puerta ${r}`]})]})}function N9({flight:r}){return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("h2",{className:"text-xl font-semibold",children:["Vuelo ",r.flight_number.toUpperCase()]}),c.jsx(C9,{status:r.api_flight_status||r.status,hasLanded:r.has_landed})]}),c.jsxs("div",{className:"flex gap-4",children:[c.jsx(nx,{gate:r.api_departure_gate,terminal:r.api_departure_terminal}),c.jsx(nx,{gate:r.api_arrival_gate,terminal:r.api_arrival_terminal})]})]})}const S9=()=>({formatTime:t=>{if(!t)return null;try{return pt(Go(t),"h:mm a")}catch{return null}},formatDate:t=>{if(!t)return null;try{return pt(Go(t),"yyyy-MM-dd")}catch{return null}}});function E9({flight:r}){console.log("FlightStatusDisplay - Datos completos del vuelo:",r);const{formatTime:e,formatDate:t}=S9(),n=e(r.actual_departure||r.scheduled_departure),a=e(r.actual_arrival||r.scheduled_arrival),i=t(r.actual_departure||r.scheduled_departure),o=t(r.actual_arrival||r.scheduled_arrival);return c.jsx(He,{className:"overflow-hidden",children:c.jsxs(We,{className:"p-6 space-y-6",children:[c.jsx(N9,{flight:r}),c.jsx(v9,{departureAirport:r.departure_airport,arrivalAirport:r.arrival_airport,scheduledDeparture:r.scheduled_departure,scheduledArrival:r.scheduled_arrival,apiDepartureCity:r.api_departure_city,apiArrivalCity:r.api_arrival_city,apiDepartureIata:r.api_departure_iata,apiArrivalIata:r.api_arrival_iata}),c.jsx(_9,{departureAirport:r.departure_airport,arrivalAirport:r.arrival_airport,departureTime:n,arrivalTime:a,departureDate:i,arrivalDate:o,actualDeparture:r.actual_departure,actualArrival:r.actual_arrival,scheduledDeparture:r.scheduled_departure,scheduledArrival:r.scheduled_arrival,lastUpdated:r.last_updated,apiDepartureCity:r.api_departure_city,apiArrivalCity:r.api_arrival_city,apiDepartureAirport:r.api_departure_airport,apiArrivalAirport:r.api_arrival_airport,apiDepartureGate:r.api_departure_gate,apiArrivalGate:r.api_arrival_gate,apiDepartureTerminal:r.api_departure_terminal,apiArrivalTerminal:r.api_arrival_terminal,apiDepartureIata:r.api_departure_iata,apiArrivalIata:r.api_arrival_iata,apiAirlineName:r.api_airline_name,apiAircraftRegistration:r.api_aircraft_registration,apiFlightStatus:r.api_flight_status})]})})}function A9(){const r=Gr(),{toast:e}=Lt(),t=ln({mutationFn:async n=>{console.log("Actualizando información del vuelo:",n);const a=await xe.functions.invoke("update-flight-info",{body:{flight_number:n}});if(console.log("Respuesta del edge function:",a),a.error)throw console.error("Error en edge function:",a.error),a.error;return a.data},onSuccess:n=>{console.log("Información del vuelo actualizada exitosamente:",n),r.invalidateQueries({queryKey:["pending-flight-notifications"]}),r.invalidateQueries({queryKey:["upcoming-flights"]}),r.invalidateQueries({queryKey:["trips-with-flights"]}),e({title:"Información actualizada",description:"La información del vuelo se ha actualizado con datos de la API"})},onError:n=>{console.error("Error actualizando información del vuelo:",n),e({title:"Error",description:`No se pudo actualizar la información del vuelo: ${n.message||"Error desconocido"}`,variant:"destructive"})}});return{updateFlightInfo:t.mutate,isUpdating:t.isPending}}function j9({flightNumber:r}){const{updateFlightInfo:e,isUpdating:t}=A9(),n=()=>{e(r)};return c.jsxs(Ne,{variant:"outline",size:"sm",onClick:n,disabled:t,className:"flex items-center gap-2",children:[c.jsx(dh,{className:`h-4 w-4 ${t?"animate-spin":""}`}),t?"Actualizando...":"Actualizar Info"]})}function P9({flight:r,onUpdateFlightStatus:e}){const t=()=>{e({flightId:r.id,hasLanded:!0})},n=()=>{e({flightId:r.id,hasLanded:!1})};return c.jsxs("div",{className:"flex flex-col gap-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ot,{variant:r.has_landed?"default":"secondary",children:r.has_landed?"Aterrizado":"En vuelo"}),c.jsxs("span",{className:"text-sm text-gray-500",children:["Vuelo ",r.flight_number]})]}),c.jsx(j9,{flightNumber:r.flight_number})]}),c.jsx("div",{className:"flex gap-2",children:r.has_landed?c.jsx(Ne,{variant:"outline",size:"sm",onClick:n,className:"flex-1",children:"Marcar como En Vuelo"}):c.jsx(Ne,{variant:"outline",size:"sm",onClick:t,className:"flex-1",children:"Marcar como Aterrizado"})})]})}function Og({flight:r,onUpdateFlightStatus:e}){return c.jsx(He,{className:"border-l-4 border-l-500",children:c.jsxs(We,{className:"p-0",children:[c.jsx(E9,{flight:r}),!r.has_landed&&c.jsx("div",{className:"p-4 border-t border-gray-100",children:c.jsx(P9,{flight:r,onUpdateFlightStatus:e})})]})})}function D9(){const{toast:r}=Lt(),e=Gr(),t=ln({mutationFn:async n=>{const{data:a,error:i}=await xe.from("packages").select("id, tracking_number").eq("trip_id",n).eq("status","procesado");if(i)throw i;if(!a||a.length===0)throw new Error('No packages found in "procesado" status for this trip');const{error:o}=await xe.from("packages").update({status:"transito",updated_at:new Date().toISOString()}).eq("trip_id",n).eq("status","procesado");if(o)throw o;const s=a.map(p=>p.id),{data:l,error:u}=await xe.from("dispatch_packages").select("dispatch_id").in("package_id",s);if(u)throw u;if(l&&l.length>0){const p=[...new Set(l.map(v=>v.dispatch_id))],{error:g}=await xe.from("dispatch_relations").update({status:"en_transito",updated_at:new Date().toISOString()}).in("id",p);if(g)throw g}const d=a.map(p=>({package_id:p.id,event_type:"in_transit",description:"Paquete en tránsito",location:"En vuelo"})),{error:f}=await xe.from("tracking_events").insert(d);if(f)throw f;const{error:h}=await xe.from("trips").update({status:"in_progress",updated_at:new Date().toISOString()}).eq("id",n);if(h)throw h;return{updatedPackages:a.length,tripId:n}},onSuccess:n=>{e.invalidateQueries({queryKey:["trips-with-flights"]}),e.invalidateQueries({queryKey:["packages"]}),e.invalidateQueries({queryKey:["packages-by-date"]}),e.invalidateQueries({queryKey:["dispatch-relations"]}),e.invalidateQueries({queryKey:["dispatch-packages"]}),e.invalidateQueries({queryKey:["packages-by-trip",n.tripId]});const a=pt(new Date,"yyyy-MM-dd");e.invalidateQueries({queryKey:["packages-by-date",a]}),e.invalidateQueries({queryKey:["dispatch-relations",a]}),e.refetchQueries({queryKey:["dispatch-relations"]}),e.refetchQueries({queryKey:["dispatch-packages"]}),r({title:"Viaje marcado en tránsito",description:`${n.updatedPackages} paquetes actualizados a "En Tránsito"`})},onError:n=>{console.error("Error marking trip as in transit:",n),r({title:"Error",description:n.message||"No se pudo marcar el viaje como en tránsito",variant:"destructive"})}});return{markTripAsInTransit:t.mutate,isMarkingAsInTransit:t.isPending}}function I9(){const{toast:r}=Lt(),e=Gr(),t=ln({mutationFn:async n=>{const{data:a,error:i}=await xe.from("packages").select("id, tracking_number").eq("trip_id",n).eq("status","transito");if(i)throw i;if(!a||a.length===0)throw new Error("No packages in transit found for this trip");const{error:o}=await xe.from("packages").update({status:"en_destino",updated_at:new Date().toISOString()}).eq("trip_id",n).eq("status","transito");if(o)throw o;const s=a.map(p=>p.id),{data:l,error:u}=await xe.from("dispatch_packages").select("dispatch_id").in("package_id",s);if(u)throw u;if(l&&l.length>0){const p=[...new Set(l.map(v=>v.dispatch_id))],{error:g}=await xe.from("dispatch_relations").update({status:"llegado",updated_at:new Date().toISOString()}).in("id",p);if(g)throw g}const d=a.map(p=>({package_id:p.id,event_type:"arrived",description:"Paquete llegó a destino",location:"Destino"})),{error:f}=await xe.from("tracking_events").insert(d);if(f)throw f;const{error:h}=await xe.from("trips").update({status:"completed",updated_at:new Date().toISOString()}).eq("id",n);if(h)throw h;return{updatedPackages:a.length,tripId:n}},onSuccess:n=>{e.invalidateQueries({queryKey:["trips-with-flights"]}),e.invalidateQueries({queryKey:["packages"]}),e.invalidateQueries({queryKey:["packages-by-date"]}),e.invalidateQueries({queryKey:["dispatch-relations"]}),e.invalidateQueries({queryKey:["dispatch-packages"]}),e.invalidateQueries({queryKey:["packages-by-trip",n.tripId]});const a=pt(new Date,"yyyy-MM-dd");e.invalidateQueries({queryKey:["packages-by-date",a]}),e.invalidateQueries({queryKey:["dispatch-relations",a]}),e.refetchQueries({queryKey:["dispatch-relations"]}),e.refetchQueries({queryKey:["dispatch-packages"]}),r({title:"Viaje marcado como llegado",description:`${n.updatedPackages} paquetes actualizados a "En Destino"`})},onError:n=>{console.error("Error marking trip as arrived:",n),r({title:"Error",description:n.message||"No se pudo marcar el viaje como llegado",variant:"destructive"})}});return{markTripAsArrived:t.mutate,isMarkingAsArrived:t.isPending}}function f4(){const{markTripAsInTransit:r,isMarkingAsInTransit:e}=D9(),{markTripAsArrived:t,isMarkingAsArrived:n}=I9();return{markTripAsInTransit:r,isMarkingAsInTransit:e,markTripAsArrived:t,isMarkingAsArrived:n}}function T9({trip:r,onAddPackage:e,onUpdateFlightStatus:t}){const n=yn(),{markTripAsArrived:a,isMarkingAsArrived:i}=f4(),o=f=>{switch(f){case"completed":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";case"scheduled":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},s=f=>{switch(f){case"completed":return"Completado";case"in_progress":return"En Progreso";case"scheduled":return"Programado";case"cancelled":return"Cancelado";default:return f}},l=f=>{const h=f.includes("T")?f:`${f}T00:00:00`;return pt(Go(h),"dd/MM/yyyy")},u=()=>{a(r.id)},d=r.status==="in_progress"||r.flight_data?.has_landed&&r.status!=="completed";return c.jsxs(He,{className:"border-l-4 border-l-blue-500",children:[c.jsx(yt,{className:`${n?"px-3 pb-3":"px-6 pb-4"}`,children:c.jsxs("div",{className:`${n?"space-y-3":"flex items-center justify-between"}`,children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs(Nt,{className:`${n?"text-base":"text-lg"} leading-tight`,children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(Li,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{children:l(r.trip_date)})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(gi,{className:"h-4 w-4 text-gray-500"}),c.jsxs("span",{className:"text-sm font-normal",children:[r.origin," → ",r.destination]})]})]}),c.jsxs("div",{className:`flex ${n?"flex-col gap-2":"items-center gap-2"} mt-2`,children:[c.jsx(Ot,{className:`${o(r.status)} ${n?"self-start":""} text-xs`,children:s(r.status)}),r.flight_number&&c.jsxs(Ot,{variant:"outline",className:`${n?"self-start":""} text-xs`,children:[c.jsx(Ts,{className:"h-3 w-3 mr-1"}),r.flight_number]})]})]}),c.jsxs("div",{className:`${n?"flex flex-col gap-2":"flex gap-2"}`,children:[d&&c.jsxs(Ne,{size:"sm",variant:"outline",onClick:u,disabled:i,className:`${n?"w-full":""} flex items-center gap-1 text-xs`,children:[c.jsx(gi,{className:"h-3 w-3"}),i?"Marcando...":"Marcar como Llegado"]}),c.jsxs(Ne,{size:"sm",onClick:()=>e(r.id),className:`${n?"w-full":""} flex items-center gap-1 text-xs`,children:[c.jsx(ao,{className:"h-3 w-3"}),"Agregar Encomienda"]})]})]})}),c.jsx(We,{className:`${n?"px-3 pb-3":"px-6 pb-4"}`,children:r.flight_data?c.jsxs("div",{className:"mt-4",children:[c.jsxs("h4",{className:`font-medium ${n?"mb-2 text-sm":"mb-3"} flex items-center gap-2`,children:[c.jsx(Ts,{className:"h-4 w-4"}),"Información del Vuelo"]}),c.jsx(Og,{flight:r.flight_data,onUpdateFlightStatus:t||(()=>{})})]}):r.flight_number?c.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:c.jsxs("p",{className:"text-sm text-gray-600",children:["Información de vuelo no disponible para ",r.flight_number]})}):c.jsx("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg",children:c.jsx("p",{className:"text-sm text-gray-600",children:"No se ha asignado número de vuelo a este viaje"})})})]})}function h4(){const r=Gr(),{toast:e}=Lt(),{data:t=[],isLoading:n}=Rt({queryKey:["pending-flight-notifications"],queryFn:async()=>{const{data:s,error:l}=await xe.from("flight_data").select("*").eq("has_landed",!0).eq("notification_sent",!1);if(l)throw l;return s},refetchInterval:3e4}),a=ln({mutationFn:async()=>{console.log("Iniciando procesamiento de notificaciones...");const{error:s}=await xe.rpc("process_arrival_notifications");if(s)throw s;const{data:l,error:u}=await xe.from("notification_log").select(`
          id,
          message,
          customers (
            phone,
            whatsapp_number,
            name
          ),
          packages (
            tracking_number
          )
        `).eq("status","pending").eq("notification_type","arrival");if(u)throw u;if(console.log("Notificaciones pendientes encontradas:",l?.length||0),l&&l.length>0){const d=l.map(async f=>{const h=f.customers?.whatsapp_number||f.customers?.phone;if(!h){console.log("Sin número de teléfono para:",f.customers?.name);return}try{const p=await xe.functions.invoke("send-whatsapp-notification",{body:{notificationId:f.id,phone:h,message:f.message}});p.error?console.error("Error enviando notificación:",p.error):console.log("Notificación enviada exitosamente:",f.id)}catch(p){console.error("Error en edge function:",p)}});await Promise.all(d)}},onSuccess:()=>{r.invalidateQueries({queryKey:["pending-flight-notifications"]}),r.invalidateQueries({queryKey:["packages"]}),r.invalidateQueries({queryKey:["notification-log"]}),e({title:"Notificaciones procesadas",description:"Se han enviado las notificaciones de llegada por WhatsApp"})},onError:s=>{console.error("Error processing notifications:",s),e({title:"Error",description:"No se pudieron procesar las notificaciones",variant:"destructive"})}}),i=ln({mutationFn:async({flightId:s,hasLanded:l})=>{const{error:u}=await xe.from("flight_data").update({has_landed:l,actual_arrival:l?new Date().toISOString():null}).eq("id",s);if(u)throw u},onSuccess:()=>{r.invalidateQueries({queryKey:["pending-flight-notifications"]}),e({title:"Estado actualizado",description:"El estado del vuelo ha sido actualizado"})}}),o=ln({mutationFn:async({phone:s,message:l})=>{const u=await xe.functions.invoke("send-whatsapp-notification",{body:{notificationId:"test-"+Date.now(),phone:s,message:l}});if(u.error)throw u.error;return u.data},onSuccess:()=>{e({title:"Notificación de prueba enviada",description:"La notificación de prueba se envió correctamente"})},onError:s=>{console.error("Error sending test notification:",s),e({title:"Error",description:"No se pudo enviar la notificación de prueba",variant:"destructive"})}});return{pendingFlights:t,isLoading:n,processNotifications:a.mutate,updateFlightStatus:i.mutate,sendTestNotification:o.mutate,isProcessing:a.isPending,isSendingTest:o.isPending}}function O9({onAddPackage:r}){const{data:e=[],isLoading:t}=g9(),{updateFlightStatus:n}=h4();return t?c.jsx("div",{className:"flex justify-center py-6 sm:py-8",children:c.jsx("div",{className:"text-gray-500 text-sm sm:text-base",children:"Cargando viajes y vuelos..."})}):c.jsx("div",{className:"space-y-4 sm:space-y-6",children:e.map(a=>c.jsx(T9,{trip:a,onAddPackage:r,onUpdateFlightStatus:n},a.id))})}function kg({viewingPackagesByDate:r,trips:e,tripsLoading:t,onAddPackage:n,onCreateTrip:a,onViewPackagesByDate:i,onBack:o,disableChat:s=!1,previewRole:l}){return c.jsx(xn,{value:"trips",className:"space-y-4 sm:space-y-8 px-2 sm:px-0",children:r?c.jsx(m9,{selectedDate:r,onBack:o,onAddPackage:n,disableChat:s,previewRole:l}):c.jsxs(c.Fragment,{children:[c.jsx(zL,{trips:e,isLoading:t,onAddPackage:n,onCreateTrip:a,onViewPackagesByDate:i}),c.jsx(O9,{onAddPackage:n})]})})}function k9({selectedDate:r,onViewDispatch:e}){const{data:t=[],isLoading:n}=Tg(r),a=yn(),i=l=>{switch(l){case"procesado":return"bg-orange-100 text-orange-800";case"en_transito":return"bg-blue-100 text-blue-800";case"llegado":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},o=l=>{switch(l){case"procesado":return"Procesado";case"en_transito":return"En Tránsito";case"llegado":return"Llegado";default:return l.charAt(0).toUpperCase()+l.slice(1)}},s=l=>l?`$${l.toLocaleString("es-CO")}`:"$0";return n?c.jsx(He,{children:c.jsx(We,{className:"py-8",children:c.jsx("div",{className:"text-center text-gray-500 text-sm",children:"Cargando despachos..."})})}):a?c.jsxs(He,{children:[c.jsxs(yt,{className:"px-3 pb-3",children:[c.jsxs(Nt,{className:"flex items-center gap-2 text-lg",children:[c.jsx(Rn,{className:"h-5 w-5"}),"Despachos",r&&c.jsx("span",{className:"text-sm font-normal text-gray-600 block mt-1",children:pt(r,"d 'de' MMMM",{locale:Bn})})]}),c.jsxs("div",{className:"text-sm text-gray-600",children:[t.length," despacho",t.length!==1?"s":""]})]}),c.jsx(We,{className:"px-3 pb-3",children:t.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(Rn,{className:"h-12 w-12 mx-auto text-gray-300 mb-3"}),c.jsx("h3",{className:"text-base font-medium text-gray-900 mb-2",children:"No hay despachos"}),c.jsx("p",{className:"text-sm text-gray-500",children:r?"No se encontraron despachos para la fecha seleccionada":"No se han creado despachos aún"})]}):c.jsx("div",{className:"space-y-3",children:t.map(l=>c.jsx(He,{className:"border border-gray-200",children:c.jsx(We,{className:"p-4",children:c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(Li,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"font-medium text-sm",children:pt(new Date(l.dispatch_date),"dd/MM/yyyy")})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(Dr,{className:"h-3 w-3 text-blue-500"}),c.jsxs("span",{children:[l.total_packages," paquetes"]})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(Ko,{className:"h-3 w-3 text-purple-500"}),c.jsxs("span",{children:[l.total_weight||0," kg"]})]})]})]}),c.jsx(Ot,{className:`${i(l.status)} text-xs`,children:o(l.status)})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500",children:"Flete:"}),c.jsx("span",{className:"font-medium ml-1",children:s(l.total_freight)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-500",children:"A Cobrar:"}),c.jsx("span",{className:"font-medium text-green-600 ml-1",children:s(l.total_amount_to_collect)})]})]}),l.notes&&c.jsxs("div",{className:"text-sm",children:[c.jsx("span",{className:"text-gray-500",children:"Notas:"}),c.jsx("p",{className:"text-gray-700 truncate mt-1",children:l.notes})]}),c.jsxs(Ne,{size:"sm",variant:"outline",onClick:()=>e(l.id),className:"w-full flex items-center gap-2",children:[c.jsx(wu,{className:"h-3 w-3"}),"Ver Detalles"]})]})})},l.id))})})]}):c.jsxs(He,{children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(Rn,{className:"h-5 w-5"}),"Despachos",r&&c.jsxs("span",{className:"text-sm font-normal text-gray-600",children:["- ",pt(r,"d 'de' MMMM 'de' yyyy",{locale:Bn})]})]}),c.jsxs("div",{className:"text-sm text-gray-600",children:[t.length," despacho",t.length!==1?"s":"",r?" en la fecha seleccionada":" en total"]})]}),c.jsx(We,{children:t.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Rn,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay despachos"}),c.jsx("p",{className:"text-gray-500",children:r?`No se encontraron despachos para ${pt(r,"d 'de' MMMM",{locale:Bn})}`:"No se han creado despachos aún"})]}):c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"Fecha"}),c.jsx(Me,{children:"Paquetes"}),c.jsx(Me,{children:"Peso Total"}),c.jsx(Me,{children:"Flete Total"}),c.jsx(Me,{children:"A Cobrar"}),c.jsx(Me,{children:"Estado"}),c.jsx(Me,{children:"Notas"}),c.jsx(Me,{children:"Acciones"})]})}),c.jsx(Wa,{children:t.map(l=>c.jsxs(Sr,{children:[c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Li,{className:"h-4 w-4 text-gray-500"}),pt(new Date(l.dispatch_date),"dd/MM/yyyy")]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Dr,{className:"h-4 w-4 text-blue-500"}),c.jsx("span",{className:"font-medium",children:l.total_packages})]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ko,{className:"h-4 w-4 text-purple-500"}),c.jsxs("span",{children:[l.total_weight||0," kg"]})]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Rn,{className:"h-4 w-4 text-orange-500"}),c.jsx("span",{children:s(l.total_freight)})]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(_a,{className:"h-4 w-4 text-green-500"}),c.jsx("span",{className:"font-medium text-green-700",children:s(l.total_amount_to_collect)})]})}),c.jsx(Re,{children:c.jsx(Ot,{className:i(l.status),children:o(l.status)})}),c.jsx(Re,{children:c.jsx("div",{className:"max-w-32 truncate text-sm text-gray-600",children:l.notes||"-"})}),c.jsx(Re,{children:c.jsxs(Ne,{size:"sm",variant:"outline",onClick:()=>e(l.id),className:"flex items-center gap-1",children:[c.jsx(wu,{className:"h-3 w-3"}),"Ver"]})})]},l.id))})]})})]})}function M9({canMarkAsInTransit:r,canMarkAsArrived:e,onMarkAsInTransit:t,onMarkAsArrived:n,isMarkingAsInTransit:a,isMarkingAsArrived:i,hasPackages:o}){const s=Gr(),l=async()=>{t(),setTimeout(()=>{s.refetchQueries({queryKey:["dispatch-relations"]}),s.refetchQueries({queryKey:["dispatch-packages"]})},1e3)},u=async()=>{n(),setTimeout(()=>{s.refetchQueries({queryKey:["dispatch-relations"]}),s.refetchQueries({queryKey:["dispatch-packages"]})},1e3)};return c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Rn,{className:"h-5 w-5"}),c.jsx("h2",{className:"text-lg font-semibold",children:"Detalles del Despacho"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[r&&c.jsxs(Ne,{size:"sm",variant:"outline",onClick:l,disabled:a,className:"flex items-center gap-1",children:[c.jsx(dl,{className:"h-3 w-3"}),a?"Marcando...":"Marcar en Tránsito"]}),e&&c.jsxs(Ne,{size:"sm",variant:"outline",onClick:u,disabled:i,className:"flex items-center gap-1",children:[c.jsx(Fn,{className:"h-3 w-3"}),i?"Marcando...":"Llegado"]}),!r&&!e&&o&&c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[c.jsx(mi,{className:"h-4 w-4"}),"No hay acciones disponibles para este despacho"]})]})]})}function R9({packageCount:r,totalWeight:e,totalFreight:t,totalAmountToCollect:n}){const a=yn(),i=o=>o?`$${o.toLocaleString("es-CO")}`:"$0";return c.jsxs("div",{className:`${a?"grid grid-cols-2 gap-2":"grid grid-cols-4 gap-4"}`,children:[c.jsx(He,{children:c.jsx(We,{className:`${a?"p-3":"p-4"}`,children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Dr,{className:"h-4 w-4 text-blue-500"}),c.jsxs("div",{children:[c.jsx("div",{className:`${a?"text-lg":"text-2xl"} font-bold`,children:r}),c.jsx("div",{className:"text-xs text-gray-600",children:"Paquetes"})]})]})})}),c.jsx(He,{children:c.jsx(We,{className:`${a?"p-3":"p-4"}`,children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ko,{className:"h-4 w-4 text-purple-500"}),c.jsxs("div",{children:[c.jsxs("div",{className:`${a?"text-lg":"text-2xl"} font-bold`,children:[e," kg"]}),c.jsx("div",{className:"text-xs text-gray-600",children:"Peso Total"})]})]})})}),c.jsx(He,{children:c.jsx(We,{className:`${a?"p-3":"p-4"}`,children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Rn,{className:"h-4 w-4 text-orange-500"}),c.jsxs("div",{children:[c.jsx("div",{className:`${a?"text-sm":"text-2xl"} font-bold`,children:i(t)}),c.jsx("div",{className:"text-xs text-gray-600",children:"Flete Total"})]})]})})}),c.jsx(He,{children:c.jsx(We,{className:`${a?"p-3":"p-4"}`,children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(_a,{className:"h-4 w-4 text-green-500"}),c.jsxs("div",{children:[c.jsx("div",{className:`${a?"text-sm":"text-2xl"} font-bold text-green-700`,children:i(n)}),c.jsx("div",{className:"text-xs text-gray-600",children:"A Cobrar"})]})]})})})]})}class L9{static async deliverPackage({packageId:e,deliveredBy:t,payments:n}){console.log("🚀 [DeliveryService] Iniciando entrega de paquete:",{packageId:e,deliveredBy:t,payments:n,paymentsCount:n?.length||0});try{if(!e)throw new Error("packageId es requerido");if(!t)throw new Error("deliveredBy es requerido");console.log("✅ [DeliveryService] Parámetros validados correctamente");const a=n&&n.length>0?n.map(s=>({method_id:s.method_id,amount:s.amount,currency:s.currency,type:s.type})):null;console.log("💰 [DeliveryService] Pagos preparados para RPC:",a);const{data:i,error:o}=await xe.rpc("deliver_package_with_payment_v2",{p_package_id:e,p_delivered_by:t,p_payments:a});if(o)throw console.error("❌ [DeliveryService] Error en función RPC:",{error:o,code:o.code,message:o.message,details:o.details,hint:o.hint}),o;return console.log("✅ [DeliveryService] Respuesta exitosa de RPC:",i),i}catch(a){throw console.error("❌ [DeliveryService] Error completo en entrega:",{error:a,errorType:typeof a,errorConstructor:a?.constructor?.name,errorMessage:a?.message,errorCode:a?.code,errorStack:a?.stack}),a}}}class F9{static async deliverPackageWithFallback({packageId:e,deliveredBy:t,payments:n}){console.log("🔄 [DeliveryFallbackService] Iniciando método alternativo..."),console.log("📋 [DeliveryFallbackService] Parámetros:",{packageId:e,deliveredBy:t,payments:n});try{console.log("📦 [DeliveryFallbackService] Obteniendo datos del paquete...");const{data:a,error:i}=await xe.from("packages").select("amount_to_collect, currency, status").eq("id",e).single();if(i)throw console.error("❌ [DeliveryFallbackService] Error obteniendo datos del paquete:",i),i;if(console.log("📦 [DeliveryFallbackService] Datos del paquete:",a),a.status==="delivered")throw new Error("El paquete ya ha sido entregado");console.log("📝 [DeliveryFallbackService] Actualizando estado del paquete...");const{data:o,error:s}=await xe.from("packages").update({status:"delivered",delivered_by:t,delivered_at:new Date().toISOString()}).eq("id",e).select();if(s)throw console.error("❌ [DeliveryFallbackService] Error en actualización de paquete:",s),s;console.log("✅ [DeliveryFallbackService] Paquete actualizado:",o);const l=n?n.reduce((u,d)=>u+d.amount,0):0;return console.log("💰 [DeliveryFallbackService] Total cobrado:",l),console.log("💰 [DeliveryFallbackService] Monto a cobrar del paquete:",a.amount_to_collect),n&&n.length>0&&await this.createDeliveryRecord(e,t,l,n),a.amount_to_collect&&a.amount_to_collect>0?await this.createOrUpdateDebtRecord(e,a.amount_to_collect,l,a.currency):console.log("ℹ️ [DeliveryFallbackService] Paquete sin monto a cobrar, no se crea registro de deuda"),console.log("✅ [DeliveryFallbackService] Entrega procesada con método alternativo"),o}catch(a){throw console.error("❌ [DeliveryFallbackService] Error en método alternativo:",a),a}}static async createDeliveryRecord(e,t,n,a){console.log("💰 [DeliveryFallbackService] Creando registro de entrega y pagos...");try{const{data:i,error:o}=await xe.from("package_deliveries").insert({package_id:e,delivered_by:t,delivery_date:new Date().toISOString(),total_amount_collected:n,delivery_status:"delivered"}).select().single();if(o){console.error("❌ [DeliveryFallbackService] Error creando registro de entrega:",o);return}console.log("✅ [DeliveryFallbackService] Registro de entrega creado:",i);const s=(l,u)=>l==="efectivo"&&u==="AWG"?"11111111-1111-1111-1111-111111111111":l==="efectivo"&&u==="COP"?"22222222-2222-2222-2222-222222222222":l==="transferencia"&&u==="AWG"?"33333333-3333-3333-3333-333333333333":l==="transferencia"&&u==="COP"?"44444444-4444-4444-4444-444444444444":"11111111-1111-1111-1111-111111111111";for(const l of a){console.log("💳 [DeliveryFallbackService] Creando pago:",l);const{error:u}=await xe.from("delivery_payments").insert({delivery_id:i.id,payment_method_id:s(l.method_id,l.currency),amount:l.amount,currency:l.currency,payment_type:l.type});u?console.error("❌ [DeliveryFallbackService] Error creando pago:",u):console.log("✅ [DeliveryFallbackService] Pago creado exitosamente")}}catch(i){console.error("❌ [DeliveryFallbackService] Error en createDeliveryRecord:",i)}}static async createOrUpdateDebtRecord(e,t,n,a){console.log("💸 [DeliveryFallbackService] Creando/actualizando registro de deuda...");try{const i=t-n,{data:o,error:s}=await xe.from("package_debts").select("id").eq("package_id",e).single();if(s&&s.code!=="PGRST116"&&console.error("❌ [DeliveryFallbackService] Error verificando deuda existente:",s),o){console.log("📝 [DeliveryFallbackService] Actualizando registro de deuda existente...");const{error:l}=await xe.from("package_debts").update({total_amount:t,pending_amount:i,paid_amount:n,debt_type:"unpaid",delivery_date:new Date().toISOString(),status:n>=t?"paid":n>0?"partial":"pending",updated_at:new Date().toISOString()}).eq("package_id",e);l?console.error("❌ [DeliveryFallbackService] Error actualizando registro de deuda:",l):console.log("✅ [DeliveryFallbackService] Registro de deuda actualizado exitosamente")}else{console.log("📝 [DeliveryFallbackService] Creando nuevo registro de deuda...");const{error:l}=await xe.from("package_debts").insert({package_id:e,total_amount:t,pending_amount:i,paid_amount:n,debt_type:"unpaid",debt_start_date:new Date().toISOString().split("T")[0],delivery_date:new Date().toISOString(),status:n>=t?"paid":n>0?"partial":"pending"});l?console.error("❌ [DeliveryFallbackService] Error creando registro de deuda:",l):console.log("✅ [DeliveryFallbackService] Registro de deuda creado exitosamente")}}catch(i){console.error("❌ [DeliveryFallbackService] Error en createOrUpdateDebtRecord:",i)}}}class y1{static handleDeliveryError(e){console.error("❌ [DeliveryErrorHandler] Error en mutación de entrega:",{error:e,errorType:typeof e,errorConstructor:e?.constructor?.name,errorMessage:e?.message,errorCode:e?.code,errorDetails:e?.details,errorHint:e?.hint});let t="No se pudo completar la entrega del paquete. Intenta nuevamente.",n=!1;if(e?.code)switch(console.log("🔍 [DeliveryErrorHandler] Código de error:",e.code),e.code){case"42804":t="Error de formato de datos. Se intentará método alternativo.",n=!0;break;case"22023":t="Error de formato de datos. Se intentará método alternativo.",n=!0;break;case"42501":t="Error de permisos. Se intentará método alternativo.",n=!0;break;case"23505":t="Error de duplicado. El paquete ya fue procesado.";break;case"PGRST116":t="No se encontró el paquete especificado.";break;default:console.log("🔍 [DeliveryErrorHandler] Código de error no manejado:",e.code),n=!0}return e?.message&&(console.log("🔍 [DeliveryErrorHandler] Mensaje de error:",e.message),e.message.includes("currency_type")||e.message.includes("currency")?(t="Error de tipo de moneda. Se intentará método alternativo.",n=!0):e.message.includes("collection_stats")?(t="Error de permisos en estadísticas. Se intentará método alternativo.",n=!0):e.message.includes("permission denied")?(t="Error de permisos en la base de datos. Se intentará método alternativo.",n=!0):e.message.includes("violates")?t="Error de validación de datos.":e.message.includes("does not exist")&&(t="Error: elemento no encontrado.")),console.log("📝 [DeliveryErrorHandler] Mensaje final:",t),console.log("🔄 [DeliveryErrorHandler] ¿Debería intentar fallback?",n),Zp({title:"Error en la entrega",description:t,variant:"destructive"}),{shouldTryFallback:n}}static isPermissionError(e){const t=!!(e?.message?.includes("collection_stats")||e?.message?.includes("currency_type")||e?.code==="42501"||e?.code==="42804"||e?.message?.includes("permission denied"));return console.log("🔒 [DeliveryErrorHandler] ¿Es error de permisos o tipo?",t,{errorMessage:e?.message,errorCode:e?.code}),t}}class B9{static handleDeliverySuccess(e,t){console.log("🎉 Entrega exitosa, invalidando queries..."),e.invalidateQueries({queryKey:["dispatch-packages"]}),e.invalidateQueries({queryKey:["packages"]}),e.invalidateQueries({queryKey:["packages-by-date"]}),e.invalidateQueries({queryKey:["debt-data"]}),e.invalidateQueries({queryKey:["collection-packages"]}),Zp({title:"¡Entrega exitosa!",description:`Paquete entregado correctamente por ${t}`}),console.log("✅ Queries invalidadas y toast mostrado")}}function p4(){const r=Gr();return ln({mutationFn:async e=>{console.log("🎯 [useDeliverPackage] Iniciando mutación con parámetros:",e);try{console.log("🚀 [useDeliverPackage] Intentando método principal...");const t=await L9.deliverPackage(e);return console.log("✅ [useDeliverPackage] Método principal exitoso:",t),t}catch(t){console.log("❌ [useDeliverPackage] Error en método principal:",t);const{shouldTryFallback:n}=y1.handleDeliveryError(t);if(n||y1.isPermissionError(t)){console.log("🔄 [useDeliverPackage] Intentando método alternativo...");try{const a=await F9.deliverPackageWithFallback(e);return console.log("✅ [useDeliverPackage] Método alternativo exitoso:",a),a}catch(a){throw console.error("❌ [useDeliverPackage] Error en método alternativo:",a),y1.handleDeliveryError(a),a}}else throw console.log("🚫 [useDeliverPackage] No se intentará método alternativo"),t}},onSuccess:(e,t)=>{console.log("🎉 [useDeliverPackage] Mutación exitosa:",{data:e,variables:t}),B9.handleDeliverySuccess(r,t.deliveredBy)},onError:e=>{console.error("💥 [useDeliverPackage] Error final en mutación:",e)}})}const b1=r=>({methodId:"efectivo",amount:"",currency:"AWG",type:"partial"}),$9=(r,e)=>({AWG:"ƒ",USD:"$",COP:"$"})[r]||"$",U9=r=>r.filter(e=>e.methodId&&e.amount&&parseFloat(e.amount)>0).map(e=>({method_id:e.methodId,amount:parseFloat(e.amount),currency:e.currency,type:e.type})),q9=(r,e,t,n,a)=>{const i={...r,[e]:t};if(e==="amount"&&a!==void 0){const o=parseFloat(t)||0;i.type=o>=a?"full":"partial"}return i.methodId||(i.methodId="efectivo"),i};function m4(r){const[e,t]=w.useState([]);return console.log("🎯 [usePaymentManagement] Package currency received:",r),w.useEffect(()=>{const u=r||"AWG";console.log("🔄 [usePaymentManagement] Initializing with currency:",u),console.log("🔄 [usePaymentManagement] Package currency was:",r);const d=b1();d.currency=u,d.methodId="efectivo",console.log("🎯 [usePaymentManagement] Default payment created:",d),console.log("🎯 [usePaymentManagement] Payment currency set to:",d.currency),t([d])},[r]),{payments:e,addPayment:()=>{const u=r||"AWG";console.log("➕ [usePaymentManagement] Adding payment with currency:",u);const d=b1();d.currency=u,d.methodId="efectivo",console.log("➕ [usePaymentManagement] New payment created:",d),t(f=>[...f,d])},updatePayment:(u,d,f,h)=>{console.log("💳 [usePaymentManagement] Updating payment:",{index:u,field:d,value:f,packageAmount:h}),console.log("💳 [usePaymentManagement] Package currency context:",r),t(p=>p.map((g,v)=>v===u?q9(g,d,f,[],h):g))},removePayment:u=>{t(d=>d.filter((f,h)=>h!==u))},resetPayments:()=>{const u=r||"AWG";console.log("🔄 [usePaymentManagement] Resetting payments with currency:",u);const d=b1();d.currency=u,d.methodId="efectivo",console.log("🔄 [usePaymentManagement] Reset payment created:",d),t([d])},getCurrencySymbol:u=>{const d=$9(u);return console.log("💱 [usePaymentManagement] Currency symbol for",u,":",d),d},getValidPayments:()=>{const u=U9(e);return console.log("✅ [usePaymentManagement] Valid payments for submission:",u),u},availablePaymentMethods:[]}}function Mg({package:r}){const e=r.amount_to_collect&&r.amount_to_collect>0,t=r.currency||"COP";console.log("📋 [MobilePackageInfo] Package data:",r),console.log("💰 [MobilePackageInfo] Package currency:",t),console.log("💰 [MobilePackageInfo] Amount to collect:",r.amount_to_collect),console.log("💰 [MobilePackageInfo] Requires payment:",e);const a=(o=>{const l={AWG:"ƒ",USD:"$",COP:"$"}[o]||"$";return console.log("💱 [MobilePackageInfo] Currency symbol for",o,":",l),l})(t),i=o=>{const l={AWG:"Florín (AWG)",USD:"Dólar (USD)",COP:"Peso (COP)"}[o]||`${o}`;return console.log("🏷️ [MobilePackageInfo] Currency label for",o,":",l),l};return c.jsxs(He,{className:"border-blue-200 bg-blue-50",children:[c.jsx(yt,{children:c.jsxs(Nt,{className:"flex items-center gap-2 text-blue-800",children:[c.jsx(Dr,{className:"h-5 w-5"}),"Información del Paquete"]})}),c.jsxs(We,{className:"space-y-4",children:[c.jsx("div",{className:"p-3 bg-white rounded-lg border",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Número de Tracking"}),c.jsx("p",{className:"text-lg font-bold text-blue-600",children:r.tracking_number})]})}),c.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[c.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border",children:[c.jsx(ts,{className:"h-5 w-5 text-gray-500"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Cliente"}),c.jsx("p",{className:"font-medium",children:r.customers?.name||"N/A"})]})]}),c.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border",children:[c.jsx(gi,{className:"h-5 w-5 text-gray-500"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Destino"}),c.jsx("p",{className:"font-medium",children:r.destination})]})]}),c.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border",children:[c.jsx(V1,{className:"h-5 w-5 text-gray-500"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Descripción"}),c.jsx("p",{className:"font-medium",children:r.description})]})]}),e&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center gap-3 p-3 bg-green-50 rounded-lg border border-green-200",children:[c.jsx(_a,{className:"h-5 w-5 text-green-600"}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm text-green-700",children:"Monto a cobrar"}),c.jsxs("p",{className:"font-bold text-green-600 text-lg",children:[a,r.amount_to_collect?.toLocaleString("es-CO")," ",t]})]})]}),c.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Moneda"}),c.jsx("div",{className:"inline-block bg-blue-100 px-3 py-1 rounded-full",children:c.jsx("span",{className:"text-sm font-medium text-blue-800",children:i(t)})})]})]}),c.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Estado"}),c.jsx("div",{className:"inline-block",children:c.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.status==="entregado"?"bg-green-100 text-green-800":r.status==="en_destino"?"bg-blue-100 text-blue-800":r.status==="en_transito"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:r.status.replace("_"," ").toUpperCase()})})]})]})]})]})}const V9=[{id:"efectivo",name:"Efectivo"},{id:"transferencia",name:"Transferencia"}];function z9({payment:r,index:e,onUpdate:t,onRemove:n,canRemove:a}){const i=u=>{const d=u.target.value;console.log("📝 Input amount change:",d);const f=Xo(d),h=$u(f);t(e,"amount",h)},o=()=>r.amount?Xo(r.amount):"",l=(u=>({AWG:"ƒ",USD:"$",COP:"$"})[u]||"$")(r.currency);return c.jsxs("div",{className:"grid grid-cols-4 gap-2 items-end",children:[c.jsx("div",{children:c.jsxs(Ca,{value:r.currency,onValueChange:u=>t(e,"currency",u),children:[c.jsx(ia,{className:"h-10",children:c.jsx(Na,{})}),c.jsx(oa,{children:["AWG","COP"].map(u=>c.jsx(pr,{value:u,children:u},u))})]})}),c.jsx("div",{children:c.jsxs(Ca,{value:r.methodId||"efectivo",onValueChange:u=>t(e,"methodId",u),children:[c.jsx(ia,{className:"h-10",children:c.jsx(Na,{placeholder:"Seleccionar método"})}),c.jsx(oa,{children:V9.map(u=>c.jsx(pr,{value:u.id,children:u.name},u.id))})]})}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm",children:l}),c.jsx(It,{type:"text",value:o(),onChange:i,className:"pl-8 h-10",placeholder:"0"})]}),c.jsx("div",{className:"flex justify-center",children:a&&c.jsx(Ne,{type:"button",variant:"outline",size:"sm",onClick:()=>n(e),className:"h-10 w-10 p-0",children:c.jsx(zN,{className:"h-4 w-4"})})})]})}function H9({payments:r,packageAmountToCollect:e,getCurrencySymbol:t}){const n=r.reduce((i,o)=>{const s=parseFloat(o.amount)||0;return i+s},0),a=e-n;return r.length===0?null:c.jsx(He,{className:"bg-blue-50",children:c.jsx(We,{className:"p-4",children:c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Total a cobrar:"}),c.jsxs("span",{className:"font-medium",children:[t("COP"),e?.toLocaleString("es-CO")||0," COP"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Total recibido:"}),c.jsx("span",{className:"font-medium",children:r.length>0&&r[0].currency==="AWG"?`${t("AWG")}${n.toLocaleString("es-CO")} AWG`:`${t("COP")}${n.toLocaleString("es-CO")} COP`})]}),c.jsxs("div",{className:"flex justify-between border-t pt-2",children:[c.jsx("span",{children:"Pendiente:"}),c.jsxs("span",{className:`font-medium ${a<=0?"text-green-600":"text-orange-600"}`,children:[t("COP"),a.toLocaleString("es-CO")," COP"]})]})]})})})}function Rg({package:r,payments:e,onUpdatePayment:t,getCurrencySymbol:n}){if(!(r.amount_to_collect&&r.amount_to_collect>0))return null;const i=r.currency||"COP";console.log("💰 [MobilePaymentSection] Package currency:",i);const o=e.reduce((u,d)=>{const f=parseFloat(d.amount)||0;return u+f},0),s=n(i);console.log("💱 [MobilePaymentSection] Currency symbol:",s);const l=(r.amount_to_collect||0)-o;return c.jsxs(He,{className:"border-green-200 bg-green-50",children:[c.jsx(yt,{children:c.jsxs(Nt,{className:"flex items-center gap-2 text-green-800",children:[c.jsx(_a,{className:"h-5 w-5"}),"Cobro Requerido"]})}),c.jsxs(We,{children:[c.jsxs("div",{className:"mb-3",children:[c.jsxs("p",{className:"text-sm text-green-700",children:[c.jsx("strong",{children:"Total a cobrar:"})," ",s,r.amount_to_collect?.toLocaleString("es-CO")," ",i]}),o>0&&c.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[c.jsxs("p",{className:"text-green-700",children:[c.jsx("strong",{children:"Recibido:"})," ",s,o.toLocaleString("es-CO")," ",i]}),c.jsxs("p",{className:`${l<=0?"text-green-600":"text-orange-600"}`,children:[c.jsx("strong",{children:"Pendiente:"})," ",s,l.toLocaleString("es-CO")," ",i]})]})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx(at,{className:"text-green-800",children:"Registrar pago"}),e.length>0&&c.jsx(z9,{payment:e[0],index:0,onUpdate:t,onRemove:()=>{},canRemove:!1}),c.jsx(H9,{payments:e,packageAmountToCollect:r.amount_to_collect||0,getCurrencySymbol:n})]})]})]})}function Lg({deliveredBy:r,setDeliveredBy:e,notes:t,setNotes:n,hideDeliveredBy:a=!1}){const[i,o]=w.useState(!1);return c.jsxs("div",{className:"space-y-4",children:[!a&&c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"deliveredBy",children:"Entregado por"}),c.jsx(It,{id:"deliveredBy",value:r,onChange:s=>e(s.target.value),placeholder:"Nombre de quien entrega"})]}),c.jsxs(He,{children:[c.jsx(yt,{className:"pb-2",children:c.jsxs(Ne,{type:"button",variant:"ghost",onClick:()=>o(!i),className:"flex items-center justify-between w-full p-0 h-auto",children:[c.jsx(Nt,{className:"text-sm",children:"Notas adicionales"}),i?c.jsx(Jp,{className:"h-4 w-4"}):c.jsx(lh,{className:"h-4 w-4"})]})}),i&&c.jsx(We,{className:"pt-0",children:c.jsx(Uu,{value:t,onChange:s=>n(s.target.value),placeholder:"Agregar notas sobre la entrega...",className:"min-h-[80px]"})})]})]})}function W9({package:r,onSuccess:e,onCancel:t}){const[n,a]=w.useState(""),{user:i}=$s();console.log("🎯 [DeliverPackageForm] PAQUETE COMPLETO:",r),console.log("🎯 [DeliverPackageForm] Tracking number:",r.tracking_number),console.log("🎯 [DeliverPackageForm] Currency from package:",r.currency),console.log("🎯 [DeliverPackageForm] Amount to collect:",r.amount_to_collect);const o=p4(),{payments:s,addPayment:l,updatePayment:u,removePayment:d,resetPayments:f,getCurrencySymbol:h,getValidPayments:p}=m4(r.currency),g=i?.email||"Usuario no identificado",v=async()=>{if(console.log("🔄 Iniciando proceso de entrega..."),console.log("📦 Paquete:",r),console.log("👤 Usuario:",i),console.log("💰 Pagos:",s),!i){console.error("❌ Usuario no autenticado"),alert("No se puede procesar la entrega: usuario no autenticado");return}try{const F=p();console.log("✅ Pagos válidos:",F);const M={packageId:r.id,deliveredBy:g,payments:F.length>0?F:void 0};console.log("📤 Enviando datos de entrega:",M),await o.mutateAsync(M),console.log("✅ Entrega completada, reseteando formulario..."),a(""),f(),setTimeout(()=>{console.log("🏁 Cerrando diálogo..."),e()},500)}catch(F){console.error("❌ Error completo en handleSubmit:",F)}},b=(F,M,T)=>{console.log("💳 Actualizando pago:",{index:F,field:M,value:T}),u(F,M,T,r.amount_to_collect||0)},y=r.amount_to_collect&&r.amount_to_collect>0,C=s.reduce((F,M)=>{const T=parseFloat(M.amount)||0;return F+T},0),S=(r.amount_to_collect||0)-C,j=r.currency||"COP",D=h(j);return console.log("💰 Estado de pagos:",{requiresPayment:y,totalCollected:C,remainingAmount:S,amountToCollect:r.amount_to_collect,packageCurrency:j,currencySymbol:D}),c.jsxs("div",{className:"space-y-4",children:[c.jsx(Mg,{package:r}),c.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[c.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Información de Entrega"}),c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("span",{className:"font-medium",children:"Entregado por:"})," ",g]})]}),c.jsx(Rg,{package:r,payments:s,onAddPayment:l,onUpdatePayment:b,onRemovePayment:d,getCurrencySymbol:h}),c.jsxs("div",{className:"space-y-4",children:[c.jsx(Lg,{deliveredBy:"",setDeliveredBy:()=>{},notes:n,setNotes:a,hideDeliveredBy:!0}),y&&S>0&&c.jsx(He,{className:"border-orange-200 bg-orange-50",children:c.jsx(We,{className:"p-3",children:c.jsxs("p",{className:"text-sm text-orange-700",children:[c.jsx("strong",{children:"Atención:"})," Queda un saldo pendiente de"," ",c.jsxs("strong",{children:[D,S.toLocaleString("es-CO")," ",j]}),". Puedes registrar los pagos arriba."]})})}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(Ne,{type:"button",variant:"outline",onClick:t,className:"w-full",children:[c.jsx(lo,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),c.jsxs(Ne,{type:"button",disabled:!g.trim()||o.isPending,className:"w-full",onClick:v,children:[c.jsx(es,{className:"h-4 w-4 mr-2"}),o.isPending?"Entregando...":"Confirmar"]})]})]})]})}function ax({open:r,onOpenChange:e,package:t}){const n=yn();if(!t)return null;const a=()=>{e(!1)},i=()=>{e(!1)};return c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:`${n?"max-w-[95vw] max-h-[95vh]":"max-w-4xl max-h-[90vh]"} overflow-y-auto`,children:[c.jsx(Kr,{children:c.jsxs(Xr,{className:"flex items-center gap-2",children:[c.jsx(Dr,{className:"h-5 w-5"}),"Entregar Paquete - ",t.tracking_number]})}),c.jsx(W9,{package:t,onSuccess:a,onCancel:i})]})})}function G9({packages:r,onDeliverPackage:e}){const t=i=>{switch(i){case"delivered":return"bg-green-100 text-green-800";case"en_destino":return"bg-blue-100 text-blue-800";case"procesado":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},n=i=>{switch(i){case"delivered":return"Entregado";case"en_destino":return"En Destino";case"procesado":return"Procesado";default:return i.charAt(0).toUpperCase()+i.slice(1)}},a=i=>i?`$${i.toLocaleString("es-CO")}`:"$0";return r.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Dr,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay paquetes en este despacho"}),c.jsx("p",{className:"text-gray-500",children:"Este despacho no contiene paquetes"})]}):c.jsx("div",{className:"space-y-3",children:r.map(i=>c.jsxs(He,{className:"border border-gray-200",children:[c.jsx(yt,{className:"pb-2",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Dr,{className:"h-4 w-4 text-blue-500"}),c.jsx("span",{className:"font-medium text-sm",children:i.tracking_number})]}),c.jsx(Ot,{className:t(i.status),variant:"secondary",children:n(i.status)})]})}),c.jsxs(We,{className:"pt-0 space-y-3",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ts,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"text-sm text-gray-700",children:i.customers?.name||"N/A"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(gi,{className:"h-3 w-3 text-gray-500"}),c.jsxs("span",{className:"text-sm text-gray-700",children:[i.origin," → ",i.destination]})]})]}),i.description&&c.jsx("div",{className:"p-2 bg-gray-50 rounded text-xs text-gray-600",children:i.description}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 pt-2 border-t",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"flex items-center justify-center gap-1",children:c.jsx(Ko,{className:"h-3 w-3 text-purple-500"})}),c.jsx("div",{className:"text-xs font-medium",children:i.weight?`${i.weight} kg`:"N/A"}),c.jsx("div",{className:"text-xs text-gray-500",children:"Peso"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"flex items-center justify-center gap-1",children:c.jsx(Rn,{className:"h-3 w-3 text-orange-500"})}),c.jsx("div",{className:"text-xs font-medium",children:a(i.freight)}),c.jsx("div",{className:"text-xs text-gray-500",children:"Flete"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"flex items-center justify-center gap-1",children:c.jsx(_a,{className:"h-3 w-3 text-green-500"})}),c.jsx("div",{className:"text-xs font-medium text-green-700",children:a(i.amount_to_collect)}),c.jsx("div",{className:"text-xs text-gray-500",children:"A Cobrar"})]})]}),i.status!=="delivered"&&c.jsxs(Ne,{size:"sm",variant:"outline",onClick:()=>e(i),className:"w-full flex items-center gap-2 mt-3",children:[c.jsx(Rn,{className:"h-3 w-3"}),"Entregar"]})]})]},i.id))})}function Y9({packages:r}){const[e,t]=w.useState(null),[n,a]=w.useState(!1),i=yn(),o=d=>{switch(d){case"delivered":return"bg-green-100 text-green-800";case"en_destino":return"bg-blue-100 text-blue-800";case"procesado":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},s=d=>{switch(d){case"delivered":return"Entregado";case"en_destino":return"En Destino";case"procesado":return"Procesado";default:return d.charAt(0).toUpperCase()+d.slice(1)}},l=d=>d?`$${d.toLocaleString("es-CO")}`:"$0",u=d=>{t(d),a(!0)};return r.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Dr,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No hay paquetes en este despacho"}),c.jsx("p",{className:"text-gray-500",children:"Este despacho no contiene paquetes"})]}):i?c.jsxs(c.Fragment,{children:[c.jsx(G9,{packages:r,onDeliverPackage:u}),c.jsx(ax,{open:n,onOpenChange:a,package:e})]}):c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"rounded-lg border",children:c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"Número de Seguimiento"}),c.jsx(Me,{children:"Cliente"}),c.jsx(Me,{children:"Ruta"}),c.jsx(Me,{children:"Estado"}),c.jsx(Me,{children:"Descripción"}),c.jsx(Me,{children:"Peso"}),c.jsx(Me,{children:"Flete"}),c.jsx(Me,{children:"A Cobrar"}),c.jsx(Me,{children:"Acciones"})]})}),c.jsx(Wa,{children:r.map(d=>c.jsxs(Sr,{children:[c.jsx(Re,{className:"font-medium",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Dr,{className:"h-4 w-4 text-blue-500"}),d.tracking_number]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ts,{className:"h-4 w-4 text-gray-500"}),d.customers?.name||"N/A"]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(gi,{className:"h-4 w-4 text-gray-500"}),c.jsxs("span",{className:"text-sm",children:[d.origin," → ",d.destination]})]})}),c.jsx(Re,{children:c.jsx(Ot,{className:o(d.status),children:s(d.status)})}),c.jsx(Re,{className:"max-w-xs truncate",children:d.description}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Ko,{className:"h-4 w-4 text-purple-500"}),d.weight?`${d.weight} kg`:"N/A"]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Rn,{className:"h-4 w-4 text-orange-500"}),l(d.freight)]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(_a,{className:"h-4 w-4 text-green-500"}),c.jsx("span",{className:"font-medium text-green-700",children:l(d.amount_to_collect)})]})}),c.jsx(Re,{children:d.status!=="delivered"&&c.jsxs(Ne,{size:"sm",variant:"outline",onClick:()=>u(d),className:"flex items-center gap-1",children:[c.jsx(Rn,{className:"h-3 w-3"}),"Entregar"]})})]},d.id))})]})}),c.jsx(ax,{open:n,onOpenChange:a,package:e})]})}function K9({dispatchId:r}){const{data:e=[],isLoading:t}=WL(r||""),{data:n=[]}=Tg(),a=yn(),{markTripAsInTransit:i,isMarkingAsInTransit:o,markTripAsArrived:s,isMarkingAsArrived:l}=f4();if(!r)return c.jsx("div",{className:"text-center py-12",children:c.jsx("p",{className:"text-gray-500",children:"Selecciona un despacho para ver los detalles"})});const u=e.reduce((b,y)=>({weight:b.weight+(y.weight||0),freight:b.freight+(y.freight||0),amount_to_collect:b.amount_to_collect+(y.amount_to_collect||0)}),{weight:0,freight:0,amount_to_collect:0}),d=n.find(b=>b.id===r),f=e[0],h=f&&e.some(b=>b.status==="procesado"),p=d?.status==="en_transito",g=()=>{f&&f.trip_id?(console.log("🚀 Marcando viaje como en tránsito:",f.trip_id),i(f.trip_id)):console.error("❌ No se puede marcar como en tránsito: no hay trip_id")},v=()=>{f&&f.trip_id?(console.log("🏁 Marcando viaje como llegado:",f.trip_id),s(f.trip_id)):console.error("❌ No se puede marcar como llegado: no hay trip_id")};return t?c.jsx("div",{className:"py-8 text-center text-gray-500",children:"Cargando detalles del despacho..."}):c.jsxs("div",{className:`space-y-4 ${a?"px-2":"space-y-6"}`,children:[c.jsx(M9,{canMarkAsInTransit:h,canMarkAsArrived:p,onMarkAsInTransit:g,onMarkAsArrived:v,isMarkingAsInTransit:o,isMarkingAsArrived:l,hasPackages:e.length>0}),c.jsx(R9,{packageCount:e.length,totalWeight:u.weight,totalFreight:u.freight,totalAmountToCollect:u.amount_to_collect}),c.jsx(Y9,{packages:e})]})}function g4(){return Rt({queryKey:["packages"],queryFn:async()=>{const{data:r,error:e}=await xe.from("packages").select(`
          *,
          customers (
            name,
            email
          )
        `).order("created_at",{ascending:!1}).limit(10);if(e)throw e;return r}})}function X9(){const r=yn(),{data:e=[],isLoading:t}=g4(),n=o=>{switch(o){case"delivered":return"bg-green-100 text-green-800";case"en_destino":case"arrived":return"bg-blue-100 text-blue-800";case"transito":case"in_transit":return"bg-yellow-100 text-yellow-800";case"procesado":return"bg-purple-100 text-purple-800";case"bodega":return"bg-gray-100 text-gray-800";case"recibido":return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},a=o=>{switch(o){case"delivered":return"Entregado";case"en_destino":case"arrived":return"En Destino";case"transito":case"in_transit":return"En Tránsito";case"procesado":return"Procesado";case"bodega":return"En Bodega";case"recibido":return"Recibido";default:return o}},i=(o,s="COP")=>o?new Intl.NumberFormat("es-CO",{style:"currency",currency:s,minimumFractionDigits:0}).format(o):"-";return t?c.jsxs(He,{children:[c.jsxs(yt,{className:"px-3 sm:px-6",children:[c.jsx(Nt,{className:"text-lg sm:text-xl",children:"Todas las Encomiendas"}),c.jsx(Hr,{className:"text-sm",children:"Lista completa de todas las encomiendas registradas"})]}),c.jsx(We,{className:"px-3 sm:px-6",children:c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500 text-sm",children:"Cargando encomiendas..."})})})]}):r?c.jsxs(He,{children:[c.jsxs(yt,{className:"px-3 pb-3",children:[c.jsxs(Nt,{className:"text-lg flex items-center gap-2",children:[c.jsx(Dr,{className:"h-5 w-5"}),"Todas las Encomiendas"]}),c.jsxs(Hr,{className:"text-sm",children:["Total: ",e.length," encomiendas"]})]}),c.jsx(We,{className:"px-3 pb-3",children:c.jsx("div",{className:"space-y-3",children:e.map(o=>c.jsx(He,{className:"border border-gray-200",children:c.jsx(We,{className:"p-4",children:c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("div",{className:"font-medium text-sm mb-1",children:o.tracking_number}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(ts,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-sm",children:o.customers?.name||"N/A"})]}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(gi,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-sm",children:o.origin}),c.jsx("span",{className:"text-xs text-gray-400",children:"→"}),c.jsx("span",{className:"text-sm",children:o.destination})]}),c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(Li,{className:"h-4 w-4 text-gray-500"}),c.jsx("span",{className:"text-sm",children:pt(new Date(o.created_at),"dd/MM/yyyy")})]}),c.jsxs("div",{className:"text-sm text-gray-600",children:["Peso: ",o.weight||0," kg | Flete: ",i(o.freight)]}),o.amount_to_collect&&c.jsxs("div",{className:"text-sm text-orange-600",children:["A cobrar: ",i(o.amount_to_collect,o.currency)]})]}),c.jsx(Ot,{className:`${n(o.status)} text-xs`,children:a(o.status)})]})})})},o.id))})})]}):c.jsxs(He,{children:[c.jsxs(yt,{className:"px-6",children:[c.jsxs(Nt,{className:"text-xl flex items-center gap-2",children:[c.jsx(Dr,{className:"h-5 w-5"}),"Todas las Encomiendas"]}),c.jsxs(Hr,{children:["Lista completa de todas las encomiendas registradas - Total: ",e.length]})]}),c.jsx(We,{className:"px-6",children:c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"N° Seguimiento"}),c.jsx(Me,{children:"Cliente"}),c.jsx(Me,{children:"Ruta"}),c.jsx(Me,{children:"Estado"}),c.jsx(Me,{children:"Peso"}),c.jsx(Me,{children:"Flete"}),c.jsx(Me,{children:"A Cobrar"}),c.jsx(Me,{children:"Fecha"})]})}),c.jsx(Wa,{children:e.map(o=>c.jsxs(Sr,{className:"hover:bg-gray-50",children:[c.jsx(Re,{className:"font-medium",children:o.tracking_number}),c.jsx(Re,{children:o.customers?.name||"N/A"}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"text-sm",children:o.origin}),c.jsx("span",{className:"mx-2",children:"→"}),c.jsx("span",{className:"text-sm",children:o.destination})]})}),c.jsx(Re,{children:c.jsx(Ot,{className:n(o.status),children:a(o.status)})}),c.jsxs(Re,{children:[o.weight||0," kg"]}),c.jsx(Re,{children:i(o.freight)}),c.jsx(Re,{children:o.amount_to_collect?i(o.amount_to_collect,o.currency):"-"}),c.jsx(Re,{children:pt(new Date(o.created_at),"dd/MM/yyyy")})]},o.id))})]})})]})}function Fg(){const[r,e]=w.useState(null),[t,n]=w.useState("list"),[a,i]=w.useState("dispatches"),o=yn(),s=u=>{e(u),n("details")},l=()=>{e(null),n("list")};return c.jsx(xn,{value:"dispatches",className:`space-y-4 ${o?"px-2":"sm:space-y-8 px-2 sm:px-0"}`,children:t==="list"?c.jsxs(Us,{value:a,onValueChange:i,className:"w-full",children:[c.jsxs(Mu,{className:"grid w-full grid-cols-2",children:[c.jsx(kn,{value:"dispatches",children:"Despachos"}),c.jsx(kn,{value:"packages",children:"Encomiendas"})]}),c.jsx(xn,{value:"dispatches",className:"mt-4",children:c.jsx(k9,{onViewDispatch:s})}),c.jsx(xn,{value:"packages",className:"mt-4",children:c.jsx(X9,{})})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex items-center gap-4",children:c.jsxs(Ne,{variant:"outline",size:"sm",onClick:l,className:"flex items-center gap-2",children:[c.jsx(Jo,{className:"h-4 w-4"}),c.jsx("span",{className:o?"text-xs":"",children:"Volver a Despachos"})]})}),c.jsx(K9,{dispatchId:r})]})})}function ix({chats:r,selectedPhone:e,onChatSelect:t}){const n=yn(),a=i=>i.startsWith("57")?`+${i.slice(0,2)} ${i.slice(2,5)} ${i.slice(5,8)} ${i.slice(8)}`:`+${i}`;return c.jsxs("div",{className:"h-full flex flex-col border-r border-gray-200 bg-white",children:[c.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-200",children:[c.jsx("h2",{className:"text-lg font-semibold",children:"Chats"}),c.jsxs("p",{className:"text-sm text-gray-500",children:[r.length," conversaciones"]})]}),c.jsx(Pg,{className:"flex-1",children:c.jsx("div",{className:"divide-y divide-gray-100",children:r.map(i=>c.jsx("div",{onClick:()=>t(i.phone),className:`p-3 sm:p-4 cursor-pointer hover:bg-gray-50 transition-colors active:bg-gray-100 ${e===i.phone&&!n?"bg-blue-50 border-r-2 border-blue-500":""}`,children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx(i4,{customerName:i.customerName,profileImageUrl:i.profileImageUrl,size:n?"sm":"md"}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsx("h3",{className:"font-medium truncate text-sm sm:text-base",children:i.customerName||"Cliente Anónimo"}),c.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0",children:pt(new Date(i.lastMessageTime),"HH:mm",{locale:Bn})})]}),!n&&c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(uh,{className:"h-3 w-3 text-gray-400"}),c.jsx("span",{className:"text-xs text-gray-500 truncate",children:a(i.phone)}),c.jsx(Ot,{variant:i.isRegistered?"default":"secondary",className:"text-xs",children:i.isRegistered?"Registrado":"No registrado"})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("p",{className:"text-xs sm:text-sm text-gray-600 truncate flex-1",children:i.lastMessage}),c.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[n&&c.jsx(Ot,{variant:i.isRegistered?"default":"secondary",className:"text-xs",children:i.isRegistered?"R":"NR"}),i.unreadCount&&i.unreadCount>0&&c.jsx(Ot,{className:"bg-green-500 text-white text-xs min-w-[20px] h-5 rounded-full flex items-center justify-center",children:i.unreadCount})]})]})]})]})},i.phone))})})]})}function Q9(){const[r,e]=w.useState(null),{chatList:t,conversationsByPhone:n,isLoading:a}=c4(),{handleSendMessage:i,isManualSending:o}=l4(),s=yn();w.useEffect(()=>{const d=new Date().toISOString();localStorage.setItem("chat-last-visited",d),console.log("Chat visited at:",d)},[]);const l=async(d,f)=>{if(!r)return;const h=n[r];h&&await i(r,h.customerId,d,f)},u=()=>{e(null)};return a?c.jsx("div",{className:"flex justify-center items-center py-12",children:c.jsx("div",{className:"text-gray-500",children:"Cargando mensajes del chat..."})}):s?r&&n[r]?c.jsx("div",{className:"h-[calc(100vh-12rem)]",children:c.jsxs("div",{className:"h-full flex flex-col",children:[c.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-gray-200 bg-white",children:[c.jsx(Ne,{variant:"ghost",size:"sm",onClick:u,className:"p-2",children:c.jsx(Jo,{className:"h-4 w-4"})}),c.jsx("h2",{className:"text-lg font-semibold",children:n[r].customerName||"Cliente"})]}),c.jsx("div",{className:"flex-1",children:c.jsx(Ep,{phone:r,customerName:n[r].customerName,customerId:n[r].customerId,messages:n[r].messages,isRegistered:!!n[r].customerId,onSendMessage:l,isLoading:o,profileImageUrl:n[r].profileImageUrl})})]})}):c.jsx("div",{className:"h-[calc(100vh-12rem)]",children:t.length===0?c.jsx(He,{className:"h-full",children:c.jsxs(We,{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[c.jsx(Mi,{className:"h-16 w-16 mx-auto mb-4 text-gray-400"}),c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No hay mensajes"}),c.jsx("p",{className:"text-gray-500",children:"Los mensajes de WhatsApp aparecerán aquí cuando los clientes escriban"})]})}):c.jsx(ix,{chats:t,selectedPhone:r,onChatSelect:e})}):c.jsx("div",{className:"h-[calc(100vh-12rem)]",children:c.jsxs("div",{className:"h-full flex",children:[c.jsx("div",{className:"w-1/3 min-w-[300px] max-w-[400px]",children:t.length===0?c.jsx(He,{className:"h-full",children:c.jsxs(We,{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[c.jsx(Mi,{className:"h-16 w-16 mx-auto mb-4 text-gray-400"}),c.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No hay mensajes"}),c.jsx("p",{className:"text-gray-500",children:"Los mensajes de WhatsApp aparecerán aquí cuando los clientes escriban"})]})}):c.jsx(ix,{chats:t,selectedPhone:r,onChatSelect:e})}),c.jsx("div",{className:"flex-1",children:r&&n[r]?c.jsx(Ep,{phone:r,customerName:n[r].customerName,customerId:n[r].customerId,messages:n[r].messages,isRegistered:!!n[r].customerId,onSendMessage:l,isLoading:o,profileImageUrl:n[r].profileImageUrl}):c.jsx(He,{className:"h-full",children:c.jsxs(We,{className:"flex flex-col items-center justify-center h-full text-center p-6",children:[c.jsx(Mi,{className:"h-16 w-16 mx-auto mb-4 text-gray-400"}),c.jsx("h3",{className:"text-lg font-semibold mb-2",children:t.length>0?"Selecciona un chat":"No hay conversaciones"}),c.jsx("p",{className:"text-gray-500",children:t.length>0?"Haz clic en una conversación de la izquierda para ver los mensajes":"Las conversaciones aparecerán cuando los clientes escriban"})]})})})]})})}function v4(){return c.jsx(xn,{value:"chat",className:"space-y-4 sm:space-y-8 px-2 sm:px-0",children:c.jsx(Q9,{})})}function Z9(){const r=Gr(),{toast:e}=Lt(),t=ln({mutationFn:async()=>{console.log("=== INICIANDO MONITOREO MANUAL ===");const n=await xe.functions.invoke("flight-monitor");if(console.log("Respuesta del edge function:",n),n.error)throw console.error("Error en edge function:",n.error),n.error;return n.data},onSuccess:n=>{console.log("Monitoreo completado exitosamente:",n),r.invalidateQueries({queryKey:["pending-flight-notifications"]}),r.invalidateQueries({queryKey:["packages"]});const a=n.totalFlightsInDb===0?"No hay vuelos en la base de datos para monitorear. Crea un viaje con número de vuelo primero.":`Se monitorearon ${n.monitored} vuelos. ${n.updated} vuelos actualizados. Total en DB: ${n.totalFlightsInDb}`;e({title:"Monitoreo completado",description:a,variant:n.totalFlightsInDb===0?"destructive":"default"})},onError:n=>{console.error("Error en monitoreo:",n),e({title:"Error en monitoreo",description:`No se pudo completar el monitoreo: ${n.message||"Error desconocido"}`,variant:"destructive"})}});return{startMonitoring:t.mutate,isMonitoring:t.isPending}}function J9(){const{startMonitoring:r,isMonitoring:e}=Z9();return c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(dh,{className:"h-5 w-5"}),"Monitoreo Automático de Vuelos"]}),c.jsx(Hr,{children:"Sistema automático de seguimiento del estado de vuelos en tiempo real"})]}),c.jsxs(Ne,{onClick:()=>r(),disabled:e,className:"flex items-center gap-2",variant:"outline",children:[c.jsx(WN,{className:"h-4 w-4"}),e?"Monitoreando...":"Monitoreo Manual"]})]})}),c.jsx(We,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[c.jsx(Fn,{className:"h-5 w-5 text-green-600"}),c.jsx("h4",{className:"font-medium text-green-900",children:"Monitoreo Automático Activo"})]}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-800",children:[c.jsx(q1,{className:"h-4 w-4"}),c.jsx("span",{children:"Se ejecuta automáticamente cada 15 minutos"})]}),c.jsx("p",{className:"text-sm text-green-700 mt-2",children:"El sistema verifica el estado de todos los vuelos automáticamente y envía notificaciones cuando los vuelos aterrizan."})]}),c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[c.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"¿Cómo funciona el monitoreo automático?"}),c.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[c.jsx("li",{children:"• El sistema verifica automáticamente cada 15 minutos el estado de todos los vuelos activos"}),c.jsx("li",{children:"• Cuando un vuelo aterriza, se actualiza el estado automáticamente"}),c.jsx("li",{children:"• Se crean notificaciones pendientes para los clientes"}),c.jsx("li",{children:"• Las notificaciones se envían automáticamente por WhatsApp"}),c.jsx("li",{children:"• También puedes ejecutar un monitoreo manual usando el botón de arriba"})]})]})]})})]})}function eF({onSendTestNotification:r,isSendingTest:e}){const[t,n]=w.useState(""),[a,i]=w.useState("Hola! Esta es una notificación de prueba del sistema de Envíos Ojitos."),o=()=>{t.trim()&&r({phone:t,message:a})};return c.jsxs(He,{children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(dl,{className:"h-5 w-5"}),"Prueba de Notificación WhatsApp"]}),c.jsx(Hr,{children:"Envía una notificación de prueba para verificar la configuración"})]}),c.jsxs(We,{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Número de teléfono (incluye código de país)"}),c.jsx(It,{placeholder:"+57 300 123 4567",value:t,onChange:s=>n(s.target.value)})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Mensaje de prueba"}),c.jsx(It,{value:a,onChange:s=>i(s.target.value)})]})]}),c.jsx(Ne,{onClick:o,disabled:e||!t.trim(),className:"w-full md:w-auto",children:e?"Enviando...":"Enviar Notificación de Prueba"})]})]})}function tF({pendingFlights:r,isLoading:e,isProcessing:t,onProcessNotifications:n,onUpdateFlightStatus:a}){return c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(Wy,{className:"h-5 w-5"}),"Información Detallada de Vuelos"]}),c.jsx(Hr,{children:"Estado completo de vuelos monitoreados y notificaciones WhatsApp"})]}),c.jsxs(Ne,{onClick:n,disabled:t||r.length===0,className:"flex items-center gap-2",children:[c.jsx(dl,{className:"h-4 w-4"}),t?"Procesando...":"Procesar Notificaciones"]})]})}),c.jsx(We,{children:e?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500",children:"Cargando información de vuelos..."})}):r.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx(Ts,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No hay vuelos pendientes de notificación"}),c.jsx("p",{className:"text-sm mt-2",children:"Los vuelos aparecerán aquí cuando se detecten aterrizajes"})]}):c.jsx("div",{className:"space-y-6",children:r.map(i=>c.jsx(Og,{flight:i,onUpdateFlightStatus:a},i.id))})})]})}function rF(){return Rt({queryKey:["upcoming-flights"],queryFn:async()=>{const r=new Date().toISOString().split("T")[0],{data:e,error:t}=await xe.from("flight_data").select("*").gte("scheduled_departure",r).order("scheduled_departure",{ascending:!0}).limit(2);if(t)throw t;return e},refetchInterval:5*60*1e3,staleTime:3*60*1e3})}function nF(){const{data:r=[],isLoading:e}=rF();return c.jsxs(He,{children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(Li,{className:"h-5 w-5"}),"Próximos Vuelos"]}),c.jsx(Hr,{children:"Los próximos 2 vuelos programados desde hoy"})]}),c.jsx(We,{children:e?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500",children:"Cargando vuelos próximos..."})}):r.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx(Ts,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No hay vuelos programados próximamente"})]}):c.jsx("div",{className:"space-y-6",children:r.map(t=>c.jsx(Og,{flight:t,onUpdateFlightStatus:()=>{}},t.id))})})]})}function aF(){const[r,e]=w.useState(!1),{toast:t}=Lt(),n=async()=>{e(!0);try{console.log("Enviando mensaje directo de WhatsApp...");const{data:a,error:i}=await xe.from("notification_log").insert({notification_type:"test",message:"hola didi",status:"pending"}).select().single();if(i)throw console.error("Error creating notification log:",i),i;console.log("Notification log created:",a);const o=await xe.functions.invoke("send-whatsapp-notification",{body:{notificationId:a.id,phone:"+573014940399",message:"hola didi"}});if(console.log("Edge function response:",o),o.error)throw console.error("Edge function error:",o.error),o.error;o.data?.success?(t({title:"✅ Mensaje enviado exitosamente",description:'Mensaje "hola didi" enviado a +573014940399'}),console.log("Mensaje enviado exitosamente:",o.data)):(console.error("Error en la respuesta:",o.data),t({title:"❌ Error al enviar mensaje",description:o.data?.error||"Error desconocido",variant:"destructive"}))}catch(a){console.error("Error en la prueba:",a),t({title:"❌ Error en la prueba",description:a.message||"Error desconocido",variant:"destructive"})}finally{e(!1)}};return c.jsxs(He,{className:"bg-blue-50 border-blue-200",children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2 text-blue-800",children:[c.jsx(_u,{className:"h-5 w-5"}),"Enviar Mensaje a Didi"]}),c.jsx(Hr,{className:"text-blue-600",children:'Enviar "hola didi" a +573014940399'})]}),c.jsx(We,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"p-3 bg-white rounded border border-blue-200",children:c.jsxs("p",{className:"text-sm text-gray-700",children:[c.jsx("strong",{children:"Número:"})," +573014940399",c.jsx("br",{}),c.jsx("strong",{children:"Mensaje:"}),' "hola didi"']})}),c.jsx(Ne,{onClick:n,disabled:r,className:"w-full bg-blue-600 hover:bg-blue-700",children:r?"Enviando mensaje...":'Enviar "hola didi" por WhatsApp'})]})})]})}function iF(){const[r,e]=w.useState(!1),[t,n]=w.useState([]),{toast:a}=Lt(),i=async()=>{e(!0),n([]);const s=[];try{console.log("Iniciando pruebas de conexión con Meta..."),s.push({test:"Verificación de Credenciales",status:"success",message:"Iniciando verificación de credenciales en Supabase..."}),console.log("Llamando edge function para validar token...");const l=await xe.functions.invoke("validate-meta-connection",{body:{testType:"token_validation"}});l.error?s.push({test:"Validación de Token",status:"error",message:"Error al validar token de Meta",details:l.error}):l.data?.success?s.push({test:"Validación de Token",status:"success",message:"Token de Meta válido",details:l.data}):s.push({test:"Validación de Token",status:"error",message:"Token de Meta inválido o problema de configuración",details:l.data}),console.log("Verificando Phone Number ID...");const u=await xe.functions.invoke("validate-meta-connection",{body:{testType:"phone_number_validation"}});u.error?s.push({test:"Validación de Phone Number ID",status:"error",message:"Error al validar Phone Number ID",details:u.error}):u.data?.success?s.push({test:"Validación de Phone Number ID",status:"success",message:"Phone Number ID configurado correctamente",details:u.data}):s.push({test:"Validación de Phone Number ID",status:"error",message:"Phone Number ID inválido o no configurado",details:u.data}),console.log("Probando conectividad con Meta API...");const d=await xe.functions.invoke("validate-meta-connection",{body:{testType:"connectivity_test"}});d.error?s.push({test:"Conectividad con Meta API",status:"error",message:"No se puede conectar con Meta API",details:d.error}):d.data?.success?s.push({test:"Conectividad con Meta API",status:"success",message:"Conexión exitosa con Meta API",details:d.data}):s.push({test:"Conectividad con Meta API",status:"warning",message:"Conexión con Meta API con problemas",details:d.data}),n(s);const f=s.filter(p=>p.status==="error").length,h=s.filter(p=>p.status==="success").length;a(f===0?{title:"✅ Todas las pruebas pasaron",description:`${h} pruebas exitosas. La conexión con Meta está funcionando.`}:{title:"⚠️ Problemas detectados",description:`${f} errores encontrados. Revisa los detalles de las pruebas.`,variant:"destructive"})}catch(l){console.error("Error en las pruebas de conexión:",l),s.push({test:"Pruebas Generales",status:"error",message:"Error general en las pruebas",details:l}),n(s),a({title:"❌ Error en las pruebas",description:l.message||"Error desconocido en las pruebas",variant:"destructive"})}finally{e(!1)}},o=s=>{switch(s){case"success":return c.jsx(Fn,{className:"h-5 w-5 text-green-500"});case"error":return c.jsx(LN,{className:"h-5 w-5 text-red-500"});case"warning":return c.jsx(mi,{className:"h-5 w-5 text-yellow-500"});default:return c.jsx(mi,{className:"h-5 w-5 text-gray-500"})}};return c.jsxs(He,{className:"bg-orange-50 border-orange-200",children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2 text-orange-800",children:[c.jsx(tm,{className:"h-5 w-5"}),"Diagnóstico de Conexión Meta"]}),c.jsx(Hr,{className:"text-orange-600",children:"Verificar configuración y conectividad con Meta WhatsApp Business API"})]}),c.jsx(We,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx(Ne,{onClick:i,disabled:r,className:"w-full bg-orange-600 hover:bg-orange-700",children:r?"Ejecutando pruebas...":"Ejecutar Diagnóstico de Conexión"}),t.length>0&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"font-semibold text-gray-800",children:"Resultados de las Pruebas:"}),t.map((s,l)=>c.jsx("div",{className:`p-3 rounded border ${s.status==="success"?"bg-green-50 border-green-200":s.status==="error"?"bg-red-50 border-red-200":"bg-yellow-50 border-yellow-200"}`,children:c.jsxs("div",{className:"flex items-start gap-2",children:[o(s.status),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-medium text-sm",children:s.test}),c.jsx("div",{className:"text-sm text-gray-600 mt-1",children:s.message}),s.details&&c.jsxs("details",{className:"mt-2",children:[c.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer",children:"Ver detalles"}),c.jsx("pre",{className:"text-xs bg-gray-100 p-2 mt-1 rounded overflow-auto",children:JSON.stringify(s.details,null,2)})]})]})]})},l))]})]})})]})}function oF(){const[r,e]=w.useState(!1),[t,n]=w.useState("+573014940399"),[a,i]=w.useState("hello_world"),[o,s]=w.useState("en_US"),{toast:l}=Lt(),u=async()=>{e(!0);try{console.log("Enviando plantilla de WhatsApp:",{templateName:a,templateLanguage:o,testPhone:t});const{data:d,error:f}=await xe.from("notification_log").insert({notification_type:"template_test",message:`Plantilla: ${a} (${o})`,status:"pending"}).select().single();if(f)throw console.error("Error creating notification log:",f),f;console.log("Notification log created:",d);const h=await xe.functions.invoke("send-whatsapp-notification",{body:{notificationId:d.id,phone:t,message:`Plantilla: ${a}`,useTemplate:!0,templateName:a,templateLanguage:o}});if(console.log("Edge function response:",h),h.error)throw console.error("Edge function error:",h.error),h.error;h.data?.success?(l({title:"✅ Plantilla enviada exitosamente",description:`Plantilla "${a}" enviada a ${t}`}),console.log("Plantilla enviada exitosamente:",h.data)):(console.error("Error en la respuesta:",h.data),l({title:"❌ Error al enviar plantilla",description:h.data?.error||"Error desconocido",variant:"destructive"}))}catch(d){console.error("Error en la prueba:",d),l({title:"❌ Error en la prueba",description:d.message||"Error desconocido",variant:"destructive"})}finally{e(!1)}};return c.jsxs(He,{className:"bg-green-50 border-green-200",children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2 text-green-800",children:[c.jsx(Mi,{className:"h-5 w-5"}),"Prueba de Plantillas WhatsApp"]}),c.jsx(Hr,{className:"text-green-600",children:"Enviar mensajes usando plantillas aprobadas de WhatsApp Business"})]}),c.jsx(We,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Número de teléfono"}),c.jsx(It,{value:t,onChange:d=>n(d.target.value),placeholder:"+57 300 123 4567"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Nombre de la plantilla"}),c.jsx(It,{value:a,onChange:d=>i(d.target.value),placeholder:"hello_world"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Idioma de la plantilla"}),c.jsxs(Ca,{value:o,onValueChange:s,children:[c.jsx(ia,{children:c.jsx(Na,{})}),c.jsxs(oa,{children:[c.jsx(pr,{value:"en_US",children:"Inglés (en_US)"}),c.jsx(pr,{value:"es",children:"Español (es)"}),c.jsx(pr,{value:"es_ES",children:"Español España (es_ES)"}),c.jsx(pr,{value:"es_MX",children:"Español México (es_MX)"})]})]})]}),c.jsx("div",{className:"p-3 bg-white rounded border border-green-200",children:c.jsxs("p",{className:"text-sm text-gray-700",children:[c.jsx("strong",{children:"Plantilla seleccionada:"})," ",a,c.jsx("br",{}),c.jsx("strong",{children:"Idioma:"})," ",o,c.jsx("br",{}),c.jsx("strong",{children:"Número destino:"})," ",t]})}),c.jsxs(Ne,{onClick:u,disabled:r||!a.trim()||!t.trim(),className:"w-full bg-green-600 hover:bg-green-700",children:[c.jsx(dl,{className:"h-4 w-4 mr-2"}),r?"Enviando plantilla...":"Enviar Plantilla de WhatsApp"]}),c.jsxs("div",{className:"text-xs text-gray-500",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Nota:"})," Las plantillas deben estar aprobadas por Meta antes de poder usarse."]}),c.jsx("p",{children:'La plantilla "hello_world" viene preaprobada para pruebas.'})]})]})})]})}function sF(){const{toast:r}=Lt(),[e,t]=w.useState(!1),n="https://bnuahsuehizwwcejqilm.supabase.co/functions/v1/whatsapp-webhook",a=i=>{navigator.clipboard.writeText(i),t(!0),r({title:"Copiado",description:"URL copiada al portapapeles"}),setTimeout(()=>t(!1),2e3)};return c.jsxs(He,{className:"bg-purple-50 border-purple-200",children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2 text-purple-800",children:[c.jsx(QN,{className:"h-5 w-5"}),"Configuración de Webhooks WhatsApp"]}),c.jsx(Hr,{className:"text-purple-600",children:"Configura webhooks para recibir actualizaciones de estado y respuestas"})]}),c.jsxs(We,{className:"space-y-6",children:[c.jsxs(Fi,{children:[c.jsx(mi,{className:"h-4 w-4"}),c.jsx(Bi,{children:"Los webhooks te permiten recibir notificaciones en tiempo real sobre el estado de los mensajes enviados (entregado, leído) y respuestas de clientes."})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium mb-2",children:"1. URL del Webhook"}),c.jsxs("div",{className:"flex items-center gap-2 p-3 bg-white rounded border",children:[c.jsx("code",{className:"flex-1 text-sm text-gray-700 break-all",children:n}),c.jsxs(Ne,{size:"sm",variant:"outline",onClick:()=>a(n),className:"shrink-0",children:[c.jsx(em,{className:"h-4 w-4"}),e?"Copiado":"Copiar"]})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium mb-2",children:"2. Configurar en Meta Developer Console"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"p-3 bg-white rounded border",children:[c.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[c.jsx("strong",{children:"Callback URL:"})," Usa la URL de arriba"]}),c.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[c.jsx("strong",{children:"Verify Token:"})," ",c.jsx(Ot,{variant:"secondary",children:"ojitos_webhook_verify"})]}),c.jsxs("p",{className:"text-sm text-gray-700",children:[c.jsx("strong",{children:"Webhook Fields:"}),' Selecciona "messages"']})]}),c.jsxs(Ne,{variant:"outline",className:"w-full",onClick:()=>window.open("https://developers.facebook.com/apps/","_blank"),children:[c.jsx(Xy,{className:"h-4 w-4 mr-2"}),"Abrir Meta Developer Console"]})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium mb-2",children:"3. Eventos que recibirás"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[c.jsxs("div",{className:"p-3 bg-white rounded border",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx(Fn,{className:"h-4 w-4 text-green-600"}),c.jsx("span",{className:"font-medium text-sm",children:"Estados de Mensaje"})]}),c.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[c.jsx("li",{children:"• Enviado"}),c.jsx("li",{children:"• Entregado"}),c.jsx("li",{children:"• Leído"}),c.jsx("li",{children:"• Falló"})]})]}),c.jsxs("div",{className:"p-3 bg-white rounded border",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx(Fn,{className:"h-4 w-4 text-blue-600"}),c.jsx("span",{className:"font-medium text-sm",children:"Mensajes Entrantes"})]}),c.jsxs("ul",{className:"text-xs text-gray-600 space-y-1",children:[c.jsx("li",{children:"• Respuestas de clientes"}),c.jsx("li",{children:"• Mensajes de texto"}),c.jsx("li",{children:"• Medios (futuro)"})]})]})]})]}),c.jsxs(Fi,{children:[c.jsx(Fn,{className:"h-4 w-4"}),c.jsx(Bi,{children:"Una vez configurado, podrás ver los estados de entrega en tiempo real y gestionar las respuestas de clientes automáticamente."})]})]})]})]})}function cF(){const[r,e]=w.useState("verification"),[t,n]=w.useState(!1),[a,i]=w.useState([]),{toast:o}=Lt(),s="https://bnuahsuehizwwcejqilm.supabase.co/functions/v1/whatsapp-webhook",l=async()=>{n(!0);try{const g=`${s}?hub.mode=subscribe&hub.verify_token=1371636570719904&hub.challenge=1234567890`,v=await fetch(g,{method:"GET"}),b=await v.text();if(v.ok&&b==="1234567890")i(y=>[...y,{type:"verification",status:"success",message:"Verificación exitosa con token de Meta",details:{challenge:b,status:v.status}}]),o({title:"✅ Verificación exitosa",description:"El webhook responde correctamente a la verificación de Meta"});else throw new Error(`Verificación falló: ${v.status} - ${b}`)}catch(g){i(v=>[...v,{type:"verification",status:"error",message:`Error en verificación: ${g.message}`,details:g}]),o({title:"❌ Error en verificación",description:g.message,variant:"destructive"})}finally{n(!1)}},u=async()=>{n(!0);try{const g={entry:[{id:"test-entry-id",changes:[{value:{messaging_product:"whatsapp",metadata:{display_phone_number:"573001234567",phone_number_id:"test-phone-id"},statuses:[{id:"test-message-id-123",status:"delivered",timestamp:Math.floor(Date.now()/1e3).toString(),recipient_id:"573014940399"}]},field:"messages"}]}]},v=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}),b=await v.text();if(v.ok)i(y=>[...y,{type:"message_status",status:"success",message:"Estado de mensaje procesado correctamente",details:{response:b,payload:g}}]),o({title:"✅ Test de estado exitoso",description:"El webhook procesó el estado del mensaje correctamente"});else throw new Error(`Test falló: ${v.status} - ${b}`)}catch(g){i(v=>[...v,{type:"message_status",status:"error",message:`Error en test de estado: ${g.message}`,details:g}]),o({title:"❌ Error en test de estado",description:g.message,variant:"destructive"})}finally{n(!1)}},d=async()=>{n(!0);try{const g={entry:[{id:"test-entry-id",changes:[{value:{messaging_product:"whatsapp",metadata:{display_phone_number:"573001234567",phone_number_id:"test-phone-id"},contacts:[{profile:{name:"Usuario de Prueba"},wa_id:"573014940399"}],messages:[{from:"573014940399",id:"test-incoming-msg-123",timestamp:Math.floor(Date.now()/1e3).toString(),text:{body:"Hola, este es un mensaje de prueba"},type:"text"}]},field:"messages"}]}]},v=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)}),b=await v.text();if(v.ok)i(y=>[...y,{type:"incoming_message",status:"success",message:"Mensaje entrante procesado correctamente",details:{response:b,payload:g}}]),o({title:"✅ Test de mensaje entrante exitoso",description:"El webhook procesó el mensaje entrante correctamente"});else throw new Error(`Test falló: ${v.status} - ${b}`)}catch(g){i(v=>[...v,{type:"incoming_message",status:"error",message:`Error en test de mensaje: ${g.message}`,details:g}]),o({title:"❌ Error en test de mensaje",description:g.message,variant:"destructive"})}finally{n(!1)}},f=()=>{switch(r){case"verification":l();break;case"message_status":u();break;case"incoming_message":d();break}},h=()=>{navigator.clipboard.writeText(s),o({title:"URL copiada",description:"La URL del webhook se ha copiado al portapapeles"})},p=()=>{i([])};return c.jsxs(He,{className:"bg-yellow-50 border-yellow-200",children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2 text-yellow-800",children:[c.jsx(YN,{className:"h-5 w-5"}),"Probador de Webhook WhatsApp"]}),c.jsx(Hr,{className:"text-yellow-600",children:"Prueba tu webhook localmente antes de configurarlo en Facebook"})]}),c.jsxs(We,{className:"space-y-6",children:[c.jsxs(Fi,{children:[c.jsx(mi,{className:"h-4 w-4"}),c.jsxs(Bi,{children:[c.jsx("strong",{children:"Token actualizado:"})," Ahora usa el token correcto de Meta (1371636570719904). Asegúrate de que este mismo token esté configurado en la Meta Developer Console."]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"URL del Webhook"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(It,{value:s,readOnly:!0,className:"font-mono text-xs"}),c.jsx(Ne,{size:"sm",variant:"outline",onClick:h,children:c.jsx(em,{className:"h-4 w-4"})})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium mb-2",children:"Tipo de Prueba"}),c.jsxs(Ca,{value:r,onValueChange:e,children:[c.jsx(ia,{children:c.jsx(Na,{})}),c.jsxs(oa,{children:[c.jsx(pr,{value:"verification",children:"Verificación de Webhook (Token Meta)"}),c.jsx(pr,{value:"message_status",children:"Estado de Mensaje"}),c.jsx(pr,{value:"incoming_message",children:"Mensaje Entrante"})]})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs(Ne,{onClick:f,disabled:t,className:"bg-yellow-600 hover:bg-yellow-700",children:[c.jsx(dl,{className:"h-4 w-4 mr-2"}),t?"Ejecutando...":"Ejecutar Prueba"]}),a.length>0&&c.jsx(Ne,{variant:"outline",onClick:p,children:"Limpiar Resultados"})]}),a.length>0&&c.jsxs("div",{className:"space-y-3",children:[c.jsx("h3",{className:"font-semibold",children:"Resultados de las Pruebas:"}),a.map((g,v)=>c.jsx("div",{className:`p-3 rounded border ${g.status==="success"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:c.jsxs("div",{className:"flex items-start gap-2",children:[g.status==="success"?c.jsx(Fn,{className:"h-5 w-5 text-green-500 mt-0.5"}):c.jsx(mi,{className:"h-5 w-5 text-red-500 mt-0.5"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx(Ot,{variant:"secondary",children:g.type}),c.jsx("span",{className:"text-sm font-medium",children:g.message})]}),g.details&&c.jsxs("details",{className:"mt-2",children:[c.jsx("summary",{className:"text-xs text-gray-500 cursor-pointer",children:"Ver detalles"}),c.jsx("pre",{className:"text-xs bg-gray-100 p-2 mt-1 rounded overflow-auto max-h-40",children:JSON.stringify(g.details,null,2)})]})]})]})},v))]}),c.jsxs(Fi,{children:[c.jsx(Fn,{className:"h-4 w-4"}),c.jsxs(Bi,{children:[c.jsx("strong",{children:"Próximos pasos:"})," Una vez que todas las pruebas pasen exitosamente, el webhook está listo para recibir eventos de Meta con el token 1371636570719904."]})]})]})]})]})}function lF(){const{data:r=[],isLoading:e}=Rt({queryKey:["message-delivery-status"],queryFn:async()=>{const{data:i,error:o}=await xe.from("message_delivery_status").select(`
          *,
          notification_log (
            message,
            customers (
              name,
              phone
            )
          )
        `).order("timestamp",{ascending:!1}).limit(50);if(o)throw console.error("Error fetching delivery status:",o),o;return(i||[]).map(s=>({id:s.id,notification_id:s.notification_id,whatsapp_message_id:s.whatsapp_message_id,status:s.status,message_timestamp:s.timestamp,recipient_phone:s.recipient_phone,notification_log:s.notification_log}))},refetchInterval:1e4}),t=i=>{switch(i){case"delivered":return c.jsx(Fn,{className:"h-4 w-4 text-green-600"});case"read":return c.jsx(Fn,{className:"h-4 w-4 text-blue-600"});case"sent":return c.jsx(q1,{className:"h-4 w-4 text-yellow-600"});case"failed":return c.jsx(mi,{className:"h-4 w-4 text-red-600"});default:return c.jsx(q1,{className:"h-4 w-4 text-gray-600"})}},n=i=>{switch(i){case"delivered":return"bg-green-100 text-green-800";case"read":return"bg-blue-100 text-blue-800";case"sent":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},a=i=>{switch(i){case"delivered":return"Entregado";case"read":return"Leído";case"sent":return"Enviado";case"failed":return"Falló";default:return i}};return c.jsxs(He,{children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(_u,{className:"h-5 w-5"}),"Estados de Entrega WhatsApp"]}),c.jsx(Hr,{children:"Estados en tiempo real de los mensajes enviados vía WhatsApp"})]}),c.jsx(We,{children:e?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500",children:"Cargando estados..."})}):r.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx(_u,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No hay estados de entrega registrados"}),c.jsx("p",{className:"text-sm mt-2",children:"Los estados aparecerán aquí cuando se configuren los webhooks"})]}):c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"Cliente"}),c.jsx(Me,{children:"Teléfono"}),c.jsx(Me,{children:"Mensaje"}),c.jsx(Me,{children:"Estado"}),c.jsx(Me,{children:"Fecha"})]})}),c.jsx(Wa,{children:r.map(i=>c.jsxs(Sr,{children:[c.jsx(Re,{children:c.jsx("div",{className:"font-medium",children:i.notification_log?.customers?.name||"N/A"})}),c.jsx(Re,{children:c.jsx("div",{className:"text-sm text-gray-500",children:i.recipient_phone})}),c.jsx(Re,{className:"max-w-xs",children:c.jsx("div",{className:"truncate",title:i.notification_log?.message,children:i.notification_log?.message||"N/A"})}),c.jsx(Re,{children:c.jsx(Ot,{className:n(i.status),variant:"secondary",children:c.jsxs("div",{className:"flex items-center gap-1",children:[t(i.status),a(i.status)]})})}),c.jsx(Re,{children:pt(new Date(i.message_timestamp),"dd/MM/yyyy HH:mm")})]},i.id))})]})})]})}function uF(){const{data:r=[],isLoading:e}=Rt({queryKey:["incoming-messages"],queryFn:async()=>{const{data:n,error:a}=await xe.from("incoming_messages").select(`
          *,
          customers (
            name
          )
        `).order("timestamp",{ascending:!1}).limit(50);if(a)throw console.error("Error fetching incoming messages:",a),a;return(n||[]).map(i=>({id:i.id,whatsapp_message_id:i.whatsapp_message_id,from_phone:i.from_phone,customer_id:i.customer_id,message_type:i.message_type,message_content:i.message_content,message_timestamp:i.timestamp,customers:i.customers}))},refetchInterval:5e3}),t=n=>{switch(n){case"text":return"bg-blue-100 text-blue-800";case"image":return"bg-green-100 text-green-800";case"audio":return"bg-purple-100 text-purple-800";case"video":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return c.jsxs(He,{children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(Mi,{className:"h-5 w-5"}),"Mensajes Entrantes"]}),c.jsx(Hr,{children:"Respuestas y mensajes recibidos de clientes vía WhatsApp"})]}),c.jsx(We,{children:e?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500",children:"Cargando mensajes..."})}):r.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx(Mi,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No hay mensajes entrantes"}),c.jsx("p",{className:"text-sm mt-2",children:"Los mensajes de clientes aparecerán aquí cuando se configuren los webhooks"})]}):c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"Cliente"}),c.jsx(Me,{children:"Teléfono"}),c.jsx(Me,{children:"Tipo"}),c.jsx(Me,{children:"Mensaje"}),c.jsx(Me,{children:"Fecha"})]})}),c.jsx(Wa,{children:r.map(n=>c.jsxs(Sr,{children:[c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ts,{className:"h-4 w-4 text-gray-400"}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:n.customers?.name||"Cliente Desconocido"}),!n.customer_id&&c.jsx("div",{className:"text-xs text-orange-600",children:"No registrado en sistema"})]})]})}),c.jsx(Re,{children:c.jsxs("div",{className:"text-sm text-gray-500",children:["+",n.from_phone]})}),c.jsx(Re,{children:c.jsx(Ot,{className:t(n.message_type),variant:"secondary",children:n.message_type})}),c.jsx(Re,{className:"max-w-xs",children:c.jsx("div",{className:"truncate",title:n.message_content||"",children:n.message_content||"(Sin contenido de texto)"})}),c.jsx(Re,{children:pt(new Date(n.message_timestamp),"dd/MM/yyyy HH:mm")})]},n.id))})]})})]})}function dF(){const{pendingFlights:r,isLoading:e,processNotifications:t,updateFlightStatus:n,sendTestNotification:a,isProcessing:i,isSendingTest:o}=h4();return c.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[c.jsx(J9,{}),c.jsx(iF,{}),c.jsx(cF,{}),c.jsx(sF,{}),c.jsx(oF,{}),c.jsx(aF,{}),c.jsx(eF,{onSendTestNotification:a,isSendingTest:o}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[c.jsx(lF,{}),c.jsx(uF,{})]}),c.jsx(nF,{}),c.jsx(tF,{pendingFlights:r,isLoading:e,isProcessing:i,onProcessNotifications:t,onUpdateFlightStatus:n})]})}function fF(){return Rt({queryKey:["notification-log"],queryFn:async()=>{const{data:r,error:e}=await xe.from("notification_log").select("*").order("created_at",{ascending:!1}).limit(50);if(e)throw e;return await Promise.all((r||[]).map(async n=>{const a={...n,packages:void 0,customers:void 0};if(n.package_id){const{data:i}=await xe.from("packages").select("tracking_number").eq("id",n.package_id).single();i&&(a.packages={tracking_number:i.tracking_number})}if(n.customer_id){const{data:i}=await xe.from("customers").select("name, phone").eq("id",n.customer_id).single();i&&(a.customers={name:i.name,phone:i.phone})}return a}))}})}function hF(){const{data:r=[],isLoading:e}=fF(),t=a=>{switch(a){case"sent":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},n=a=>{switch(a){case"sent":return"Enviado";case"pending":return"Pendiente";case"failed":return"Fallido";default:return a}};return c.jsxs(He,{children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(_u,{className:"h-5 w-5"}),"Log de Notificaciones"]}),c.jsx(Hr,{children:"Historial de notificaciones enviadas a los clientes"})]}),c.jsx(We,{children:e?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500",children:"Cargando notificaciones..."})}):r.length===0?c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx(_u,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No hay notificaciones registradas"})]}):c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"Fecha"}),c.jsx(Me,{children:"Cliente"}),c.jsx(Me,{children:"Tracking"}),c.jsx(Me,{children:"Mensaje"}),c.jsx(Me,{children:"Estado"}),c.jsx(Me,{children:"Enviado"})]})}),c.jsx(Wa,{children:r.map(a=>c.jsxs(Sr,{children:[c.jsx(Re,{children:pt(new Date(a.created_at),"dd/MM/yyyy HH:mm")}),c.jsx(Re,{children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:a.customers?.name||"N/A"}),c.jsx("div",{className:"text-sm text-gray-500",children:a.customers?.phone||"N/A"})]})}),c.jsx(Re,{className:"font-medium",children:a.packages?.tracking_number||"N/A"}),c.jsx(Re,{className:"max-w-xs",children:c.jsx("div",{className:"truncate",title:a.message,children:a.message})}),c.jsx(Re,{children:c.jsx(Ot,{className:t(a.status),children:n(a.status)})}),c.jsx(Re,{children:a.sent_at?pt(new Date(a.sent_at),"dd/MM/yyyy HH:mm"):"-"})]},a.id))})]})})]})}function pF(){return c.jsxs(xn,{value:"notifications",className:"space-y-4 sm:space-y-8 px-2 sm:px-0",children:[c.jsx(dF,{}),c.jsx(hF,{})]})}var Bg="Switch",[mF,vH]=Ui(Bg),[gF,vF]=mF(Bg),x4=w.forwardRef((r,e)=>{const{__scopeSwitch:t,name:n,checked:a,defaultChecked:i,required:o,disabled:s,value:l="on",onCheckedChange:u,form:d,...f}=r,[h,p]=w.useState(null),g=Wr(e,S=>p(S)),v=w.useRef(!1),b=h?d||!!h.closest("form"):!0,[y=!1,C]=ul({prop:a,defaultProp:i,onChange:u});return c.jsxs(gF,{scope:t,checked:y,disabled:s,children:[c.jsx(cr.button,{type:"button",role:"switch","aria-checked":y,"aria-required":o,"data-state":w4(y),"data-disabled":s?"":void 0,disabled:s,value:l,...f,ref:g,onClick:rt(r.onClick,S=>{C(j=>!j),b&&(v.current=S.isPropagationStopped(),v.current||S.stopPropagation())})}),b&&c.jsx(xF,{control:h,bubbles:!v.current,name:n,value:l,checked:y,required:o,disabled:s,form:d,style:{transform:"translateX(-100%)"}})]})});x4.displayName=Bg;var y4="SwitchThumb",b4=w.forwardRef((r,e)=>{const{__scopeSwitch:t,...n}=r,a=vF(y4,t);return c.jsx(cr.span,{"data-state":w4(a.checked),"data-disabled":a.disabled?"":void 0,...n,ref:e})});b4.displayName=y4;var xF=r=>{const{control:e,checked:t,bubbles:n=!0,...a}=r,i=w.useRef(null),o=Ty(t),s=Oy(e);return w.useEffect(()=>{const l=i.current,u=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(u,"checked").set;if(o!==t&&f){const h=new Event("click",{bubbles:n});f.call(l,t),l.dispatchEvent(h)}},[o,t,n]),c.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:t,...a,tabIndex:-1,ref:i,style:{...r.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function w4(r){return r?"checked":"unchecked"}var _4=x4,yF=b4;const Kf=w.forwardRef(({className:r,...e},t)=>c.jsx(_4,{className:Le("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...e,ref:t,children:c.jsx(yF,{className:Le("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Kf.displayName=_4.displayName;function bF(){const{toast:r}=Lt(),e=Gr(),[t,n]=w.useState(!0),[a,i]=w.useState(!0),[o,s]=w.useState(""),{data:l,isLoading:u}=Rt({queryKey:["notification-settings"],queryFn:async()=>{const{data:h,error:p}=await xe.from("notification_settings").select("*").limit(1).single();if(p&&p.code!=="PGRST116")throw p;return h}});w.useEffect(()=>{l&&(n(l.enable_arrival_notifications??!0),i(l.whatsapp_enabled??!0))},[l]);const d=ln({mutationFn:async h=>{if(l){const{error:p}=await xe.from("notification_settings").update(h).eq("id",l.id);if(p)throw p}else{const{error:p}=await xe.from("notification_settings").insert(h);if(p)throw p}},onSuccess:()=>{e.invalidateQueries({queryKey:["notification-settings"]}),r({title:"Configuración actualizada",description:"Los ajustes de notificación se guardaron correctamente"})},onError:h=>{console.error("Error updating settings:",h),r({title:"Error",description:"No se pudieron guardar los ajustes",variant:"destructive"})}}),f=()=>{d.mutate({enable_arrival_notifications:t,whatsapp_enabled:a,updated_at:new Date().toISOString()})};return u?c.jsx(He,{children:c.jsx(We,{className:"py-8",children:c.jsx("div",{className:"text-center text-gray-500",children:"Cargando configuración..."})})}):c.jsxs(He,{children:[c.jsxs(yt,{children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(tm,{className:"h-5 w-5"}),"Configuración de Notificaciones"]}),c.jsx(Hr,{children:"Personaliza cómo y cuándo se envían las notificaciones a los clientes"})]}),c.jsxs(We,{className:"space-y-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-0.5",children:[c.jsx(at,{children:"Notificaciones de Llegada"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Enviar notificaciones automáticas cuando los vuelos lleguen"})]}),c.jsx(Kf,{checked:t,onCheckedChange:n})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"space-y-0.5",children:[c.jsx(at,{children:"WhatsApp Habilitado"}),c.jsx("div",{className:"text-sm text-gray-500",children:"Usar WhatsApp como canal principal de notificaciones"})]}),c.jsx(Kf,{checked:a,onCheckedChange:i})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{children:"Plantilla de Mensaje (Opcional)"}),c.jsx(It,{placeholder:"Ej: Estimado {cliente}, su encomienda {tracking} ha llegado...",value:o,onChange:h=>s(h.target.value)}),c.jsxs("div",{className:"text-sm text-gray-500",children:["Variables disponibles: ","{cliente}",", ","{tracking}",", ","{destino}"]})]})]}),c.jsx("div",{className:"pt-4 border-t",children:c.jsx(Ne,{onClick:f,disabled:d.isPending,className:"w-full md:w-auto",children:d.isPending?"Guardando...":"Guardar Configuración"})}),c.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[c.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Información Importante"}),c.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[c.jsx("li",{children:"• Las notificaciones se envían automáticamente cuando los vuelos aterrizan"}),c.jsx("li",{children:"• Asegúrate de que los clientes tengan números de WhatsApp válidos"}),c.jsx("li",{children:"• El sistema verifica el estado cada 30 segundos"}),c.jsx("li",{children:"• Puedes enviar notificaciones manuales desde la sección de paquetes"})]})]})]})]})}function wF(){return c.jsx(xn,{value:"settings",className:"space-y-4 sm:space-y-8 px-2 sm:px-0",children:c.jsx(bF,{})})}function _F({open:r,onOpenChange:e,user:t,onSuccess:n}){const[a,i]=w.useState({first_name:"",last_name:"",phone:"",role:"employee",is_active:!0}),{toast:o}=Lt();w.useEffect(()=>{t&&i({first_name:t.first_name,last_name:t.last_name,phone:t.phone||"",role:t.role,is_active:t.is_active})},[t]);const s=ln({mutationFn:async d=>{if(!t)throw new Error("No user selected");const{error:f}=await xe.from("user_profiles").update({first_name:d.first_name,last_name:d.last_name,phone:d.phone||null,role:d.role,is_active:d.is_active}).eq("id",t.id);if(f)throw f},onSuccess:()=>{o({title:"Usuario actualizado",description:"Los datos del usuario han sido actualizados exitosamente"}),n()},onError:d=>{console.error("Error updating user:",d),o({title:"Error",description:d.message||"No se pudo actualizar el usuario",variant:"destructive"})}}),l=d=>{if(d.preventDefault(),!a.first_name.trim()||!a.last_name.trim()){o({title:"Error",description:"El nombre y apellido son obligatorios",variant:"destructive"});return}s.mutate(a)},u=(d,f)=>{i(h=>({...h,[d]:f}))};return t?c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[500px]",children:[c.jsxs(Kr,{children:[c.jsx(Xr,{children:"Editar Usuario"}),c.jsx(sa,{children:"Modifica la información del usuario seleccionado."})]}),c.jsxs("form",{onSubmit:l,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"first_name",children:"Nombre *"}),c.jsx(It,{id:"first_name",value:a.first_name,onChange:d=>u("first_name",d.target.value),placeholder:"Nombre",required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"last_name",children:"Apellido *"}),c.jsx(It,{id:"last_name",value:a.last_name,onChange:d=>u("last_name",d.target.value),placeholder:"Apellido",required:!0})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"email",children:"Email"}),c.jsx(It,{id:"email",type:"email",value:t.email,disabled:!0,className:"bg-gray-100"}),c.jsx("p",{className:"text-sm text-gray-500",children:"El email no se puede modificar"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"phone",children:"Teléfono"}),c.jsx(It,{id:"phone",value:a.phone,onChange:d=>u("phone",d.target.value),placeholder:"+57 300 123 4567"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"role",children:"Rol *"}),c.jsxs(Ca,{value:a.role,onValueChange:d=>u("role",d),children:[c.jsx(ia,{children:c.jsx(Na,{placeholder:"Seleccionar rol"})}),c.jsxs(oa,{children:[c.jsx(pr,{value:"admin",children:"Administrador"}),c.jsx(pr,{value:"employee",children:"Empleado"}),c.jsx(pr,{value:"traveler",children:"Viajero"})]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Kf,{id:"is_active",checked:a.is_active,onCheckedChange:d=>u("is_active",d)}),c.jsx(at,{htmlFor:"is_active",children:"Usuario activo"})]}),c.jsxs(rs,{className:"gap-3",children:[c.jsx(Ne,{type:"button",variant:"secondary",onClick:()=>e(!1),children:"Cancelar"}),c.jsx(Ne,{type:"submit",disabled:s.isPending,children:s.isPending?"Actualizando...":"Actualizar"})]})]})]})}):null}function CF({open:r,onOpenChange:e,user:t,onSuccess:n}){const{toast:a}=Lt(),i=ln({mutationFn:async()=>{if(!t)throw new Error("No user selected");const{error:s}=await xe.from("user_profiles").delete().eq("id",t.id);if(s)throw s;const{error:l}=await xe.auth.admin.deleteUser(t.user_id);if(l)throw l},onSuccess:()=>{a({title:"Usuario eliminado",description:"El usuario ha sido eliminado exitosamente"}),n()},onError:s=>{console.error("Error deleting user:",s),a({title:"Error",description:s.message||"No se pudo eliminar el usuario",variant:"destructive"})}}),o=()=>{i.mutate()};return t?c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[400px]",children:[c.jsxs(Kr,{children:[c.jsx(Xr,{children:"Eliminar Usuario"}),c.jsx(sa,{children:"¿Estás seguro de que quieres eliminar a este usuario? Esta acción no se puede deshacer."})]}),c.jsx("div",{className:"py-4",children:c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Nombre:"})," ",t.first_name," ",t.last_name]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Email:"})," ",t.email]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Rol:"})," ",t.role]})]})}),c.jsxs(rs,{className:"gap-3",children:[c.jsx(Ne,{type:"button",variant:"secondary",onClick:()=>e(!1),children:"Cancelar"}),c.jsx(Ne,{variant:"destructive",onClick:o,disabled:i.isPending,children:i.isPending?"Eliminando...":"Eliminar"})]})]})}):null}function NF({users:r,isLoading:e,onUpdate:t}){const[n,a]=w.useState(null),[i,o]=w.useState(!1),[s,l]=w.useState(!1),u=v=>{switch(v){case"admin":return"destructive";case"employee":return"default";case"traveler":return"secondary";default:return"outline"}},d=v=>{switch(v){case"admin":return"Administrador";case"employee":return"Empleado";case"traveler":return"Viajero";default:return v}},f=v=>{a(v),o(!0)},h=v=>{a(v),l(!0)},p=()=>{o(!1),a(null),t()},g=()=>{l(!1),a(null),t()};return e?c.jsx("div",{className:"flex justify-center py-8",children:c.jsx("div",{className:"text-gray-500",children:"Cargando usuarios..."})}):c.jsxs(c.Fragment,{children:[c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"Nombre"}),c.jsx(Me,{children:"Email"}),c.jsx(Me,{children:"Teléfono"}),c.jsx(Me,{children:"Rol"}),c.jsx(Me,{children:"Estado"}),c.jsx(Me,{children:"Fecha Creación"}),c.jsx(Me,{children:"Acciones"})]})}),c.jsx(Wa,{children:r.map(v=>c.jsxs(Sr,{children:[c.jsxs(Re,{children:[v.first_name," ",v.last_name]}),c.jsx(Re,{children:v.email}),c.jsx(Re,{children:v.phone||"-"}),c.jsx(Re,{children:c.jsx(Ot,{variant:u(v.role),children:d(v.role)})}),c.jsx(Re,{children:c.jsx(Ot,{variant:v.is_active?"default":"secondary",children:v.is_active?"Activo":"Inactivo"})}),c.jsx(Re,{children:new Date(v.created_at).toLocaleDateString()}),c.jsx(Re,{children:c.jsxs("div",{className:"flex gap-2",children:[c.jsx(Ne,{variant:"outline",size:"sm",onClick:()=>f(v),children:c.jsx(rm,{className:"h-4 w-4"})}),c.jsx(Ne,{variant:"outline",size:"sm",onClick:()=>h(v),children:c.jsx(Jy,{className:"h-4 w-4"})})]})})]},v.id))})]}),c.jsx(_F,{open:i,onOpenChange:o,user:n,onSuccess:p}),c.jsx(CF,{open:s,onOpenChange:l,user:n,onSuccess:g})]})}function SF({open:r,onOpenChange:e,onSuccess:t}){const[n,a]=w.useState({email:"",password:"",first_name:"",last_name:"",phone:"",role:"employee"}),{toast:i}=Lt(),o=ln({mutationFn:async u=>{const{data:d,error:f}=await xe.auth.admin.createUser({email:u.email,password:u.password,email_confirm:!0});if(f)throw f;const{error:h}=await xe.from("user_profiles").insert({user_id:d.user.id,email:u.email,first_name:u.first_name,last_name:u.last_name,phone:u.phone||null,role:u.role,created_by:(await xe.auth.getUser()).data.user?.id});if(h)throw h;return d},onSuccess:()=>{i({title:"Usuario creado",description:"El usuario ha sido creado exitosamente"}),a({email:"",password:"",first_name:"",last_name:"",phone:"",role:"employee"}),t()},onError:u=>{console.error("Error creating user:",u),i({title:"Error",description:u.message||"No se pudo crear el usuario",variant:"destructive"})}}),s=u=>{if(u.preventDefault(),!n.email.trim()||!n.password.trim()||!n.first_name.trim()||!n.last_name.trim()){i({title:"Error",description:"Por favor completa todos los campos obligatorios",variant:"destructive"});return}o.mutate(n)},l=(u,d)=>{a(f=>({...f,[u]:d}))};return c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[500px]",children:[c.jsxs(Kr,{children:[c.jsx(Xr,{children:"Crear Nuevo Usuario"}),c.jsx(sa,{children:"Completa la información para crear un nuevo usuario del sistema."})]}),c.jsxs("form",{onSubmit:s,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"first_name",children:"Nombre *"}),c.jsx(It,{id:"first_name",value:n.first_name,onChange:u=>l("first_name",u.target.value),placeholder:"Nombre",required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"last_name",children:"Apellido *"}),c.jsx(It,{id:"last_name",value:n.last_name,onChange:u=>l("last_name",u.target.value),placeholder:"Apellido",required:!0})]})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"email",children:"Email *"}),c.jsx(It,{id:"email",type:"email",value:n.email,onChange:u=>l("email",u.target.value),placeholder:"email@ejemplo.com",required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"password",children:"Contraseña *"}),c.jsx(It,{id:"password",type:"password",value:n.password,onChange:u=>l("password",u.target.value),placeholder:"Contraseña temporal",required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"phone",children:"Teléfono"}),c.jsx(It,{id:"phone",value:n.phone,onChange:u=>l("phone",u.target.value),placeholder:"+57 300 123 4567"})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"role",children:"Rol *"}),c.jsxs(Ca,{value:n.role,onValueChange:u=>l("role",u),children:[c.jsx(ia,{children:c.jsx(Na,{placeholder:"Seleccionar rol"})}),c.jsxs(oa,{children:[c.jsx(pr,{value:"admin",children:"Administrador"}),c.jsx(pr,{value:"employee",children:"Empleado"}),c.jsx(pr,{value:"traveler",children:"Viajero"})]})]})]}),c.jsxs(rs,{className:"gap-3",children:[c.jsx(Ne,{type:"button",variant:"secondary",onClick:()=>e(!1),children:"Cancelar"}),c.jsx(Ne,{type:"submit",disabled:o.isPending,children:o.isPending?"Creando...":"Crear Usuario"})]})]})]})})}function EF(){return Rt({queryKey:["user-profiles"],queryFn:async()=>{const{data:r,error:e}=await xe.from("user_profiles").select("*").order("created_at",{ascending:!1});if(e)throw e;return r}})}function AF(){const[r,e]=w.useState(!1),{data:t,isLoading:n,refetch:a}=EF(),i=()=>{e(!1),a()};return c.jsxs(c.Fragment,{children:[c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx(Nt,{children:"Usuarios del Sistema"}),c.jsxs(Ne,{onClick:()=>e(!0),children:[c.jsx(ao,{className:"h-4 w-4 mr-2"}),"Nuevo Usuario"]})]})}),c.jsx(We,{children:c.jsx(NF,{users:t||[],isLoading:n,onUpdate:a})})]}),c.jsx(SF,{open:r,onOpenChange:e,onSuccess:i})]})}function jF(){return c.jsx(xn,{value:"users",className:"space-y-4 sm:space-y-6",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold tracking-tight",children:"Gestión de Usuarios"}),c.jsx("p",{className:"text-muted-foreground",children:"Administra usuarios, empleados y viajeros del sistema"})]}),c.jsx(AF,{})]})})}function PF(){return Rt({queryKey:["trips"],queryFn:async()=>{const{data:r,error:e}=await xe.from("trips").select(`
          *,
          travelers:traveler_id (
            id,
            first_name,
            last_name,
            phone
          )
        `).order("trip_date",{ascending:!1});if(e)throw e;return r}})}function DF(){return Rt({queryKey:["customers-count"],queryFn:async()=>{const{count:r,error:e}=await xe.from("customers").select("*",{count:"exact",head:!0});if(e)throw e;return r||0}})}function IF(){return Rt({queryKey:["package-stats"],queryFn:async()=>{const{data:r,error:e}=await xe.from("packages").select("status");if(e)throw e;return{total:r.length,recibido:r.filter(n=>n.status==="recibido").length,bodega:r.filter(n=>n.status==="bodega").length,procesado:r.filter(n=>n.status==="procesado").length,transito:r.filter(n=>n.status==="transito").length,en_destino:r.filter(n=>n.status==="en_destino").length,delivered:r.filter(n=>n.status==="delivered").length,pending:r.filter(n=>n.status==="pending").length,inTransit:r.filter(n=>n.status==="in_transit").length}}})}function TF(){const{data:r=0,refetch:e}=Rt({queryKey:["unread-messages"],queryFn:async()=>{try{const t=localStorage.getItem("chat-last-visited"),n=t?new Date(t):new Date(Date.now()-24*60*60*1e3);console.log("Checking unread messages since:",n.toISOString());const{data:a,error:i}=await xe.from("incoming_messages").select("id, from_phone, timestamp").gt("timestamp",n.toISOString()).order("timestamp",{ascending:!1});if(i)return console.error("Error fetching unread messages:",i),0;const s=new Set(a?.map(l=>l.from_phone)||[]).size;return console.log(`Found ${a?.length||0} new messages from ${s} conversations`),s}catch(t){return console.error("Error in useUnreadMessages:",t),0}},refetchInterval:5e3});return{unreadCount:r,refetch:e}}function $g(){const r=g4(),{data:e=[],isLoading:t,refetch:n}=PF(),{data:a=0}=DF(),{data:i}=IF(),{unreadCount:o,refetch:s}=TF();return{packagesData:r,trips:e,tripsLoading:t,refetchTrips:n,customersCount:a,packageStats:i,unreadCount:o,refetchUnreadMessages:s}}function Ug(){const[r,e]=w.useState(""),[t,n]=w.useState(!1),[a,i]=w.useState(!1),[o,s]=w.useState(),[l,u]=w.useState(),[d,f]=w.useState("dashboard"),[h,p]=w.useState(null);return{searchTerm:r,setSearchTerm:e,packageDialogOpen:t,setPackageDialogOpen:n,tripDialogOpen:a,setTripDialogOpen:i,selectedTripId:o,setSelectedTripId:s,selectedDate:l,setSelectedDate:u,activeTab:d,setActiveTab:f,viewingPackagesByDate:h,setViewingPackagesByDate:p}}function qg({activeTab:r,refetchUnreadMessages:e,refetchTrips:t,packagesRefetch:n,setSelectedTripId:a,setPackageDialogOpen:i,setTripDialogOpen:o,setSelectedDate:s,setViewingPackagesByDate:l,setActiveTab:u}){const d=Gr();return{handleNewPackage:()=>{a(""),i(!0)},handleAddPackageToTrip:D=>{a(D),i(!0)},handleCreateTripFromCalendar:D=>{s(D),o(!0)},handleViewPackagesByDate:D=>{l(D)},handlePackageSuccess:()=>{i(!1),d.invalidateQueries({queryKey:["packages"]}),d.invalidateQueries({queryKey:["trips"]}),d.invalidateQueries({queryKey:["packages-by-date"]}),d.invalidateQueries({queryKey:["packages-by-trip"]}),n(),t()},handleTripSuccess:()=>{o(!1),s(null),d.invalidateQueries({queryKey:["trips"]}),d.invalidateQueries({queryKey:["packages-by-date"]}),t()},handleTripDialogClose:D=>{D||s(null),o(D)},handleViewNotifications:()=>{u("notifications"),e()},handlePackagesUpdate:()=>{d.invalidateQueries({queryKey:["packages"]}),d.invalidateQueries({queryKey:["packages-by-date"]}),d.invalidateQueries({queryKey:["packages-by-trip"]}),d.invalidateQueries({queryKey:["trips"]}),n(),t()},handleBackToCalendar:()=>{l(null),d.invalidateQueries({queryKey:["trips"]}),t()}}}function OF(){const[r,e]=w.useState(null),[t,n]=w.useState(null),[a,i]=w.useState([]),[o,s]=w.useState(0),l=async()=>{try{console.log("Initializing camera for Beeprt CC450 CPCL Barcode scanning (priority over QR)..."),(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(g=>g.stop());const h=(await navigator.mediaDevices.enumerateDevices()).filter(g=>g.kind==="videoinput");console.log("Available cameras:",h.map(g=>({label:g.label,deviceId:g.deviceId})));const p=h.sort((g,v)=>{const b=g.label.toLowerCase().includes("back")||g.label.toLowerCase().includes("rear")||g.label.toLowerCase().includes("environment")||g.label.toLowerCase().includes("trasera"),y=v.label.toLowerCase().includes("back")||v.label.toLowerCase().includes("rear")||v.label.toLowerCase().includes("environment")||v.label.toLowerCase().includes("trasera");return b&&!y?-1:!b&&y?1:0});i(p),s(0),e(!0),console.log("Camera initialized for Barcode detection (priority). Default camera:",p[0]?.label||"Unknown")}catch(d){console.error("Camera permission denied:",d),e(!1),n("Se requiere acceso a la cámara para escanear códigos de barras")}},u=()=>{if(a.length>1){console.log("Switching camera...");const d=(o+1)%a.length;s(d),console.log("Switched to camera:",a[d]?.label||`Camera ${d+1}`)}};return w.useEffect(()=>{l()},[]),{hasPermission:r,error:t,setError:n,availableCameras:a,currentCameraIndex:o,switchCamera:u}}function kF(r){return{deviceId:{exact:r},facingMode:"environment",width:{ideal:2560,min:1280,max:4096},height:{ideal:1440,min:720,max:2160},focusMode:"continuous",aspectRatio:{ideal:16/9},frameRate:{ideal:60,min:30,max:60},exposureMode:"continuous",whiteBalanceMode:"continuous",brightness:{ideal:.5},contrast:{ideal:1.2},saturation:{ideal:1.1}}}function MF(r){return{video:{deviceId:{exact:r},facingMode:"environment",width:{ideal:1920,min:1280},height:{ideal:1080,min:720},frameRate:{ideal:30,min:15}},audio:!1}}class RF{constructor(e,t){this.videoRef=e,this.streamRef=t}async startVideoStream(e){try{console.log("Starting ultra high-resolution video stream for thermal printer Barcode detection with device:",e),this.stopCurrentStream();const t=kF(e);console.log("Video constraints for thermal printer Barcode:",t);const n={video:t,audio:!1},a=await navigator.mediaDevices.getUserMedia(n);return this.streamRef.current=a,await this.setupVideoElement(a),this.logVideoSettings(a),console.log("Ultra high-resolution video stream started for thermal printer Barcode detection"),a}catch(t){return console.error("Error starting ultra high-resolution video stream:",t),this.tryFallbackStream(e)}}stopCurrentStream(){this.streamRef.current&&(this.streamRef.current.getTracks().forEach(e=>e.stop()),this.streamRef.current=null)}async setupVideoElement(e){this.videoRef.current&&(this.videoRef.current.srcObject=e,this.videoRef.current.setAttribute("playsinline","true"),this.videoRef.current.setAttribute("autoplay","true"),this.videoRef.current.setAttribute("muted","true"),await this.videoRef.current.play())}logVideoSettings(e){const n=e.getVideoTracks()[0].getSettings();console.log("Actual video settings for thermal printer Barcode:",{width:n.width,height:n.height,frameRate:n.frameRate,facingMode:n.facingMode,deviceId:n.deviceId})}async tryFallbackStream(e){try{console.log("Trying high resolution fallback for thermal printer Barcode...");const t=MF(e),n=await navigator.mediaDevices.getUserMedia(t);return this.streamRef.current=n,this.videoRef.current&&(this.videoRef.current.srcObject=n,await this.videoRef.current.play(),console.log("High resolution fallback video stream started")),n}catch(t){throw console.error("High resolution fallback also failed:",t),t}}cleanup(){console.log("Cleaning up video stream..."),this.stopCurrentStream(),this.videoRef.current&&(this.videoRef.current.srcObject=null)}}function LF(){const r=w.useRef(null),e=w.useRef(null),t=w.useRef(null);return w.useEffect(()=>(t.current=new RF(r,e),()=>{t.current?.cleanup()}),[]),{videoRef:r,streamRef:e,startVideoStream:async i=>{if(!t.current)throw new Error("Video stream manager not initialized");return t.current.startVideoStream(i)},cleanup:()=>{t.current?.cleanup()}}}function FF(r,e){var t=Object.setPrototypeOf;t?t(r,e):r.__proto__=e}function BF(r,e){e===void 0&&(e=r.constructor);var t=Error.captureStackTrace;t&&t(r,e)}var $F=function(){var r=function(t,n){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,i){a.__proto__=i}||function(a,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(a[o]=i[o])},r(t,n)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),UF=function(r){$F(e,r);function e(t,n){var a=this.constructor,i=r.call(this,t,n)||this;return Object.defineProperty(i,"name",{value:a.name,enumerable:!1,configurable:!0}),FF(i,a.prototype),BF(i),i}return e}(Error),qF=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),da=function(r){qF(e,r);function e(t){t===void 0&&(t=void 0);var n=r.call(this,t)||this;return n.message=t,n}return e.prototype.getKind=function(){var t=this.constructor;return t.kind},e.kind="Exception",e}(UF),VF=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),kr=function(r){VF(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ArgumentException",e}(da),zF=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),st=function(r){zF(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IllegalArgumentException",e}(da),C4=function(){function r(e){if(this.binarizer=e,e===null)throw new st("Binarizer must be non-null.")}return r.prototype.getWidth=function(){return this.binarizer.getWidth()},r.prototype.getHeight=function(){return this.binarizer.getHeight()},r.prototype.getBlackRow=function(e,t){return this.binarizer.getBlackRow(e,t)},r.prototype.getBlackMatrix=function(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix},r.prototype.isCropSupported=function(){return this.binarizer.getLuminanceSource().isCropSupported()},r.prototype.crop=function(e,t,n,a){var i=this.binarizer.getLuminanceSource().crop(e,t,n,a);return new r(this.binarizer.createBinarizer(i))},r.prototype.isRotateSupported=function(){return this.binarizer.getLuminanceSource().isRotateSupported()},r.prototype.rotateCounterClockwise=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new r(this.binarizer.createBinarizer(e))},r.prototype.rotateCounterClockwise45=function(){var e=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new r(this.binarizer.createBinarizer(e))},r.prototype.toString=function(){try{return this.getBlackMatrix().toString()}catch{return""}},r}(),HF=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vr=function(r){HF(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getChecksumInstance=function(){return new e},e.kind="ChecksumException",e}(da),WF=function(){function r(e){this.source=e}return r.prototype.getLuminanceSource=function(){return this.source},r.prototype.getWidth=function(){return this.source.getWidth()},r.prototype.getHeight=function(){return this.source.getHeight()},r}(),mr=function(){function r(){}return r.arraycopy=function(e,t,n,a,i){for(;i--;)n[a++]=e[t++]},r.currentTimeMillis=function(){return Date.now()},r}(),GF=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vg=function(r){GF(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IndexOutOfBoundsException",e}(da),YF=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ox=function(r){YF(e,r);function e(t,n){t===void 0&&(t=void 0),n===void 0&&(n=void 0);var a=r.call(this,n)||this;return a.index=t,a.message=n,a}return e.kind="ArrayIndexOutOfBoundsException",e}(Vg),KF=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},on=function(){function r(){}return r.fill=function(e,t){for(var n=0,a=e.length;n<a;n++)e[n]=t},r.fillWithin=function(e,t,n,a){r.rangeCheck(e.length,t,n);for(var i=t;i<n;i++)e[i]=a},r.rangeCheck=function(e,t,n){if(t>n)throw new st("fromIndex("+t+") > toIndex("+n+")");if(t<0)throw new ox(t);if(n>e)throw new ox(n)},r.asList=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},r.create=function(e,t,n){var a=Array.from({length:e});return a.map(function(i){return Array.from({length:t}).fill(n)})},r.createInt32Array=function(e,t,n){var a=Array.from({length:e});return a.map(function(i){return Int32Array.from({length:t}).fill(n)})},r.equals=function(e,t){if(!e||!t||!e.length||!t.length||e.length!==t.length)return!1;for(var n=0,a=e.length;n<a;n++)if(e[n]!==t[n])return!1;return!0},r.hashCode=function(e){var t,n;if(e===null)return 0;var a=1;try{for(var i=KF(e),o=i.next();!o.done;o=i.next()){var s=o.value;a=31*a+s}}catch(l){t={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a},r.fillUint8Array=function(e,t){for(var n=0;n!==e.length;n++)e[n]=t},r.copyOf=function(e,t){return e.slice(0,t)},r.copyOfUint8Array=function(e,t){if(e.length<=t){var n=new Uint8Array(t);return n.set(e),n}return e.slice(0,t)},r.copyOfRange=function(e,t,n){var a=n-t,i=new Int32Array(a);return mr.arraycopy(e,t,i,0,a),i},r.binarySearch=function(e,t,n){n===void 0&&(n=r.numberComparator);for(var a=0,i=e.length-1;a<=i;){var o=i+a>>1,s=n(t,e[o]);if(s>0)a=o+1;else if(s<0)i=o-1;else return o}return-a-1},r.numberComparator=function(e,t){return e-t},r}(),Tt=function(){function r(){}return r.numberOfTrailingZeros=function(e){var t;if(e===0)return 32;var n=31;return t=e<<16,t!==0&&(n-=16,e=t),t=e<<8,t!==0&&(n-=8,e=t),t=e<<4,t!==0&&(n-=4,e=t),t=e<<2,t!==0&&(n-=2,e=t),n-(e<<1>>>31)},r.numberOfLeadingZeros=function(e){if(e===0)return 32;var t=1;return e>>>16||(t+=16,e<<=16),e>>>24||(t+=8,e<<=8),e>>>28||(t+=4,e<<=4),e>>>30||(t+=2,e<<=2),t-=e>>>31,t},r.toHexString=function(e){return e.toString(16)},r.toBinaryString=function(e){return String(parseInt(String(e),2))},r.bitCount=function(e){return e=e-(e>>>1&1431655765),e=(e&858993459)+(e>>>2&858993459),e=e+(e>>>4)&252645135,e=e+(e>>>8),e=e+(e>>>16),e&63},r.truncDivision=function(e,t){return Math.trunc(e/t)},r.parseInt=function(e,t){return t===void 0&&(t=void 0),parseInt(e,t)},r.MIN_VALUE_32_BITS=-2147483648,r.MAX_VALUE=Number.MAX_SAFE_INTEGER,r}(),vn=function(){function r(e,t){e===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=e,t==null?this.bits=r.makeArray(e):this.bits=t)}return r.prototype.getSize=function(){return this.size},r.prototype.getSizeInBytes=function(){return Math.floor((this.size+7)/8)},r.prototype.ensureCapacity=function(e){if(e>this.bits.length*32){var t=r.makeArray(e);mr.arraycopy(this.bits,0,t,0,this.bits.length),this.bits=t}},r.prototype.get=function(e){return(this.bits[Math.floor(e/32)]&1<<(e&31))!==0},r.prototype.set=function(e){this.bits[Math.floor(e/32)]|=1<<(e&31)},r.prototype.flip=function(e){this.bits[Math.floor(e/32)]^=1<<(e&31)},r.prototype.getNextSet=function(e){var t=this.size;if(e>=t)return t;var n=this.bits,a=Math.floor(e/32),i=n[a];i&=~((1<<(e&31))-1);for(var o=n.length;i===0;){if(++a===o)return t;i=n[a]}var s=a*32+Tt.numberOfTrailingZeros(i);return s>t?t:s},r.prototype.getNextUnset=function(e){var t=this.size;if(e>=t)return t;var n=this.bits,a=Math.floor(e/32),i=~n[a];i&=~((1<<(e&31))-1);for(var o=n.length;i===0;){if(++a===o)return t;i=~n[a]}var s=a*32+Tt.numberOfTrailingZeros(i);return s>t?t:s},r.prototype.setBulk=function(e,t){this.bits[Math.floor(e/32)]=t},r.prototype.setRange=function(e,t){if(t<e||e<0||t>this.size)throw new st;if(t!==e){t--;for(var n=Math.floor(e/32),a=Math.floor(t/32),i=this.bits,o=n;o<=a;o++){var s=o>n?0:e&31,l=o<a?31:t&31,u=(2<<l)-(1<<s);i[o]|=u}}},r.prototype.clear=function(){for(var e=this.bits.length,t=this.bits,n=0;n<e;n++)t[n]=0},r.prototype.isRange=function(e,t,n){if(t<e||e<0||t>this.size)throw new st;if(t===e)return!0;t--;for(var a=Math.floor(e/32),i=Math.floor(t/32),o=this.bits,s=a;s<=i;s++){var l=s>a?0:e&31,u=s<i?31:t&31,d=(2<<u)-(1<<l)&4294967295;if((o[s]&d)!==(n?d:0))return!1}return!0},r.prototype.appendBit=function(e){this.ensureCapacity(this.size+1),e&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++},r.prototype.appendBits=function(e,t){if(t<0||t>32)throw new st("Num bits must be between 0 and 32");this.ensureCapacity(this.size+t);for(var n=t;n>0;n--)this.appendBit((e>>n-1&1)===1)},r.prototype.appendBitArray=function(e){var t=e.size;this.ensureCapacity(this.size+t);for(var n=0;n<t;n++)this.appendBit(e.get(n))},r.prototype.xor=function(e){if(this.size!==e.size)throw new st("Sizes don't match");for(var t=this.bits,n=0,a=t.length;n<a;n++)t[n]^=e.bits[n]},r.prototype.toBytes=function(e,t,n,a){for(var i=0;i<a;i++){for(var o=0,s=0;s<8;s++)this.get(e)&&(o|=1<<7-s),e++;t[n+i]=o}},r.prototype.getBitArray=function(){return this.bits},r.prototype.reverse=function(){for(var e=new Int32Array(this.bits.length),t=Math.floor((this.size-1)/32),n=t+1,a=this.bits,i=0;i<n;i++){var o=a[i];o=o>>1&1431655765|(o&1431655765)<<1,o=o>>2&858993459|(o&858993459)<<2,o=o>>4&252645135|(o&252645135)<<4,o=o>>8&16711935|(o&16711935)<<8,o=o>>16&65535|(o&65535)<<16,e[t-i]=o}if(this.size!==n*32){for(var s=n*32-this.size,l=e[0]>>>s,i=1;i<n;i++){var u=e[i];l|=u<<32-s,e[i-1]=l,l=u>>>s}e[n-1]=l}this.bits=e},r.makeArray=function(e){return new Int32Array(Math.floor((e+31)/32))},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.size===t.size&&on.equals(this.bits,t.bits)},r.prototype.hashCode=function(){return 31*this.size+on.hashCode(this.bits)},r.prototype.toString=function(){for(var e="",t=0,n=this.size;t<n;t++)t&7||(e+=" "),e+=this.get(t)?"X":".";return e},r.prototype.clone=function(){return new r(this.size,this.bits.slice())},r.prototype.toArray=function(){for(var e=[],t=0,n=this.size;t<n;t++)e.push(this.get(t));return e},r}(),Ap;(function(r){r[r.OTHER=0]="OTHER",r[r.PURE_BARCODE=1]="PURE_BARCODE",r[r.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",r[r.TRY_HARDER=3]="TRY_HARDER",r[r.CHARACTER_SET=4]="CHARACTER_SET",r[r.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",r[r.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",r[r.ENABLE_CODE_39_EXTENDED_MODE=7]="ENABLE_CODE_39_EXTENDED_MODE",r[r.ASSUME_GS1=8]="ASSUME_GS1",r[r.RETURN_CODABAR_START_END=9]="RETURN_CODABAR_START_END",r[r.NEED_RESULT_POINT_CALLBACK=10]="NEED_RESULT_POINT_CALLBACK",r[r.ALLOWED_EAN_EXTENSIONS=11]="ALLOWED_EAN_EXTENSIONS"})(Ap||(Ap={}));const gr=Ap;var XF=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ke=function(r){XF(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getFormatInstance=function(){return new e},e.kind="FormatException",e}(da),QF=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},nr;(function(r){r[r.Cp437=0]="Cp437",r[r.ISO8859_1=1]="ISO8859_1",r[r.ISO8859_2=2]="ISO8859_2",r[r.ISO8859_3=3]="ISO8859_3",r[r.ISO8859_4=4]="ISO8859_4",r[r.ISO8859_5=5]="ISO8859_5",r[r.ISO8859_6=6]="ISO8859_6",r[r.ISO8859_7=7]="ISO8859_7",r[r.ISO8859_8=8]="ISO8859_8",r[r.ISO8859_9=9]="ISO8859_9",r[r.ISO8859_10=10]="ISO8859_10",r[r.ISO8859_11=11]="ISO8859_11",r[r.ISO8859_13=12]="ISO8859_13",r[r.ISO8859_14=13]="ISO8859_14",r[r.ISO8859_15=14]="ISO8859_15",r[r.ISO8859_16=15]="ISO8859_16",r[r.SJIS=16]="SJIS",r[r.Cp1250=17]="Cp1250",r[r.Cp1251=18]="Cp1251",r[r.Cp1252=19]="Cp1252",r[r.Cp1256=20]="Cp1256",r[r.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",r[r.UTF8=22]="UTF8",r[r.ASCII=23]="ASCII",r[r.Big5=24]="Big5",r[r.GB18030=25]="GB18030",r[r.EUC_KR=26]="EUC_KR"})(nr||(nr={}));var an=function(){function r(e,t,n){for(var a,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];this.valueIdentifier=e,this.name=n,typeof t=="number"?this.values=Int32Array.from([t]):this.values=t,this.otherEncodingNames=o,r.VALUE_IDENTIFIER_TO_ECI.set(e,this),r.NAME_TO_ECI.set(n,this);for(var l=this.values,u=0,d=l.length;u!==d;u++){var f=l[u];r.VALUES_TO_ECI.set(f,this)}try{for(var h=QF(o),p=h.next();!p.done;p=h.next()){var g=p.value;r.NAME_TO_ECI.set(g,this)}}catch(v){a={error:v}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}}return r.prototype.getValueIdentifier=function(){return this.valueIdentifier},r.prototype.getName=function(){return this.name},r.prototype.getValue=function(){return this.values[0]},r.getCharacterSetECIByValue=function(e){if(e<0||e>=900)throw new ke("incorect value");var t=r.VALUES_TO_ECI.get(e);if(t===void 0)throw new ke("incorect value");return t},r.getCharacterSetECIByName=function(e){var t=r.NAME_TO_ECI.get(e);if(t===void 0)throw new ke("incorect value");return t},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.getName()===t.getName()},r.VALUE_IDENTIFIER_TO_ECI=new Map,r.VALUES_TO_ECI=new Map,r.NAME_TO_ECI=new Map,r.Cp437=new r(nr.Cp437,Int32Array.from([0,2]),"Cp437"),r.ISO8859_1=new r(nr.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),r.ISO8859_2=new r(nr.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),r.ISO8859_3=new r(nr.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),r.ISO8859_4=new r(nr.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),r.ISO8859_5=new r(nr.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),r.ISO8859_6=new r(nr.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),r.ISO8859_7=new r(nr.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),r.ISO8859_8=new r(nr.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),r.ISO8859_9=new r(nr.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),r.ISO8859_10=new r(nr.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),r.ISO8859_11=new r(nr.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),r.ISO8859_13=new r(nr.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),r.ISO8859_14=new r(nr.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),r.ISO8859_15=new r(nr.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),r.ISO8859_16=new r(nr.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),r.SJIS=new r(nr.SJIS,20,"SJIS","Shift_JIS"),r.Cp1250=new r(nr.Cp1250,21,"Cp1250","windows-1250"),r.Cp1251=new r(nr.Cp1251,22,"Cp1251","windows-1251"),r.Cp1252=new r(nr.Cp1252,23,"Cp1252","windows-1252"),r.Cp1256=new r(nr.Cp1256,24,"Cp1256","windows-1256"),r.UnicodeBigUnmarked=new r(nr.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),r.UTF8=new r(nr.UTF8,26,"UTF8","UTF-8"),r.ASCII=new r(nr.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),r.Big5=new r(nr.Big5,28,"Big5"),r.GB18030=new r(nr.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),r.EUC_KR=new r(nr.EUC_KR,30,"EUC_KR","EUC-KR"),r}(),ZF=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ef=function(r){ZF(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="UnsupportedOperationException",e}(da),Va=function(){function r(){}return r.decode=function(e,t){var n=this.encodingName(t);return this.customDecoder?this.customDecoder(e,n):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(n)?this.decodeFallback(e,n):new TextDecoder(n).decode(e)},r.shouldDecodeOnFallback=function(e){return!r.isBrowser()&&e==="ISO-8859-1"},r.encode=function(e,t){var n=this.encodingName(t);return this.customEncoder?this.customEncoder(e,n):typeof TextEncoder>"u"?this.encodeFallback(e):new TextEncoder().encode(e)},r.isBrowser=function(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"},r.encodingName=function(e){return typeof e=="string"?e:e.getName()},r.encodingCharacterSet=function(e){return e instanceof an?e:an.getCharacterSetECIByName(e)},r.decodeFallback=function(e,t){var n=this.encodingCharacterSet(t);if(r.isDecodeFallbackSupported(n)){for(var a="",i=0,o=e.length;i<o;i++){var s=e[i].toString(16);s.length<2&&(s="0"+s),a+="%"+s}return decodeURIComponent(a)}if(n.equals(an.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(e.buffer));throw new Ef("Encoding "+this.encodingName(t)+" not supported by fallback.")},r.isDecodeFallbackSupported=function(e){return e.equals(an.UTF8)||e.equals(an.ISO8859_1)||e.equals(an.ASCII)},r.encodeFallback=function(e){for(var t=btoa(unescape(encodeURIComponent(e))),n=t.split(""),a=[],i=0;i<n.length;i++)a.push(n[i].charCodeAt(0));return new Uint8Array(a)},r}(),Bt=function(){function r(){}return r.castAsNonUtf8Char=function(e,t){t===void 0&&(t=null);var n=t?t.getName():this.ISO88591;return Va.decode(new Uint8Array([e]),n)},r.guessEncoding=function(e,t){if(t!=null&&t.get(gr.CHARACTER_SET)!==void 0)return t.get(gr.CHARACTER_SET).toString();for(var n=e.length,a=!0,i=!0,o=!0,s=0,l=0,u=0,d=0,f=0,h=0,p=0,g=0,v=0,b=0,y=0,C=e.length>3&&e[0]===239&&e[1]===187&&e[2]===191,S=0;S<n&&(a||i||o);S++){var j=e[S]&255;o&&(s>0?j&128?s--:o=!1:j&128&&(j&64?(s++,j&32?(s++,j&16?(s++,j&8?o=!1:d++):u++):l++):o=!1)),a&&(j>127&&j<160?a=!1:j>159&&(j<192||j===215||j===247)&&y++),i&&(f>0?j<64||j===127||j>252?i=!1:f--:j===128||j===160||j>239?i=!1:j>160&&j<224?(h++,g=0,p++,p>v&&(v=p)):j>127?(f++,p=0,g++,g>b&&(b=g)):(p=0,g=0))}return o&&s>0&&(o=!1),i&&f>0&&(i=!1),o&&(C||l+u+d>0)?r.UTF8:i&&(r.ASSUME_SHIFT_JIS||v>=3||b>=3)?r.SHIFT_JIS:a&&i?v===2&&h===2||y*10>=n?r.SHIFT_JIS:r.ISO88591:a?r.ISO88591:i?r.SHIFT_JIS:o?r.UTF8:r.PLATFORM_DEFAULT_ENCODING},r.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a=-1;function i(s,l,u,d,f,h){if(s==="%%")return"%";if(t[++a]!==void 0){s=d?parseInt(d.substr(1)):void 0;var p=f?parseInt(f.substr(1)):void 0,g;switch(h){case"s":g=t[a];break;case"c":g=t[a][0];break;case"f":g=parseFloat(t[a]).toFixed(s);break;case"p":g=parseFloat(t[a]).toPrecision(s);break;case"e":g=parseFloat(t[a]).toExponential(s);break;case"x":g=parseInt(t[a]).toString(p||16);break;case"d":g=parseFloat(parseInt(t[a],p||10).toPrecision(s)).toFixed(0);break}g=typeof g=="object"?JSON.stringify(g):(+g).toString(p);for(var v=parseInt(u),b=u&&u[0]+""=="0"?"0":" ";g.length<v;)g=l!==void 0?g+b:b+g;return g}}var o=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(o,i)},r.getBytes=function(e,t){return Va.encode(e,t)},r.getCharCode=function(e,t){return t===void 0&&(t=0),e.charCodeAt(t)},r.getCharAt=function(e){return String.fromCharCode(e)},r.SHIFT_JIS=an.SJIS.getName(),r.GB2312="GB2312",r.ISO88591=an.ISO8859_1.getName(),r.EUC_JP="EUC_JP",r.UTF8=an.UTF8.getName(),r.PLATFORM_DEFAULT_ENCODING=r.UTF8,r.ASSUME_SHIFT_JIS=!1,r}(),Pt=function(){function r(e){e===void 0&&(e=""),this.value=e}return r.prototype.enableDecoding=function(e){return this.encoding=e,this},r.prototype.append=function(e){return typeof e=="string"?this.value+=e.toString():this.encoding?this.value+=Bt.castAsNonUtf8Char(e,this.encoding):this.value+=String.fromCharCode(e),this},r.prototype.appendChars=function(e,t,n){for(var a=t;t<t+n;a++)this.append(e[a]);return this},r.prototype.length=function(){return this.value.length},r.prototype.charAt=function(e){return this.value.charAt(e)},r.prototype.deleteCharAt=function(e){this.value=this.value.substr(0,e)+this.value.substring(e+1)},r.prototype.setCharAt=function(e,t){this.value=this.value.substr(0,e)+t+this.value.substr(e+1)},r.prototype.substring=function(e,t){return this.value.substring(e,t)},r.prototype.setLengthToZero=function(){this.value=""},r.prototype.toString=function(){return this.value},r.prototype.insert=function(e,t){this.value=this.value.substring(0,e)+t+this.value.substring(e)},r}(),$i=function(){function r(e,t,n,a){if(this.width=e,this.height=t,this.rowSize=n,this.bits=a,t==null&&(t=e),this.height=t,e<1||t<1)throw new st("Both dimensions must be greater than 0");n==null&&(n=Math.floor((e+31)/32)),this.rowSize=n,a==null&&(this.bits=new Int32Array(this.rowSize*this.height))}return r.parseFromBooleanArray=function(e){for(var t=e.length,n=e[0].length,a=new r(n,t),i=0;i<t;i++)for(var o=e[i],s=0;s<n;s++)o[s]&&a.set(s,i);return a},r.parseFromString=function(e,t,n){if(e===null)throw new st("stringRepresentation cannot be null");for(var a=new Array(e.length),i=0,o=0,s=-1,l=0,u=0;u<e.length;)if(e.charAt(u)===`
`||e.charAt(u)==="\r"){if(i>o){if(s===-1)s=i-o;else if(i-o!==s)throw new st("row lengths do not match");o=i,l++}u++}else if(e.substring(u,u+t.length)===t)u+=t.length,a[i]=!0,i++;else if(e.substring(u,u+n.length)===n)u+=n.length,a[i]=!1,i++;else throw new st("illegal character encountered: "+e.substring(u));if(i>o){if(s===-1)s=i-o;else if(i-o!==s)throw new st("row lengths do not match");l++}for(var d=new r(s,l),f=0;f<i;f++)a[f]&&d.set(Math.floor(f%s),Math.floor(f/s));return d},r.prototype.get=function(e,t){var n=t*this.rowSize+Math.floor(e/32);return(this.bits[n]>>>(e&31)&1)!==0},r.prototype.set=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]|=1<<(e&31)&4294967295},r.prototype.unset=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]&=~(1<<(e&31)&4294967295)},r.prototype.flip=function(e,t){var n=t*this.rowSize+Math.floor(e/32);this.bits[n]^=1<<(e&31)&4294967295},r.prototype.xor=function(e){if(this.width!==e.getWidth()||this.height!==e.getHeight()||this.rowSize!==e.getRowSize())throw new st("input matrix dimensions do not match");for(var t=new vn(Math.floor(this.width/32)+1),n=this.rowSize,a=this.bits,i=0,o=this.height;i<o;i++)for(var s=i*n,l=e.getRow(i,t).getBitArray(),u=0;u<n;u++)a[s+u]^=l[u]},r.prototype.clear=function(){for(var e=this.bits,t=e.length,n=0;n<t;n++)e[n]=0},r.prototype.setRegion=function(e,t,n,a){if(t<0||e<0)throw new st("Left and top must be nonnegative");if(a<1||n<1)throw new st("Height and width must be at least 1");var i=e+n,o=t+a;if(o>this.height||i>this.width)throw new st("The region must fit inside the matrix");for(var s=this.rowSize,l=this.bits,u=t;u<o;u++)for(var d=u*s,f=e;f<i;f++)l[d+Math.floor(f/32)]|=1<<(f&31)&4294967295},r.prototype.getRow=function(e,t){t==null||t.getSize()<this.width?t=new vn(this.width):t.clear();for(var n=this.rowSize,a=this.bits,i=e*n,o=0;o<n;o++)t.setBulk(o*32,a[i+o]);return t},r.prototype.setRow=function(e,t){mr.arraycopy(t.getBitArray(),0,this.bits,e*this.rowSize,this.rowSize)},r.prototype.rotate180=function(){for(var e=this.getWidth(),t=this.getHeight(),n=new vn(e),a=new vn(e),i=0,o=Math.floor((t+1)/2);i<o;i++)n=this.getRow(i,n),a=this.getRow(t-1-i,a),n.reverse(),a.reverse(),this.setRow(i,a),this.setRow(t-1-i,n)},r.prototype.getEnclosingRectangle=function(){for(var e=this.width,t=this.height,n=this.rowSize,a=this.bits,i=e,o=t,s=-1,l=-1,u=0;u<t;u++)for(var d=0;d<n;d++){var f=a[u*n+d];if(f!==0){if(u<o&&(o=u),u>l&&(l=u),d*32<i){for(var h=0;!(f<<31-h&4294967295);)h++;d*32+h<i&&(i=d*32+h)}if(d*32+31>s){for(var h=31;!(f>>>h);)h--;d*32+h>s&&(s=d*32+h)}}}return s<i||l<o?null:Int32Array.from([i,o,s-i+1,l-o+1])},r.prototype.getTopLeftOnBit=function(){for(var e=this.rowSize,t=this.bits,n=0;n<t.length&&t[n]===0;)n++;if(n===t.length)return null;for(var a=n/e,i=n%e*32,o=t[n],s=0;!(o<<31-s&4294967295);)s++;return i+=s,Int32Array.from([i,a])},r.prototype.getBottomRightOnBit=function(){for(var e=this.rowSize,t=this.bits,n=t.length-1;n>=0&&t[n]===0;)n--;if(n<0)return null;for(var a=Math.floor(n/e),i=Math.floor(n%e)*32,o=t[n],s=31;!(o>>>s);)s--;return i+=s,Int32Array.from([i,a])},r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.getRowSize=function(){return this.rowSize},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.width===t.width&&this.height===t.height&&this.rowSize===t.rowSize&&on.equals(this.bits,t.bits)},r.prototype.hashCode=function(){var e=this.width;return e=31*e+this.width,e=31*e+this.height,e=31*e+this.rowSize,e=31*e+on.hashCode(this.bits),e},r.prototype.toString=function(e,t,n){return e===void 0&&(e="X "),t===void 0&&(t="  "),n===void 0&&(n=`
`),this.buildToString(e,t,n)},r.prototype.buildToString=function(e,t,n){for(var a=new Pt,i=0,o=this.height;i<o;i++){for(var s=0,l=this.width;s<l;s++)a.append(this.get(s,i)?e:t);a.append(n)}return a.toString()},r.prototype.clone=function(){return new r(this.width,this.height,this.rowSize,this.bits.slice())},r}(),JF=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ce=function(r){JF(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.getNotFoundInstance=function(){return new e},e.kind="NotFoundException",e}(da),eB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),tB=function(r){eB(e,r);function e(t){var n=r.call(this,t)||this;return n.luminances=e.EMPTY,n.buckets=new Int32Array(e.LUMINANCE_BUCKETS),n}return e.prototype.getBlackRow=function(t,n){var a=this.getLuminanceSource(),i=a.getWidth();n==null||n.getSize()<i?n=new vn(i):n.clear(),this.initArrays(i);for(var o=a.getRow(t,this.luminances),s=this.buckets,l=0;l<i;l++)s[(o[l]&255)>>e.LUMINANCE_SHIFT]++;var u=e.estimateBlackPoint(s);if(i<3)for(var l=0;l<i;l++)(o[l]&255)<u&&n.set(l);else for(var d=o[0]&255,f=o[1]&255,l=1;l<i-1;l++){var h=o[l+1]&255;(f*4-d-h)/2<u&&n.set(l),d=f,f=h}return n},e.prototype.getBlackMatrix=function(){var t=this.getLuminanceSource(),n=t.getWidth(),a=t.getHeight(),i=new $i(n,a);this.initArrays(n);for(var o=this.buckets,s=1;s<5;s++)for(var l=Math.floor(a*s/5),u=t.getRow(l,this.luminances),d=Math.floor(n*4/5),f=Math.floor(n/5);f<d;f++){var h=u[f]&255;o[h>>e.LUMINANCE_SHIFT]++}for(var p=e.estimateBlackPoint(o),g=t.getMatrix(),s=0;s<a;s++)for(var v=s*n,f=0;f<n;f++){var h=g[v+f]&255;h<p&&i.set(f,s)}return i},e.prototype.createBinarizer=function(t){return new e(t)},e.prototype.initArrays=function(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));for(var n=this.buckets,a=0;a<e.LUMINANCE_BUCKETS;a++)n[a]=0},e.estimateBlackPoint=function(t){for(var n=t.length,a=0,i=0,o=0,s=0;s<n;s++)t[s]>o&&(i=s,o=t[s]),t[s]>a&&(a=t[s]);for(var l=0,u=0,s=0;s<n;s++){var d=s-i,f=t[s]*d*d;f>u&&(l=s,u=f)}if(i>l){var h=i;i=l,l=h}if(l-i<=n/16)throw new Ce;for(var p=l-1,g=-1,s=l-1;s>i;s--){var v=s-i,f=v*v*(l-s)*(a-t[s]);f>g&&(p=s,g=f)}return p<<e.LUMINANCE_SHIFT},e.LUMINANCE_BITS=5,e.LUMINANCE_SHIFT=8-e.LUMINANCE_BITS,e.LUMINANCE_BUCKETS=1<<e.LUMINANCE_BITS,e.EMPTY=Uint8ClampedArray.from([0]),e}(WF),rB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),N4=function(r){rB(e,r);function e(t){var n=r.call(this,t)||this;return n.matrix=null,n}return e.prototype.getBlackMatrix=function(){if(this.matrix!==null)return this.matrix;var t=this.getLuminanceSource(),n=t.getWidth(),a=t.getHeight();if(n>=e.MINIMUM_DIMENSION&&a>=e.MINIMUM_DIMENSION){var i=t.getMatrix(),o=n>>e.BLOCK_SIZE_POWER;n&e.BLOCK_SIZE_MASK&&o++;var s=a>>e.BLOCK_SIZE_POWER;a&e.BLOCK_SIZE_MASK&&s++;var l=e.calculateBlackPoints(i,o,s,n,a),u=new $i(n,a);e.calculateThresholdForBlock(i,o,s,n,a,l,u),this.matrix=u}else this.matrix=r.prototype.getBlackMatrix.call(this);return this.matrix},e.prototype.createBinarizer=function(t){return new e(t)},e.calculateThresholdForBlock=function(t,n,a,i,o,s,l){for(var u=o-e.BLOCK_SIZE,d=i-e.BLOCK_SIZE,f=0;f<a;f++){var h=f<<e.BLOCK_SIZE_POWER;h>u&&(h=u);for(var p=e.cap(f,2,a-3),g=0;g<n;g++){var v=g<<e.BLOCK_SIZE_POWER;v>d&&(v=d);for(var b=e.cap(g,2,n-3),y=0,C=-2;C<=2;C++){var S=s[p+C];y+=S[b-2]+S[b-1]+S[b]+S[b+1]+S[b+2]}var j=y/25;e.thresholdBlock(t,v,h,j,i,l)}}},e.cap=function(t,n,a){return t<n?n:t>a?a:t},e.thresholdBlock=function(t,n,a,i,o,s){for(var l=0,u=a*o+n;l<e.BLOCK_SIZE;l++,u+=o)for(var d=0;d<e.BLOCK_SIZE;d++)(t[u+d]&255)<=i&&s.set(n+d,a+l)},e.calculateBlackPoints=function(t,n,a,i,o){for(var s=o-e.BLOCK_SIZE,l=i-e.BLOCK_SIZE,u=new Array(a),d=0;d<a;d++){u[d]=new Int32Array(n);var f=d<<e.BLOCK_SIZE_POWER;f>s&&(f=s);for(var h=0;h<n;h++){var p=h<<e.BLOCK_SIZE_POWER;p>l&&(p=l);for(var g=0,v=255,b=0,y=0,C=f*i+p;y<e.BLOCK_SIZE;y++,C+=i){for(var S=0;S<e.BLOCK_SIZE;S++){var j=t[C+S]&255;g+=j,j<v&&(v=j),j>b&&(b=j)}if(b-v>e.MIN_DYNAMIC_RANGE)for(y++,C+=i;y<e.BLOCK_SIZE;y++,C+=i)for(var S=0;S<e.BLOCK_SIZE;S++)g+=t[C+S]&255}var D=g>>e.BLOCK_SIZE_POWER*2;if(b-v<=e.MIN_DYNAMIC_RANGE&&(D=v/2,d>0&&h>0)){var F=(u[d-1][h]+2*u[d][h-1]+u[d-1][h-1])/4;v<F&&(D=F)}u[d][h]=D}}return u},e.BLOCK_SIZE_POWER=3,e.BLOCK_SIZE=1<<e.BLOCK_SIZE_POWER,e.BLOCK_SIZE_MASK=e.BLOCK_SIZE-1,e.MINIMUM_DIMENSION=e.BLOCK_SIZE*5,e.MIN_DYNAMIC_RANGE=24,e}(tB),Ku=function(){function r(e,t){this.width=e,this.height=t}return r.prototype.getWidth=function(){return this.width},r.prototype.getHeight=function(){return this.height},r.prototype.isCropSupported=function(){return!1},r.prototype.crop=function(e,t,n,a){throw new Ef("This luminance source does not support cropping.")},r.prototype.isRotateSupported=function(){return!1},r.prototype.rotateCounterClockwise=function(){throw new Ef("This luminance source does not support rotation by 90 degrees.")},r.prototype.rotateCounterClockwise45=function(){throw new Ef("This luminance source does not support rotation by 45 degrees.")},r.prototype.toString=function(){for(var e=new Uint8ClampedArray(this.width),t=new Pt,n=0;n<this.height;n++){for(var a=this.getRow(n,e),i=0;i<this.width;i++){var o=a[i]&255,s=void 0;o<64?s="#":o<128?s="+":o<192?s=".":s=" ",t.append(s)}t.append(`
`)}return t.toString()},r}(),nB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),zh=function(r){nB(e,r);function e(t){var n=r.call(this,t.getWidth(),t.getHeight())||this;return n.delegate=t,n}return e.prototype.getRow=function(t,n){for(var a=this.delegate.getRow(t,n),i=this.getWidth(),o=0;o<i;o++)a[o]=255-(a[o]&255);return a},e.prototype.getMatrix=function(){for(var t=this.delegate.getMatrix(),n=this.getWidth()*this.getHeight(),a=new Uint8ClampedArray(n),i=0;i<n;i++)a[i]=255-(t[i]&255);return a},e.prototype.isCropSupported=function(){return this.delegate.isCropSupported()},e.prototype.crop=function(t,n,a,i){return new e(this.delegate.crop(t,n,a,i))},e.prototype.isRotateSupported=function(){return this.delegate.isRotateSupported()},e.prototype.invert=function(){return this.delegate},e.prototype.rotateCounterClockwise=function(){return new e(this.delegate.rotateCounterClockwise())},e.prototype.rotateCounterClockwise45=function(){return new e(this.delegate.rotateCounterClockwise45())},e}(Ku),aB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),iB=function(r){aB(e,r);function e(t,n){n===void 0&&(n=!1);var a=r.call(this,t.width,t.height)||this;return a.canvas=t,a.tempCanvasElement=null,a.buffer=e.makeBufferFromCanvasImageData(t,n),a}return e.makeBufferFromCanvasImageData=function(t,n){n===void 0&&(n=!1);var a=t.getContext("2d").getImageData(0,0,t.width,t.height);return e.toGrayscaleBuffer(a.data,t.width,t.height,n)},e.toGrayscaleBuffer=function(t,n,a,i){i===void 0&&(i=!1);var o=new Uint8ClampedArray(n*a);if(e.FRAME_INDEX=!e.FRAME_INDEX,e.FRAME_INDEX||!i)for(var s=0,l=0,u=t.length;s<u;s+=4,l++){var d=void 0,f=t[s+3];if(f===0)d=255;else{var h=t[s],p=t[s+1],g=t[s+2];d=306*h+601*p+117*g+512>>10}o[l]=d}else for(var s=0,l=0,v=t.length;s<v;s+=4,l++){var d=void 0,f=t[s+3];if(f===0)d=255;else{var h=t[s],p=t[s+1],g=t[s+2];d=306*h+601*p+117*g+512>>10}o[l]=255-d}return o},e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new st("Requested row is outside the image: "+t);var a=this.getWidth(),i=t*a;return n===null?n=this.buffer.slice(i,i+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(i,i+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,a,i){return r.prototype.crop.call(this,t,n,a,i),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement},e.prototype.rotate=function(t){var n=this.getTempCanvasElement(),a=n.getContext("2d"),i=t*e.DEGREE_TO_RADIANS,o=this.canvas.width,s=this.canvas.height,l=Math.ceil(Math.abs(Math.cos(i))*o+Math.abs(Math.sin(i))*s),u=Math.ceil(Math.abs(Math.sin(i))*o+Math.abs(Math.cos(i))*s);return n.width=l,n.height=u,a.translate(l/2,u/2),a.rotate(i),a.drawImage(this.canvas,o/-2,s/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.prototype.invert=function(){return new zh(this)},e.DEGREE_TO_RADIANS=Math.PI/180,e.FRAME_INDEX=!0,e}(Ku),oB=function(){function r(e,t,n){this.deviceId=e,this.label=t,this.kind="videoinput",this.groupId=n||void 0}return r.prototype.toJSON=function(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}},r}(),zn=function(r,e,t,n){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function s(d){try{u(n.next(d))}catch(f){o(f)}}function l(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?i(d.value):a(d.value).then(s,l)}u((n=n.apply(r,e||[])).next())})},Hn=function(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,a&&(i=u[0]&2?a.return:u[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,u[1])).done)return i;switch(a=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,a=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){t.label=u[1];break}if(u[0]===6&&t.label<i[1]){t.label=i[1],i=u;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(u);break}i[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(d){u=[6,d],a=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},sB=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vl=function(){function r(e,t,n){t===void 0&&(t=500),this.reader=e,this.timeBetweenScansMillis=t,this._hints=n,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}return Object.defineProperty(r.prototype,"hasNavigator",{get:function(){return typeof navigator<"u"},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isMediaDevicesSuported",{get:function(){return this.hasNavigator&&!!navigator.mediaDevices},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"canEnumerateDevices",{get:function(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"timeBetweenDecodingAttempts",{get:function(){return this._timeBetweenDecodingAttempts},set:function(e){this._timeBetweenDecodingAttempts=e<0?0:e},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"hints",{get:function(){return this._hints},set:function(e){this._hints=e||null},enumerable:!1,configurable:!0}),r.prototype.listVideoInputDevices=function(){return zn(this,void 0,void 0,function(){var e,t,n,a,i,o,s,l,u,d,f,h;return Hn(this,function(p){switch(p.label){case 0:if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=p.sent(),t=[];try{for(n=sB(e),a=n.next();!a.done;a=n.next())i=a.value,o=i.kind==="video"?"videoinput":i.kind,o==="videoinput"&&(s=i.deviceId||i.id,l=i.label||"Video device "+(t.length+1),u=i.groupId,d={deviceId:s,label:l,kind:o,groupId:u},t.push(d))}catch(g){f={error:g}}finally{try{a&&!a.done&&(h=n.return)&&h.call(n)}finally{if(f)throw f.error}}return[2,t]}})})},r.prototype.getVideoInputDevices=function(){return zn(this,void 0,void 0,function(){var e;return Hn(this,function(t){switch(t.label){case 0:return[4,this.listVideoInputDevices()];case 1:return e=t.sent(),[2,e.map(function(n){return new oB(n.deviceId,n.label)})]}})})},r.prototype.findDeviceById=function(e){return zn(this,void 0,void 0,function(){var t;return Hn(this,function(n){switch(n.label){case 0:return[4,this.listVideoInputDevices()];case 1:return t=n.sent(),t?[2,t.find(function(a){return a.deviceId===e})]:[2,null]}})})},r.prototype.decodeFromInputVideoDevice=function(e,t){return zn(this,void 0,void 0,function(){return Hn(this,function(n){switch(n.label){case 0:return[4,this.decodeOnceFromVideoDevice(e,t)];case 1:return[2,n.sent()]}})})},r.prototype.decodeOnceFromVideoDevice=function(e,t){return zn(this,void 0,void 0,function(){var n,a;return Hn(this,function(i){switch(i.label){case 0:return this.reset(),e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,t)];case 1:return[2,i.sent()]}})})},r.prototype.decodeOnceFromConstraints=function(e,t){return zn(this,void 0,void 0,function(){var n;return Hn(this,function(a){switch(a.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,t)];case 2:return[2,a.sent()]}})})},r.prototype.decodeOnceFromStream=function(e,t){return zn(this,void 0,void 0,function(){var n,a;return Hn(this,function(i){switch(i.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return n=i.sent(),[4,this.decodeOnce(n)];case 2:return a=i.sent(),[2,a]}})})},r.prototype.decodeFromInputVideoDeviceContinuously=function(e,t,n){return zn(this,void 0,void 0,function(){return Hn(this,function(a){switch(a.label){case 0:return[4,this.decodeFromVideoDevice(e,t,n)];case 1:return[2,a.sent()]}})})},r.prototype.decodeFromVideoDevice=function(e,t,n){return zn(this,void 0,void 0,function(){var a,i;return Hn(this,function(o){switch(o.label){case 0:return e?a={deviceId:{exact:e}}:a={facingMode:"environment"},i={video:a},[4,this.decodeFromConstraints(i,t,n)];case 1:return[2,o.sent()]}})})},r.prototype.decodeFromConstraints=function(e,t,n){return zn(this,void 0,void 0,function(){var a;return Hn(this,function(i){switch(i.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return a=i.sent(),[4,this.decodeFromStream(a,t,n)];case 2:return[2,i.sent()]}})})},r.prototype.decodeFromStream=function(e,t,n){return zn(this,void 0,void 0,function(){var a;return Hn(this,function(i){switch(i.label){case 0:return this.reset(),[4,this.attachStreamToVideo(e,t)];case 1:return a=i.sent(),[4,this.decodeContinuously(a,n)];case 2:return[2,i.sent()]}})})},r.prototype.stopAsyncDecode=function(){this._stopAsyncDecode=!0},r.prototype.stopContinuousDecode=function(){this._stopContinuousDecode=!0},r.prototype.attachStreamToVideo=function(e,t){return zn(this,void 0,void 0,function(){var n;return Hn(this,function(a){switch(a.label){case 0:return n=this.prepareVideoElement(t),this.addVideoSource(n,e),this.videoElement=n,this.stream=e,[4,this.playVideoOnLoadAsync(n)];case 1:return a.sent(),[2,n]}})})},r.prototype.playVideoOnLoadAsync=function(e){var t=this;return new Promise(function(n,a){return t.playVideoOnLoad(e,function(){return n()})})},r.prototype.playVideoOnLoad=function(e,t){var n=this;this.videoEndedListener=function(){return n.stopStreams()},this.videoCanPlayListener=function(){return n.tryPlayVideo(e)},e.addEventListener("ended",this.videoEndedListener),e.addEventListener("canplay",this.videoCanPlayListener),e.addEventListener("playing",t),this.tryPlayVideo(e)},r.prototype.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2},r.prototype.tryPlayVideo=function(e){return zn(this,void 0,void 0,function(){return Hn(this,function(t){switch(t.label){case 0:if(this.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,e.play()];case 2:return t.sent(),[3,4];case 3:return t.sent(),console.warn("It was not possible to play the video."),[3,4];case 4:return[2]}})})},r.prototype.getMediaElement=function(e,t){var n=document.getElementById(e);if(!n)throw new kr("element with id '"+e+"' not found");if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new kr("element with id '"+e+"' must be an "+t+" element");return n},r.prototype.decodeFromImage=function(e,t){if(!e&&!t)throw new kr("either imageElement with a src set or an url must be provided");return t&&!e?this.decodeFromImageUrl(t):this.decodeFromImageElement(e)},r.prototype.decodeFromVideo=function(e,t){if(!e&&!t)throw new kr("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrl(t):this.decodeFromVideoElement(e)},r.prototype.decodeFromVideoContinuously=function(e,t,n){if(e===void 0&&t===void 0)throw new kr("Either an element with a src set or an URL must be provided");return t&&!e?this.decodeFromVideoUrlContinuously(t,n):this.decodeFromVideoElementContinuously(e,n)},r.prototype.decodeFromImageElement=function(e){if(!e)throw new kr("An image element must be provided.");this.reset();var t=this.prepareImageElement(e);this.imageElement=t;var n;return this.isImageLoaded(t)?n=this.decodeOnce(t,!1,!0):n=this._decodeOnLoadImage(t),n},r.prototype.decodeFromVideoElement=function(e){var t=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideo(t)},r.prototype.decodeFromVideoElementContinuously=function(e,t){var n=this._decodeFromVideoElementSetup(e);return this._decodeOnLoadVideoContinuously(n,t)},r.prototype._decodeFromVideoElementSetup=function(e){if(!e)throw new kr("A video element must be provided.");this.reset();var t=this.prepareVideoElement(e);return this.videoElement=t,t},r.prototype.decodeFromImageUrl=function(e){if(!e)throw new kr("An URL must be provided.");this.reset();var t=this.prepareImageElement();this.imageElement=t;var n=this._decodeOnLoadImage(t);return t.src=e,n},r.prototype.decodeFromVideoUrl=function(e){if(!e)throw new kr("An URL must be provided.");this.reset();var t=this.prepareVideoElement(),n=this.decodeFromVideoElement(t);return t.src=e,n},r.prototype.decodeFromVideoUrlContinuously=function(e,t){if(!e)throw new kr("An URL must be provided.");this.reset();var n=this.prepareVideoElement(),a=this.decodeFromVideoElementContinuously(n,t);return n.src=e,a},r.prototype._decodeOnLoadImage=function(e){var t=this;return new Promise(function(n,a){t.imageLoadedListener=function(){return t.decodeOnce(e,!1,!0).then(n,a)},e.addEventListener("load",t.imageLoadedListener)})},r.prototype._decodeOnLoadVideo=function(e){return zn(this,void 0,void 0,function(){return Hn(this,function(t){switch(t.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return t.sent(),[4,this.decodeOnce(e)];case 2:return[2,t.sent()]}})})},r.prototype._decodeOnLoadVideoContinuously=function(e,t){return zn(this,void 0,void 0,function(){return Hn(this,function(n){switch(n.label){case 0:return[4,this.playVideoOnLoadAsync(e)];case 1:return n.sent(),this.decodeContinuously(e,t),[2]}})})},r.prototype.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},r.prototype.prepareImageElement=function(e){var t;return typeof e>"u"&&(t=document.createElement("img"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"img")),e instanceof HTMLImageElement&&(t=e),t},r.prototype.prepareVideoElement=function(e){var t;return!e&&typeof document<"u"&&(t=document.createElement("video"),t.width=200,t.height=200),typeof e=="string"&&(t=this.getMediaElement(e,"video")),e instanceof HTMLVideoElement&&(t=e),t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t},r.prototype.decodeOnce=function(e,t,n){var a=this;t===void 0&&(t=!0),n===void 0&&(n=!0),this._stopAsyncDecode=!1;var i=function(o,s){if(a._stopAsyncDecode){s(new Ce("Video stream has ended before any code could be detected.")),a._stopAsyncDecode=void 0;return}try{var l=a.decode(e);o(l)}catch(h){var u=t&&h instanceof Ce,d=h instanceof Vr||h instanceof ke,f=d&&n;if(u||f)return setTimeout(i,a._timeBetweenDecodingAttempts,o,s);s(h)}};return new Promise(function(o,s){return i(o,s)})},r.prototype.decodeContinuously=function(e,t){var n=this;this._stopContinuousDecode=!1;var a=function(){if(n._stopContinuousDecode){n._stopContinuousDecode=void 0;return}try{var i=n.decode(e);t(i,null),setTimeout(a,n.timeBetweenScansMillis)}catch(l){t(null,l);var o=l instanceof Vr||l instanceof ke,s=l instanceof Ce;(o||s)&&setTimeout(a,n._timeBetweenDecodingAttempts)}};a()},r.prototype.decode=function(e){var t=this.createBinaryBitmap(e);return this.decodeBitmap(t)},r.prototype.createBinaryBitmap=function(e){this.getCaptureCanvasContext(e);var t=!1;e instanceof HTMLVideoElement?(this.drawFrameOnCanvas(e),t=!0):this.drawImageOnCanvas(e);var n=this.getCaptureCanvas(e),a=new iB(n,t),i=new N4(a);return new C4(i)},r.prototype.getCaptureCanvasContext=function(e){if(!this.captureCanvasContext){var t=this.getCaptureCanvas(e),n=void 0;try{n=t.getContext("2d",{willReadFrequently:!0})}catch{n=t.getContext("2d")}this.captureCanvasContext=n}return this.captureCanvasContext},r.prototype.getCaptureCanvas=function(e){if(!this.captureCanvas){var t=this.createCaptureCanvas(e);this.captureCanvas=t}return this.captureCanvas},r.prototype.drawFrameOnCanvas=function(e,t,n){t===void 0&&(t={sx:0,sy:0,sWidth:e.videoWidth,sHeight:e.videoHeight,dx:0,dy:0,dWidth:e.videoWidth,dHeight:e.videoHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},r.prototype.drawImageOnCanvas=function(e,t,n){t===void 0&&(t={sx:0,sy:0,sWidth:e.naturalWidth,sHeight:e.naturalHeight,dx:0,dy:0,dWidth:e.naturalWidth,dHeight:e.naturalHeight}),n===void 0&&(n=this.captureCanvasContext),n.drawImage(e,t.sx,t.sy,t.sWidth,t.sHeight,t.dx,t.dy,t.dWidth,t.dHeight)},r.prototype.decodeBitmap=function(e){return this.reader.decode(e,this._hints)},r.prototype.createCaptureCanvas=function(e){if(typeof document>"u")return this._destroyCaptureCanvas(),null;var t=document.createElement("canvas"),n,a;return typeof e<"u"&&(e instanceof HTMLVideoElement?(n=e.videoWidth,a=e.videoHeight):e instanceof HTMLImageElement&&(n=e.naturalWidth||e.width,a=e.naturalHeight||e.height)),t.style.width=n+"px",t.style.height=a+"px",t.width=n,t.height=a,t},r.prototype.stopStreams=function(){this.stream&&(this.stream.getVideoTracks().forEach(function(e){return e.stop()}),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()},r.prototype.reset=function(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()},r.prototype._destroyVideoElement=function(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)},r.prototype._destroyImageElement=function(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)},r.prototype._destroyCaptureCanvas=function(){this.captureCanvasContext=void 0,this.captureCanvas=void 0},r.prototype.addVideoSource=function(e,t){try{e.srcObject=t}catch{e.src=URL.createObjectURL(t)}},r.prototype.cleanVideoSource=function(e){try{e.srcObject=null}catch{e.src=""}this.videoElement.removeAttribute("src")},r}(),$n=function(){function r(e,t,n,a,i,o){n===void 0&&(n=t==null?0:8*t.length),o===void 0&&(o=mr.currentTimeMillis()),this.text=e,this.rawBytes=t,this.numBits=n,this.resultPoints=a,this.format=i,this.timestamp=o,this.text=e,this.rawBytes=t,n==null?this.numBits=t==null?0:8*t.length:this.numBits=n,this.resultPoints=a,this.format=i,this.resultMetadata=null,o==null?this.timestamp=mr.currentTimeMillis():this.timestamp=o}return r.prototype.getText=function(){return this.text},r.prototype.getRawBytes=function(){return this.rawBytes},r.prototype.getNumBits=function(){return this.numBits},r.prototype.getResultPoints=function(){return this.resultPoints},r.prototype.getBarcodeFormat=function(){return this.format},r.prototype.getResultMetadata=function(){return this.resultMetadata},r.prototype.putMetadata=function(e,t){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(e,t)},r.prototype.putAllMetadata=function(e){e!==null&&(this.resultMetadata===null?this.resultMetadata=e:this.resultMetadata=new Map(e))},r.prototype.addResultPoints=function(e){var t=this.resultPoints;if(t===null)this.resultPoints=e;else if(e!==null&&e.length>0){var n=new Array(t.length+e.length);mr.arraycopy(t,0,n,0,t.length),mr.arraycopy(e,0,n,t.length,e.length),this.resultPoints=n}},r.prototype.getTimestamp=function(){return this.timestamp},r.prototype.toString=function(){return this.text},r}(),jp;(function(r){r[r.AZTEC=0]="AZTEC",r[r.CODABAR=1]="CODABAR",r[r.CODE_39=2]="CODE_39",r[r.CODE_93=3]="CODE_93",r[r.CODE_128=4]="CODE_128",r[r.DATA_MATRIX=5]="DATA_MATRIX",r[r.EAN_8=6]="EAN_8",r[r.EAN_13=7]="EAN_13",r[r.ITF=8]="ITF",r[r.MAXICODE=9]="MAXICODE",r[r.PDF_417=10]="PDF_417",r[r.QR_CODE=11]="QR_CODE",r[r.RSS_14=12]="RSS_14",r[r.RSS_EXPANDED=13]="RSS_EXPANDED",r[r.UPC_A=14]="UPC_A",r[r.UPC_E=15]="UPC_E",r[r.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(jp||(jp={}));const ot=jp;var Pp;(function(r){r[r.OTHER=0]="OTHER",r[r.ORIENTATION=1]="ORIENTATION",r[r.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",r[r.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",r[r.ISSUE_NUMBER=4]="ISSUE_NUMBER",r[r.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",r[r.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",r[r.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",r[r.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",r[r.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",r[r.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Pp||(Pp={}));const En=Pp;var Hh=function(){function r(e,t,n,a,i,o){i===void 0&&(i=-1),o===void 0&&(o=-1),this.rawBytes=e,this.text=t,this.byteSegments=n,this.ecLevel=a,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=o,this.numBits=e==null?0:8*e.length}return r.prototype.getRawBytes=function(){return this.rawBytes},r.prototype.getNumBits=function(){return this.numBits},r.prototype.setNumBits=function(e){this.numBits=e},r.prototype.getText=function(){return this.text},r.prototype.getByteSegments=function(){return this.byteSegments},r.prototype.getECLevel=function(){return this.ecLevel},r.prototype.getErrorsCorrected=function(){return this.errorsCorrected},r.prototype.setErrorsCorrected=function(e){this.errorsCorrected=e},r.prototype.getErasures=function(){return this.erasures},r.prototype.setErasures=function(e){this.erasures=e},r.prototype.getOther=function(){return this.other},r.prototype.setOther=function(e){this.other=e},r.prototype.hasStructuredAppend=function(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0},r.prototype.getStructuredAppendParity=function(){return this.structuredAppendParity},r.prototype.getStructuredAppendSequenceNumber=function(){return this.structuredAppendSequenceNumber},r}(),lu=function(){function r(){}return r.prototype.exp=function(e){return this.expTable[e]},r.prototype.log=function(e){if(e===0)throw new st;return this.logTable[e]},r.addOrSubtract=function(e,t){return e^t},r}(),Vo=function(){function r(e,t){if(t.length===0)throw new st;this.field=e;var n=t.length;if(n>1&&t[0]===0){for(var a=1;a<n&&t[a]===0;)a++;a===n?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(n-a),mr.arraycopy(t,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return r.prototype.getCoefficients=function(){return this.coefficients},r.prototype.getDegree=function(){return this.coefficients.length-1},r.prototype.isZero=function(){return this.coefficients[0]===0},r.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},r.prototype.evaluateAt=function(e){if(e===0)return this.getCoefficient(0);var t=this.coefficients,n;if(e===1){n=0;for(var a=0,i=t.length;a!==i;a++){var o=t[a];n=lu.addOrSubtract(n,o)}return n}n=t[0];for(var s=t.length,l=this.field,a=1;a<s;a++)n=lu.addOrSubtract(l.multiply(e,n),t[a]);return n},r.prototype.addOrSubtract=function(e){if(!this.field.equals(e.field))throw new st("GenericGFPolys do not have same GenericGF field");if(this.isZero())return e;if(e.isZero())return this;var t=this.coefficients,n=e.coefficients;if(t.length>n.length){var a=t;t=n,n=a}var i=new Int32Array(n.length),o=n.length-t.length;mr.arraycopy(n,0,i,0,o);for(var s=o;s<n.length;s++)i[s]=lu.addOrSubtract(t[s-o],n[s]);return new r(this.field,i)},r.prototype.multiply=function(e){if(!this.field.equals(e.field))throw new st("GenericGFPolys do not have same GenericGF field");if(this.isZero()||e.isZero())return this.field.getZero();for(var t=this.coefficients,n=t.length,a=e.coefficients,i=a.length,o=new Int32Array(n+i-1),s=this.field,l=0;l<n;l++)for(var u=t[l],d=0;d<i;d++)o[l+d]=lu.addOrSubtract(o[l+d],s.multiply(u,a[d]));return new r(s,o)},r.prototype.multiplyScalar=function(e){if(e===0)return this.field.getZero();if(e===1)return this;for(var t=this.coefficients.length,n=this.field,a=new Int32Array(t),i=this.coefficients,o=0;o<t;o++)a[o]=n.multiply(i[o],e);return new r(n,a)},r.prototype.multiplyByMonomial=function(e,t){if(e<0)throw new st;if(t===0)return this.field.getZero();for(var n=this.coefficients,a=n.length,i=new Int32Array(a+e),o=this.field,s=0;s<a;s++)i[s]=o.multiply(n[s],t);return new r(o,i)},r.prototype.divide=function(e){if(!this.field.equals(e.field))throw new st("GenericGFPolys do not have same GenericGF field");if(e.isZero())throw new st("Divide by 0");for(var t=this.field,n=t.getZero(),a=this,i=e.getCoefficient(e.getDegree()),o=t.inverse(i);a.getDegree()>=e.getDegree()&&!a.isZero();){var s=a.getDegree()-e.getDegree(),l=t.multiply(a.getCoefficient(a.getDegree()),o),u=e.multiplyByMonomial(s,l),d=t.buildMonomial(s,l);n=n.addOrSubtract(d),a=a.addOrSubtract(u)}return[n,a]},r.prototype.toString=function(){for(var e="",t=this.getDegree();t>=0;t--){var n=this.getCoefficient(t);if(n!==0){if(n<0?(e+=" - ",n=-n):e.length>0&&(e+=" + "),t===0||n!==1){var a=this.field.log(n);a===0?e+="1":a===1?e+="a":(e+="a^",e+=a)}t!==0&&(t===1?e+="x":(e+="x^",e+=t))}}return e},r}(),cB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),S4=function(r){cB(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ArithmeticException",e}(da),lB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),aa=function(r){lB(e,r);function e(t,n,a){var i=r.call(this)||this;i.primitive=t,i.size=n,i.generatorBase=a;for(var o=new Int32Array(n),s=1,l=0;l<n;l++)o[l]=s,s*=2,s>=n&&(s^=t,s&=n-1);i.expTable=o;for(var u=new Int32Array(n),l=0;l<n-1;l++)u[o[l]]=l;return i.logTable=u,i.zero=new Vo(i,Int32Array.from([0])),i.one=new Vo(i,Int32Array.from([1])),i}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(t,n){if(t<0)throw new st;if(n===0)return this.zero;var a=new Int32Array(t+1);return a[0]=n,new Vo(this,a)},e.prototype.inverse=function(t){if(t===0)throw new S4;return this.expTable[this.size-this.logTable[t]-1]},e.prototype.multiply=function(t,n){return t===0||n===0?0:this.expTable[(this.logTable[t]+this.logTable[n])%(this.size-1)]},e.prototype.getSize=function(){return this.size},e.prototype.getGeneratorBase=function(){return this.generatorBase},e.prototype.toString=function(){return"GF(0x"+Tt.toHexString(this.primitive)+","+this.size+")"},e.prototype.equals=function(t){return t===this},e.AZTEC_DATA_12=new e(4201,4096,1),e.AZTEC_DATA_10=new e(1033,1024,1),e.AZTEC_DATA_6=new e(67,64,1),e.AZTEC_PARAM=new e(19,16,1),e.QR_CODE_FIELD_256=new e(285,256,0),e.DATA_MATRIX_FIELD_256=new e(301,256,1),e.AZTEC_DATA_8=e.DATA_MATRIX_FIELD_256,e.MAXICODE_FIELD_64=e.AZTEC_DATA_6,e}(lu),uB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),of=function(r){uB(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ReedSolomonException",e}(da),dB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Xu=function(r){dB(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="IllegalStateException",e}(da),Wh=function(){function r(e){this.field=e}return r.prototype.decode=function(e,t){for(var n=this.field,a=new Vo(n,e),i=new Int32Array(t),o=!0,s=0;s<t;s++){var l=a.evaluateAt(n.exp(s+n.getGeneratorBase()));i[i.length-1-s]=l,l!==0&&(o=!1)}if(!o)for(var u=new Vo(n,i),d=this.runEuclideanAlgorithm(n.buildMonomial(t,1),u,t),f=d[0],h=d[1],p=this.findErrorLocations(f),g=this.findErrorMagnitudes(h,p),s=0;s<p.length;s++){var v=e.length-1-n.log(p[s]);if(v<0)throw new of("Bad error location");e[v]=aa.addOrSubtract(e[v],g[s])}},r.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.getDegree()<t.getDegree()){var a=e;e=t,t=a}for(var i=this.field,o=e,s=t,l=i.getZero(),u=i.getOne();s.getDegree()>=(n/2|0);){var d=o,f=l;if(o=s,l=u,o.isZero())throw new of("r_{i-1} was zero");s=d;for(var h=i.getZero(),p=o.getCoefficient(o.getDegree()),g=i.inverse(p);s.getDegree()>=o.getDegree()&&!s.isZero();){var v=s.getDegree()-o.getDegree(),b=i.multiply(s.getCoefficient(s.getDegree()),g);h=h.addOrSubtract(i.buildMonomial(v,b)),s=s.addOrSubtract(o.multiplyByMonomial(v,b))}if(u=h.multiply(l).addOrSubtract(f),s.getDegree()>=o.getDegree())throw new Xu("Division algorithm failed to reduce polynomial?")}var y=u.getCoefficient(0);if(y===0)throw new of("sigmaTilde(0) was zero");var C=i.inverse(y),S=u.multiplyScalar(C),j=s.multiplyScalar(C);return[S,j]},r.prototype.findErrorLocations=function(e){var t=e.getDegree();if(t===1)return Int32Array.from([e.getCoefficient(1)]);for(var n=new Int32Array(t),a=0,i=this.field,o=1;o<i.getSize()&&a<t;o++)e.evaluateAt(o)===0&&(n[a]=i.inverse(o),a++);if(a!==t)throw new of("Error locator degree does not match number of roots");return n},r.prototype.findErrorMagnitudes=function(e,t){for(var n=t.length,a=new Int32Array(n),i=this.field,o=0;o<n;o++){for(var s=i.inverse(t[o]),l=1,u=0;u<n;u++)if(o!==u){var d=i.multiply(t[u],s),f=d&1?d&-2:d|1;l=i.multiply(l,f)}a[o]=i.multiply(e.evaluateAt(s),i.inverse(l)),i.getGeneratorBase()!==0&&(a[o]=i.multiply(a[o],s))}return a},r}(),Nn;(function(r){r[r.UPPER=0]="UPPER",r[r.LOWER=1]="LOWER",r[r.MIXED=2]="MIXED",r[r.DIGIT=3]="DIGIT",r[r.PUNCT=4]="PUNCT",r[r.BINARY=5]="BINARY"})(Nn||(Nn={}));var sx=function(){function r(){}return r.prototype.decode=function(e){this.ddata=e;var t=e.getBits(),n=this.extractBits(t),a=this.correctBits(n),i=r.convertBoolArrayToByteArray(a),o=r.getEncodedData(a),s=new Hh(i,o,null,null);return s.setNumBits(a.length),s},r.highLevelDecode=function(e){return this.getEncodedData(e)},r.getEncodedData=function(e){for(var t=e.length,n=Nn.UPPER,a=Nn.UPPER,i="",o=0;o<t;)if(a===Nn.BINARY){if(t-o<5)break;var s=r.readCode(e,o,5);if(o+=5,s===0){if(t-o<11)break;s=r.readCode(e,o,11)+31,o+=11}for(var l=0;l<s;l++){if(t-o<8){o=t;break}var u=r.readCode(e,o,8);i+=Bt.castAsNonUtf8Char(u),o+=8}a=n}else{var d=a===Nn.DIGIT?4:5;if(t-o<d)break;var u=r.readCode(e,o,d);o+=d;var f=r.getCharacter(a,u);f.startsWith("CTRL_")?(n=a,a=r.getTable(f.charAt(5)),f.charAt(6)==="L"&&(n=a)):(i+=f,a=n)}return i},r.getTable=function(e){switch(e){case"L":return Nn.LOWER;case"P":return Nn.PUNCT;case"M":return Nn.MIXED;case"D":return Nn.DIGIT;case"B":return Nn.BINARY;case"U":default:return Nn.UPPER}},r.getCharacter=function(e,t){switch(e){case Nn.UPPER:return r.UPPER_TABLE[t];case Nn.LOWER:return r.LOWER_TABLE[t];case Nn.MIXED:return r.MIXED_TABLE[t];case Nn.PUNCT:return r.PUNCT_TABLE[t];case Nn.DIGIT:return r.DIGIT_TABLE[t];default:throw new Xu("Bad table")}},r.prototype.correctBits=function(e){var t,n;this.ddata.getNbLayers()<=2?(n=6,t=aa.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(n=8,t=aa.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(n=10,t=aa.AZTEC_DATA_10):(n=12,t=aa.AZTEC_DATA_12);var a=this.ddata.getNbDatablocks(),i=e.length/n;if(i<a)throw new ke;for(var o=e.length%n,s=new Int32Array(i),l=0;l<i;l++,o+=n)s[l]=r.readCode(e,o,n);try{var u=new Wh(t);u.decode(s,i-a)}catch(b){throw new ke(b)}for(var d=(1<<n)-1,f=0,l=0;l<a;l++){var h=s[l];if(h===0||h===d)throw new ke;(h===1||h===d-1)&&f++}for(var p=new Array(a*n-f),g=0,l=0;l<a;l++){var h=s[l];if(h===1||h===d-1)p.fill(h>1,g,g+n-1),g+=n-1;else for(var v=n-1;v>=0;--v)p[g++]=(h&1<<v)!==0}return p},r.prototype.extractBits=function(e){var t=this.ddata.isCompact(),n=this.ddata.getNbLayers(),a=(t?11:14)+n*4,i=new Int32Array(a),o=new Array(this.totalBitsInLayer(n,t));if(t)for(var s=0;s<i.length;s++)i[s]=s;else for(var l=a+1+2*Tt.truncDivision(Tt.truncDivision(a,2)-1,15),u=a/2,d=Tt.truncDivision(l,2),s=0;s<u;s++){var f=s+Tt.truncDivision(s,15);i[u-s-1]=d-f-1,i[u+s]=d+f+1}for(var s=0,h=0;s<n;s++){for(var p=(n-s)*4+(t?9:12),g=s*2,v=a-1-g,b=0;b<p;b++)for(var y=b*2,C=0;C<2;C++)o[h+y+C]=e.get(i[g+C],i[g+b]),o[h+2*p+y+C]=e.get(i[g+b],i[v-C]),o[h+4*p+y+C]=e.get(i[v-C],i[v-b]),o[h+6*p+y+C]=e.get(i[v-b],i[g+C]);h+=p*8}return o},r.readCode=function(e,t,n){for(var a=0,i=t;i<t+n;i++)a<<=1,e[i]&&(a|=1);return a},r.readByte=function(e,t){var n=e.length-t;return n>=8?r.readCode(e,t,8):r.readCode(e,t,n)<<8-n},r.convertBoolArrayToByteArray=function(e){for(var t=new Uint8Array((e.length+7)/8),n=0;n<t.length;n++)t[n]=r.readByte(e,8*n);return t},r.prototype.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},r.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],r.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],r.MIXED_TABLE=["CTRL_PS"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~","","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],r.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],r.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"],r}(),Wt=function(){function r(){}return r.round=function(e){return isNaN(e)?0:e<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:e>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:e+(e<0?-.5:.5)|0},r.distance=function(e,t,n,a){var i=e-n,o=t-a;return Math.sqrt(i*i+o*o)},r.sum=function(e){for(var t=0,n=0,a=e.length;n!==a;n++){var i=e[n];t+=i}return t},r}(),Dp=function(){function r(){}return r.floatToIntBits=function(e){return e},r.MAX_VALUE=Number.MAX_SAFE_INTEGER,r}(),Je=function(){function r(e,t){this.x=e,this.y=t}return r.prototype.getX=function(){return this.x},r.prototype.getY=function(){return this.y},r.prototype.equals=function(e){if(e instanceof r){var t=e;return this.x===t.x&&this.y===t.y}return!1},r.prototype.hashCode=function(){return 31*Dp.floatToIntBits(this.x)+Dp.floatToIntBits(this.y)},r.prototype.toString=function(){return"("+this.x+","+this.y+")"},r.orderBestPatterns=function(e){var t=this.distance(e[0],e[1]),n=this.distance(e[1],e[2]),a=this.distance(e[0],e[2]),i,o,s;if(n>=t&&n>=a?(o=e[0],i=e[1],s=e[2]):a>=n&&a>=t?(o=e[1],i=e[0],s=e[2]):(o=e[2],i=e[0],s=e[1]),this.crossProductZ(i,o,s)<0){var l=i;i=s,s=l}e[0]=i,e[1]=o,e[2]=s},r.distance=function(e,t){return Wt.distance(e.x,e.y,t.x,t.y)},r.crossProductZ=function(e,t,n){var a=t.x,i=t.y;return(n.x-a)*(e.y-i)-(n.y-i)*(e.x-a)},r}(),zg=function(){function r(e,t){this.bits=e,this.points=t}return r.prototype.getBits=function(){return this.bits},r.prototype.getPoints=function(){return this.points},r}(),fB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),hB=function(r){fB(e,r);function e(t,n,a,i,o){var s=r.call(this,t,n)||this;return s.compact=a,s.nbDatablocks=i,s.nbLayers=o,s}return e.prototype.getNbLayers=function(){return this.nbLayers},e.prototype.getNbDatablocks=function(){return this.nbDatablocks},e.prototype.isCompact=function(){return this.compact},e}(zg),Ip=function(){function r(e,t,n,a){this.image=e,this.height=e.getHeight(),this.width=e.getWidth(),t==null&&(t=r.INIT_SIZE),n==null&&(n=e.getWidth()/2|0),a==null&&(a=e.getHeight()/2|0);var i=t/2|0;if(this.leftInit=n-i,this.rightInit=n+i,this.upInit=a-i,this.downInit=a+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new Ce}return r.prototype.detect=function(){for(var e=this.leftInit,t=this.rightInit,n=this.upInit,a=this.downInit,i=!1,o=!0,s=!1,l=!1,u=!1,d=!1,f=!1,h=this.width,p=this.height;o;){o=!1;for(var g=!0;(g||!l)&&t<h;)g=this.containsBlackPoint(n,a,t,!1),g?(t++,o=!0,l=!0):l||t++;if(t>=h){i=!0;break}for(var v=!0;(v||!u)&&a<p;)v=this.containsBlackPoint(e,t,a,!0),v?(a++,o=!0,u=!0):u||a++;if(a>=p){i=!0;break}for(var b=!0;(b||!d)&&e>=0;)b=this.containsBlackPoint(n,a,e,!1),b?(e--,o=!0,d=!0):d||e--;if(e<0){i=!0;break}for(var y=!0;(y||!f)&&n>=0;)y=this.containsBlackPoint(e,t,n,!0),y?(n--,o=!0,f=!0):f||n--;if(n<0){i=!0;break}o&&(s=!0)}if(!i&&s){for(var C=t-e,S=null,j=1;S===null&&j<C;j++)S=this.getBlackPointOnSegment(e,a-j,e+j,a);if(S==null)throw new Ce;for(var D=null,j=1;D===null&&j<C;j++)D=this.getBlackPointOnSegment(e,n+j,e+j,n);if(D==null)throw new Ce;for(var F=null,j=1;F===null&&j<C;j++)F=this.getBlackPointOnSegment(t,n+j,t-j,n);if(F==null)throw new Ce;for(var M=null,j=1;M===null&&j<C;j++)M=this.getBlackPointOnSegment(t,a-j,t-j,a);if(M==null)throw new Ce;return this.centerEdges(M,S,F,D)}else throw new Ce},r.prototype.getBlackPointOnSegment=function(e,t,n,a){for(var i=Wt.round(Wt.distance(e,t,n,a)),o=(n-e)/i,s=(a-t)/i,l=this.image,u=0;u<i;u++){var d=Wt.round(e+u*o),f=Wt.round(t+u*s);if(l.get(d,f))return new Je(d,f)}return null},r.prototype.centerEdges=function(e,t,n,a){var i=e.getX(),o=e.getY(),s=t.getX(),l=t.getY(),u=n.getX(),d=n.getY(),f=a.getX(),h=a.getY(),p=r.CORR;return i<this.width/2?[new Je(f-p,h+p),new Je(s+p,l+p),new Je(u-p,d-p),new Je(i+p,o-p)]:[new Je(f+p,h+p),new Je(s+p,l-p),new Je(u-p,d+p),new Je(i-p,o-p)]},r.prototype.containsBlackPoint=function(e,t,n,a){var i=this.image;if(a){for(var o=e;o<=t;o++)if(i.get(o,n))return!0}else for(var s=e;s<=t;s++)if(i.get(n,s))return!0;return!1},r.INIT_SIZE=10,r.CORR=1,r}(),cx=function(){function r(){}return r.checkAndNudgePoints=function(e,t){for(var n=e.getWidth(),a=e.getHeight(),i=!0,o=0;o<t.length&&i;o+=2){var s=Math.floor(t[o]),l=Math.floor(t[o+1]);if(s<-1||s>n||l<-1||l>a)throw new Ce;i=!1,s===-1?(t[o]=0,i=!0):s===n&&(t[o]=n-1,i=!0),l===-1?(t[o+1]=0,i=!0):l===a&&(t[o+1]=a-1,i=!0)}i=!0;for(var o=t.length-2;o>=0&&i;o-=2){var s=Math.floor(t[o]),l=Math.floor(t[o+1]);if(s<-1||s>n||l<-1||l>a)throw new Ce;i=!1,s===-1?(t[o]=0,i=!0):s===n&&(t[o]=n-1,i=!0),l===-1?(t[o+1]=0,i=!0):l===a&&(t[o+1]=a-1,i=!0)}},r}(),E4=function(){function r(e,t,n,a,i,o,s,l,u){this.a11=e,this.a21=t,this.a31=n,this.a12=a,this.a22=i,this.a32=o,this.a13=s,this.a23=l,this.a33=u}return r.quadrilateralToQuadrilateral=function(e,t,n,a,i,o,s,l,u,d,f,h,p,g,v,b){var y=r.quadrilateralToSquare(e,t,n,a,i,o,s,l),C=r.squareToQuadrilateral(u,d,f,h,p,g,v,b);return C.times(y)},r.prototype.transformPoints=function(e){for(var t=e.length,n=this.a11,a=this.a12,i=this.a13,o=this.a21,s=this.a22,l=this.a23,u=this.a31,d=this.a32,f=this.a33,h=0;h<t;h+=2){var p=e[h],g=e[h+1],v=i*p+l*g+f;e[h]=(n*p+o*g+u)/v,e[h+1]=(a*p+s*g+d)/v}},r.prototype.transformPointsWithValues=function(e,t){for(var n=this.a11,a=this.a12,i=this.a13,o=this.a21,s=this.a22,l=this.a23,u=this.a31,d=this.a32,f=this.a33,h=e.length,p=0;p<h;p++){var g=e[p],v=t[p],b=i*g+l*v+f;e[p]=(n*g+o*v+u)/b,t[p]=(a*g+s*v+d)/b}},r.squareToQuadrilateral=function(e,t,n,a,i,o,s,l){var u=e-n+i-s,d=t-a+o-l;if(u===0&&d===0)return new r(n-e,i-n,e,a-t,o-a,t,0,0,1);var f=n-i,h=s-i,p=a-o,g=l-o,v=f*g-h*p,b=(u*g-h*d)/v,y=(f*d-u*p)/v;return new r(n-e+b*n,s-e+y*s,e,a-t+b*a,l-t+y*l,t,b,y,1)},r.quadrilateralToSquare=function(e,t,n,a,i,o,s,l){return r.squareToQuadrilateral(e,t,n,a,i,o,s,l).buildAdjoint()},r.prototype.buildAdjoint=function(){return new r(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)},r.prototype.times=function(e){return new r(this.a11*e.a11+this.a21*e.a12+this.a31*e.a13,this.a11*e.a21+this.a21*e.a22+this.a31*e.a23,this.a11*e.a31+this.a21*e.a32+this.a31*e.a33,this.a12*e.a11+this.a22*e.a12+this.a32*e.a13,this.a12*e.a21+this.a22*e.a22+this.a32*e.a23,this.a12*e.a31+this.a22*e.a32+this.a32*e.a33,this.a13*e.a11+this.a23*e.a12+this.a33*e.a13,this.a13*e.a21+this.a23*e.a22+this.a33*e.a23,this.a13*e.a31+this.a23*e.a32+this.a33*e.a33)},r}(),pB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),mB=function(r){pB(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.sampleGrid=function(t,n,a,i,o,s,l,u,d,f,h,p,g,v,b,y,C,S,j){var D=E4.quadrilateralToQuadrilateral(i,o,s,l,u,d,f,h,p,g,v,b,y,C,S,j);return this.sampleGridWithTransform(t,n,a,D)},e.prototype.sampleGridWithTransform=function(t,n,a,i){if(n<=0||a<=0)throw new Ce;for(var o=new $i(n,a),s=new Float32Array(2*n),l=0;l<a;l++){for(var u=s.length,d=l+.5,f=0;f<u;f+=2)s[f]=f/2+.5,s[f+1]=d;i.transformPoints(s),cx.checkAndNudgePoints(t,s);try{for(var f=0;f<u;f+=2)t.get(Math.floor(s[f]),Math.floor(s[f+1]))&&o.set(f/2,l)}catch{throw new Ce}}return o},e}(cx),Hg=function(){function r(){}return r.setGridSampler=function(e){r.gridSampler=e},r.getInstance=function(){return r.gridSampler},r.gridSampler=new mB,r}(),ra=function(){function r(e,t){this.x=e,this.y=t}return r.prototype.toResultPoint=function(){return new Je(this.getX(),this.getY())},r.prototype.getX=function(){return this.x},r.prototype.getY=function(){return this.y},r}(),gB=function(){function r(e){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=e}return r.prototype.detect=function(){return this.detectMirror(!1)},r.prototype.detectMirror=function(e){var t=this.getMatrixCenter(),n=this.getBullsEyeCorners(t);if(e){var a=n[0];n[0]=n[2],n[2]=a}this.extractParameters(n);var i=this.sampleGrid(this.image,n[this.shift%4],n[(this.shift+1)%4],n[(this.shift+2)%4],n[(this.shift+3)%4]),o=this.getMatrixCornerPoints(n);return new hB(i,o,this.compact,this.nbDataBlocks,this.nbLayers)},r.prototype.extractParameters=function(e){if(!this.isValidPoint(e[0])||!this.isValidPoint(e[1])||!this.isValidPoint(e[2])||!this.isValidPoint(e[3]))throw new Ce;var t=2*this.nbCenterLayers,n=new Int32Array([this.sampleLine(e[0],e[1],t),this.sampleLine(e[1],e[2],t),this.sampleLine(e[2],e[3],t),this.sampleLine(e[3],e[0],t)]);this.shift=this.getRotation(n,t);for(var a=0,i=0;i<4;i++){var o=n[(this.shift+i)%4];this.compact?(a<<=7,a+=o>>1&127):(a<<=10,a+=(o>>2&992)+(o>>1&31))}var s=this.getCorrectedParameterData(a,this.compact);this.compact?(this.nbLayers=(s>>6)+1,this.nbDataBlocks=(s&63)+1):(this.nbLayers=(s>>11)+1,this.nbDataBlocks=(s&2047)+1)},r.prototype.getRotation=function(e,t){var n=0;e.forEach(function(i,o,s){var l=(i>>t-2<<1)+(i&1);n=(n<<3)+l}),n=((n&1)<<11)+(n>>1);for(var a=0;a<4;a++)if(Tt.bitCount(n^this.EXPECTED_CORNER_BITS[a])<=2)return a;throw new Ce},r.prototype.getCorrectedParameterData=function(e,t){var n,a;t?(n=7,a=2):(n=10,a=4);for(var i=n-a,o=new Int32Array(n),s=n-1;s>=0;--s)o[s]=e&15,e>>=4;try{var l=new Wh(aa.AZTEC_PARAM);l.decode(o,i)}catch{throw new Ce}for(var u=0,s=0;s<a;s++)u=(u<<4)+o[s];return u},r.prototype.getBullsEyeCorners=function(e){var t=e,n=e,a=e,i=e,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){var s=this.getFirstDifferent(t,o,1,-1),l=this.getFirstDifferent(n,o,1,1),u=this.getFirstDifferent(a,o,-1,1),d=this.getFirstDifferent(i,o,-1,-1);if(this.nbCenterLayers>2){var f=this.distancePoint(d,s)*this.nbCenterLayers/(this.distancePoint(i,t)*(this.nbCenterLayers+2));if(f<.75||f>1.25||!this.isWhiteOrBlackRectangle(s,l,u,d))break}t=s,n=l,a=u,i=d,o=!o}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new Ce;this.compact=this.nbCenterLayers===5;var h=new Je(t.getX()+.5,t.getY()-.5),p=new Je(n.getX()+.5,n.getY()+.5),g=new Je(a.getX()-.5,a.getY()+.5),v=new Je(i.getX()-.5,i.getY()-.5);return this.expandSquare([h,p,g,v],2*this.nbCenterLayers-3,2*this.nbCenterLayers)},r.prototype.getMatrixCenter=function(){var e,t,n,a;try{var i=new Ip(this.image).detect();e=i[0],t=i[1],n=i[2],a=i[3]}catch{var o=this.image.getWidth()/2,s=this.image.getHeight()/2;e=this.getFirstDifferent(new ra(o+7,s-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new ra(o+7,s+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new ra(o-7,s+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new ra(o-7,s-7),!1,-1,-1).toResultPoint()}var l=Wt.round((e.getX()+a.getX()+t.getX()+n.getX())/4),u=Wt.round((e.getY()+a.getY()+t.getY()+n.getY())/4);try{var i=new Ip(this.image,15,l,u).detect();e=i[0],t=i[1],n=i[2],a=i[3]}catch{e=this.getFirstDifferent(new ra(l+7,u-7),!1,1,-1).toResultPoint(),t=this.getFirstDifferent(new ra(l+7,u+7),!1,1,1).toResultPoint(),n=this.getFirstDifferent(new ra(l-7,u+7),!1,-1,1).toResultPoint(),a=this.getFirstDifferent(new ra(l-7,u-7),!1,-1,-1).toResultPoint()}return l=Wt.round((e.getX()+a.getX()+t.getX()+n.getX())/4),u=Wt.round((e.getY()+a.getY()+t.getY()+n.getY())/4),new ra(l,u)},r.prototype.getMatrixCornerPoints=function(e){return this.expandSquare(e,2*this.nbCenterLayers,this.getDimension())},r.prototype.sampleGrid=function(e,t,n,a,i){var o=Hg.getInstance(),s=this.getDimension(),l=s/2-this.nbCenterLayers,u=s/2+this.nbCenterLayers;return o.sampleGrid(e,s,s,l,l,u,l,u,u,l,u,t.getX(),t.getY(),n.getX(),n.getY(),a.getX(),a.getY(),i.getX(),i.getY())},r.prototype.sampleLine=function(e,t,n){for(var a=0,i=this.distanceResultPoint(e,t),o=i/n,s=e.getX(),l=e.getY(),u=o*(t.getX()-e.getX())/i,d=o*(t.getY()-e.getY())/i,f=0;f<n;f++)this.image.get(Wt.round(s+f*u),Wt.round(l+f*d))&&(a|=1<<n-f-1);return a},r.prototype.isWhiteOrBlackRectangle=function(e,t,n,a){var i=3;e=new ra(e.getX()-i,e.getY()+i),t=new ra(t.getX()-i,t.getY()-i),n=new ra(n.getX()+i,n.getY()-i),a=new ra(a.getX()+i,a.getY()+i);var o=this.getColor(a,e);if(o===0)return!1;var s=this.getColor(e,t);return s!==o||(s=this.getColor(t,n),s!==o)?!1:(s=this.getColor(n,a),s===o)},r.prototype.getColor=function(e,t){for(var n=this.distancePoint(e,t),a=(t.getX()-e.getX())/n,i=(t.getY()-e.getY())/n,o=0,s=e.getX(),l=e.getY(),u=this.image.get(e.getX(),e.getY()),d=Math.ceil(n),f=0;f<d;f++)s+=a,l+=i,this.image.get(Wt.round(s),Wt.round(l))!==u&&o++;var h=o/n;return h>.1&&h<.9?0:h<=.1===u?1:-1},r.prototype.getFirstDifferent=function(e,t,n,a){for(var i=e.getX()+n,o=e.getY()+a;this.isValid(i,o)&&this.image.get(i,o)===t;)i+=n,o+=a;for(i-=n,o-=a;this.isValid(i,o)&&this.image.get(i,o)===t;)i+=n;for(i-=n;this.isValid(i,o)&&this.image.get(i,o)===t;)o+=a;return o-=a,new ra(i,o)},r.prototype.expandSquare=function(e,t,n){var a=n/(2*t),i=e[0].getX()-e[2].getX(),o=e[0].getY()-e[2].getY(),s=(e[0].getX()+e[2].getX())/2,l=(e[0].getY()+e[2].getY())/2,u=new Je(s+a*i,l+a*o),d=new Je(s-a*i,l-a*o);i=e[1].getX()-e[3].getX(),o=e[1].getY()-e[3].getY(),s=(e[1].getX()+e[3].getX())/2,l=(e[1].getY()+e[3].getY())/2;var f=new Je(s+a*i,l+a*o),h=new Je(s-a*i,l-a*o),p=[u,f,d,h];return p},r.prototype.isValid=function(e,t){return e>=0&&e<this.image.getWidth()&&t>0&&t<this.image.getHeight()},r.prototype.isValidPoint=function(e){var t=Wt.round(e.getX()),n=Wt.round(e.getY());return this.isValid(t,n)},r.prototype.distancePoint=function(e,t){return Wt.distance(e.getX(),e.getY(),t.getX(),t.getY())},r.prototype.distanceResultPoint=function(e,t){return Wt.distance(e.getX(),e.getY(),t.getX(),t.getY())},r.prototype.getDimension=function(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(Tt.truncDivision(this.nbLayers-4,8)+1)+15},r}(),Xf=function(){function r(){}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var n=null,a=new gB(e.getBlackMatrix()),i=null,o=null;try{var s=a.detectMirror(!1);i=s.getPoints(),this.reportFoundResultPoints(t,i),o=new sx().decode(s)}catch(f){n=f}if(o==null)try{var s=a.detectMirror(!0);i=s.getPoints(),this.reportFoundResultPoints(t,i),o=new sx().decode(s)}catch(f){throw n??f}var l=new $n(o.getText(),o.getRawBytes(),o.getNumBits(),i,ot.AZTEC,mr.currentTimeMillis()),u=o.getByteSegments();u!=null&&l.putMetadata(En.BYTE_SEGMENTS,u);var d=o.getECLevel();return d!=null&&l.putMetadata(En.ERROR_CORRECTION_LEVEL,d),l},r.prototype.reportFoundResultPoints=function(e,t){if(e!=null){var n=e.get(gr.NEED_RESULT_POINT_CALLBACK);n!=null&&t.forEach(function(a,i,o){n.foundPossibleResultPoint(a)})}},r.prototype.reset=function(){},r}(),vB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){vB(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new Xf,t)||this}return e})(vl);var cn=function(){function r(){}return r.prototype.decode=function(e,t){try{return this.doDecode(e,t)}catch{var n=t&&t.get(gr.TRY_HARDER)===!0;if(n&&e.isRotateSupported()){var a=e.rotateCounterClockwise(),i=this.doDecode(a,t),o=i.getResultMetadata(),s=270;o!==null&&o.get(En.ORIENTATION)===!0&&(s=s+o.get(En.ORIENTATION)%360),i.putMetadata(En.ORIENTATION,s);var l=i.getResultPoints();if(l!==null)for(var u=a.getHeight(),d=0;d<l.length;d++)l[d]=new Je(u-l[d].getY()-1,l[d].getX());return i}else throw new Ce}},r.prototype.reset=function(){},r.prototype.doDecode=function(e,t){var n=e.getWidth(),a=e.getHeight(),i=new vn(n),o=t&&t.get(gr.TRY_HARDER)===!0,s=Math.max(1,a>>(o?8:5)),l;o?l=a:l=15;for(var u=Math.trunc(a/2),d=0;d<l;d++){var f=Math.trunc((d+1)/2),h=(d&1)===0,p=u+s*(h?f:-f);if(p<0||p>=a)break;try{i=e.getBlackRow(p,i)}catch{continue}for(var g=function(C){if(C===1&&(i.reverse(),t&&t.get(gr.NEED_RESULT_POINT_CALLBACK)===!0)){var S=new Map;t.forEach(function(F,M){return S.set(M,F)}),S.delete(gr.NEED_RESULT_POINT_CALLBACK),t=S}try{var j=v.decodeRow(p,i,t);if(C===1){j.putMetadata(En.ORIENTATION,180);var D=j.getResultPoints();D!==null&&(D[0]=new Je(n-D[0].getX()-1,D[0].getY()),D[1]=new Je(n-D[1].getX()-1,D[1].getY()))}return{value:j}}catch{}},v=this,b=0;b<2;b++){var y=g(b);if(typeof y=="object")return y.value}}throw new Ce},r.recordPattern=function(e,t,n){for(var a=n.length,i=0;i<a;i++)n[i]=0;var o=e.getSize();if(t>=o)throw new Ce;for(var s=!e.get(t),l=0,u=t;u<o;){if(e.get(u)!==s)n[l]++;else{if(++l===a)break;n[l]=1,s=!s}u++}if(!(l===a||l===a-1&&u===o))throw new Ce},r.recordPatternInReverse=function(e,t,n){for(var a=n.length,i=e.get(t);t>0&&a>=0;)e.get(--t)!==i&&(a--,i=!i);if(a>=0)throw new Ce;r.recordPattern(e,t+1,n)},r.patternMatchVariance=function(e,t,n){for(var a=e.length,i=0,o=0,s=0;s<a;s++)i+=e[s],o+=t[s];if(i<o)return Number.POSITIVE_INFINITY;var l=i/o;n*=l;for(var u=0,d=0;d<a;d++){var f=e[d],h=t[d]*l,p=f>h?f-h:h-f;if(p>n)return Number.POSITIVE_INFINITY;u+=p}return u/i},r}(),xB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),lx=function(r){xB(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.findStartPattern=function(t){for(var n=t.getSize(),a=t.getNextSet(0),i=0,o=Int32Array.from([0,0,0,0,0,0]),s=a,l=!1,u=6,d=a;d<n;d++)if(t.get(d)!==l)o[i]++;else{if(i===u-1){for(var f=e.MAX_AVG_VARIANCE,h=-1,p=e.CODE_START_A;p<=e.CODE_START_C;p++){var g=cn.patternMatchVariance(o,e.CODE_PATTERNS[p],e.MAX_INDIVIDUAL_VARIANCE);g<f&&(f=g,h=p)}if(h>=0&&t.isRange(Math.max(0,s-(d-s)/2),s,!1))return Int32Array.from([s,d,h]);s+=o[0]+o[1],o=o.slice(2,o.length),o[i-1]=0,o[i]=0,i--}else i++;o[i]=1,l=!l}throw new Ce},e.decodeCode=function(t,n,a){cn.recordPattern(t,a,n);for(var i=e.MAX_AVG_VARIANCE,o=-1,s=0;s<e.CODE_PATTERNS.length;s++){var l=e.CODE_PATTERNS[s],u=this.patternMatchVariance(n,l,e.MAX_INDIVIDUAL_VARIANCE);u<i&&(i=u,o=s)}if(o>=0)return o;throw new Ce},e.prototype.decodeRow=function(t,n,a){var i=a&&a.get(gr.ASSUME_GS1)===!0,o=e.findStartPattern(n),s=o[2],l=0,u=new Uint8Array(20);u[l++]=s;var d;switch(s){case e.CODE_START_A:d=e.CODE_CODE_A;break;case e.CODE_START_B:d=e.CODE_CODE_B;break;case e.CODE_START_C:d=e.CODE_CODE_C;break;default:throw new ke}for(var f=!1,h=!1,p="",g=o[0],v=o[1],b=Int32Array.from([0,0,0,0,0,0]),y=0,C=0,S=s,j=0,D=!0,F=!1,M=!1;!f;){var T=h;switch(h=!1,y=C,C=e.decodeCode(n,b,v),u[l++]=C,C!==e.CODE_STOP&&(D=!0),C!==e.CODE_STOP&&(j++,S+=j*C),g=v,v+=b.reduce(function(re,G){return re+G},0),C){case e.CODE_START_A:case e.CODE_START_B:case e.CODE_START_C:throw new ke}switch(d){case e.CODE_CODE_A:if(C<64)M===F?p+=String.fromCharCode(32+C):p+=String.fromCharCode(32+C+128),M=!1;else if(C<96)M===F?p+=String.fromCharCode(C-64):p+=String.fromCharCode(C+64),M=!1;else switch(C!==e.CODE_STOP&&(D=!1),C){case e.CODE_FNC_1:i&&(p.length===0?p+="]C1":p+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_A:!F&&M?(F=!0,M=!1):F&&M?(F=!1,M=!1):M=!0;break;case e.CODE_SHIFT:h=!0,d=e.CODE_CODE_B;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_B:if(C<96)M===F?p+=String.fromCharCode(32+C):p+=String.fromCharCode(32+C+128),M=!1;else switch(C!==e.CODE_STOP&&(D=!1),C){case e.CODE_FNC_1:i&&(p.length===0?p+="]C1":p+="");break;case e.CODE_FNC_2:case e.CODE_FNC_3:break;case e.CODE_FNC_4_B:!F&&M?(F=!0,M=!1):F&&M?(F=!1,M=!1):M=!0;break;case e.CODE_SHIFT:h=!0,d=e.CODE_CODE_A;break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_C:d=e.CODE_CODE_C;break;case e.CODE_STOP:f=!0;break}break;case e.CODE_CODE_C:if(C<100)C<10&&(p+="0"),p+=C;else switch(C!==e.CODE_STOP&&(D=!1),C){case e.CODE_FNC_1:i&&(p.length===0?p+="]C1":p+="");break;case e.CODE_CODE_A:d=e.CODE_CODE_A;break;case e.CODE_CODE_B:d=e.CODE_CODE_B;break;case e.CODE_STOP:f=!0;break}break}T&&(d=d===e.CODE_CODE_A?e.CODE_CODE_B:e.CODE_CODE_A)}var q=v-g;if(v=n.getNextUnset(v),!n.isRange(v,Math.min(n.getSize(),v+(v-g)/2),!1))throw new Ce;if(S-=j*y,S%103!==y)throw new Vr;var J=p.length;if(J===0)throw new Ce;J>0&&D&&(d===e.CODE_CODE_C?p=p.substring(0,J-2):p=p.substring(0,J-1));for(var O=(o[1]+o[0])/2,k=g+q/2,H=u.length,X=new Uint8Array(H),ce=0;ce<H;ce++)X[ce]=u[ce];var Q=[new Je(O,t),new Je(k,t)];return new $n(p,X,0,Q,ot.CODE_128,new Date().getTime())},e.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],e.MAX_AVG_VARIANCE=.25,e.MAX_INDIVIDUAL_VARIANCE=.7,e.CODE_SHIFT=98,e.CODE_CODE_C=99,e.CODE_CODE_B=100,e.CODE_CODE_A=101,e.CODE_FNC_1=102,e.CODE_FNC_2=97,e.CODE_FNC_3=96,e.CODE_FNC_4_A=101,e.CODE_FNC_4_B=100,e.CODE_START_A=103,e.CODE_START_B=104,e.CODE_START_C=105,e.CODE_STOP=106,e}(cn),yB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),w1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ux=function(r){yB(e,r);function e(t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var a=r.call(this)||this;return a.usingCheckDigit=t,a.extendedMode=n,a.decodeRowResult="",a.counters=new Int32Array(9),a}return e.prototype.decodeRow=function(t,n,a){var i,o,s,l,u=this.counters;u.fill(0),this.decodeRowResult="";var d=e.findAsteriskPattern(n,u),f=n.getNextSet(d[1]),h=n.getSize(),p,g;do{e.recordPattern(n,f,u);var v=e.toNarrowWidePattern(u);if(v<0)throw new Ce;p=e.patternToChar(v),this.decodeRowResult+=p,g=f;try{for(var b=(i=void 0,w1(u)),y=b.next();!y.done;y=b.next()){var C=y.value;f+=C}}catch(H){i={error:H}}finally{try{y&&!y.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}f=n.getNextSet(f)}while(p!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var S=0;try{for(var j=w1(u),D=j.next();!D.done;D=j.next()){var C=D.value;S+=C}}catch(H){s={error:H}}finally{try{D&&!D.done&&(l=j.return)&&l.call(j)}finally{if(s)throw s.error}}var F=f-g-S;if(f!==h&&F*2<S)throw new Ce;if(this.usingCheckDigit){for(var M=this.decodeRowResult.length-1,T=0,q=0;q<M;q++)T+=e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(q));if(this.decodeRowResult.charAt(M)!==e.ALPHABET_STRING.charAt(T%43))throw new Vr;this.decodeRowResult=this.decodeRowResult.substring(0,M)}if(this.decodeRowResult.length===0)throw new Ce;var J;this.extendedMode?J=e.decodeExtended(this.decodeRowResult):J=this.decodeRowResult;var O=(d[1]+d[0])/2,k=g+S/2;return new $n(J,null,0,[new Je(O,t),new Je(k,t)],ot.CODE_39,new Date().getTime())},e.findAsteriskPattern=function(t,n){for(var a=t.getSize(),i=t.getNextSet(0),o=0,s=i,l=!1,u=n.length,d=i;d<a;d++)if(t.get(d)!==l)n[o]++;else{if(o===u-1){if(this.toNarrowWidePattern(n)===e.ASTERISK_ENCODING&&t.isRange(Math.max(0,s-Math.floor((d-s)/2)),s,!1))return[s,d];s+=n[0]+n[1],n.copyWithin(0,2,2+o-1),n[o-1]=0,n[o]=0,o--}else o++;n[o]=1,l=!l}throw new Ce},e.toNarrowWidePattern=function(t){var n,a,i=t.length,o=0,s;do{var l=2147483647;try{for(var u=(n=void 0,w1(t)),d=u.next();!d.done;d=u.next()){var f=d.value;f<l&&f>o&&(l=f)}}catch(v){n={error:v}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(n)throw n.error}}o=l,s=0;for(var h=0,p=0,g=0;g<i;g++){var f=t[g];f>o&&(p|=1<<i-1-g,s++,h+=f)}if(s===3){for(var g=0;g<i&&s>0;g++){var f=t[g];if(f>o&&(s--,f*2>=h))return-1}return p}}while(s>3);return-1},e.patternToChar=function(t){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===t)return e.ALPHABET_STRING.charAt(n);if(t===e.ASTERISK_ENCODING)return"*";throw new Ce},e.decodeExtended=function(t){for(var n=t.length,a="",i=0;i<n;i++){var o=t.charAt(i);if(o==="+"||o==="$"||o==="%"||o==="/"){var s=t.charAt(i+1),l="\0";switch(o){case"+":if(s>="A"&&s<="Z")l=String.fromCharCode(s.charCodeAt(0)+32);else throw new ke;break;case"$":if(s>="A"&&s<="Z")l=String.fromCharCode(s.charCodeAt(0)-64);else throw new ke;break;case"%":if(s>="A"&&s<="E")l=String.fromCharCode(s.charCodeAt(0)-38);else if(s>="F"&&s<="J")l=String.fromCharCode(s.charCodeAt(0)-11);else if(s>="K"&&s<="O")l=String.fromCharCode(s.charCodeAt(0)+16);else if(s>="P"&&s<="T")l=String.fromCharCode(s.charCodeAt(0)+43);else if(s==="U")l="\0";else if(s==="V")l="@";else if(s==="W")l="`";else if(s==="X"||s==="Y"||s==="Z")l="";else throw new ke;break;case"/":if(s>="A"&&s<="O")l=String.fromCharCode(s.charCodeAt(0)-32);else if(s==="Z")l=":";else throw new ke;break}a+=l,i++}else a+=o}return a},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],e.ASTERISK_ENCODING=148,e}(cn),bB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},dx=function(r){bB(e,r);function e(){var t=r.call(this)||this;return t.decodeRowResult="",t.counters=new Int32Array(6),t}return e.prototype.decodeRow=function(t,n,a){var i,o,s,l,u=this.findAsteriskPattern(n),d=n.getNextSet(u[1]),f=n.getSize(),h=this.counters;h.fill(0),this.decodeRowResult="";var p,g;do{e.recordPattern(n,d,h);var v=this.toPattern(h);if(v<0)throw new Ce;p=this.patternToChar(v),this.decodeRowResult+=p,g=d;try{for(var b=(i=void 0,_1(h)),y=b.next();!y.done;y=b.next()){var C=y.value;d+=C}}catch(q){i={error:q}}finally{try{y&&!y.done&&(o=b.return)&&o.call(b)}finally{if(i)throw i.error}}d=n.getNextSet(d)}while(p!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);var S=0;try{for(var j=_1(h),D=j.next();!D.done;D=j.next()){var C=D.value;S+=C}}catch(q){s={error:q}}finally{try{D&&!D.done&&(l=j.return)&&l.call(j)}finally{if(s)throw s.error}}if(d===f||!n.get(d))throw new Ce;if(this.decodeRowResult.length<2)throw new Ce;this.checkChecksums(this.decodeRowResult),this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-2);var F=this.decodeExtended(this.decodeRowResult),M=(u[1]+u[0])/2,T=g+S/2;return new $n(F,null,0,[new Je(M,t),new Je(T,t)],ot.CODE_93,new Date().getTime())},e.prototype.findAsteriskPattern=function(t){var n=t.getSize(),a=t.getNextSet(0);this.counters.fill(0);for(var i=this.counters,o=a,s=!1,l=i.length,u=0,d=a;d<n;d++)if(t.get(d)!==s)i[u]++;else{if(u===l-1){if(this.toPattern(i)===e.ASTERISK_ENCODING)return new Int32Array([o,d]);o+=i[0]+i[1],i.copyWithin(0,2,2+u-1),i[u-1]=0,i[u]=0,u--}else u++;i[u]=1,s=!s}throw new Ce},e.prototype.toPattern=function(t){var n,a,i=0;try{for(var o=_1(t),s=o.next();!s.done;s=o.next()){var l=s.value;i+=l}}catch(g){n={error:g}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}for(var u=0,d=t.length,f=0;f<d;f++){var h=Math.round(t[f]*9/i);if(h<1||h>4)return-1;if(f&1)u<<=h;else for(var p=0;p<h;p++)u=u<<1|1}return u},e.prototype.patternToChar=function(t){for(var n=0;n<e.CHARACTER_ENCODINGS.length;n++)if(e.CHARACTER_ENCODINGS[n]===t)return e.ALPHABET_STRING.charAt(n);throw new Ce},e.prototype.decodeExtended=function(t){for(var n=t.length,a="",i=0;i<n;i++){var o=t.charAt(i);if(o>="a"&&o<="d"){if(i>=n-1)throw new ke;var s=t.charAt(i+1),l="\0";switch(o){case"d":if(s>="A"&&s<="Z")l=String.fromCharCode(s.charCodeAt(0)+32);else throw new ke;break;case"a":if(s>="A"&&s<="Z")l=String.fromCharCode(s.charCodeAt(0)-64);else throw new ke;break;case"b":if(s>="A"&&s<="E")l=String.fromCharCode(s.charCodeAt(0)-38);else if(s>="F"&&s<="J")l=String.fromCharCode(s.charCodeAt(0)-11);else if(s>="K"&&s<="O")l=String.fromCharCode(s.charCodeAt(0)+16);else if(s>="P"&&s<="T")l=String.fromCharCode(s.charCodeAt(0)+43);else if(s==="U")l="\0";else if(s==="V")l="@";else if(s==="W")l="`";else if(s>="X"&&s<="Z")l="";else throw new ke;break;case"c":if(s>="A"&&s<="O")l=String.fromCharCode(s.charCodeAt(0)-32);else if(s==="Z")l=":";else throw new ke;break}a+=l,i++}else a+=o}return a},e.prototype.checkChecksums=function(t){var n=t.length;this.checkOneChecksum(t,n-2,20),this.checkOneChecksum(t,n-1,15)},e.prototype.checkOneChecksum=function(t,n,a){for(var i=1,o=0,s=n-1;s>=0;s--)o+=i*e.ALPHABET_STRING.indexOf(t.charAt(s)),++i>a&&(i=1);if(t.charAt(n)!==e.ALPHABET_STRING[o%47])throw new Vr},e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*",e.CHARACTER_ENCODINGS=[276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350],e.ASTERISK_ENCODING=e.CHARACTER_ENCODINGS[47],e}(cn),wB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),_B=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},fx=function(r){wB(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.narrowLineWidth=-1,t}return e.prototype.decodeRow=function(t,n,a){var i,o,s=this.decodeStart(n),l=this.decodeEnd(n),u=new Pt;e.decodeMiddle(n,s[1],l[0],u);var d=u.toString(),f=null;a!=null&&(f=a.get(gr.ALLOWED_LENGTHS)),f==null&&(f=e.DEFAULT_ALLOWED_LENGTHS);var h=d.length,p=!1,g=0;try{for(var v=_B(f),b=v.next();!b.done;b=v.next()){var y=b.value;if(h===y){p=!0;break}y>g&&(g=y)}}catch(j){i={error:j}}finally{try{b&&!b.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}if(!p&&h>g&&(p=!0),!p)throw new ke;var C=[new Je(s[1],t),new Je(l[0],t)],S=new $n(d,null,0,C,ot.ITF,new Date().getTime());return S},e.decodeMiddle=function(t,n,a,i){var o=new Int32Array(10),s=new Int32Array(5),l=new Int32Array(5);for(o.fill(0),s.fill(0),l.fill(0);n<a;){cn.recordPattern(t,n,o);for(var u=0;u<5;u++){var d=2*u;s[u]=o[d],l[u]=o[d+1]}var f=e.decodeDigit(s);i.append(f.toString()),f=this.decodeDigit(l),i.append(f.toString()),o.forEach(function(h){n+=h})}},e.prototype.decodeStart=function(t){var n=e.skipWhiteSpace(t),a=e.findGuardPattern(t,n,e.START_PATTERN);return this.narrowLineWidth=(a[1]-a[0])/4,this.validateQuietZone(t,a[0]),a},e.prototype.validateQuietZone=function(t,n){var a=this.narrowLineWidth*10;a=a<n?a:n;for(var i=n-1;a>0&&i>=0&&!t.get(i);i--)a--;if(a!==0)throw new Ce},e.skipWhiteSpace=function(t){var n=t.getSize(),a=t.getNextSet(0);if(a===n)throw new Ce;return a},e.prototype.decodeEnd=function(t){t.reverse();try{var n=e.skipWhiteSpace(t),a=void 0;try{a=e.findGuardPattern(t,n,e.END_PATTERN_REVERSED[0])}catch(o){o instanceof Ce&&(a=e.findGuardPattern(t,n,e.END_PATTERN_REVERSED[1]))}this.validateQuietZone(t,a[0]);var i=a[0];return a[0]=t.getSize()-a[1],a[1]=t.getSize()-i,a}finally{t.reverse()}},e.findGuardPattern=function(t,n,a){var i=a.length,o=new Int32Array(i),s=t.getSize(),l=!1,u=0,d=n;o.fill(0);for(var f=n;f<s;f++)if(t.get(f)!==l)o[u]++;else{if(u===i-1){if(cn.patternMatchVariance(o,a,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return[d,f];d+=o[0]+o[1],mr.arraycopy(o,2,o,0,u-1),o[u-1]=0,o[u]=0,u--}else u++;o[u]=1,l=!l}throw new Ce},e.decodeDigit=function(t){for(var n=e.MAX_AVG_VARIANCE,a=-1,i=e.PATTERNS.length,o=0;o<i;o++){var s=e.PATTERNS[o],l=cn.patternMatchVariance(t,s,e.MAX_INDIVIDUAL_VARIANCE);l<n?(n=l,a=o):l===n&&(a=-1)}if(a>=0)return a%10;throw new Ce},e.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],e.MAX_AVG_VARIANCE=.38,e.MAX_INDIVIDUAL_VARIANCE=.5,e.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],e.START_PATTERN=Int32Array.from([1,1,1,1]),e.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])],e}(cn),CB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),sl=function(r){CB(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.decodeRowStringBuffer="",t}return e.findStartGuardPattern=function(t){for(var n=!1,a,i=0,o=Int32Array.from([0,0,0]);!n;){o=Int32Array.from([0,0,0]),a=e.findGuardPattern(t,i,!1,this.START_END_PATTERN,o);var s=a[0];i=a[1];var l=s-(i-s);l>=0&&(n=t.isRange(l,s,!1))}return a},e.checkChecksum=function(t){return e.checkStandardUPCEANChecksum(t)},e.checkStandardUPCEANChecksum=function(t){var n=t.length;if(n===0)return!1;var a=parseInt(t.charAt(n-1),10);return e.getStandardUPCEANChecksum(t.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(t){for(var n=t.length,a=0,i=n-1;i>=0;i-=2){var o=t.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new ke;a+=o}a*=3;for(var i=n-2;i>=0;i-=2){var o=t.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new ke;a+=o}return(1e3-a)%10},e.decodeEnd=function(t,n){return e.findGuardPattern(t,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e.findGuardPatternWithoutCounters=function(t,n,a,i){return this.findGuardPattern(t,n,a,i,new Int32Array(i.length))},e.findGuardPattern=function(t,n,a,i,o){var s=t.getSize();n=a?t.getNextUnset(n):t.getNextSet(n);for(var l=0,u=n,d=i.length,f=a,h=n;h<s;h++)if(t.get(h)!==f)o[l]++;else{if(l===d-1){if(cn.patternMatchVariance(o,i,e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return Int32Array.from([u,h]);u+=o[0]+o[1];for(var p=o.slice(2,o.length),g=0;g<l-1;g++)o[g]=p[g];o[l-1]=0,o[l]=0,l--}else l++;o[l]=1,f=!f}throw new Ce},e.decodeDigit=function(t,n,a,i){this.recordPattern(t,a,n);for(var o=this.MAX_AVG_VARIANCE,s=-1,l=i.length,u=0;u<l;u++){var d=i[u],f=cn.patternMatchVariance(n,d,e.MAX_INDIVIDUAL_VARIANCE);f<o&&(o=f,s=u)}if(s>=0)return s;throw new Ce},e.MAX_AVG_VARIANCE=.48,e.MAX_INDIVIDUAL_VARIANCE=.7,e.START_END_PATTERN=Int32Array.from([1,1,1]),e.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),e.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])],e}(cn),NB=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},SB=function(){function r(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return r.prototype.decodeRow=function(e,t,n){var a=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,a),o=a.toString(),s=r.parseExtensionString(o),l=[new Je((n[0]+n[1])/2,e),new Je(i,e)],u=new $n(o,null,0,l,ot.UPC_EAN_EXTENSION,new Date().getTime());return s!=null&&u.putAllMetadata(s),u},r.prototype.decodeMiddle=function(e,t,n){var a,i,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var s=e.getSize(),l=t[1],u=0,d=0;d<5&&l<s;d++){var f=sl.decodeDigit(e,o,l,sl.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var h=(a=void 0,NB(o)),p=h.next();!p.done;p=h.next()){var g=p.value;l+=g}}catch(b){a={error:b}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}f>=10&&(u|=1<<4-d),d!==4&&(l=e.getNextSet(l),l=e.getNextUnset(l))}if(n.length!==5)throw new Ce;var v=this.determineCheckDigit(u);if(r.extensionChecksum(n.toString())!==v)throw new Ce;return l},r.extensionChecksum=function(e){for(var t=e.length,n=0,a=t-2;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;n*=3;for(var a=t-1;a>=0;a-=2)n+=e.charAt(a).charCodeAt(0)-48;return n*=3,n%10},r.prototype.determineCheckDigit=function(e){for(var t=0;t<10;t++)if(e===this.CHECK_DIGIT_ENCODINGS[t])return t;throw new Ce},r.parseExtensionString=function(e){if(e.length!==5)return null;var t=r.parseExtension5String(e);return t==null?null:new Map([[En.SUGGESTED_PRICE,t]])},r.parseExtension5String=function(e){var t;switch(e.charAt(0)){case"0":t="£";break;case"5":t="$";break;case"9":switch(e){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}t="";break;default:t="";break}var n=parseInt(e.substring(1)),a=(n/100).toString(),i=n%100,o=i<10?"0"+i:i.toString();return t+a+"."+o},r}(),EB=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},AB=function(){function r(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}return r.prototype.decodeRow=function(e,t,n){var a=this.decodeRowStringBuffer,i=this.decodeMiddle(t,n,a),o=a.toString(),s=r.parseExtensionString(o),l=[new Je((n[0]+n[1])/2,e),new Je(i,e)],u=new $n(o,null,0,l,ot.UPC_EAN_EXTENSION,new Date().getTime());return s!=null&&u.putAllMetadata(s),u},r.prototype.decodeMiddle=function(e,t,n){var a,i,o=this.decodeMiddleCounters;o[0]=0,o[1]=0,o[2]=0,o[3]=0;for(var s=e.getSize(),l=t[1],u=0,d=0;d<2&&l<s;d++){var f=sl.decodeDigit(e,o,l,sl.L_AND_G_PATTERNS);n+=String.fromCharCode(48+f%10);try{for(var h=(a=void 0,EB(o)),p=h.next();!p.done;p=h.next()){var g=p.value;l+=g}}catch(v){a={error:v}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}f>=10&&(u|=1<<1-d),d!==1&&(l=e.getNextSet(l),l=e.getNextUnset(l))}if(n.length!==2)throw new Ce;if(parseInt(n.toString())%4!==u)throw new Ce;return l},r.parseExtensionString=function(e){return e.length!==2?null:new Map([[En.ISSUE_NUMBER,parseInt(e)]])},r}(),jB=function(){function r(){}return r.decodeRow=function(e,t,n){var a=sl.findGuardPattern(t,n,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{var i=new SB;return i.decodeRow(e,t,a)}catch{var o=new AB;return o.decodeRow(e,t,a)}},r.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]),r}(),PB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),rn=function(r){PB(e,r);function e(){var t=r.call(this)||this;t.decodeRowStringBuffer="",e.L_AND_G_PATTERNS=e.L_PATTERNS.map(function(s){return Int32Array.from(s)});for(var n=10;n<20;n++){for(var a=e.L_PATTERNS[n-10],i=new Int32Array(a.length),o=0;o<a.length;o++)i[o]=a[a.length-o-1];e.L_AND_G_PATTERNS[n]=i}return t}return e.prototype.decodeRow=function(t,n,a){var i=e.findStartGuardPattern(n),o=a==null?null:a.get(gr.NEED_RESULT_POINT_CALLBACK);if(o!=null){var s=new Je((i[0]+i[1])/2,t);o.foundPossibleResultPoint(s)}var l=this.decodeMiddle(n,i,this.decodeRowStringBuffer),u=l.rowOffset,d=l.resultString;if(o!=null){var f=new Je(u,t);o.foundPossibleResultPoint(f)}var h=e.decodeEnd(n,u);if(o!=null){var p=new Je((h[0]+h[1])/2,t);o.foundPossibleResultPoint(p)}var g=h[1],v=g+(g-h[0]);if(v>=n.getSize()||!n.isRange(g,v,!1))throw new Ce;var b=d.toString();if(b.length<8)throw new ke;if(!e.checkChecksum(b))throw new Vr;var y=(i[1]+i[0])/2,C=(h[1]+h[0])/2,S=this.getBarcodeFormat(),j=[new Je(y,t),new Je(C,t)],D=new $n(b,null,0,j,S,new Date().getTime()),F=0;try{var M=jB.decodeRow(t,n,h[1]);D.putMetadata(En.UPC_EAN_EXTENSION,M.getText()),D.putAllMetadata(M.getResultMetadata()),D.addResultPoints(M.getResultPoints()),F=M.getText().length}catch{}var T=a==null?null:a.get(gr.ALLOWED_EAN_EXTENSIONS);if(T!=null){var q=!1;for(var J in T)if(F.toString()===J){q=!0;break}if(!q)throw new Ce}return S===ot.EAN_13||ot.UPC_A,D},e.checkChecksum=function(t){return e.checkStandardUPCEANChecksum(t)},e.checkStandardUPCEANChecksum=function(t){var n=t.length;if(n===0)return!1;var a=parseInt(t.charAt(n-1),10);return e.getStandardUPCEANChecksum(t.substring(0,n-1))===a},e.getStandardUPCEANChecksum=function(t){for(var n=t.length,a=0,i=n-1;i>=0;i-=2){var o=t.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new ke;a+=o}a*=3;for(var i=n-2;i>=0;i-=2){var o=t.charAt(i).charCodeAt(0)-48;if(o<0||o>9)throw new ke;a+=o}return(1e3-a)%10},e.decodeEnd=function(t,n){return e.findGuardPattern(t,n,!1,e.START_END_PATTERN,new Int32Array(e.START_END_PATTERN.length).fill(0))},e}(sl),DB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),hx=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Tp=function(r){DB(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return e.prototype.decodeMiddle=function(t,n,a){var i,o,s,l,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=t.getSize(),f=n[1],h=0,p=0;p<6&&f<d;p++){var g=rn.decodeDigit(t,u,f,rn.L_AND_G_PATTERNS);a+=String.fromCharCode(48+g%10);try{for(var v=(i=void 0,hx(u)),b=v.next();!b.done;b=v.next()){var y=b.value;f+=y}}catch(D){i={error:D}}finally{try{b&&!b.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}g>=10&&(h|=1<<5-p)}a=e.determineFirstDigit(a,h);var C=rn.findGuardPattern(t,f,!0,rn.MIDDLE_PATTERN,new Int32Array(rn.MIDDLE_PATTERN.length).fill(0));f=C[1];for(var p=0;p<6&&f<d;p++){var g=rn.decodeDigit(t,u,f,rn.L_PATTERNS);a+=String.fromCharCode(48+g);try{for(var S=(s=void 0,hx(u)),j=S.next();!j.done;j=S.next()){var y=j.value;f+=y}}catch(M){s={error:M}}finally{try{j&&!j.done&&(l=S.return)&&l.call(S)}finally{if(s)throw s.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return ot.EAN_13},e.determineFirstDigit=function(t,n){for(var a=0;a<10;a++)if(n===this.FIRST_DIGIT_ENCODINGS[a])return t=String.fromCharCode(48+a)+t,t;throw new Ce},e.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26],e}(rn),IB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),px=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},mx=function(r){IB(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=Int32Array.from([0,0,0,0]),t}return e.prototype.decodeMiddle=function(t,n,a){var i,o,s,l,u=this.decodeMiddleCounters;u[0]=0,u[1]=0,u[2]=0,u[3]=0;for(var d=t.getSize(),f=n[1],h=0;h<4&&f<d;h++){var p=rn.decodeDigit(t,u,f,rn.L_PATTERNS);a+=String.fromCharCode(48+p);try{for(var g=(i=void 0,px(u)),v=g.next();!v.done;v=g.next()){var b=v.value;f+=b}}catch(j){i={error:j}}finally{try{v&&!v.done&&(o=g.return)&&o.call(g)}finally{if(i)throw i.error}}}var y=rn.findGuardPattern(t,f,!0,rn.MIDDLE_PATTERN,new Int32Array(rn.MIDDLE_PATTERN.length).fill(0));f=y[1];for(var h=0;h<4&&f<d;h++){var p=rn.decodeDigit(t,u,f,rn.L_PATTERNS);a+=String.fromCharCode(48+p);try{for(var C=(s=void 0,px(u)),S=C.next();!S.done;S=C.next()){var b=S.value;f+=b}}catch(F){s={error:F}}finally{try{S&&!S.done&&(l=C.return)&&l.call(C)}finally{if(s)throw s.error}}}return{rowOffset:f,resultString:a}},e.prototype.getBarcodeFormat=function(){return ot.EAN_8},e}(rn),TB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),gx=function(r){TB(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.ean13Reader=new Tp,t}return e.prototype.getBarcodeFormat=function(){return ot.UPC_A},e.prototype.decode=function(t,n){return this.maybeReturnResult(this.ean13Reader.decode(t))},e.prototype.decodeRow=function(t,n,a){return this.maybeReturnResult(this.ean13Reader.decodeRow(t,n,a))},e.prototype.decodeMiddle=function(t,n,a){return this.ean13Reader.decodeMiddle(t,n,a)},e.prototype.maybeReturnResult=function(t){var n=t.getText();if(n.charAt(0)==="0"){var a=new $n(n.substring(1),null,null,t.getResultPoints(),ot.UPC_A);return t.getResultMetadata()!=null&&a.putAllMetadata(t.getResultMetadata()),a}else throw new Ce},e.prototype.reset=function(){this.ean13Reader.reset()},e}(rn),OB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),kB=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vx=function(r){OB(e,r);function e(){var t=r.call(this)||this;return t.decodeMiddleCounters=new Int32Array(4),t}return e.prototype.decodeMiddle=function(t,n,a){var i,o,s=this.decodeMiddleCounters.map(function(b){return b});s[0]=0,s[1]=0,s[2]=0,s[3]=0;for(var l=t.getSize(),u=n[1],d=0,f=0;f<6&&u<l;f++){var h=e.decodeDigit(t,s,u,e.L_AND_G_PATTERNS);a+=String.fromCharCode(48+h%10);try{for(var p=(i=void 0,kB(s)),g=p.next();!g.done;g=p.next()){var v=g.value;u+=v}}catch(b){i={error:b}}finally{try{g&&!g.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}h>=10&&(d|=1<<5-f)}return e.determineNumSysAndCheckDigit(new Pt(a),d),u},e.prototype.decodeEnd=function(t,n){return e.findGuardPatternWithoutCounters(t,n,!0,e.MIDDLE_END_PATTERN)},e.prototype.checkChecksum=function(t){return rn.checkChecksum(e.convertUPCEtoUPCA(t))},e.determineNumSysAndCheckDigit=function(t,n){for(var a=0;a<=1;a++)for(var i=0;i<10;i++)if(n===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[a][i]){t.insert(0,"0"+a),t.append("0"+i);return}throw Ce.getNotFoundInstance()},e.prototype.getBarcodeFormat=function(){return ot.UPC_E},e.convertUPCEtoUPCA=function(t){var n=t.slice(1,7).split("").map(function(o){return o.charCodeAt(0)}),a=new Pt;a.append(t.charAt(0));var i=n[5];switch(i){case 0:case 1:case 2:a.appendChars(n,0,2),a.append(i),a.append("0000"),a.appendChars(n,2,3);break;case 3:a.appendChars(n,0,3),a.append("00000"),a.appendChars(n,3,2);break;case 4:a.appendChars(n,0,4),a.append("00000"),a.append(n[4]);break;default:a.appendChars(n,0,5),a.append("0000"),a.append(i);break}return t.length>=8&&a.append(t.charAt(7)),a.toString()},e.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),e.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])],e}(rn),MB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),xx=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},C1=function(r){MB(e,r);function e(t){var n=r.call(this)||this,a=t==null?null:t.get(gr.POSSIBLE_FORMATS),i=[];return a!=null&&(a.indexOf(ot.EAN_13)>-1&&i.push(new Tp),a.indexOf(ot.UPC_A)>-1&&i.push(new gx),a.indexOf(ot.EAN_8)>-1&&i.push(new mx),a.indexOf(ot.UPC_E)>-1&&i.push(new vx)),i.length===0&&(i.push(new Tp),i.push(new gx),i.push(new mx),i.push(new vx)),n.readers=i,n}return e.prototype.decodeRow=function(t,n,a){var i,o;try{for(var s=xx(this.readers),l=s.next();!l.done;l=s.next()){var u=l.value;try{var d=u.decodeRow(t,n,a),f=d.getBarcodeFormat()===ot.EAN_13&&d.getText().charAt(0)==="0",h=a==null?null:a.get(gr.POSSIBLE_FORMATS),p=h==null||h.includes(ot.UPC_A);if(f&&p){var g=d.getRawBytes(),v=new $n(d.getText().substring(1),g,g?g.length:null,d.getResultPoints(),ot.UPC_A);return v.putAllMetadata(d.getResultMetadata()),v}return d}catch{}}}catch(b){i={error:b}}finally{try{l&&!l.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}throw new Ce},e.prototype.reset=function(){var t,n;try{for(var a=xx(this.readers),i=a.next();!i.done;i=a.next()){var o=i.value;o.reset()}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},e}(cn),RB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),LB=function(r){RB(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.CODA_BAR_CHAR_SET={nnnnnww:"0",nnnnwwn:"1",nnnwnnw:"2",wwnnnnn:"3",nnwnnwn:"4",wnnnnwn:"5",nwnnnnw:"6",nwnnwnn:"7",nwwnnnn:"8",wnnwnnn:"9",nnnwwnn:"-",nnwwnnn:"$",wnnnwnw:":",wnwnnnw:"/",wnwnwnn:".",nnwwwww:"+",nnwwnwn:"A",nwnwnnw:"B",nnnwnww:"C",nnnwwwn:"D"},t}return e.prototype.decodeRow=function(t,n,a){var i=this.getValidRowData(n);if(!i)throw new Ce;var o=this.codaBarDecodeRow(i.row);if(!o)throw new Ce;return new $n(o,null,0,[new Je(i.left,t),new Je(i.right,t)],ot.CODABAR,new Date().getTime())},e.prototype.getValidRowData=function(t){var n=t.toArray(),a=n.indexOf(!0);if(a===-1)return null;var i=n.lastIndexOf(!0);if(i<=a)return null;n=n.slice(a,i+1);for(var o=[],s=n[0],l=1,u=1;u<n.length;u++)n[u]===s?l++:(s=n[u],o.push(l),l=1);return o.push(l),o.length<23&&(o.length+1)%8!==0?null:{row:o,left:a,right:i}},e.prototype.codaBarDecodeRow=function(t){for(var n=[],a=Math.ceil(t.reduce(function(l,u){return(l+u)/2},0));t.length>0;){var i=t.splice(0,8).splice(0,7),o=i.map(function(l){return l<a?"n":"w"}).join("");if(this.CODA_BAR_CHAR_SET[o]===void 0)return null;n.push(this.CODA_BAR_CHAR_SET[o])}var s=n.join("");return this.validCodaBarString(s)?s:null},e.prototype.validCodaBarString=function(t){var n=/^[A-D].{1,}[A-D]$/;return n.test(t)},e}(cn),FB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),BB=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ws=function(r){FB(e,r);function e(){var t=r.call(this)||this;return t.decodeFinderCounters=new Int32Array(4),t.dataCharacterCounters=new Int32Array(8),t.oddRoundingErrors=new Array(4),t.evenRoundingErrors=new Array(4),t.oddCounts=new Array(t.dataCharacterCounters.length/2),t.evenCounts=new Array(t.dataCharacterCounters.length/2),t}return e.prototype.getDecodeFinderCounters=function(){return this.decodeFinderCounters},e.prototype.getDataCharacterCounters=function(){return this.dataCharacterCounters},e.prototype.getOddRoundingErrors=function(){return this.oddRoundingErrors},e.prototype.getEvenRoundingErrors=function(){return this.evenRoundingErrors},e.prototype.getOddCounts=function(){return this.oddCounts},e.prototype.getEvenCounts=function(){return this.evenCounts},e.prototype.parseFinderValue=function(t,n){for(var a=0;a<n.length;a++)if(cn.patternMatchVariance(t,n[a],e.MAX_INDIVIDUAL_VARIANCE)<e.MAX_AVG_VARIANCE)return a;throw new Ce},e.count=function(t){return Wt.sum(new Int32Array(t))},e.increment=function(t,n){for(var a=0,i=n[0],o=1;o<t.length;o++)n[o]>i&&(i=n[o],a=o);t[a]++},e.decrement=function(t,n){for(var a=0,i=n[0],o=1;o<t.length;o++)n[o]<i&&(i=n[o],a=o);t[a]--},e.isFinderPattern=function(t){var n,a,i=t[0]+t[1],o=i+t[2]+t[3],s=i/o;if(s>=e.MIN_FINDER_PATTERN_RATIO&&s<=e.MAX_FINDER_PATTERN_RATIO){var l=Number.MAX_SAFE_INTEGER,u=Number.MIN_SAFE_INTEGER;try{for(var d=BB(t),f=d.next();!f.done;f=d.next()){var h=f.value;h>u&&(u=h),h<l&&(l=h)}}catch(p){n={error:p}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}return u<10*l}return!1},e.MAX_AVG_VARIANCE=.2,e.MAX_INDIVIDUAL_VARIANCE=.45,e.MIN_FINDER_PATTERN_RATIO=9.5/12,e.MAX_FINDER_PATTERN_RATIO=12.5/14,e}(cn),Qf=function(){function r(e,t){this.value=e,this.checksumPortion=t}return r.prototype.getValue=function(){return this.value},r.prototype.getChecksumPortion=function(){return this.checksumPortion},r.prototype.toString=function(){return this.value+"("+this.checksumPortion+")"},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value&&this.checksumPortion===t.checksumPortion},r.prototype.hashCode=function(){return this.value^this.checksumPortion},r}(),A4=function(){function r(e,t,n,a,i){this.value=e,this.startEnd=t,this.value=e,this.startEnd=t,this.resultPoints=new Array,this.resultPoints.push(new Je(n,i)),this.resultPoints.push(new Je(a,i))}return r.prototype.getValue=function(){return this.value},r.prototype.getStartEnd=function(){return this.startEnd},r.prototype.getResultPoints=function(){return this.resultPoints},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.prototype.hashCode=function(){return this.value},r}(),$B=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$c=function(){function r(){}return r.getRSSvalue=function(e,t,n){var a,i,o=0;try{for(var s=$B(e),l=s.next();!l.done;l=s.next()){var u=l.value;o+=u}}catch(C){a={error:C}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}for(var d=0,f=0,h=e.length,p=0;p<h-1;p++){var g=void 0;for(g=1,f|=1<<p;g<e[p];g++,f&=~(1<<p)){var v=r.combins(o-g-1,h-p-2);if(n&&f===0&&o-g-(h-p-1)>=h-p-1&&(v-=r.combins(o-g-(h-p),h-p-2)),h-p-1>1){for(var b=0,y=o-g-(h-p-2);y>t;y--)b+=r.combins(o-g-y-1,h-p-3);v-=b*(h-1-p)}else o-g>t&&v--;d+=v}o-=g}return d},r.combins=function(e,t){var n,a;e-t>t?(a=t,n=e-t):(a=e-t,n=t);for(var i=1,o=1,s=e;s>n;s--)i*=s,o<=a&&(i/=o,o++);for(;o<=a;)i/=o,o++;return i},r}(),UB=function(){function r(){}return r.buildBitArray=function(e){var t=e.length*2-1;e[e.length-1].getRightChar()==null&&(t-=1);for(var n=12*t,a=new vn(n),i=0,o=e[0],s=o.getRightChar().getValue(),l=11;l>=0;--l)s&1<<l&&a.set(i),i++;for(var l=1;l<e.length;++l){for(var u=e[l],d=u.getLeftChar().getValue(),f=11;f>=0;--f)d&1<<f&&a.set(i),i++;if(u.getRightChar()!==null)for(var h=u.getRightChar().getValue(),f=11;f>=0;--f)h&1<<f&&a.set(i),i++}return a},r}(),xs=function(){function r(e,t){t?this.decodedInformation=null:(this.finished=e,this.decodedInformation=t)}return r.prototype.getDecodedInformation=function(){return this.decodedInformation},r.prototype.isFinished=function(){return this.finished},r}(),Wg=function(){function r(e){this.newPosition=e}return r.prototype.getNewPosition=function(){return this.newPosition},r}(),qB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),si=function(r){qB(e,r);function e(t,n){var a=r.call(this,t)||this;return a.value=n,a}return e.prototype.getValue=function(){return this.value},e.prototype.isFNC1=function(){return this.value===e.FNC1},e.FNC1="$",e}(Wg),VB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),ys=function(r){VB(e,r);function e(t,n,a){var i=r.call(this,t)||this;return a?(i.remaining=!0,i.remainingValue=i.remainingValue):(i.remaining=!1,i.remainingValue=0),i.newString=n,i}return e.prototype.getNewString=function(){return this.newString},e.prototype.isRemaining=function(){return this.remaining},e.prototype.getRemainingValue=function(){return this.remainingValue},e}(Wg),zB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Tc=function(r){zB(e,r);function e(t,n,a){var i=r.call(this,t)||this;if(n<0||n>10||a<0||a>10)throw new ke;return i.firstDigit=n,i.secondDigit=a,i}return e.prototype.getFirstDigit=function(){return this.firstDigit},e.prototype.getSecondDigit=function(){return this.secondDigit},e.prototype.getValue=function(){return this.firstDigit*10+this.secondDigit},e.prototype.isFirstDigitFNC1=function(){return this.firstDigit===e.FNC1},e.prototype.isSecondDigitFNC1=function(){return this.secondDigit===e.FNC1},e.prototype.isAnyFNC1=function(){return this.firstDigit===e.FNC1||this.secondDigit===e.FNC1},e.FNC1=10,e}(Wg),sf=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},HB=function(){function r(){}return r.parseFieldsInGeneralPurpose=function(e){var t,n,a,i,o,s,l,u;if(!e)return null;if(e.length<2)throw new Ce;var d=e.substring(0,2);try{for(var f=sf(r.TWO_DIGIT_DATA_LENGTH),h=f.next();!h.done;h=f.next()){var p=h.value;if(p[0]===d)return p[1]===r.VARIABLE_LENGTH?r.processVariableAI(2,p[2],e):r.processFixedAI(2,p[1],e)}}catch(F){t={error:F}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}if(e.length<3)throw new Ce;var g=e.substring(0,3);try{for(var v=sf(r.THREE_DIGIT_DATA_LENGTH),b=v.next();!b.done;b=v.next()){var p=b.value;if(p[0]===g)return p[1]===r.VARIABLE_LENGTH?r.processVariableAI(3,p[2],e):r.processFixedAI(3,p[1],e)}}catch(F){a={error:F}}finally{try{b&&!b.done&&(i=v.return)&&i.call(v)}finally{if(a)throw a.error}}try{for(var y=sf(r.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH),C=y.next();!C.done;C=y.next()){var p=C.value;if(p[0]===g)return p[1]===r.VARIABLE_LENGTH?r.processVariableAI(4,p[2],e):r.processFixedAI(4,p[1],e)}}catch(F){o={error:F}}finally{try{C&&!C.done&&(s=y.return)&&s.call(y)}finally{if(o)throw o.error}}if(e.length<4)throw new Ce;var S=e.substring(0,4);try{for(var j=sf(r.FOUR_DIGIT_DATA_LENGTH),D=j.next();!D.done;D=j.next()){var p=D.value;if(p[0]===S)return p[1]===r.VARIABLE_LENGTH?r.processVariableAI(4,p[2],e):r.processFixedAI(4,p[1],e)}}catch(F){l={error:F}}finally{try{D&&!D.done&&(u=j.return)&&u.call(j)}finally{if(l)throw l.error}}throw new Ce},r.processFixedAI=function(e,t,n){if(n.length<e)throw new Ce;var a=n.substring(0,e);if(n.length<e+t)throw new Ce;var i=n.substring(e,e+t),o=n.substring(e+t),s="("+a+")"+i,l=r.parseFieldsInGeneralPurpose(o);return l==null?s:s+l},r.processVariableAI=function(e,t,n){var a=n.substring(0,e),i;n.length<e+t?i=n.length:i=e+t;var o=n.substring(e,i),s=n.substring(i),l="("+a+")"+o,u=r.parseFieldsInGeneralPurpose(s);return u==null?l:l+u},r.VARIABLE_LENGTH=[],r.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",r.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",r.VARIABLE_LENGTH,20],["22",r.VARIABLE_LENGTH,29],["30",r.VARIABLE_LENGTH,8],["37",r.VARIABLE_LENGTH,8],["90",r.VARIABLE_LENGTH,30],["91",r.VARIABLE_LENGTH,30],["92",r.VARIABLE_LENGTH,30],["93",r.VARIABLE_LENGTH,30],["94",r.VARIABLE_LENGTH,30],["95",r.VARIABLE_LENGTH,30],["96",r.VARIABLE_LENGTH,30],["97",r.VARIABLE_LENGTH,3],["98",r.VARIABLE_LENGTH,30],["99",r.VARIABLE_LENGTH,30]],r.THREE_DIGIT_DATA_LENGTH=[["240",r.VARIABLE_LENGTH,30],["241",r.VARIABLE_LENGTH,30],["242",r.VARIABLE_LENGTH,6],["250",r.VARIABLE_LENGTH,30],["251",r.VARIABLE_LENGTH,30],["253",r.VARIABLE_LENGTH,17],["254",r.VARIABLE_LENGTH,20],["400",r.VARIABLE_LENGTH,30],["401",r.VARIABLE_LENGTH,30],["402",17],["403",r.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",r.VARIABLE_LENGTH,20],["421",r.VARIABLE_LENGTH,15],["422",3],["423",r.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],r.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",r.VARIABLE_LENGTH,15],["391",r.VARIABLE_LENGTH,18],["392",r.VARIABLE_LENGTH,15],["393",r.VARIABLE_LENGTH,18],["703",r.VARIABLE_LENGTH,30]],r.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",r.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",r.VARIABLE_LENGTH,20],["8003",r.VARIABLE_LENGTH,30],["8004",r.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",r.VARIABLE_LENGTH,30],["8008",r.VARIABLE_LENGTH,12],["8018",18],["8020",r.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",r.VARIABLE_LENGTH,70],["8200",r.VARIABLE_LENGTH,70]],r}(),Af=function(){function r(e){this.buffer=new Pt,this.information=e}return r.prototype.decodeAllCodes=function(e,t){var n=t,a=null;do{var i=this.decodeGeneralPurposeField(n,a),o=HB.parseFieldsInGeneralPurpose(i.getNewString());if(o!=null&&e.append(o),i.isRemaining()?a=""+i.getRemainingValue():a=null,n===i.getNewPosition())break;n=i.getNewPosition()}while(!0);return e.toString()},r.prototype.isStillNumeric=function(e){if(e+7>this.information.getSize())return e+4<=this.information.getSize();for(var t=e;t<e+3;++t)if(this.information.get(t))return!0;return this.information.get(e+3)},r.prototype.decodeNumeric=function(e){if(e+7>this.information.getSize()){var t=this.extractNumericValueFromBitArray(e,4);return t===0?new Tc(this.information.getSize(),Tc.FNC1,Tc.FNC1):new Tc(this.information.getSize(),t-1,Tc.FNC1)}var n=this.extractNumericValueFromBitArray(e,7),a=(n-8)/11,i=(n-8)%11;return new Tc(e+7,a,i)},r.prototype.extractNumericValueFromBitArray=function(e,t){return r.extractNumericValueFromBitArray(this.information,e,t)},r.extractNumericValueFromBitArray=function(e,t,n){for(var a=0,i=0;i<n;++i)e.get(t+i)&&(a|=1<<n-i-1);return a},r.prototype.decodeGeneralPurposeField=function(e,t){this.buffer.setLengthToZero(),t!=null&&this.buffer.append(t),this.current.setPosition(e);var n=this.parseBlocks();return n!=null&&n.isRemaining()?new ys(this.current.getPosition(),this.buffer.toString(),n.getRemainingValue()):new ys(this.current.getPosition(),this.buffer.toString())},r.prototype.parseBlocks=function(){var e,t;do{var n=this.current.getPosition();this.current.isAlpha()?(t=this.parseAlphaBlock(),e=t.isFinished()):this.current.isIsoIec646()?(t=this.parseIsoIec646Block(),e=t.isFinished()):(t=this.parseNumericBlock(),e=t.isFinished());var a=n!==this.current.getPosition();if(!a&&!e)break}while(!e);return t.getDecodedInformation()},r.prototype.parseNumericBlock=function(){for(;this.isStillNumeric(this.current.getPosition());){var e=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFirstDigitFNC1()){var t=void 0;return e.isSecondDigitFNC1()?t=new ys(this.current.getPosition(),this.buffer.toString()):t=new ys(this.current.getPosition(),this.buffer.toString(),e.getSecondDigit()),new xs(!0,t)}if(this.buffer.append(e.getFirstDigit()),e.isSecondDigitFNC1()){var t=new ys(this.current.getPosition(),this.buffer.toString());return new xs(!0,t)}this.buffer.append(e.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new xs(!1)},r.prototype.parseIsoIec646Block=function(){for(;this.isStillIsoIec646(this.current.getPosition());){var e=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new ys(this.current.getPosition(),this.buffer.toString());return new xs(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new xs(!1)},r.prototype.parseAlphaBlock=function(){for(;this.isStillAlpha(this.current.getPosition());){var e=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(e.getNewPosition()),e.isFNC1()){var t=new ys(this.current.getPosition(),this.buffer.toString());return new xs(!0,t)}this.buffer.append(e.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new xs(!1)},r.prototype.isStillIsoIec646=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+7>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<116)return!0;if(e+8>this.information.getSize())return!1;var a=this.extractNumericValueFromBitArray(e,8);return a>=232&&a<253},r.prototype.decodeIsoIec646=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new si(e+5,si.FNC1);if(t>=5&&t<15)return new si(e+5,"0"+(t-5));var n=this.extractNumericValueFromBitArray(e,7);if(n>=64&&n<90)return new si(e+7,""+(n+1));if(n>=90&&n<116)return new si(e+7,""+(n+7));var a=this.extractNumericValueFromBitArray(e,8),i;switch(a){case 232:i="!";break;case 233:i='"';break;case 234:i="%";break;case 235:i="&";break;case 236:i="'";break;case 237:i="(";break;case 238:i=")";break;case 239:i="*";break;case 240:i="+";break;case 241:i=",";break;case 242:i="-";break;case 243:i=".";break;case 244:i="/";break;case 245:i=":";break;case 246:i=";";break;case 247:i="<";break;case 248:i="=";break;case 249:i=">";break;case 250:i="?";break;case 251:i="_";break;case 252:i=" ";break;default:throw new ke}return new si(e+8,i)},r.prototype.isStillAlpha=function(e){if(e+5>this.information.getSize())return!1;var t=this.extractNumericValueFromBitArray(e,5);if(t>=5&&t<16)return!0;if(e+6>this.information.getSize())return!1;var n=this.extractNumericValueFromBitArray(e,6);return n>=16&&n<63},r.prototype.decodeAlphanumeric=function(e){var t=this.extractNumericValueFromBitArray(e,5);if(t===15)return new si(e+5,si.FNC1);if(t>=5&&t<15)return new si(e+5,"0"+(t-5));var n=this.extractNumericValueFromBitArray(e,6);if(n>=32&&n<58)return new si(e+6,""+(n+33));var a;switch(n){case 58:a="*";break;case 59:a=",";break;case 60:a="-";break;case 61:a=".";break;case 62:a="/";break;default:throw new Xu("Decoding invalid alphanumeric value: "+n)}return new si(e+6,a)},r.prototype.isAlphaTo646ToAlphaLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<5&&t+e<this.information.getSize();++t)if(t===2){if(!this.information.get(e+2))return!1}else if(this.information.get(e+t))return!1;return!0},r.prototype.isAlphaOr646ToNumericLatch=function(e){if(e+3>this.information.getSize())return!1;for(var t=e;t<e+3;++t)if(this.information.get(t))return!1;return!0},r.prototype.isNumericToAlphaNumericLatch=function(e){if(e+1>this.information.getSize())return!1;for(var t=0;t<4&&t+e<this.information.getSize();++t)if(this.information.get(e+t))return!1;return!0},r}(),j4=function(){function r(e){this.information=e,this.generalDecoder=new Af(e)}return r.prototype.getInformation=function(){return this.information},r.prototype.getGeneralDecoder=function(){return this.generalDecoder},r}(),WB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),hi=function(r){WB(e,r);function e(t){return r.call(this,t)||this}return e.prototype.encodeCompressedGtin=function(t,n){t.append("(01)");var a=t.length();t.append("9"),this.encodeCompressedGtinWithoutAI(t,n,a)},e.prototype.encodeCompressedGtinWithoutAI=function(t,n,a){for(var i=0;i<4;++i){var o=this.getGeneralDecoder().extractNumericValueFromBitArray(n+10*i,10);o/100===0&&t.append("0"),o/10===0&&t.append("0"),t.append(o)}e.appendCheckDigit(t,a)},e.appendCheckDigit=function(t,n){for(var a=0,i=0;i<13;i++){var o=t.charAt(i+n).charCodeAt(0)-48;a+=i&1?o:3*o}a=10-a%10,a===10&&(a=0),t.append(a)},e.GTIN_SIZE=40,e}(j4),GB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),YB=function(r){GB(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){var t=new Pt;t.append("(01)");var n=t.length(),a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE,4);return t.append(a),this.encodeCompressedGtinWithoutAI(t,e.HEADER_SIZE+4,n),this.getGeneralDecoder().decodeAllCodes(t,e.HEADER_SIZE+44)},e.HEADER_SIZE=4,e}(hi),KB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),XB=function(r){KB(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){var t=new Pt;return this.getGeneralDecoder().decodeAllCodes(t,e.HEADER_SIZE)},e.HEADER_SIZE=5,e}(j4),QB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),jf=function(r){QB(e,r);function e(t){return r.call(this,t)||this}return e.prototype.encodeCompressedWeight=function(t,n,a){var i=this.getGeneralDecoder().extractNumericValueFromBitArray(n,a);this.addWeightCode(t,i);for(var o=this.checkWeight(i),s=1e5,l=0;l<5;++l)o/s===0&&t.append("0"),s/=10;t.append(o)},e}(hi),ZB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),P4=function(r){ZB(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+jf.GTIN_SIZE+e.WEIGHT_SIZE)throw new Ce;var t=new Pt;return this.encodeCompressedGtin(t,e.HEADER_SIZE),this.encodeCompressedWeight(t,e.HEADER_SIZE+jf.GTIN_SIZE,e.WEIGHT_SIZE),t.toString()},e.HEADER_SIZE=5,e.WEIGHT_SIZE=15,e}(jf),JB=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),e$=function(r){JB(e,r);function e(t){return r.call(this,t)||this}return e.prototype.addWeightCode=function(t,n){t.append("(3103)")},e.prototype.checkWeight=function(t){return t},e}(P4),t$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),r$=function(r){t$(e,r);function e(t){return r.call(this,t)||this}return e.prototype.addWeightCode=function(t,n){n<1e4?t.append("(3202)"):t.append("(3203)")},e.prototype.checkWeight=function(t){return t<1e4?t:t-1e4},e}(P4),n$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),a$=function(r){n$(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+hi.GTIN_SIZE)throw new Ce;var t=new Pt;this.encodeCompressedGtin(t,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+hi.GTIN_SIZE,e.LAST_DIGIT_SIZE);t.append("(392"),t.append(n),t.append(")");var a=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+hi.GTIN_SIZE+e.LAST_DIGIT_SIZE,null);return t.append(a.getNewString()),t.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e}(hi),i$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),o$=function(r){i$(e,r);function e(t){return r.call(this,t)||this}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()<e.HEADER_SIZE+hi.GTIN_SIZE)throw new Ce;var t=new Pt;this.encodeCompressedGtin(t,e.HEADER_SIZE);var n=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+hi.GTIN_SIZE,e.LAST_DIGIT_SIZE);t.append("(393"),t.append(n),t.append(")");var a=this.getGeneralDecoder().extractNumericValueFromBitArray(e.HEADER_SIZE+hi.GTIN_SIZE+e.LAST_DIGIT_SIZE,e.FIRST_THREE_DIGITS_SIZE);a/100===0&&t.append("0"),a/10===0&&t.append("0"),t.append(a);var i=this.getGeneralDecoder().decodeGeneralPurposeField(e.HEADER_SIZE+hi.GTIN_SIZE+e.LAST_DIGIT_SIZE+e.FIRST_THREE_DIGITS_SIZE,null);return t.append(i.getNewString()),t.toString()},e.HEADER_SIZE=8,e.LAST_DIGIT_SIZE=2,e.FIRST_THREE_DIGITS_SIZE=10,e}(hi),s$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),jo=function(r){s$(e,r);function e(t,n,a){var i=r.call(this,t)||this;return i.dateCode=a,i.firstAIdigits=n,i}return e.prototype.parseInformation=function(){if(this.getInformation().getSize()!==e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE+e.DATE_SIZE)throw new Ce;var t=new Pt;return this.encodeCompressedGtin(t,e.HEADER_SIZE),this.encodeCompressedWeight(t,e.HEADER_SIZE+e.GTIN_SIZE,e.WEIGHT_SIZE),this.encodeCompressedDate(t,e.HEADER_SIZE+e.GTIN_SIZE+e.WEIGHT_SIZE),t.toString()},e.prototype.encodeCompressedDate=function(t,n){var a=this.getGeneralDecoder().extractNumericValueFromBitArray(n,e.DATE_SIZE);if(a!==38400){t.append("("),t.append(this.dateCode),t.append(")");var i=a%32;a/=32;var o=a%12+1;a/=12;var s=a;s/10===0&&t.append("0"),t.append(s),o/10===0&&t.append("0"),t.append(o),i/10===0&&t.append("0"),t.append(i)}},e.prototype.addWeightCode=function(t,n){t.append("("),t.append(this.firstAIdigits),t.append(n/1e5),t.append(")")},e.prototype.checkWeight=function(t){return t%1e5},e.HEADER_SIZE=8,e.WEIGHT_SIZE=20,e.DATE_SIZE=16,e}(jf);function c$(r){try{if(r.get(1))return new YB(r);if(!r.get(2))return new XB(r);var e=Af.extractNumericValueFromBitArray(r,1,4);switch(e){case 4:return new e$(r);case 5:return new r$(r)}var t=Af.extractNumericValueFromBitArray(r,1,5);switch(t){case 12:return new a$(r);case 13:return new o$(r)}var n=Af.extractNumericValueFromBitArray(r,1,7);switch(n){case 56:return new jo(r,"310","11");case 57:return new jo(r,"320","11");case 58:return new jo(r,"310","13");case 59:return new jo(r,"320","13");case 60:return new jo(r,"310","15");case 61:return new jo(r,"320","15");case 62:return new jo(r,"310","17");case 63:return new jo(r,"320","17")}}catch(a){throw console.log(a),new Xu("unknown decoder: "+r)}}var yx=function(){function r(e,t,n,a){this.leftchar=e,this.rightchar=t,this.finderpattern=n,this.maybeLast=a}return r.prototype.mayBeLast=function(){return this.maybeLast},r.prototype.getLeftChar=function(){return this.leftchar},r.prototype.getRightChar=function(){return this.rightchar},r.prototype.getFinderPattern=function(){return this.finderpattern},r.prototype.mustBeLast=function(){return this.rightchar==null},r.prototype.toString=function(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"},r.equals=function(e,t){return e instanceof r?r.equalsOrNull(e.leftchar,t.leftchar)&&r.equalsOrNull(e.rightchar,t.rightchar)&&r.equalsOrNull(e.finderpattern,t.finderpattern):!1},r.equalsOrNull=function(e,t){return e===null?t===null:r.equals(e,t)},r.prototype.hashCode=function(){var e=this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue();return e},r}(),l$=function(){function r(e,t,n){this.pairs=e,this.rowNumber=t,this.wasReversed=n}return r.prototype.getPairs=function(){return this.pairs},r.prototype.getRowNumber=function(){return this.rowNumber},r.prototype.isReversed=function(){return this.wasReversed},r.prototype.isEquivalent=function(e){return this.checkEqualitity(this,e)},r.prototype.toString=function(){return"{ "+this.pairs+" }"},r.prototype.equals=function(e,t){return e instanceof r?this.checkEqualitity(e,t)&&e.wasReversed===t.wasReversed:!1},r.prototype.checkEqualitity=function(e,t){if(!(!e||!t)){var n;return e.forEach(function(a,i){t.forEach(function(o){a.getLeftChar().getValue()===o.getLeftChar().getValue()&&a.getRightChar().getValue()===o.getRightChar().getValue()&&a.getFinderPatter().getValue()===o.getFinderPatter().getValue()&&(n=!0)})}),n}},r}(),u$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Po=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},d$=function(r){u$(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.pairs=new Array(e.MAX_PAIRS),t.rows=new Array,t.startEnd=[2],t}return e.prototype.decodeRow=function(t,n,a){this.pairs.length=0,this.startFromEven=!1;try{return e.constructResult(this.decodeRow2pairs(t,n))}catch{}return this.pairs.length=0,this.startFromEven=!0,e.constructResult(this.decodeRow2pairs(t,n))},e.prototype.reset=function(){this.pairs.length=0,this.rows.length=0},e.prototype.decodeRow2pairs=function(t,n){for(var a=!1;!a;)try{this.pairs.push(this.retrieveNextPair(n,this.pairs,t))}catch(s){if(s instanceof Ce){if(!this.pairs.length)throw new Ce;a=!0}}if(this.checkChecksum())return this.pairs;var i;if(this.rows.length?i=!0:i=!1,this.storeRow(t,!1),i){var o=this.checkRowsBoolean(!1);if(o!=null||(o=this.checkRowsBoolean(!0),o!=null))return o}throw new Ce},e.prototype.checkRowsBoolean=function(t){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());var n=null;try{n=this.checkRows(new Array,0)}catch(a){console.log(a)}return t&&(this.rows=this.rows.reverse()),n},e.prototype.checkRows=function(t,n){for(var a,i,o=n;o<this.rows.length;o++){var s=this.rows[o];this.pairs.length=0;try{for(var l=(a=void 0,Po(t)),u=l.next();!u.done;u=l.next()){var d=u.value;this.pairs.push(d.getPairs())}}catch(h){a={error:h}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}if(this.pairs.push(s.getPairs()),!!e.isValidSequence(this.pairs)){if(this.checkChecksum())return this.pairs;var f=new Array(t);f.push(s);try{return this.checkRows(f,o+1)}catch(h){console.log(h)}}}throw new Ce},e.isValidSequence=function(t){var n,a;try{for(var i=Po(e.FINDER_PATTERN_SEQUENCES),o=i.next();!o.done;o=i.next()){var s=o.value;if(!(t.length>s.length)){for(var l=!0,u=0;u<t.length;u++)if(t[u].getFinderPattern().getValue()!==s[u]){l=!1;break}if(l)return!0}}}catch(d){n={error:d}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}return!1},e.prototype.storeRow=function(t,n){for(var a=0,i=!1,o=!1;a<this.rows.length;){var s=this.rows[a];if(s.getRowNumber()>t){o=s.isEquivalent(this.pairs);break}i=s.isEquivalent(this.pairs),a++}o||i||e.isPartialRow(this.pairs,this.rows)||(this.rows.push(a,new l$(this.pairs,t,n)),this.removePartialRows(this.pairs,this.rows))},e.prototype.removePartialRows=function(t,n){var a,i,o,s,l,u;try{for(var d=Po(n),f=d.next();!f.done;f=d.next()){var h=f.value;if(h.getPairs().length!==t.length){var p=!0;try{for(var g=(o=void 0,Po(h.getPairs())),v=g.next();!v.done;v=g.next()){var b=v.value,y=!1;try{for(var C=(l=void 0,Po(t)),S=C.next();!S.done;S=C.next()){var j=S.value;if(yx.equals(b,j)){y=!0;break}}}catch(D){l={error:D}}finally{try{S&&!S.done&&(u=C.return)&&u.call(C)}finally{if(l)throw l.error}}y||(p=!1)}}catch(D){o={error:D}}finally{try{v&&!v.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}}}}catch(D){a={error:D}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}},e.isPartialRow=function(t,n){var a,i,o,s,l,u;try{for(var d=Po(n),f=d.next();!f.done;f=d.next()){var h=f.value,p=!0;try{for(var g=(o=void 0,Po(t)),v=g.next();!v.done;v=g.next()){var b=v.value,y=!1;try{for(var C=(l=void 0,Po(h.getPairs())),S=C.next();!S.done;S=C.next()){var j=S.value;if(b.equals(j)){y=!0;break}}}catch(D){l={error:D}}finally{try{S&&!S.done&&(u=C.return)&&u.call(C)}finally{if(l)throw l.error}}if(!y){p=!1;break}}}catch(D){o={error:D}}finally{try{v&&!v.done&&(s=g.return)&&s.call(g)}finally{if(o)throw o.error}}if(p)return!0}}catch(D){a={error:D}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}return!1},e.prototype.getRows=function(){return this.rows},e.constructResult=function(t){var n=UB.buildBitArray(t),a=c$(n),i=a.parseInformation(),o=t[0].getFinderPattern().getResultPoints(),s=t[t.length-1].getFinderPattern().getResultPoints(),l=[o[0],o[1],s[0],s[1]];return new $n(i,null,null,l,ot.RSS_EXPANDED,null)},e.prototype.checkChecksum=function(){var t=this.pairs.get(0),n=t.getLeftChar(),a=t.getRightChar();if(a===null)return!1;for(var i=a.getChecksumPortion(),o=2,s=1;s<this.pairs.size();++s){var l=this.pairs.get(s);i+=l.getLeftChar().getChecksumPortion(),o++;var u=l.getRightChar();u!=null&&(i+=u.getChecksumPortion(),o++)}i%=211;var d=211*(o-4)+i;return d===n.getValue()},e.getNextSecondBar=function(t,n){var a;return t.get(n)?(a=t.getNextUnset(n),a=t.getNextSet(a)):(a=t.getNextSet(n),a=t.getNextUnset(a)),a},e.prototype.retrieveNextPair=function(t,n,a){var i=n.length%2===0;this.startFromEven&&(i=!i);var o,s=!0,l=-1;do this.findNextPair(t,n,l),o=this.parseFoundFinderPattern(t,a,i),o===null?l=e.getNextSecondBar(t,this.startEnd[0]):s=!1;while(s);var u=this.decodeDataCharacter(t,o,i,!0);if(!this.isEmptyPair(n)&&n[n.length-1].mustBeLast())throw new Ce;var d;try{d=this.decodeDataCharacter(t,o,i,!1)}catch(f){d=null,console.log(f)}return new yx(u,d,o,!0)},e.prototype.isEmptyPair=function(t){return t.length===0},e.prototype.findNextPair=function(t,n,a){var i=this.getDecodeFinderCounters();i[0]=0,i[1]=0,i[2]=0,i[3]=0;var o=t.getSize(),s;if(a>=0)s=a;else if(this.isEmptyPair(n))s=0;else{var l=n[n.length-1];s=l.getFinderPattern().getStartEnd()[1]}var u=n.length%2!==0;this.startFromEven&&(u=!u);for(var d=!1;s<o&&(d=!t.get(s),!!d);)s++;for(var f=0,h=s,p=s;p<o;p++)if(t.get(p)!==d)i[f]++;else{if(f===3){if(u&&e.reverseCounters(i),e.isFinderPattern(i)){this.startEnd[0]=h,this.startEnd[1]=p;return}u&&e.reverseCounters(i),h+=i[0]+i[1],i[0]=i[2],i[1]=i[3],i[2]=0,i[3]=0,f--}else f++;i[f]=1,d=!d}throw new Ce},e.reverseCounters=function(t){for(var n=t.length,a=0;a<n/2;++a){var i=t[a];t[a]=t[n-a-1],t[n-a-1]=i}},e.prototype.parseFoundFinderPattern=function(t,n,a){var i,o,s;if(a){for(var l=this.startEnd[0]-1;l>=0&&!t.get(l);)l--;l++,i=this.startEnd[0]-l,o=l,s=this.startEnd[1]}else o=this.startEnd[0],s=t.getNextUnset(this.startEnd[1]+1),i=s-this.startEnd[1];var u=this.getDecodeFinderCounters();mr.arraycopy(u,0,u,1,u.length-1),u[0]=i;var d;try{d=this.parseFinderValue(u,e.FINDER_PATTERNS)}catch{return null}return new A4(d,[o,s],o,s,n)},e.prototype.decodeDataCharacter=function(t,n,a,i){for(var o=this.getDataCharacterCounters(),s=0;s<o.length;s++)o[s]=0;if(i)e.recordPatternInReverse(t,n.getStartEnd()[0],o);else{e.recordPattern(t,n.getStartEnd()[1],o);for(var l=0,u=o.length-1;l<u;l++,u--){var d=o[l];o[l]=o[u],o[u]=d}}var f=17,h=Wt.sum(new Int32Array(o))/f,p=(n.getStartEnd()[1]-n.getStartEnd()[0])/15;if(Math.abs(h-p)/p>.3)throw new Ce;for(var g=this.getOddCounts(),v=this.getEvenCounts(),b=this.getOddRoundingErrors(),y=this.getEvenRoundingErrors(),l=0;l<o.length;l++){var C=1*o[l]/h,S=C+.5;if(S<1){if(C<.3)throw new Ce;S=1}else if(S>8){if(C>8.7)throw new Ce;S=8}var j=l/2;l&1?(v[j]=S,y[j]=C-S):(g[j]=S,b[j]=C-S)}this.adjustOddEvenCounts(f);for(var D=4*n.getValue()+(a?0:2)+(i?0:1)-1,F=0,M=0,l=g.length-1;l>=0;l--){if(e.isNotA1left(n,a,i)){var T=e.WEIGHTS[D][2*l];M+=g[l]*T}F+=g[l]}for(var q=0,l=v.length-1;l>=0;l--)if(e.isNotA1left(n,a,i)){var T=e.WEIGHTS[D][2*l+1];q+=v[l]*T}var J=M+q;if(F&1||F>13||F<4)throw new Ce;var O=(13-F)/2,k=e.SYMBOL_WIDEST[O],H=9-k,X=$c.getRSSvalue(g,k,!0),ce=$c.getRSSvalue(v,H,!1),Q=e.EVEN_TOTAL_SUBSET[O],re=e.GSUM[O],G=X*Q+ce+re;return new Qf(G,J)},e.isNotA1left=function(t,n,a){return!(t.getValue()===0&&n&&a)},e.prototype.adjustOddEvenCounts=function(t){var n=Wt.sum(new Int32Array(this.getOddCounts())),a=Wt.sum(new Int32Array(this.getEvenCounts())),i=!1,o=!1;n>13?o=!0:n<4&&(i=!0);var s=!1,l=!1;a>13?l=!0:a<4&&(s=!0);var u=n+a-t,d=(n&1)===1,f=(a&1)===0;if(u===1)if(d){if(f)throw new Ce;o=!0}else{if(!f)throw new Ce;l=!0}else if(u===-1)if(d){if(f)throw new Ce;i=!0}else{if(!f)throw new Ce;s=!0}else if(u===0){if(d){if(!f)throw new Ce;n<a?(i=!0,l=!0):(o=!0,s=!0)}else if(f)throw new Ce}else throw new Ce;if(i){if(o)throw new Ce;e.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&e.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(l)throw new Ce;e.increment(this.getEvenCounts(),this.getOddRoundingErrors())}l&&e.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.SYMBOL_WIDEST=[7,5,4,3,1],e.EVEN_TOTAL_SUBSET=[4,20,52,104,204],e.GSUM=[0,348,1388,2948,3988],e.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],e.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],e.FINDER_PAT_A=0,e.FINDER_PAT_B=1,e.FINDER_PAT_C=2,e.FINDER_PAT_D=3,e.FINDER_PAT_E=4,e.FINDER_PAT_F=5,e.FINDER_PATTERN_SEQUENCES=[[e.FINDER_PAT_A,e.FINDER_PAT_A],[e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B],[e.FINDER_PAT_A,e.FINDER_PAT_C,e.FINDER_PAT_B,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_C],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_E,e.FINDER_PAT_B,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F],[e.FINDER_PAT_A,e.FINDER_PAT_A,e.FINDER_PAT_B,e.FINDER_PAT_B,e.FINDER_PAT_C,e.FINDER_PAT_D,e.FINDER_PAT_D,e.FINDER_PAT_E,e.FINDER_PAT_E,e.FINDER_PAT_F,e.FINDER_PAT_F]],e.MAX_PAIRS=11,e}(ws),f$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),h$=function(r){f$(e,r);function e(t,n,a){var i=r.call(this,t,n)||this;return i.count=0,i.finderPattern=a,i}return e.prototype.getFinderPattern=function(){return this.finderPattern},e.prototype.getCount=function(){return this.count},e.prototype.incrementCount=function(){this.count++},e}(Qf),p$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),N1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},bx=function(r){p$(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.possibleLeftPairs=[],t.possibleRightPairs=[],t}return e.prototype.decodeRow=function(t,n,a){var i,o,s,l,u=this.decodePair(n,!1,t,a);e.addOrTally(this.possibleLeftPairs,u),n.reverse();var d=this.decodePair(n,!0,t,a);e.addOrTally(this.possibleRightPairs,d),n.reverse();try{for(var f=N1(this.possibleLeftPairs),h=f.next();!h.done;h=f.next()){var p=h.value;if(p.getCount()>1)try{for(var g=(s=void 0,N1(this.possibleRightPairs)),v=g.next();!v.done;v=g.next()){var b=v.value;if(b.getCount()>1&&e.checkChecksum(p,b))return e.constructResult(p,b)}}catch(y){s={error:y}}finally{try{v&&!v.done&&(l=g.return)&&l.call(g)}finally{if(s)throw s.error}}}}catch(y){i={error:y}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}throw new Ce},e.addOrTally=function(t,n){var a,i;if(n!=null){var o=!1;try{for(var s=N1(t),l=s.next();!l.done;l=s.next()){var u=l.value;if(u.getValue()===n.getValue()){u.incrementCount(),o=!0;break}}}catch(d){a={error:d}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}o||t.push(n)}},e.prototype.reset=function(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0},e.constructResult=function(t,n){for(var a=4537077*t.getValue()+n.getValue(),i=new String(a).toString(),o=new Pt,s=13-i.length;s>0;s--)o.append("0");o.append(i);for(var l=0,s=0;s<13;s++){var u=o.charAt(s).charCodeAt(0)-48;l+=s&1?u:3*u}l=10-l%10,l===10&&(l=0),o.append(l.toString());var d=t.getFinderPattern().getResultPoints(),f=n.getFinderPattern().getResultPoints();return new $n(o.toString(),null,0,[d[0],d[1],f[0],f[1]],ot.RSS_14,new Date().getTime())},e.checkChecksum=function(t,n){var a=(t.getChecksumPortion()+16*n.getChecksumPortion())%79,i=9*t.getFinderPattern().getValue()+n.getFinderPattern().getValue();return i>72&&i--,i>8&&i--,a===i},e.prototype.decodePair=function(t,n,a,i){try{var o=this.findFinderPattern(t,n),s=this.parseFoundFinderPattern(t,a,n,o),l=i==null?null:i.get(gr.NEED_RESULT_POINT_CALLBACK);if(l!=null){var u=(o[0]+o[1])/2;n&&(u=t.getSize()-1-u),l.foundPossibleResultPoint(new Je(u,a))}var d=this.decodeDataCharacter(t,s,!0),f=this.decodeDataCharacter(t,s,!1);return new h$(1597*d.getValue()+f.getValue(),d.getChecksumPortion()+4*f.getChecksumPortion(),s)}catch{return null}},e.prototype.decodeDataCharacter=function(t,n,a){for(var i=this.getDataCharacterCounters(),o=0;o<i.length;o++)i[o]=0;if(a)cn.recordPatternInReverse(t,n.getStartEnd()[0],i);else{cn.recordPattern(t,n.getStartEnd()[1]+1,i);for(var s=0,l=i.length-1;s<l;s++,l--){var u=i[s];i[s]=i[l],i[l]=u}}for(var d=a?16:15,f=Wt.sum(new Int32Array(i))/d,h=this.getOddCounts(),p=this.getEvenCounts(),g=this.getOddRoundingErrors(),v=this.getEvenRoundingErrors(),s=0;s<i.length;s++){var b=i[s]/f,y=Math.floor(b+.5);y<1?y=1:y>8&&(y=8);var C=Math.floor(s/2);s&1?(p[C]=y,v[C]=b-y):(h[C]=y,g[C]=b-y)}this.adjustOddEvenCounts(a,d);for(var S=0,j=0,s=h.length-1;s>=0;s--)j*=9,j+=h[s],S+=h[s];for(var D=0,F=0,s=p.length-1;s>=0;s--)D*=9,D+=p[s],F+=p[s];var M=j+3*D;if(a){if(S&1||S>12||S<4)throw new Ce;var T=(12-S)/2,q=e.OUTSIDE_ODD_WIDEST[T],J=9-q,O=$c.getRSSvalue(h,q,!1),k=$c.getRSSvalue(p,J,!0),H=e.OUTSIDE_EVEN_TOTAL_SUBSET[T],X=e.OUTSIDE_GSUM[T];return new Qf(O*H+k+X,M)}else{if(F&1||F>10||F<4)throw new Ce;var T=(10-F)/2,q=e.INSIDE_ODD_WIDEST[T],J=9-q,O=$c.getRSSvalue(h,q,!0),k=$c.getRSSvalue(p,J,!1),ce=e.INSIDE_ODD_TOTAL_SUBSET[T],X=e.INSIDE_GSUM[T];return new Qf(k*ce+O+X,M)}},e.prototype.findFinderPattern=function(t,n){var a=this.getDecodeFinderCounters();a[0]=0,a[1]=0,a[2]=0,a[3]=0;for(var i=t.getSize(),o=!1,s=0;s<i&&(o=!t.get(s),n!==o);)s++;for(var l=0,u=s,d=s;d<i;d++)if(t.get(d)!==o)a[l]++;else{if(l===3){if(ws.isFinderPattern(a))return[u,d];u+=a[0]+a[1],a[0]=a[2],a[1]=a[3],a[2]=0,a[3]=0,l--}else l++;a[l]=1,o=!o}throw new Ce},e.prototype.parseFoundFinderPattern=function(t,n,a,i){for(var o=t.get(i[0]),s=i[0]-1;s>=0&&o!==t.get(s);)s--;s++;var l=i[0]-s,u=this.getDecodeFinderCounters(),d=new Int32Array(u.length);mr.arraycopy(u,0,d,1,u.length-1),d[0]=l;var f=this.parseFinderValue(d,e.FINDER_PATTERNS),h=s,p=i[1];return a&&(h=t.getSize()-1-h,p=t.getSize()-1-p),new A4(f,[s,i[1]],h,p,n)},e.prototype.adjustOddEvenCounts=function(t,n){var a=Wt.sum(new Int32Array(this.getOddCounts())),i=Wt.sum(new Int32Array(this.getEvenCounts())),o=!1,s=!1,l=!1,u=!1;t?(a>12?s=!0:a<4&&(o=!0),i>12?u=!0:i<4&&(l=!0)):(a>11?s=!0:a<5&&(o=!0),i>10?u=!0:i<4&&(l=!0));var d=a+i-n,f=(a&1)===(t?1:0),h=(i&1)===1;if(d===1)if(f){if(h)throw new Ce;s=!0}else{if(!h)throw new Ce;u=!0}else if(d===-1)if(f){if(h)throw new Ce;o=!0}else{if(!h)throw new Ce;l=!0}else if(d===0){if(f){if(!h)throw new Ce;a<i?(o=!0,u=!0):(s=!0,l=!0)}else if(h)throw new Ce}else throw new Ce;if(o){if(s)throw new Ce;ws.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(s&&ws.decrement(this.getOddCounts(),this.getOddRoundingErrors()),l){if(u)throw new Ce;ws.increment(this.getEvenCounts(),this.getOddRoundingErrors())}u&&ws.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())},e.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],e.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],e.OUTSIDE_GSUM=[0,161,961,2015,2715],e.INSIDE_GSUM=[0,336,1036,1516],e.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],e.INSIDE_ODD_WIDEST=[2,4,6,8],e.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])],e}(ws),m$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Uc=function(r){m$(e,r);function e(t){var n=r.call(this)||this;n.readers=[];var a=t?t.get(gr.POSSIBLE_FORMATS):null,i=t&&t.get(gr.ASSUME_CODE_39_CHECK_DIGIT)!==void 0,o=t&&t.get(gr.ENABLE_CODE_39_EXTENDED_MODE)!==void 0;return a&&((a.includes(ot.EAN_13)||a.includes(ot.UPC_A)||a.includes(ot.EAN_8)||a.includes(ot.UPC_E))&&n.readers.push(new C1(t)),a.includes(ot.CODE_39)&&n.readers.push(new ux(i,o)),a.includes(ot.CODE_93)&&n.readers.push(new dx),a.includes(ot.CODE_128)&&n.readers.push(new lx),a.includes(ot.ITF)&&n.readers.push(new fx),a.includes(ot.CODABAR)&&n.readers.push(new LB),a.includes(ot.RSS_14)&&n.readers.push(new bx),a.includes(ot.RSS_EXPANDED)&&(console.warn("RSS Expanded reader IS NOT ready for production yet! use at your own risk."),n.readers.push(new d$))),n.readers.length===0&&(n.readers.push(new C1(t)),n.readers.push(new ux),n.readers.push(new dx),n.readers.push(new C1(t)),n.readers.push(new lx),n.readers.push(new fx),n.readers.push(new bx)),n}return e.prototype.decodeRow=function(t,n,a){for(var i=0;i<this.readers.length;i++)try{return this.readers[i].decodeRow(t,n,a)}catch{}throw new Ce},e.prototype.reset=function(){this.readers.forEach(function(t){return t.reset()})},e}(cn),g$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){g$(e,r);function e(t,n){return t===void 0&&(t=500),r.call(this,new Uc(n),t,n)||this}return e})(vl);var wx=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jt=function(){function r(e,t,n){this.ecCodewords=e,this.ecBlocks=[t],n&&this.ecBlocks.push(n)}return r.prototype.getECCodewords=function(){return this.ecCodewords},r.prototype.getECBlocks=function(){return this.ecBlocks},r}(),Xt=function(){function r(e,t){this.count=e,this.dataCodewords=t}return r.prototype.getCount=function(){return this.count},r.prototype.getDataCodewords=function(){return this.dataCodewords},r}(),v$=function(){function r(e,t,n,a,i,o){var s,l;this.versionNumber=e,this.symbolSizeRows=t,this.symbolSizeColumns=n,this.dataRegionSizeRows=a,this.dataRegionSizeColumns=i,this.ecBlocks=o;var u=0,d=o.getECCodewords(),f=o.getECBlocks();try{for(var h=wx(f),p=h.next();!p.done;p=h.next()){var g=p.value;u+=g.getCount()*(g.getDataCodewords()+d)}}catch(v){s={error:v}}finally{try{p&&!p.done&&(l=h.return)&&l.call(h)}finally{if(s)throw s.error}}this.totalCodewords=u}return r.prototype.getVersionNumber=function(){return this.versionNumber},r.prototype.getSymbolSizeRows=function(){return this.symbolSizeRows},r.prototype.getSymbolSizeColumns=function(){return this.symbolSizeColumns},r.prototype.getDataRegionSizeRows=function(){return this.dataRegionSizeRows},r.prototype.getDataRegionSizeColumns=function(){return this.dataRegionSizeColumns},r.prototype.getTotalCodewords=function(){return this.totalCodewords},r.prototype.getECBlocks=function(){return this.ecBlocks},r.getVersionForDimensions=function(e,t){var n,a;if(e&1||t&1)throw new ke;try{for(var i=wx(r.VERSIONS),o=i.next();!o.done;o=i.next()){var s=o.value;if(s.symbolSizeRows===e&&s.symbolSizeColumns===t)return s}}catch(l){n={error:l}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(n)throw n.error}}throw new ke},r.prototype.toString=function(){return""+this.versionNumber},r.buildVersions=function(){return[new r(1,10,10,8,8,new Jt(5,new Xt(1,3))),new r(2,12,12,10,10,new Jt(7,new Xt(1,5))),new r(3,14,14,12,12,new Jt(10,new Xt(1,8))),new r(4,16,16,14,14,new Jt(12,new Xt(1,12))),new r(5,18,18,16,16,new Jt(14,new Xt(1,18))),new r(6,20,20,18,18,new Jt(18,new Xt(1,22))),new r(7,22,22,20,20,new Jt(20,new Xt(1,30))),new r(8,24,24,22,22,new Jt(24,new Xt(1,36))),new r(9,26,26,24,24,new Jt(28,new Xt(1,44))),new r(10,32,32,14,14,new Jt(36,new Xt(1,62))),new r(11,36,36,16,16,new Jt(42,new Xt(1,86))),new r(12,40,40,18,18,new Jt(48,new Xt(1,114))),new r(13,44,44,20,20,new Jt(56,new Xt(1,144))),new r(14,48,48,22,22,new Jt(68,new Xt(1,174))),new r(15,52,52,24,24,new Jt(42,new Xt(2,102))),new r(16,64,64,14,14,new Jt(56,new Xt(2,140))),new r(17,72,72,16,16,new Jt(36,new Xt(4,92))),new r(18,80,80,18,18,new Jt(48,new Xt(4,114))),new r(19,88,88,20,20,new Jt(56,new Xt(4,144))),new r(20,96,96,22,22,new Jt(68,new Xt(4,174))),new r(21,104,104,24,24,new Jt(56,new Xt(6,136))),new r(22,120,120,18,18,new Jt(68,new Xt(6,175))),new r(23,132,132,20,20,new Jt(62,new Xt(8,163))),new r(24,144,144,22,22,new Jt(62,new Xt(8,156),new Xt(2,155))),new r(25,8,18,6,16,new Jt(7,new Xt(1,5))),new r(26,8,32,6,14,new Jt(11,new Xt(1,10))),new r(27,12,26,10,24,new Jt(14,new Xt(1,16))),new r(28,12,36,10,16,new Jt(18,new Xt(1,22))),new r(29,16,36,14,16,new Jt(24,new Xt(1,32))),new r(30,16,48,14,22,new Jt(28,new Xt(1,49)))]},r.VERSIONS=r.buildVersions(),r}(),x$=function(){function r(e){var t=e.getHeight();if(t<8||t>144||t&1)throw new ke;this.version=r.readVersion(e),this.mappingBitMatrix=this.extractDataRegion(e),this.readMappingMatrix=new $i(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}return r.prototype.getVersion=function(){return this.version},r.readVersion=function(e){var t=e.getHeight(),n=e.getWidth();return v$.getVersionForDimensions(t,n)},r.prototype.readCodewords=function(){var e=new Int8Array(this.version.getTotalCodewords()),t=0,n=4,a=0,i=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth(),s=!1,l=!1,u=!1,d=!1;do if(n===i&&a===0&&!s)e[t++]=this.readCorner1(i,o)&255,n-=2,a+=2,s=!0;else if(n===i-2&&a===0&&o&3&&!l)e[t++]=this.readCorner2(i,o)&255,n-=2,a+=2,l=!0;else if(n===i+4&&a===2&&!(o&7)&&!u)e[t++]=this.readCorner3(i,o)&255,n-=2,a+=2,u=!0;else if(n===i-2&&a===0&&(o&7)===4&&!d)e[t++]=this.readCorner4(i,o)&255,n-=2,a+=2,d=!0;else{do n<i&&a>=0&&!this.readMappingMatrix.get(a,n)&&(e[t++]=this.readUtah(n,a,i,o)&255),n-=2,a+=2;while(n>=0&&a<o);n+=1,a+=3;do n>=0&&a<o&&!this.readMappingMatrix.get(a,n)&&(e[t++]=this.readUtah(n,a,i,o)&255),n+=2,a-=2;while(n<i&&a>=0);n+=3,a+=1}while(n<i||a<o);if(t!==this.version.getTotalCodewords())throw new ke;return e},r.prototype.readModule=function(e,t,n,a){return e<0&&(e+=n,t+=4-(n+4&7)),t<0&&(t+=a,e+=4-(a+4&7)),this.readMappingMatrix.set(t,e),this.mappingBitMatrix.get(t,e)},r.prototype.readUtah=function(e,t,n,a){var i=0;return this.readModule(e-2,t-2,n,a)&&(i|=1),i<<=1,this.readModule(e-2,t-1,n,a)&&(i|=1),i<<=1,this.readModule(e-1,t-2,n,a)&&(i|=1),i<<=1,this.readModule(e-1,t-1,n,a)&&(i|=1),i<<=1,this.readModule(e-1,t,n,a)&&(i|=1),i<<=1,this.readModule(e,t-2,n,a)&&(i|=1),i<<=1,this.readModule(e,t-1,n,a)&&(i|=1),i<<=1,this.readModule(e,t,n,a)&&(i|=1),i},r.prototype.readCorner1=function(e,t){var n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,1,e,t)&&(n|=1),n<<=1,this.readModule(e-1,2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n},r.prototype.readCorner2=function(e,t){var n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-4,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n},r.prototype.readCorner3=function(e,t){var n=0;return this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(0,t-3,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-3,e,t)&&(n|=1),n<<=1,this.readModule(1,t-2,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n},r.prototype.readCorner4=function(e,t){var n=0;return this.readModule(e-3,0,e,t)&&(n|=1),n<<=1,this.readModule(e-2,0,e,t)&&(n|=1),n<<=1,this.readModule(e-1,0,e,t)&&(n|=1),n<<=1,this.readModule(0,t-2,e,t)&&(n|=1),n<<=1,this.readModule(0,t-1,e,t)&&(n|=1),n<<=1,this.readModule(1,t-1,e,t)&&(n|=1),n<<=1,this.readModule(2,t-1,e,t)&&(n|=1),n<<=1,this.readModule(3,t-1,e,t)&&(n|=1),n},r.prototype.extractDataRegion=function(e){var t=this.version.getSymbolSizeRows(),n=this.version.getSymbolSizeColumns();if(e.getHeight()!==t)throw new st("Dimension of bitMatrix must match the version size");for(var a=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),o=t/a|0,s=n/i|0,l=o*a,u=s*i,d=new $i(u,l),f=0;f<o;++f)for(var h=f*a,p=0;p<s;++p)for(var g=p*i,v=0;v<a;++v)for(var b=f*(a+2)+1+v,y=h+v,C=0;C<i;++C){var S=p*(i+2)+1+C;if(e.get(S,b)){var j=g+C;d.set(j,y)}}return d},r}(),_x=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},y$=function(){function r(e,t){this.numDataCodewords=e,this.codewords=t}return r.getDataBlocks=function(e,t){var n,a,i,o,s=t.getECBlocks(),l=0,u=s.getECBlocks();try{for(var d=_x(u),f=d.next();!f.done;f=d.next()){var h=f.value;l+=h.getCount()}}catch(X){n={error:X}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}var p=new Array(l),g=0;try{for(var v=_x(u),b=v.next();!b.done;b=v.next())for(var h=b.value,y=0;y<h.getCount();y++){var C=h.getDataCodewords(),S=s.getECCodewords()+C;p[g++]=new r(C,new Uint8Array(S))}}catch(X){i={error:X}}finally{try{b&&!b.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}for(var j=p[0].codewords.length,D=j-s.getECCodewords(),F=D-1,M=0,y=0;y<F;y++)for(var T=0;T<g;T++)p[T].codewords[y]=e[M++];for(var q=t.getVersionNumber()===24,J=q?8:g,T=0;T<J;T++)p[T].codewords[D-1]=e[M++];for(var O=p[0].codewords.length,y=D;y<O;y++)for(var T=0;T<g;T++){var k=q?(T+8)%g:T,H=q&&k>7?y-1:y;p[k].codewords[H]=e[M++]}if(M!==e.length)throw new st;return p},r.prototype.getNumDataCodewords=function(){return this.numDataCodewords},r.prototype.getCodewords=function(){return this.codewords},r}(),D4=function(){function r(e){this.bytes=e,this.byteOffset=0,this.bitOffset=0}return r.prototype.getBitOffset=function(){return this.bitOffset},r.prototype.getByteOffset=function(){return this.byteOffset},r.prototype.readBits=function(e){if(e<1||e>32||e>this.available())throw new st(""+e);var t=0,n=this.bitOffset,a=this.byteOffset,i=this.bytes;if(n>0){var o=8-n,s=e<o?e:o,l=o-s,u=255>>8-s<<l;t=(i[a]&u)>>l,e-=s,n+=s,n===8&&(n=0,a++)}if(e>0){for(;e>=8;)t=t<<8|i[a]&255,a++,e-=8;if(e>0){var l=8-e,u=255>>l<<l;t=t<<e|(i[a]&u)>>l,n+=e}}return this.bitOffset=n,this.byteOffset=a,t},r.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},r}(),en;(function(r){r[r.PAD_ENCODE=0]="PAD_ENCODE",r[r.ASCII_ENCODE=1]="ASCII_ENCODE",r[r.C40_ENCODE=2]="C40_ENCODE",r[r.TEXT_ENCODE=3]="TEXT_ENCODE",r[r.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",r[r.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",r[r.BASE256_ENCODE=6]="BASE256_ENCODE"})(en||(en={}));var b$=function(){function r(){}return r.decode=function(e){var t=new D4(e),n=new Pt,a=new Pt,i=new Array,o=en.ASCII_ENCODE;do if(o===en.ASCII_ENCODE)o=this.decodeAsciiSegment(t,n,a);else{switch(o){case en.C40_ENCODE:this.decodeC40Segment(t,n);break;case en.TEXT_ENCODE:this.decodeTextSegment(t,n);break;case en.ANSIX12_ENCODE:this.decodeAnsiX12Segment(t,n);break;case en.EDIFACT_ENCODE:this.decodeEdifactSegment(t,n);break;case en.BASE256_ENCODE:this.decodeBase256Segment(t,n,i);break;default:throw new ke}o=en.ASCII_ENCODE}while(o!==en.PAD_ENCODE&&t.available()>0);return a.length()>0&&n.append(a.toString()),new Hh(e,n.toString(),i.length===0?null:i,null)},r.decodeAsciiSegment=function(e,t,n){var a=!1;do{var i=e.readBits(8);if(i===0)throw new ke;if(i<=128)return a&&(i+=128),t.append(String.fromCharCode(i-1)),en.ASCII_ENCODE;if(i===129)return en.PAD_ENCODE;if(i<=229){var o=i-130;o<10&&t.append("0"),t.append(""+o)}else switch(i){case 230:return en.C40_ENCODE;case 231:return en.BASE256_ENCODE;case 232:t.append("");break;case 233:case 234:break;case 235:a=!0;break;case 236:t.append("[)>05"),n.insert(0,"");break;case 237:t.append("[)>06"),n.insert(0,"");break;case 238:return en.ANSIX12_ENCODE;case 239:return en.TEXT_ENCODE;case 240:return en.EDIFACT_ENCODE;case 241:break;default:if(i!==254||e.available()!==0)throw new ke;break}}while(e.available()>0);return en.ASCII_ENCODE},r.decodeC40Segment=function(e,t){var n=!1,a=[],i=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var s=0;s<3;s++){var l=a[s];switch(i){case 0:if(l<3)i=l+1;else if(l<this.C40_BASIC_SET_CHARS.length){var u=this.C40_BASIC_SET_CHARS[l];n?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):t.append(u)}else throw new ke;break;case 1:n?(t.append(String.fromCharCode(l+128)),n=!1):t.append(String.fromCharCode(l)),i=0;break;case 2:if(l<this.C40_SHIFT2_SET_CHARS.length){var u=this.C40_SHIFT2_SET_CHARS[l];n?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):t.append(u)}else switch(l){case 27:t.append("");break;case 30:n=!0;break;default:throw new ke}i=0;break;case 3:n?(t.append(String.fromCharCode(l+224)),n=!1):t.append(String.fromCharCode(l+96)),i=0;break;default:throw new ke}}}while(e.available()>0)},r.decodeTextSegment=function(e,t){var n=!1,a=[],i=0;do{if(e.available()===8)return;var o=e.readBits(8);if(o===254)return;this.parseTwoBytes(o,e.readBits(8),a);for(var s=0;s<3;s++){var l=a[s];switch(i){case 0:if(l<3)i=l+1;else if(l<this.TEXT_BASIC_SET_CHARS.length){var u=this.TEXT_BASIC_SET_CHARS[l];n?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):t.append(u)}else throw new ke;break;case 1:n?(t.append(String.fromCharCode(l+128)),n=!1):t.append(String.fromCharCode(l)),i=0;break;case 2:if(l<this.TEXT_SHIFT2_SET_CHARS.length){var u=this.TEXT_SHIFT2_SET_CHARS[l];n?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):t.append(u)}else switch(l){case 27:t.append("");break;case 30:n=!0;break;default:throw new ke}i=0;break;case 3:if(l<this.TEXT_SHIFT3_SET_CHARS.length){var u=this.TEXT_SHIFT3_SET_CHARS[l];n?(t.append(String.fromCharCode(u.charCodeAt(0)+128)),n=!1):t.append(u),i=0}else throw new ke;break;default:throw new ke}}}while(e.available()>0)},r.decodeAnsiX12Segment=function(e,t){var n=[];do{if(e.available()===8)return;var a=e.readBits(8);if(a===254)return;this.parseTwoBytes(a,e.readBits(8),n);for(var i=0;i<3;i++){var o=n[i];switch(o){case 0:t.append("\r");break;case 1:t.append("*");break;case 2:t.append(">");break;case 3:t.append(" ");break;default:if(o<14)t.append(String.fromCharCode(o+44));else if(o<40)t.append(String.fromCharCode(o+51));else throw new ke;break}}}while(e.available()>0)},r.parseTwoBytes=function(e,t,n){var a=(e<<8)+t-1,i=Math.floor(a/1600);n[0]=i,a-=i*1600,i=Math.floor(a/40),n[1]=i,n[2]=a-i*40},r.decodeEdifactSegment=function(e,t){do{if(e.available()<=16)return;for(var n=0;n<4;n++){var a=e.readBits(6);if(a===31){var i=8-e.getBitOffset();i!==8&&e.readBits(i);return}a&32||(a|=64),t.append(String.fromCharCode(a))}}while(e.available()>0)},r.decodeBase256Segment=function(e,t,n){var a=1+e.getByteOffset(),i=this.unrandomize255State(e.readBits(8),a++),o;if(i===0?o=e.available()/8|0:i<250?o=i:o=250*(i-249)+this.unrandomize255State(e.readBits(8),a++),o<0)throw new ke;for(var s=new Uint8Array(o),l=0;l<o;l++){if(e.available()<8)throw new ke;s[l]=this.unrandomize255State(e.readBits(8),a++)}n.push(s);try{t.append(Va.decode(s,Bt.ISO88591))}catch(u){throw new Xu("Platform does not support required encoding: "+u.message)}},r.unrandomize255State=function(e,t){var n=149*t%255+1,a=e-n;return a>=0?a:a+256},r.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],r.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],r.TEXT_SHIFT2_SET_CHARS=r.C40_SHIFT2_SET_CHARS,r.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""],r}(),w$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},_$=function(){function r(){this.rsDecoder=new Wh(aa.DATA_MATRIX_FIELD_256)}return r.prototype.decode=function(e){var t,n,a=new x$(e),i=a.getVersion(),o=a.readCodewords(),s=y$.getDataBlocks(o,i),l=0;try{for(var u=w$(s),d=u.next();!d.done;d=u.next()){var f=d.value;l+=f.getNumDataCodewords()}}catch(S){t={error:S}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}for(var h=new Uint8Array(l),p=s.length,g=0;g<p;g++){var v=s[g],b=v.getCodewords(),y=v.getNumDataCodewords();this.correctErrors(b,y);for(var C=0;C<y;C++)h[C*p+g]=b[C]}return b$.decode(h)},r.prototype.correctErrors=function(e,t){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new Vr}for(var a=0;a<t;a++)e[a]=n[a]},r}(),C$=function(){function r(e){this.image=e,this.rectangleDetector=new Ip(this.image)}return r.prototype.detect=function(){var e=this.rectangleDetector.detect(),t=this.detectSolid1(e);if(t=this.detectSolid2(t),t[3]=this.correctTopRight(t),!t[3])throw new Ce;t=this.shiftToModuleCenter(t);var n=t[0],a=t[1],i=t[2],o=t[3],s=this.transitionsBetween(n,o)+1,l=this.transitionsBetween(i,o)+1;(s&1)===1&&(s+=1),(l&1)===1&&(l+=1),4*s<7*l&&4*l<7*s&&(s=l=Math.max(s,l));var u=r.sampleGrid(this.image,n,a,i,o,s,l);return new zg(u,[n,a,i,o])},r.shiftPoint=function(e,t,n){var a=(t.getX()-e.getX())/(n+1),i=(t.getY()-e.getY())/(n+1);return new Je(e.getX()+a,e.getY()+i)},r.moveAway=function(e,t,n){var a=e.getX(),i=e.getY();return a<t?a-=1:a+=1,i<n?i-=1:i+=1,new Je(a,i)},r.prototype.detectSolid1=function(e){var t=e[0],n=e[1],a=e[3],i=e[2],o=this.transitionsBetween(t,n),s=this.transitionsBetween(n,a),l=this.transitionsBetween(a,i),u=this.transitionsBetween(i,t),d=o,f=[i,t,n,a];return d>s&&(d=s,f[0]=t,f[1]=n,f[2]=a,f[3]=i),d>l&&(d=l,f[0]=n,f[1]=a,f[2]=i,f[3]=t),d>u&&(f[0]=a,f[1]=i,f[2]=t,f[3]=n),f},r.prototype.detectSolid2=function(e){var t=e[0],n=e[1],a=e[2],i=e[3],o=this.transitionsBetween(t,i),s=r.shiftPoint(n,a,(o+1)*4),l=r.shiftPoint(a,n,(o+1)*4),u=this.transitionsBetween(s,t),d=this.transitionsBetween(l,i);return u<d?(e[0]=t,e[1]=n,e[2]=a,e[3]=i):(e[0]=n,e[1]=a,e[2]=i,e[3]=t),e},r.prototype.correctTopRight=function(e){var t=e[0],n=e[1],a=e[2],i=e[3],o=this.transitionsBetween(t,i),s=this.transitionsBetween(n,i),l=r.shiftPoint(t,n,(s+1)*4),u=r.shiftPoint(a,n,(o+1)*4);o=this.transitionsBetween(l,i),s=this.transitionsBetween(u,i);var d=new Je(i.getX()+(a.getX()-n.getX())/(o+1),i.getY()+(a.getY()-n.getY())/(o+1)),f=new Je(i.getX()+(t.getX()-n.getX())/(s+1),i.getY()+(t.getY()-n.getY())/(s+1));if(!this.isValid(d))return this.isValid(f)?f:null;if(!this.isValid(f))return d;var h=this.transitionsBetween(l,d)+this.transitionsBetween(u,d),p=this.transitionsBetween(l,f)+this.transitionsBetween(u,f);return h>p?d:f},r.prototype.shiftToModuleCenter=function(e){var t=e[0],n=e[1],a=e[2],i=e[3],o=this.transitionsBetween(t,i)+1,s=this.transitionsBetween(a,i)+1,l=r.shiftPoint(t,n,s*4),u=r.shiftPoint(a,n,o*4);o=this.transitionsBetween(l,i)+1,s=this.transitionsBetween(u,i)+1,(o&1)===1&&(o+=1),(s&1)===1&&(s+=1);var d=(t.getX()+n.getX()+a.getX()+i.getX())/4,f=(t.getY()+n.getY()+a.getY()+i.getY())/4;t=r.moveAway(t,d,f),n=r.moveAway(n,d,f),a=r.moveAway(a,d,f),i=r.moveAway(i,d,f);var h,p;return l=r.shiftPoint(t,n,s*4),l=r.shiftPoint(l,i,o*4),h=r.shiftPoint(n,t,s*4),h=r.shiftPoint(h,a,o*4),u=r.shiftPoint(a,i,s*4),u=r.shiftPoint(u,n,o*4),p=r.shiftPoint(i,a,s*4),p=r.shiftPoint(p,t,o*4),[l,h,u,p]},r.prototype.isValid=function(e){return e.getX()>=0&&e.getX()<this.image.getWidth()&&e.getY()>0&&e.getY()<this.image.getHeight()},r.sampleGrid=function(e,t,n,a,i,o,s){var l=Hg.getInstance();return l.sampleGrid(e,o,s,.5,.5,o-.5,.5,o-.5,s-.5,.5,s-.5,t.getX(),t.getY(),i.getX(),i.getY(),a.getX(),a.getY(),n.getX(),n.getY())},r.prototype.transitionsBetween=function(e,t){var n=Math.trunc(e.getX()),a=Math.trunc(e.getY()),i=Math.trunc(t.getX()),o=Math.trunc(t.getY()),s=Math.abs(o-a)>Math.abs(i-n);if(s){var l=n;n=a,a=l,l=i,i=o,o=l}for(var u=Math.abs(i-n),d=Math.abs(o-a),f=-u/2,h=a<o?1:-1,p=n<i?1:-1,g=0,v=this.image.get(s?a:n,s?n:a),b=n,y=a;b!==i;b+=p){var C=this.image.get(s?y:b,s?b:y);if(C!==v&&(g++,v=C),f+=d,f>0){if(y===o)break;y+=h,f-=u}}return g},r}(),Zf=function(){function r(){this.decoder=new _$}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var n,a;if(t!=null&&t.has(gr.PURE_BARCODE)){var i=r.extractPureBits(e.getBlackMatrix());n=this.decoder.decode(i),a=r.NO_POINTS}else{var o=new C$(e.getBlackMatrix()).detect();n=this.decoder.decode(o.getBits()),a=o.getPoints()}var s=n.getRawBytes(),l=new $n(n.getText(),s,8*s.length,a,ot.DATA_MATRIX,mr.currentTimeMillis()),u=n.getByteSegments();u!=null&&l.putMetadata(En.BYTE_SEGMENTS,u);var d=n.getECLevel();return d!=null&&l.putMetadata(En.ERROR_CORRECTION_LEVEL,d),l},r.prototype.reset=function(){},r.extractPureBits=function(e){var t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t==null||n==null)throw new Ce;var a=this.moduleSize(t,e),i=t[1],o=n[1],s=t[0],l=n[0],u=(l-s+1)/a,d=(o-i+1)/a;if(u<=0||d<=0)throw new Ce;var f=a/2;i+=f,s+=f;for(var h=new $i(u,d),p=0;p<d;p++)for(var g=i+p*a,v=0;v<u;v++)e.get(s+v*a,g)&&h.set(v,p);return h},r.moduleSize=function(e,t){for(var n=t.getWidth(),a=e[0],i=e[1];a<n&&t.get(a,i);)a++;if(a===n)throw new Ce;var o=a-e[0];if(o===0)throw new Ce;return o},r.NO_POINTS=[],r}(),N$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){N$(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new Zf,t)||this}return e})(vl);var qc;(function(r){r[r.L=0]="L",r[r.M=1]="M",r[r.Q=2]="Q",r[r.H=3]="H"})(qc||(qc={}));var S$=function(){function r(e,t,n){this.value=e,this.stringValue=t,this.bits=n,r.FOR_BITS.set(n,this),r.FOR_VALUE.set(e,this)}return r.prototype.getValue=function(){return this.value},r.prototype.getBits=function(){return this.bits},r.fromString=function(e){switch(e){case"L":return r.L;case"M":return r.M;case"Q":return r.Q;case"H":return r.H;default:throw new kr(e+"not available")}},r.prototype.toString=function(){return this.stringValue},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.forBits=function(e){if(e<0||e>=r.FOR_BITS.size)throw new st;return r.FOR_BITS.get(e)},r.FOR_BITS=new Map,r.FOR_VALUE=new Map,r.L=new r(qc.L,"L",1),r.M=new r(qc.M,"M",0),r.Q=new r(qc.Q,"Q",3),r.H=new r(qc.H,"H",2),r}(),E$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},I4=function(){function r(e){this.errorCorrectionLevel=S$.forBits(e>>3&3),this.dataMask=e&7}return r.numBitsDiffering=function(e,t){return Tt.bitCount(e^t)},r.decodeFormatInformation=function(e,t){var n=r.doDecodeFormatInformation(e,t);return n!==null?n:r.doDecodeFormatInformation(e^r.FORMAT_INFO_MASK_QR,t^r.FORMAT_INFO_MASK_QR)},r.doDecodeFormatInformation=function(e,t){var n,a,i=Number.MAX_SAFE_INTEGER,o=0;try{for(var s=E$(r.FORMAT_INFO_DECODE_LOOKUP),l=s.next();!l.done;l=s.next()){var u=l.value,d=u[0];if(d===e||d===t)return new r(u[1]);var f=r.numBitsDiffering(e,d);f<i&&(o=u[1],i=f),e!==t&&(f=r.numBitsDiffering(t,d),f<i&&(o=u[1],i=f))}}catch(h){n={error:h}}finally{try{l&&!l.done&&(a=s.return)&&a.call(s)}finally{if(n)throw n.error}}return i<=3?new r(o):null},r.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},r.prototype.getDataMask=function(){return this.dataMask},r.prototype.hashCode=function(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.errorCorrectionLevel===t.errorCorrectionLevel&&this.dataMask===t.dataMask},r.FORMAT_INFO_MASK_QR=21522,r.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])],r}(),A$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},me=function(){function r(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.ecCodewordsPerBlock=e,this.ecBlocks=t}return r.prototype.getECCodewordsPerBlock=function(){return this.ecCodewordsPerBlock},r.prototype.getNumBlocks=function(){var e,t,n=0,a=this.ecBlocks;try{for(var i=A$(a),o=i.next();!o.done;o=i.next()){var s=o.value;n+=s.getCount()}}catch(l){e={error:l}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n},r.prototype.getTotalECCodewords=function(){return this.ecCodewordsPerBlock*this.getNumBlocks()},r.prototype.getECBlocks=function(){return this.ecBlocks},r}(),z=function(){function r(e,t){this.count=e,this.dataCodewords=t}return r.prototype.getCount=function(){return this.count},r.prototype.getDataCodewords=function(){return this.dataCodewords},r}(),j$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Is=function(){function r(e,t){for(var n,a,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];this.versionNumber=e,this.alignmentPatternCenters=t,this.ecBlocks=i;var s=0,l=i[0].getECCodewordsPerBlock(),u=i[0].getECBlocks();try{for(var d=j$(u),f=d.next();!f.done;f=d.next()){var h=f.value;s+=h.getCount()*(h.getDataCodewords()+l)}}catch(p){n={error:p}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}this.totalCodewords=s}return r.prototype.getVersionNumber=function(){return this.versionNumber},r.prototype.getAlignmentPatternCenters=function(){return this.alignmentPatternCenters},r.prototype.getTotalCodewords=function(){return this.totalCodewords},r.prototype.getDimensionForVersion=function(){return 17+4*this.versionNumber},r.prototype.getECBlocksForLevel=function(e){return this.ecBlocks[e.getValue()]},r.getProvisionalVersionForDimension=function(e){if(e%4!==1)throw new ke;try{return this.getVersionForNumber((e-17)/4)}catch{throw new ke}},r.getVersionForNumber=function(e){if(e<1||e>40)throw new st;return r.VERSIONS[e-1]},r.decodeVersionInformation=function(e){for(var t=Number.MAX_SAFE_INTEGER,n=0,a=0;a<r.VERSION_DECODE_INFO.length;a++){var i=r.VERSION_DECODE_INFO[a];if(i===e)return r.getVersionForNumber(a+7);var o=I4.numBitsDiffering(e,i);o<t&&(n=a+7,t=o)}return t<=3?r.getVersionForNumber(n):null},r.prototype.buildFunctionPattern=function(){var e=this.getDimensionForVersion(),t=new $i(e);t.setRegion(0,0,9,9),t.setRegion(e-8,0,8,9),t.setRegion(0,e-8,9,8);for(var n=this.alignmentPatternCenters.length,a=0;a<n;a++)for(var i=this.alignmentPatternCenters[a]-2,o=0;o<n;o++)a===0&&(o===0||o===n-1)||a===n-1&&o===0||t.setRegion(this.alignmentPatternCenters[o]-2,i,5,5);return t.setRegion(6,9,1,e-17),t.setRegion(9,6,e-17,1),this.versionNumber>6&&(t.setRegion(e-11,0,3,6),t.setRegion(0,e-11,6,3)),t},r.prototype.toString=function(){return""+this.versionNumber},r.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),r.VERSIONS=[new r(1,new Int32Array(0),new me(7,new z(1,19)),new me(10,new z(1,16)),new me(13,new z(1,13)),new me(17,new z(1,9))),new r(2,Int32Array.from([6,18]),new me(10,new z(1,34)),new me(16,new z(1,28)),new me(22,new z(1,22)),new me(28,new z(1,16))),new r(3,Int32Array.from([6,22]),new me(15,new z(1,55)),new me(26,new z(1,44)),new me(18,new z(2,17)),new me(22,new z(2,13))),new r(4,Int32Array.from([6,26]),new me(20,new z(1,80)),new me(18,new z(2,32)),new me(26,new z(2,24)),new me(16,new z(4,9))),new r(5,Int32Array.from([6,30]),new me(26,new z(1,108)),new me(24,new z(2,43)),new me(18,new z(2,15),new z(2,16)),new me(22,new z(2,11),new z(2,12))),new r(6,Int32Array.from([6,34]),new me(18,new z(2,68)),new me(16,new z(4,27)),new me(24,new z(4,19)),new me(28,new z(4,15))),new r(7,Int32Array.from([6,22,38]),new me(20,new z(2,78)),new me(18,new z(4,31)),new me(18,new z(2,14),new z(4,15)),new me(26,new z(4,13),new z(1,14))),new r(8,Int32Array.from([6,24,42]),new me(24,new z(2,97)),new me(22,new z(2,38),new z(2,39)),new me(22,new z(4,18),new z(2,19)),new me(26,new z(4,14),new z(2,15))),new r(9,Int32Array.from([6,26,46]),new me(30,new z(2,116)),new me(22,new z(3,36),new z(2,37)),new me(20,new z(4,16),new z(4,17)),new me(24,new z(4,12),new z(4,13))),new r(10,Int32Array.from([6,28,50]),new me(18,new z(2,68),new z(2,69)),new me(26,new z(4,43),new z(1,44)),new me(24,new z(6,19),new z(2,20)),new me(28,new z(6,15),new z(2,16))),new r(11,Int32Array.from([6,30,54]),new me(20,new z(4,81)),new me(30,new z(1,50),new z(4,51)),new me(28,new z(4,22),new z(4,23)),new me(24,new z(3,12),new z(8,13))),new r(12,Int32Array.from([6,32,58]),new me(24,new z(2,92),new z(2,93)),new me(22,new z(6,36),new z(2,37)),new me(26,new z(4,20),new z(6,21)),new me(28,new z(7,14),new z(4,15))),new r(13,Int32Array.from([6,34,62]),new me(26,new z(4,107)),new me(22,new z(8,37),new z(1,38)),new me(24,new z(8,20),new z(4,21)),new me(22,new z(12,11),new z(4,12))),new r(14,Int32Array.from([6,26,46,66]),new me(30,new z(3,115),new z(1,116)),new me(24,new z(4,40),new z(5,41)),new me(20,new z(11,16),new z(5,17)),new me(24,new z(11,12),new z(5,13))),new r(15,Int32Array.from([6,26,48,70]),new me(22,new z(5,87),new z(1,88)),new me(24,new z(5,41),new z(5,42)),new me(30,new z(5,24),new z(7,25)),new me(24,new z(11,12),new z(7,13))),new r(16,Int32Array.from([6,26,50,74]),new me(24,new z(5,98),new z(1,99)),new me(28,new z(7,45),new z(3,46)),new me(24,new z(15,19),new z(2,20)),new me(30,new z(3,15),new z(13,16))),new r(17,Int32Array.from([6,30,54,78]),new me(28,new z(1,107),new z(5,108)),new me(28,new z(10,46),new z(1,47)),new me(28,new z(1,22),new z(15,23)),new me(28,new z(2,14),new z(17,15))),new r(18,Int32Array.from([6,30,56,82]),new me(30,new z(5,120),new z(1,121)),new me(26,new z(9,43),new z(4,44)),new me(28,new z(17,22),new z(1,23)),new me(28,new z(2,14),new z(19,15))),new r(19,Int32Array.from([6,30,58,86]),new me(28,new z(3,113),new z(4,114)),new me(26,new z(3,44),new z(11,45)),new me(26,new z(17,21),new z(4,22)),new me(26,new z(9,13),new z(16,14))),new r(20,Int32Array.from([6,34,62,90]),new me(28,new z(3,107),new z(5,108)),new me(26,new z(3,41),new z(13,42)),new me(30,new z(15,24),new z(5,25)),new me(28,new z(15,15),new z(10,16))),new r(21,Int32Array.from([6,28,50,72,94]),new me(28,new z(4,116),new z(4,117)),new me(26,new z(17,42)),new me(28,new z(17,22),new z(6,23)),new me(30,new z(19,16),new z(6,17))),new r(22,Int32Array.from([6,26,50,74,98]),new me(28,new z(2,111),new z(7,112)),new me(28,new z(17,46)),new me(30,new z(7,24),new z(16,25)),new me(24,new z(34,13))),new r(23,Int32Array.from([6,30,54,78,102]),new me(30,new z(4,121),new z(5,122)),new me(28,new z(4,47),new z(14,48)),new me(30,new z(11,24),new z(14,25)),new me(30,new z(16,15),new z(14,16))),new r(24,Int32Array.from([6,28,54,80,106]),new me(30,new z(6,117),new z(4,118)),new me(28,new z(6,45),new z(14,46)),new me(30,new z(11,24),new z(16,25)),new me(30,new z(30,16),new z(2,17))),new r(25,Int32Array.from([6,32,58,84,110]),new me(26,new z(8,106),new z(4,107)),new me(28,new z(8,47),new z(13,48)),new me(30,new z(7,24),new z(22,25)),new me(30,new z(22,15),new z(13,16))),new r(26,Int32Array.from([6,30,58,86,114]),new me(28,new z(10,114),new z(2,115)),new me(28,new z(19,46),new z(4,47)),new me(28,new z(28,22),new z(6,23)),new me(30,new z(33,16),new z(4,17))),new r(27,Int32Array.from([6,34,62,90,118]),new me(30,new z(8,122),new z(4,123)),new me(28,new z(22,45),new z(3,46)),new me(30,new z(8,23),new z(26,24)),new me(30,new z(12,15),new z(28,16))),new r(28,Int32Array.from([6,26,50,74,98,122]),new me(30,new z(3,117),new z(10,118)),new me(28,new z(3,45),new z(23,46)),new me(30,new z(4,24),new z(31,25)),new me(30,new z(11,15),new z(31,16))),new r(29,Int32Array.from([6,30,54,78,102,126]),new me(30,new z(7,116),new z(7,117)),new me(28,new z(21,45),new z(7,46)),new me(30,new z(1,23),new z(37,24)),new me(30,new z(19,15),new z(26,16))),new r(30,Int32Array.from([6,26,52,78,104,130]),new me(30,new z(5,115),new z(10,116)),new me(28,new z(19,47),new z(10,48)),new me(30,new z(15,24),new z(25,25)),new me(30,new z(23,15),new z(25,16))),new r(31,Int32Array.from([6,30,56,82,108,134]),new me(30,new z(13,115),new z(3,116)),new me(28,new z(2,46),new z(29,47)),new me(30,new z(42,24),new z(1,25)),new me(30,new z(23,15),new z(28,16))),new r(32,Int32Array.from([6,34,60,86,112,138]),new me(30,new z(17,115)),new me(28,new z(10,46),new z(23,47)),new me(30,new z(10,24),new z(35,25)),new me(30,new z(19,15),new z(35,16))),new r(33,Int32Array.from([6,30,58,86,114,142]),new me(30,new z(17,115),new z(1,116)),new me(28,new z(14,46),new z(21,47)),new me(30,new z(29,24),new z(19,25)),new me(30,new z(11,15),new z(46,16))),new r(34,Int32Array.from([6,34,62,90,118,146]),new me(30,new z(13,115),new z(6,116)),new me(28,new z(14,46),new z(23,47)),new me(30,new z(44,24),new z(7,25)),new me(30,new z(59,16),new z(1,17))),new r(35,Int32Array.from([6,30,54,78,102,126,150]),new me(30,new z(12,121),new z(7,122)),new me(28,new z(12,47),new z(26,48)),new me(30,new z(39,24),new z(14,25)),new me(30,new z(22,15),new z(41,16))),new r(36,Int32Array.from([6,24,50,76,102,128,154]),new me(30,new z(6,121),new z(14,122)),new me(28,new z(6,47),new z(34,48)),new me(30,new z(46,24),new z(10,25)),new me(30,new z(2,15),new z(64,16))),new r(37,Int32Array.from([6,28,54,80,106,132,158]),new me(30,new z(17,122),new z(4,123)),new me(28,new z(29,46),new z(14,47)),new me(30,new z(49,24),new z(10,25)),new me(30,new z(24,15),new z(46,16))),new r(38,Int32Array.from([6,32,58,84,110,136,162]),new me(30,new z(4,122),new z(18,123)),new me(28,new z(13,46),new z(32,47)),new me(30,new z(48,24),new z(14,25)),new me(30,new z(42,15),new z(32,16))),new r(39,Int32Array.from([6,26,54,82,110,138,166]),new me(30,new z(20,117),new z(4,118)),new me(28,new z(40,47),new z(7,48)),new me(30,new z(43,24),new z(22,25)),new me(30,new z(10,15),new z(67,16))),new r(40,Int32Array.from([6,30,58,86,114,142,170]),new me(30,new z(19,118),new z(6,119)),new me(28,new z(18,47),new z(31,48)),new me(30,new z(34,24),new z(34,25)),new me(30,new z(20,15),new z(61,16)))],r}(),pn;(function(r){r[r.DATA_MASK_000=0]="DATA_MASK_000",r[r.DATA_MASK_001=1]="DATA_MASK_001",r[r.DATA_MASK_010=2]="DATA_MASK_010",r[r.DATA_MASK_011=3]="DATA_MASK_011",r[r.DATA_MASK_100=4]="DATA_MASK_100",r[r.DATA_MASK_101=5]="DATA_MASK_101",r[r.DATA_MASK_110=6]="DATA_MASK_110",r[r.DATA_MASK_111=7]="DATA_MASK_111"})(pn||(pn={}));var Cx=function(){function r(e,t){this.value=e,this.isMasked=t}return r.prototype.unmaskBitMatrix=function(e,t){for(var n=0;n<t;n++)for(var a=0;a<t;a++)this.isMasked(n,a)&&e.flip(a,n)},r.values=new Map([[pn.DATA_MASK_000,new r(pn.DATA_MASK_000,function(e,t){return(e+t&1)===0})],[pn.DATA_MASK_001,new r(pn.DATA_MASK_001,function(e,t){return(e&1)===0})],[pn.DATA_MASK_010,new r(pn.DATA_MASK_010,function(e,t){return t%3===0})],[pn.DATA_MASK_011,new r(pn.DATA_MASK_011,function(e,t){return(e+t)%3===0})],[pn.DATA_MASK_100,new r(pn.DATA_MASK_100,function(e,t){return(Math.floor(e/2)+Math.floor(t/3)&1)===0})],[pn.DATA_MASK_101,new r(pn.DATA_MASK_101,function(e,t){return e*t%6===0})],[pn.DATA_MASK_110,new r(pn.DATA_MASK_110,function(e,t){return e*t%6<3})],[pn.DATA_MASK_111,new r(pn.DATA_MASK_111,function(e,t){return(e+t+e*t%3&1)===0})]]),r}(),P$=function(){function r(e){var t=e.getHeight();if(t<21||(t&3)!==1)throw new ke;this.bitMatrix=e}return r.prototype.readFormatInformation=function(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;for(var e=0,t=0;t<6;t++)e=this.copyBit(t,8,e);e=this.copyBit(7,8,e),e=this.copyBit(8,8,e),e=this.copyBit(8,7,e);for(var n=5;n>=0;n--)e=this.copyBit(8,n,e);for(var a=this.bitMatrix.getHeight(),i=0,o=a-7,n=a-1;n>=o;n--)i=this.copyBit(8,n,i);for(var t=a-8;t<a;t++)i=this.copyBit(t,8,i);if(this.parsedFormatInfo=I4.decodeFormatInformation(e,i),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new ke},r.prototype.readVersion=function(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;var e=this.bitMatrix.getHeight(),t=Math.floor((e-17)/4);if(t<=6)return Is.getVersionForNumber(t);for(var n=0,a=e-11,i=5;i>=0;i--)for(var o=e-9;o>=a;o--)n=this.copyBit(o,i,n);var s=Is.decodeVersionInformation(n);if(s!==null&&s.getDimensionForVersion()===e)return this.parsedVersion=s,s;n=0;for(var o=5;o>=0;o--)for(var i=e-9;i>=a;i--)n=this.copyBit(o,i,n);if(s=Is.decodeVersionInformation(n),s!==null&&s.getDimensionForVersion()===e)return this.parsedVersion=s,s;throw new ke},r.prototype.copyBit=function(e,t,n){var a=this.isMirror?this.bitMatrix.get(t,e):this.bitMatrix.get(e,t);return a?n<<1|1:n<<1},r.prototype.readCodewords=function(){var e=this.readFormatInformation(),t=this.readVersion(),n=Cx.values.get(e.getDataMask()),a=this.bitMatrix.getHeight();n.unmaskBitMatrix(this.bitMatrix,a);for(var i=t.buildFunctionPattern(),o=!0,s=new Uint8Array(t.getTotalCodewords()),l=0,u=0,d=0,f=a-1;f>0;f-=2){f===6&&f--;for(var h=0;h<a;h++)for(var p=o?a-1-h:h,g=0;g<2;g++)i.get(f-g,p)||(d++,u<<=1,this.bitMatrix.get(f-g,p)&&(u|=1),d===8&&(s[l++]=u,d=0,u=0));o=!o}if(l!==t.getTotalCodewords())throw new ke;return s},r.prototype.remask=function(){if(this.parsedFormatInfo!==null){var e=Cx.values.get(this.parsedFormatInfo.getDataMask()),t=this.bitMatrix.getHeight();e.unmaskBitMatrix(this.bitMatrix,t)}},r.prototype.setMirror=function(e){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=e},r.prototype.mirror=function(){for(var e=this.bitMatrix,t=0,n=e.getWidth();t<n;t++)for(var a=t+1,i=e.getHeight();a<i;a++)e.get(t,a)!==e.get(a,t)&&(e.flip(a,t),e.flip(t,a))},r}(),Nx=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},D$=function(){function r(e,t){this.numDataCodewords=e,this.codewords=t}return r.getDataBlocks=function(e,t,n){var a,i,o,s;if(e.length!==t.getTotalCodewords())throw new st;var l=t.getECBlocksForLevel(n),u=0,d=l.getECBlocks();try{for(var f=Nx(d),h=f.next();!h.done;h=f.next()){var p=h.value;u+=p.getCount()}}catch(H){a={error:H}}finally{try{h&&!h.done&&(i=f.return)&&i.call(f)}finally{if(a)throw a.error}}var g=new Array(u),v=0;try{for(var b=Nx(d),y=b.next();!y.done;y=b.next())for(var p=y.value,C=0;C<p.getCount();C++){var S=p.getDataCodewords(),j=l.getECCodewordsPerBlock()+S;g[v++]=new r(S,new Uint8Array(j))}}catch(H){o={error:H}}finally{try{y&&!y.done&&(s=b.return)&&s.call(b)}finally{if(o)throw o.error}}for(var D=g[0].codewords.length,F=g.length-1;F>=0;){var M=g[F].codewords.length;if(M===D)break;F--}F++;for(var T=D-l.getECCodewordsPerBlock(),q=0,C=0;C<T;C++)for(var J=0;J<v;J++)g[J].codewords[C]=e[q++];for(var J=F;J<v;J++)g[J].codewords[T]=e[q++];for(var O=g[0].codewords.length,C=T;C<O;C++)for(var J=0;J<v;J++){var k=J<F?C:C+1;g[J].codewords[k]=e[q++]}return g},r.prototype.getNumDataCodewords=function(){return this.numDataCodewords},r.prototype.getCodewords=function(){return this.codewords},r}(),Ra;(function(r){r[r.TERMINATOR=0]="TERMINATOR",r[r.NUMERIC=1]="NUMERIC",r[r.ALPHANUMERIC=2]="ALPHANUMERIC",r[r.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",r[r.BYTE=4]="BYTE",r[r.ECI=5]="ECI",r[r.KANJI=6]="KANJI",r[r.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",r[r.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",r[r.HANZI=9]="HANZI"})(Ra||(Ra={}));var xr=function(){function r(e,t,n,a){this.value=e,this.stringValue=t,this.characterCountBitsForVersions=n,this.bits=a,r.FOR_BITS.set(a,this),r.FOR_VALUE.set(e,this)}return r.forBits=function(e){var t=r.FOR_BITS.get(e);if(t===void 0)throw new st;return t},r.prototype.getCharacterCountBits=function(e){var t=e.getVersionNumber(),n;return t<=9?n=0:t<=26?n=1:n=2,this.characterCountBitsForVersions[n]},r.prototype.getValue=function(){return this.value},r.prototype.getBits=function(){return this.bits},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;return this.value===t.value},r.prototype.toString=function(){return this.stringValue},r.FOR_BITS=new Map,r.FOR_VALUE=new Map,r.TERMINATOR=new r(Ra.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),r.NUMERIC=new r(Ra.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),r.ALPHANUMERIC=new r(Ra.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),r.STRUCTURED_APPEND=new r(Ra.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),r.BYTE=new r(Ra.BYTE,"BYTE",Int32Array.from([8,16,16]),4),r.ECI=new r(Ra.ECI,"ECI",Int32Array.from([0,0,0]),7),r.KANJI=new r(Ra.KANJI,"KANJI",Int32Array.from([8,10,12]),8),r.FNC1_FIRST_POSITION=new r(Ra.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),r.FNC1_SECOND_POSITION=new r(Ra.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),r.HANZI=new r(Ra.HANZI,"HANZI",Int32Array.from([8,10,12]),13),r}(),I$=function(){function r(){}return r.decode=function(e,t,n,a){var i=new D4(e),o=new Pt,s=new Array,l=-1,u=-1;try{var d=null,f=!1,h=void 0;do{if(i.available()<4)h=xr.TERMINATOR;else{var p=i.readBits(4);h=xr.forBits(p)}switch(h){case xr.TERMINATOR:break;case xr.FNC1_FIRST_POSITION:case xr.FNC1_SECOND_POSITION:f=!0;break;case xr.STRUCTURED_APPEND:if(i.available()<16)throw new ke;l=i.readBits(8),u=i.readBits(8);break;case xr.ECI:var g=r.parseECIValue(i);if(d=an.getCharacterSetECIByValue(g),d===null)throw new ke;break;case xr.HANZI:var v=i.readBits(4),b=i.readBits(h.getCharacterCountBits(t));v===r.GB2312_SUBSET&&r.decodeHanziSegment(i,o,b);break;default:var y=i.readBits(h.getCharacterCountBits(t));switch(h){case xr.NUMERIC:r.decodeNumericSegment(i,o,y);break;case xr.ALPHANUMERIC:r.decodeAlphanumericSegment(i,o,y,f);break;case xr.BYTE:r.decodeByteSegment(i,o,y,d,s,a);break;case xr.KANJI:r.decodeKanjiSegment(i,o,y);break;default:throw new ke}break}}while(h!==xr.TERMINATOR)}catch{throw new ke}return new Hh(e,o.toString(),s.length===0?null:s,n===null?null:n.toString(),l,u)},r.decodeHanziSegment=function(e,t,n){if(n*13>e.available())throw new ke;for(var a=new Uint8Array(2*n),i=0;n>0;){var o=e.readBits(13),s=o/96<<8&4294967295|o%96;s<959?s+=41377:s+=42657,a[i]=s>>8&255,a[i+1]=s&255,i+=2,n--}try{t.append(Va.decode(a,Bt.GB2312))}catch(l){throw new ke(l)}},r.decodeKanjiSegment=function(e,t,n){if(n*13>e.available())throw new ke;for(var a=new Uint8Array(2*n),i=0;n>0;){var o=e.readBits(13),s=o/192<<8&4294967295|o%192;s<7936?s+=33088:s+=49472,a[i]=s>>8,a[i+1]=s,i+=2,n--}try{t.append(Va.decode(a,Bt.SHIFT_JIS))}catch(l){throw new ke(l)}},r.decodeByteSegment=function(e,t,n,a,i,o){if(8*n>e.available())throw new ke;for(var s=new Uint8Array(n),l=0;l<n;l++)s[l]=e.readBits(8);var u;a===null?u=Bt.guessEncoding(s,o):u=a.getName();try{t.append(Va.decode(s,u))}catch(d){throw new ke(d)}i.push(s)},r.toAlphaNumericChar=function(e){if(e>=r.ALPHANUMERIC_CHARS.length)throw new ke;return r.ALPHANUMERIC_CHARS[e]},r.decodeAlphanumericSegment=function(e,t,n,a){for(var i=t.length();n>1;){if(e.available()<11)throw new ke;var o=e.readBits(11);t.append(r.toAlphaNumericChar(Math.floor(o/45))),t.append(r.toAlphaNumericChar(o%45)),n-=2}if(n===1){if(e.available()<6)throw new ke;t.append(r.toAlphaNumericChar(e.readBits(6)))}if(a)for(var s=i;s<t.length();s++)t.charAt(s)==="%"&&(s<t.length()-1&&t.charAt(s+1)==="%"?t.deleteCharAt(s+1):t.setCharAt(s,""))},r.decodeNumericSegment=function(e,t,n){for(;n>=3;){if(e.available()<10)throw new ke;var a=e.readBits(10);if(a>=1e3)throw new ke;t.append(r.toAlphaNumericChar(Math.floor(a/100))),t.append(r.toAlphaNumericChar(Math.floor(a/10)%10)),t.append(r.toAlphaNumericChar(a%10)),n-=3}if(n===2){if(e.available()<7)throw new ke;var i=e.readBits(7);if(i>=100)throw new ke;t.append(r.toAlphaNumericChar(Math.floor(i/10))),t.append(r.toAlphaNumericChar(i%10))}else if(n===1){if(e.available()<4)throw new ke;var o=e.readBits(4);if(o>=10)throw new ke;t.append(r.toAlphaNumericChar(o))}},r.parseECIValue=function(e){var t=e.readBits(8);if(!(t&128))return t&127;if((t&192)===128){var n=e.readBits(8);return(t&63)<<8&4294967295|n}if((t&224)===192){var a=e.readBits(16);return(t&31)<<16&4294967295|a}throw new ke},r.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",r.GB2312_SUBSET=1,r}(),T4=function(){function r(e){this.mirrored=e}return r.prototype.isMirrored=function(){return this.mirrored},r.prototype.applyMirroredCorrection=function(e){if(!(!this.mirrored||e===null||e.length<3)){var t=e[0];e[0]=e[2],e[2]=t}},r}(),Sx=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},T$=function(){function r(){this.rsDecoder=new Wh(aa.QR_CODE_FIELD_256)}return r.prototype.decodeBooleanArray=function(e,t){return this.decodeBitMatrix($i.parseFromBooleanArray(e),t)},r.prototype.decodeBitMatrix=function(e,t){var n=new P$(e),a=null;try{return this.decodeBitMatrixParser(n,t)}catch(o){a=o}try{n.remask(),n.setMirror(!0),n.readVersion(),n.readFormatInformation(),n.mirror();var i=this.decodeBitMatrixParser(n,t);return i.setOther(new T4(!0)),i}catch(o){throw a!==null?a:o}},r.prototype.decodeBitMatrixParser=function(e,t){var n,a,i,o,s=e.readVersion(),l=e.readFormatInformation().getErrorCorrectionLevel(),u=e.readCodewords(),d=D$.getDataBlocks(u,s,l),f=0;try{for(var h=Sx(d),p=h.next();!p.done;p=h.next()){var g=p.value;f+=g.getNumDataCodewords()}}catch(F){n={error:F}}finally{try{p&&!p.done&&(a=h.return)&&a.call(h)}finally{if(n)throw n.error}}var v=new Uint8Array(f),b=0;try{for(var y=Sx(d),C=y.next();!C.done;C=y.next()){var g=C.value,S=g.getCodewords(),j=g.getNumDataCodewords();this.correctErrors(S,j);for(var D=0;D<j;D++)v[b++]=S[D]}}catch(F){i={error:F}}finally{try{C&&!C.done&&(o=y.return)&&o.call(y)}finally{if(i)throw i.error}}return I$.decode(v,s,l,t)},r.prototype.correctErrors=function(e,t){var n=new Int32Array(e);try{this.rsDecoder.decode(n,e.length-t)}catch{throw new Vr}for(var a=0;a<t;a++)e[a]=n[a]},r}(),O$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),k$=function(r){O$(e,r);function e(t,n,a){var i=r.call(this,t,n)||this;return i.estimatedModuleSize=a,i}return e.prototype.aboutEquals=function(t,n,a){if(Math.abs(n-this.getY())<=t&&Math.abs(a-this.getX())<=t){var i=Math.abs(t-this.estimatedModuleSize);return i<=1||i<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,n,a){var i=(this.getX()+n)/2,o=(this.getY()+t)/2,s=(this.estimatedModuleSize+a)/2;return new e(i,o,s)},e}(Je),M$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},R$=function(){function r(e,t,n,a,i,o,s){this.image=e,this.startX=t,this.startY=n,this.width=a,this.height=i,this.moduleSize=o,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}return r.prototype.find=function(){for(var e=this.startX,t=this.height,n=this.width,a=e+n,i=this.startY+t/2,o=new Int32Array(3),s=this.image,l=0;l<t;l++){var u=i+(l&1?-Math.floor((l+1)/2):Math.floor((l+1)/2));o[0]=0,o[1]=0,o[2]=0;for(var d=e;d<a&&!s.get(d,u);)d++;for(var f=0;d<a;){if(s.get(d,u))if(f===1)o[1]++;else if(f===2){if(this.foundPatternCross(o)){var h=this.handlePossibleCenter(o,u,d);if(h!==null)return h}o[0]=o[2],o[1]=1,o[2]=0,f=1}else o[++f]++;else f===1&&f++,o[f]++;d++}if(this.foundPatternCross(o)){var h=this.handlePossibleCenter(o,u,a);if(h!==null)return h}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new Ce},r.centerFromEnd=function(e,t){return t-e[2]-e[1]/2},r.prototype.foundPatternCross=function(e){for(var t=this.moduleSize,n=t/2,a=0;a<3;a++)if(Math.abs(t-e[a])>=n)return!1;return!0},r.prototype.crossCheckVertical=function(e,t,n,a){var i=this.image,o=i.getHeight(),s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;for(var l=e;l>=0&&i.get(t,l)&&s[1]<=n;)s[1]++,l--;if(l<0||s[1]>n)return NaN;for(;l>=0&&!i.get(t,l)&&s[0]<=n;)s[0]++,l--;if(s[0]>n)return NaN;for(l=e+1;l<o&&i.get(t,l)&&s[1]<=n;)s[1]++,l++;if(l===o||s[1]>n)return NaN;for(;l<o&&!i.get(t,l)&&s[2]<=n;)s[2]++,l++;if(s[2]>n)return NaN;var u=s[0]+s[1]+s[2];return 5*Math.abs(u-a)>=2*a?NaN:this.foundPatternCross(s)?r.centerFromEnd(s,l):NaN},r.prototype.handlePossibleCenter=function(e,t,n){var a,i,o=e[0]+e[1]+e[2],s=r.centerFromEnd(e,n),l=this.crossCheckVertical(t,s,2*e[1],o);if(!isNaN(l)){var u=(e[0]+e[1]+e[2])/3;try{for(var d=M$(this.possibleCenters),f=d.next();!f.done;f=d.next()){var h=f.value;if(h.aboutEquals(u,l,s))return h.combineEstimate(l,s,u)}}catch(g){a={error:g}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}var p=new k$(s,l,u);this.possibleCenters.push(p),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(p)}return null},r}(),L$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),F$=function(r){L$(e,r);function e(t,n,a,i){var o=r.call(this,t,n)||this;return o.estimatedModuleSize=a,o.count=i,i===void 0&&(o.count=1),o}return e.prototype.getEstimatedModuleSize=function(){return this.estimatedModuleSize},e.prototype.getCount=function(){return this.count},e.prototype.aboutEquals=function(t,n,a){if(Math.abs(n-this.getY())<=t&&Math.abs(a-this.getX())<=t){var i=Math.abs(t-this.estimatedModuleSize);return i<=1||i<=this.estimatedModuleSize}return!1},e.prototype.combineEstimate=function(t,n,a){var i=this.count+1,o=(this.count*this.getX()+n)/i,s=(this.count*this.getY()+t)/i,l=(this.count*this.estimatedModuleSize+a)/i;return new e(o,s,l,i)},e}(Je),B$=function(){function r(e){this.bottomLeft=e[0],this.topLeft=e[1],this.topRight=e[2]}return r.prototype.getBottomLeft=function(){return this.bottomLeft},r.prototype.getTopLeft=function(){return this.topLeft},r.prototype.getTopRight=function(){return this.topRight},r}(),nu=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},$$=function(){function r(e,t){this.image=e,this.resultPointCallback=t,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=t}return r.prototype.getImage=function(){return this.image},r.prototype.getPossibleCenters=function(){return this.possibleCenters},r.prototype.find=function(e){var t=e!=null&&e.get(gr.TRY_HARDER)!==void 0,n=e!=null&&e.get(gr.PURE_BARCODE)!==void 0,a=this.image,i=a.getHeight(),o=a.getWidth(),s=Math.floor(3*i/(4*r.MAX_MODULES));(s<r.MIN_SKIP||t)&&(s=r.MIN_SKIP);for(var l=!1,u=new Int32Array(5),d=s-1;d<i&&!l;d+=s){u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0;for(var f=0,h=0;h<o;h++)if(a.get(h,d))(f&1)===1&&f++,u[f]++;else if(f&1)u[f]++;else if(f===4)if(r.foundPatternCross(u)){var p=this.handlePossibleCenter(u,d,h,n);if(p===!0)if(s=2,this.hasSkipped===!0)l=this.haveMultiplyConfirmedCenters();else{var g=this.findRowSkip();g>u[2]&&(d+=g-u[2]-s,h=o-1)}else{u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;continue}f=0,u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0}else u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,f=3;else u[++f]++;if(r.foundPatternCross(u)){var p=this.handlePossibleCenter(u,d,o,n);p===!0&&(s=u[0],this.hasSkipped&&(l=this.haveMultiplyConfirmedCenters()))}}var v=this.selectBestPatterns();return Je.orderBestPatterns(v),new B$(v)},r.centerFromEnd=function(e,t){return t-e[4]-e[3]-e[2]/2},r.foundPatternCross=function(e){for(var t=0,n=0;n<5;n++){var a=e[n];if(a===0)return!1;t+=a}if(t<7)return!1;var i=t/7,o=i/2;return Math.abs(i-e[0])<o&&Math.abs(i-e[1])<o&&Math.abs(3*i-e[2])<3*o&&Math.abs(i-e[3])<o&&Math.abs(i-e[4])<o},r.prototype.getCrossCheckStateCount=function(){var e=this.crossCheckStateCount;return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e},r.prototype.crossCheckDiagonal=function(e,t,n,a){for(var i=this.getCrossCheckStateCount(),o=0,s=this.image;e>=o&&t>=o&&s.get(t-o,e-o);)i[2]++,o++;if(e<o||t<o)return!1;for(;e>=o&&t>=o&&!s.get(t-o,e-o)&&i[1]<=n;)i[1]++,o++;if(e<o||t<o||i[1]>n)return!1;for(;e>=o&&t>=o&&s.get(t-o,e-o)&&i[0]<=n;)i[0]++,o++;if(i[0]>n)return!1;var l=s.getHeight(),u=s.getWidth();for(o=1;e+o<l&&t+o<u&&s.get(t+o,e+o);)i[2]++,o++;if(e+o>=l||t+o>=u)return!1;for(;e+o<l&&t+o<u&&!s.get(t+o,e+o)&&i[3]<n;)i[3]++,o++;if(e+o>=l||t+o>=u||i[3]>=n)return!1;for(;e+o<l&&t+o<u&&s.get(t+o,e+o)&&i[4]<n;)i[4]++,o++;if(i[4]>=n)return!1;var d=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(d-a)<2*a&&r.foundPatternCross(i)},r.prototype.crossCheckVertical=function(e,t,n,a){for(var i=this.image,o=i.getHeight(),s=this.getCrossCheckStateCount(),l=e;l>=0&&i.get(t,l);)s[2]++,l--;if(l<0)return NaN;for(;l>=0&&!i.get(t,l)&&s[1]<=n;)s[1]++,l--;if(l<0||s[1]>n)return NaN;for(;l>=0&&i.get(t,l)&&s[0]<=n;)s[0]++,l--;if(s[0]>n)return NaN;for(l=e+1;l<o&&i.get(t,l);)s[2]++,l++;if(l===o)return NaN;for(;l<o&&!i.get(t,l)&&s[3]<n;)s[3]++,l++;if(l===o||s[3]>=n)return NaN;for(;l<o&&i.get(t,l)&&s[4]<n;)s[4]++,l++;if(s[4]>=n)return NaN;var u=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(u-a)>=2*a?NaN:r.foundPatternCross(s)?r.centerFromEnd(s,l):NaN},r.prototype.crossCheckHorizontal=function(e,t,n,a){for(var i=this.image,o=i.getWidth(),s=this.getCrossCheckStateCount(),l=e;l>=0&&i.get(l,t);)s[2]++,l--;if(l<0)return NaN;for(;l>=0&&!i.get(l,t)&&s[1]<=n;)s[1]++,l--;if(l<0||s[1]>n)return NaN;for(;l>=0&&i.get(l,t)&&s[0]<=n;)s[0]++,l--;if(s[0]>n)return NaN;for(l=e+1;l<o&&i.get(l,t);)s[2]++,l++;if(l===o)return NaN;for(;l<o&&!i.get(l,t)&&s[3]<n;)s[3]++,l++;if(l===o||s[3]>=n)return NaN;for(;l<o&&i.get(l,t)&&s[4]<n;)s[4]++,l++;if(s[4]>=n)return NaN;var u=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(u-a)>=a?NaN:r.foundPatternCross(s)?r.centerFromEnd(s,l):NaN},r.prototype.handlePossibleCenter=function(e,t,n,a){var i=e[0]+e[1]+e[2]+e[3]+e[4],o=r.centerFromEnd(e,n),s=this.crossCheckVertical(t,Math.floor(o),e[2],i);if(!isNaN(s)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(s),e[2],i),!isNaN(o)&&(!a||this.crossCheckDiagonal(Math.floor(s),Math.floor(o),e[2],i)))){for(var l=i/7,u=!1,d=this.possibleCenters,f=0,h=d.length;f<h;f++){var p=d[f];if(p.aboutEquals(l,s,o)){d[f]=p.combineEstimate(s,o,l),u=!0;break}}if(!u){var g=new F$(o,s,l);d.push(g),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(g)}return!0}return!1},r.prototype.findRowSkip=function(){var e,t,n=this.possibleCenters.length;if(n<=1)return 0;var a=null;try{for(var i=nu(this.possibleCenters),o=i.next();!o.done;o=i.next()){var s=o.value;if(s.getCount()>=r.CENTER_QUORUM)if(a==null)a=s;else return this.hasSkipped=!0,Math.floor((Math.abs(a.getX()-s.getX())-Math.abs(a.getY()-s.getY()))/2)}}catch(l){e={error:l}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return 0},r.prototype.haveMultiplyConfirmedCenters=function(){var e,t,n,a,i=0,o=0,s=this.possibleCenters.length;try{for(var l=nu(this.possibleCenters),u=l.next();!u.done;u=l.next()){var d=u.value;d.getCount()>=r.CENTER_QUORUM&&(i++,o+=d.getEstimatedModuleSize())}}catch(v){e={error:v}}finally{try{u&&!u.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}if(i<3)return!1;var f=o/s,h=0;try{for(var p=nu(this.possibleCenters),g=p.next();!g.done;g=p.next()){var d=g.value;h+=Math.abs(d.getEstimatedModuleSize()-f)}}catch(v){n={error:v}}finally{try{g&&!g.done&&(a=p.return)&&a.call(p)}finally{if(n)throw n.error}}return h<=.05*o},r.prototype.selectBestPatterns=function(){var e,t,n,a,i=this.possibleCenters.length;if(i<3)throw new Ce;var o=this.possibleCenters,s;if(i>3){var l=0,u=0;try{for(var d=nu(this.possibleCenters),f=d.next();!f.done;f=d.next()){var h=f.value,p=h.getEstimatedModuleSize();l+=p,u+=p*p}}catch(D){e={error:D}}finally{try{f&&!f.done&&(t=d.return)&&t.call(d)}finally{if(e)throw e.error}}s=l/i;var g=Math.sqrt(u/i-s*s);o.sort(function(D,F){var M=Math.abs(F.getEstimatedModuleSize()-s),T=Math.abs(D.getEstimatedModuleSize()-s);return M<T?-1:M>T?1:0});for(var v=Math.max(.2*s,g),b=0;b<o.length&&o.length>3;b++){var y=o[b];Math.abs(y.getEstimatedModuleSize()-s)>v&&(o.splice(b,1),b--)}}if(o.length>3){var l=0;try{for(var C=nu(o),S=C.next();!S.done;S=C.next()){var j=S.value;l+=j.getEstimatedModuleSize()}}catch(F){n={error:F}}finally{try{S&&!S.done&&(a=C.return)&&a.call(C)}finally{if(n)throw n.error}}s=l/o.length,o.sort(function(F,M){if(M.getCount()===F.getCount()){var T=Math.abs(M.getEstimatedModuleSize()-s),q=Math.abs(F.getEstimatedModuleSize()-s);return T<q?1:T>q?-1:0}else return M.getCount()-F.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]},r.CENTER_QUORUM=2,r.MIN_SKIP=3,r.MAX_MODULES=57,r}(),U$=function(){function r(e){this.image=e}return r.prototype.getImage=function(){return this.image},r.prototype.getResultPointCallback=function(){return this.resultPointCallback},r.prototype.detect=function(e){this.resultPointCallback=e==null?null:e.get(gr.NEED_RESULT_POINT_CALLBACK);var t=new $$(this.image,this.resultPointCallback),n=t.find(e);return this.processFinderPatternInfo(n)},r.prototype.processFinderPatternInfo=function(e){var t=e.getTopLeft(),n=e.getTopRight(),a=e.getBottomLeft(),i=this.calculateModuleSize(t,n,a);if(i<1)throw new Ce("No pattern found in proccess finder.");var o=r.computeDimension(t,n,a,i),s=Is.getProvisionalVersionForDimension(o),l=s.getDimensionForVersion()-7,u=null;if(s.getAlignmentPatternCenters().length>0)for(var d=n.getX()-t.getX()+a.getX(),f=n.getY()-t.getY()+a.getY(),h=1-3/l,p=Math.floor(t.getX()+h*(d-t.getX())),g=Math.floor(t.getY()+h*(f-t.getY())),v=4;v<=16;v<<=1)try{u=this.findAlignmentInRegion(i,p,g,v);break}catch(S){if(!(S instanceof Ce))throw S}var b=r.createTransform(t,n,a,u,o),y=r.sampleGrid(this.image,b,o),C;return u===null?C=[a,t,n]:C=[a,t,n,u],new zg(y,C)},r.createTransform=function(e,t,n,a,i){var o=i-3.5,s,l,u,d;return a!==null?(s=a.getX(),l=a.getY(),u=o-3,d=u):(s=t.getX()-e.getX()+n.getX(),l=t.getY()-e.getY()+n.getY(),u=o,d=o),E4.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,u,d,3.5,o,e.getX(),e.getY(),t.getX(),t.getY(),s,l,n.getX(),n.getY())},r.sampleGrid=function(e,t,n){var a=Hg.getInstance();return a.sampleGridWithTransform(e,n,n,t)},r.computeDimension=function(e,t,n,a){var i=Wt.round(Je.distance(e,t)/a),o=Wt.round(Je.distance(e,n)/a),s=Math.floor((i+o)/2)+7;switch(s&3){case 0:s++;break;case 2:s--;break;case 3:throw new Ce("Dimensions could be not found.")}return s},r.prototype.calculateModuleSize=function(e,t,n){return(this.calculateModuleSizeOneWay(e,t)+this.calculateModuleSizeOneWay(e,n))/2},r.prototype.calculateModuleSizeOneWay=function(e,t){var n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY())),a=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY()));return isNaN(n)?a/7:isNaN(a)?n/7:(n+a)/14},r.prototype.sizeOfBlackWhiteBlackRunBothWays=function(e,t,n,a){var i=this.sizeOfBlackWhiteBlackRun(e,t,n,a),o=1,s=e-(n-e);s<0?(o=e/(e-s),s=0):s>=this.image.getWidth()&&(o=(this.image.getWidth()-1-e)/(s-e),s=this.image.getWidth()-1);var l=Math.floor(t-(a-t)*o);return o=1,l<0?(o=t/(t-l),l=0):l>=this.image.getHeight()&&(o=(this.image.getHeight()-1-t)/(l-t),l=this.image.getHeight()-1),s=Math.floor(e+(s-e)*o),i+=this.sizeOfBlackWhiteBlackRun(e,t,s,l),i-1},r.prototype.sizeOfBlackWhiteBlackRun=function(e,t,n,a){var i=Math.abs(a-t)>Math.abs(n-e);if(i){var o=e;e=t,t=o,o=n,n=a,a=o}for(var s=Math.abs(n-e),l=Math.abs(a-t),u=-s/2,d=e<n?1:-1,f=t<a?1:-1,h=0,p=n+d,g=e,v=t;g!==p;g+=d){var b=i?v:g,y=i?g:v;if(h===1===this.image.get(b,y)){if(h===2)return Wt.distance(g,v,e,t);h++}if(u+=l,u>0){if(v===a)break;v+=f,u-=s}}return h===2?Wt.distance(n+d,a,e,t):NaN},r.prototype.findAlignmentInRegion=function(e,t,n,a){var i=Math.floor(a*e),o=Math.max(0,t-i),s=Math.min(this.image.getWidth()-1,t+i);if(s-o<e*3)throw new Ce("Alignment top exceeds estimated module size.");var l=Math.max(0,n-i),u=Math.min(this.image.getHeight()-1,n+i);if(u-l<e*3)throw new Ce("Alignment bottom exceeds estimated module size.");var d=new R$(this.image,o,l,s-o,u-l,e,this.resultPointCallback);return d.find()},r}(),Jf=function(){function r(){this.decoder=new T$}return r.prototype.getDecoder=function(){return this.decoder},r.prototype.decode=function(e,t){var n,a;if(t!=null&&t.get(gr.PURE_BARCODE)!==void 0){var i=r.extractPureBits(e.getBlackMatrix());n=this.decoder.decodeBitMatrix(i,t),a=r.NO_POINTS}else{var o=new U$(e.getBlackMatrix()).detect(t);n=this.decoder.decodeBitMatrix(o.getBits(),t),a=o.getPoints()}n.getOther()instanceof T4&&n.getOther().applyMirroredCorrection(a);var s=new $n(n.getText(),n.getRawBytes(),void 0,a,ot.QR_CODE,void 0),l=n.getByteSegments();l!==null&&s.putMetadata(En.BYTE_SEGMENTS,l);var u=n.getECLevel();return u!==null&&s.putMetadata(En.ERROR_CORRECTION_LEVEL,u),n.hasStructuredAppend()&&(s.putMetadata(En.STRUCTURED_APPEND_SEQUENCE,n.getStructuredAppendSequenceNumber()),s.putMetadata(En.STRUCTURED_APPEND_PARITY,n.getStructuredAppendParity())),s},r.prototype.reset=function(){},r.extractPureBits=function(e){var t=e.getTopLeftOnBit(),n=e.getBottomRightOnBit();if(t===null||n===null)throw new Ce;var a=this.moduleSize(t,e),i=t[1],o=n[1],s=t[0],l=n[0];if(s>=l||i>=o)throw new Ce;if(o-i!==l-s&&(l=s+(o-i),l>=e.getWidth()))throw new Ce;var u=Math.round((l-s+1)/a),d=Math.round((o-i+1)/a);if(u<=0||d<=0)throw new Ce;if(d!==u)throw new Ce;var f=Math.floor(a/2);i+=f,s+=f;var h=s+Math.floor((u-1)*a)-l;if(h>0){if(h>f)throw new Ce;s-=h}var p=i+Math.floor((d-1)*a)-o;if(p>0){if(p>f)throw new Ce;i-=p}for(var g=new $i(u,d),v=0;v<d;v++)for(var b=i+Math.floor(v*a),y=0;y<u;y++)e.get(s+Math.floor(y*a),b)&&g.set(y,v);return g},r.moduleSize=function(e,t){for(var n=t.getHeight(),a=t.getWidth(),i=e[0],o=e[1],s=!0,l=0;i<a&&o<n;){if(s!==t.get(i,o)){if(++l===5)break;s=!s}i++,o++}if(i===a||o===n)throw new Ce;return(i-e[0])/7},r.NO_POINTS=new Array,r}(),q$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Vt=function(){function r(){}return r.prototype.PDF417Common=function(){},r.getBitCountSum=function(e){return Wt.sum(e)},r.toIntArray=function(e){var t,n;if(e==null||!e.length)return r.EMPTY_INT_ARRAY;var a=new Int32Array(e.length),i=0;try{for(var o=q$(e),s=o.next();!s.done;s=o.next()){var l=s.value;a[i++]=l}}catch(u){t={error:u}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return a},r.getCodeword=function(e){var t=on.binarySearch(r.SYMBOL_TABLE,e&262143);return t<0?-1:(r.CODEWORD_TABLE[t]-1)%r.NUMBER_OF_CODEWORDS},r.NUMBER_OF_CODEWORDS=929,r.MAX_CODEWORDS_IN_BARCODE=r.NUMBER_OF_CODEWORDS-1,r.MIN_ROWS_IN_BARCODE=3,r.MAX_ROWS_IN_BARCODE=90,r.MODULES_IN_CODEWORD=17,r.MODULES_IN_STOP_PATTERN=18,r.BARS_IN_MODULE=8,r.EMPTY_INT_ARRAY=new Int32Array([]),r.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),r.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]),r}(),V$=function(){function r(e,t){this.bits=e,this.points=t}return r.prototype.getBits=function(){return this.bits},r.prototype.getPoints=function(){return this.points},r}(),z$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},H$=function(){function r(){}return r.detectMultiple=function(e,t,n){var a=e.getBlackMatrix(),i=r.detect(n,a);return i.length||(a=a.clone(),a.rotate180(),i=r.detect(n,a)),new V$(a,i)},r.detect=function(e,t){for(var n,a,i=new Array,o=0,s=0,l=!1;o<t.getHeight();){var u=r.findVertices(t,o,s);if(u[0]==null&&u[3]==null){if(!l)break;l=!1,s=0;try{for(var d=(n=void 0,z$(i)),f=d.next();!f.done;f=d.next()){var h=f.value;h[1]!=null&&(o=Math.trunc(Math.max(o,h[1].getY()))),h[3]!=null&&(o=Math.max(o,Math.trunc(h[3].getY())))}}catch(p){n={error:p}}finally{try{f&&!f.done&&(a=d.return)&&a.call(d)}finally{if(n)throw n.error}}o+=r.ROW_STEP;continue}if(l=!0,i.push(u),!e)break;u[2]!=null?(s=Math.trunc(u[2].getX()),o=Math.trunc(u[2].getY())):(s=Math.trunc(u[4].getX()),o=Math.trunc(u[4].getY()))}return i},r.findVertices=function(e,t,n){var a=e.getHeight(),i=e.getWidth(),o=new Array(8);return r.copyToResult(o,r.findRowsWithPattern(e,a,i,t,n,r.START_PATTERN),r.INDEXES_START_PATTERN),o[4]!=null&&(n=Math.trunc(o[4].getX()),t=Math.trunc(o[4].getY())),r.copyToResult(o,r.findRowsWithPattern(e,a,i,t,n,r.STOP_PATTERN),r.INDEXES_STOP_PATTERN),o},r.copyToResult=function(e,t,n){for(var a=0;a<n.length;a++)e[n[a]]=t[a]},r.findRowsWithPattern=function(e,t,n,a,i,o){for(var s=new Array(4),l=!1,u=new Int32Array(o.length);a<t;a+=r.ROW_STEP){var d=r.findGuardPattern(e,i,a,n,!1,o,u);if(d!=null){for(;a>0;){var f=r.findGuardPattern(e,i,--a,n,!1,o,u);if(f!=null)d=f;else{a++;break}}s[0]=new Je(d[0],a),s[1]=new Je(d[1],a),l=!0;break}}var h=a+1;if(l){for(var p=0,f=Int32Array.from([Math.trunc(s[0].getX()),Math.trunc(s[1].getX())]);h<t;h++){var d=r.findGuardPattern(e,f[0],h,n,!1,o,u);if(d!=null&&Math.abs(f[0]-d[0])<r.MAX_PATTERN_DRIFT&&Math.abs(f[1]-d[1])<r.MAX_PATTERN_DRIFT)f=d,p=0;else{if(p>r.SKIPPED_ROW_COUNT_MAX)break;p++}}h-=p+1,s[2]=new Je(f[0],h),s[3]=new Je(f[1],h)}return h-a<r.BARCODE_MIN_HEIGHT&&on.fill(s,null),s},r.findGuardPattern=function(e,t,n,a,i,o,s){on.fillWithin(s,0,s.length,0);for(var l=t,u=0;e.get(l,n)&&l>0&&u++<r.MAX_PIXEL_DRIFT;)l--;for(var d=l,f=0,h=o.length,p=i;d<a;d++){var g=e.get(d,n);if(g!==p)s[f]++;else{if(f===h-1){if(r.patternMatchVariance(s,o,r.MAX_INDIVIDUAL_VARIANCE)<r.MAX_AVG_VARIANCE)return new Int32Array([l,d]);l+=s[0]+s[1],mr.arraycopy(s,2,s,0,f-1),s[f-1]=0,s[f]=0,f--}else f++;s[f]=1,p=!p}}return f===h-1&&r.patternMatchVariance(s,o,r.MAX_INDIVIDUAL_VARIANCE)<r.MAX_AVG_VARIANCE?new Int32Array([l,d-1]):null},r.patternMatchVariance=function(e,t,n){for(var a=e.length,i=0,o=0,s=0;s<a;s++)i+=e[s],o+=t[s];if(i<o)return 1/0;var l=i/o;n*=l;for(var u=0,d=0;d<a;d++){var f=e[d],h=t[d]*l,p=f>h?f-h:h-f;if(p>n)return 1/0;u+=p}return u/i},r.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),r.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),r.MAX_AVG_VARIANCE=.42,r.MAX_INDIVIDUAL_VARIANCE=.8,r.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),r.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),r.MAX_PIXEL_DRIFT=3,r.MAX_PATTERN_DRIFT=5,r.SKIPPED_ROW_COUNT_MAX=25,r.ROW_STEP=5,r.BARCODE_MIN_HEIGHT=10,r}(),W$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ns=function(){function r(e,t){if(t.length===0)throw new st;this.field=e;var n=t.length;if(n>1&&t[0]===0){for(var a=1;a<n&&t[a]===0;)a++;a===n?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(n-a),mr.arraycopy(t,a,this.coefficients,0,this.coefficients.length))}else this.coefficients=t}return r.prototype.getCoefficients=function(){return this.coefficients},r.prototype.getDegree=function(){return this.coefficients.length-1},r.prototype.isZero=function(){return this.coefficients[0]===0},r.prototype.getCoefficient=function(e){return this.coefficients[this.coefficients.length-1-e]},r.prototype.evaluateAt=function(e){var t,n;if(e===0)return this.getCoefficient(0);if(e===1){var a=0;try{for(var i=W$(this.coefficients),o=i.next();!o.done;o=i.next()){var s=o.value;a=this.field.add(a,s)}}catch(f){t={error:f}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a}for(var l=this.coefficients[0],u=this.coefficients.length,d=1;d<u;d++)l=this.field.add(this.field.multiply(e,l),this.coefficients[d]);return l},r.prototype.add=function(e){if(!this.field.equals(e.field))throw new st("ModulusPolys do not have same ModulusGF field");if(this.isZero())return e;if(e.isZero())return this;var t=this.coefficients,n=e.coefficients;if(t.length>n.length){var a=t;t=n,n=a}var i=new Int32Array(n.length),o=n.length-t.length;mr.arraycopy(n,0,i,0,o);for(var s=o;s<n.length;s++)i[s]=this.field.add(t[s-o],n[s]);return new r(this.field,i)},r.prototype.subtract=function(e){if(!this.field.equals(e.field))throw new st("ModulusPolys do not have same ModulusGF field");return e.isZero()?this:this.add(e.negative())},r.prototype.multiply=function(e){return e instanceof r?this.multiplyOther(e):this.multiplyScalar(e)},r.prototype.multiplyOther=function(e){if(!this.field.equals(e.field))throw new st("ModulusPolys do not have same ModulusGF field");if(this.isZero()||e.isZero())return new r(this.field,new Int32Array([0]));for(var t=this.coefficients,n=t.length,a=e.coefficients,i=a.length,o=new Int32Array(n+i-1),s=0;s<n;s++)for(var l=t[s],u=0;u<i;u++)o[s+u]=this.field.add(o[s+u],this.field.multiply(l,a[u]));return new r(this.field,o)},r.prototype.negative=function(){for(var e=this.coefficients.length,t=new Int32Array(e),n=0;n<e;n++)t[n]=this.field.subtract(0,this.coefficients[n]);return new r(this.field,t)},r.prototype.multiplyScalar=function(e){if(e===0)return new r(this.field,new Int32Array([0]));if(e===1)return this;for(var t=this.coefficients.length,n=new Int32Array(t),a=0;a<t;a++)n[a]=this.field.multiply(this.coefficients[a],e);return new r(this.field,n)},r.prototype.multiplyByMonomial=function(e,t){if(e<0)throw new st;if(t===0)return new r(this.field,new Int32Array([0]));for(var n=this.coefficients.length,a=new Int32Array(n+e),i=0;i<n;i++)a[i]=this.field.multiply(this.coefficients[i],t);return new r(this.field,a)},r.prototype.toString=function(){for(var e=new Pt,t=this.getDegree();t>=0;t--){var n=this.getCoefficient(t);n!==0&&(n<0?(e.append(" - "),n=-n):e.length()>0&&e.append(" + "),(t===0||n!==1)&&e.append(n),t!==0&&(t===1?e.append("x"):(e.append("x^"),e.append(t))))}return e.toString()},r}(),G$=function(){function r(){}return r.prototype.add=function(e,t){return(e+t)%this.modulus},r.prototype.subtract=function(e,t){return(this.modulus+e-t)%this.modulus},r.prototype.exp=function(e){return this.expTable[e]},r.prototype.log=function(e){if(e===0)throw new st;return this.logTable[e]},r.prototype.inverse=function(e){if(e===0)throw new S4;return this.expTable[this.modulus-this.logTable[e]-1]},r.prototype.multiply=function(e,t){return e===0||t===0?0:this.expTable[(this.logTable[e]+this.logTable[t])%(this.modulus-1)]},r.prototype.getSize=function(){return this.modulus},r.prototype.equals=function(e){return e===this},r}(),Y$=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),K$=function(r){Y$(e,r);function e(t,n){var a=r.call(this)||this;a.modulus=t,a.expTable=new Int32Array(t),a.logTable=new Int32Array(t);for(var i=1,o=0;o<t;o++)a.expTable[o]=i,i=i*n%t;for(var o=0;o<t-1;o++)a.logTable[a.expTable[o]]=o;return a.zero=new Ns(a,new Int32Array([0])),a.one=new Ns(a,new Int32Array([1])),a}return e.prototype.getZero=function(){return this.zero},e.prototype.getOne=function(){return this.one},e.prototype.buildMonomial=function(t,n){if(t<0)throw new st;if(n===0)return this.zero;var a=new Int32Array(t+1);return a[0]=n,new Ns(this,a)},e.PDF417_GF=new e(Vt.NUMBER_OF_CODEWORDS,3),e}(G$),X$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Q$=function(){function r(){this.field=K$.PDF417_GF}return r.prototype.decode=function(e,t,n){for(var a,i,o=new Ns(this.field,e),s=new Int32Array(t),l=!1,u=t;u>0;u--){var d=o.evaluateAt(this.field.exp(u));s[t-u]=d,d!==0&&(l=!0)}if(!l)return 0;var f=this.field.getOne();if(n!=null)try{for(var h=X$(n),p=h.next();!p.done;p=h.next()){var g=p.value,v=this.field.exp(e.length-1-g),b=new Ns(this.field,new Int32Array([this.field.subtract(0,v),1]));f=f.multiply(b)}}catch(T){a={error:T}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}for(var y=new Ns(this.field,s),C=this.runEuclideanAlgorithm(this.field.buildMonomial(t,1),y,t),S=C[0],j=C[1],D=this.findErrorLocations(S),F=this.findErrorMagnitudes(j,S,D),u=0;u<D.length;u++){var M=e.length-1-this.field.log(D[u]);if(M<0)throw Vr.getChecksumInstance();e[M]=this.field.subtract(e[M],F[u])}return D.length},r.prototype.runEuclideanAlgorithm=function(e,t,n){if(e.getDegree()<t.getDegree()){var a=e;e=t,t=a}for(var i=e,o=t,s=this.field.getZero(),l=this.field.getOne();o.getDegree()>=Math.round(n/2);){var u=i,d=s;if(i=o,s=l,i.isZero())throw Vr.getChecksumInstance();o=u;for(var f=this.field.getZero(),h=i.getCoefficient(i.getDegree()),p=this.field.inverse(h);o.getDegree()>=i.getDegree()&&!o.isZero();){var g=o.getDegree()-i.getDegree(),v=this.field.multiply(o.getCoefficient(o.getDegree()),p);f=f.add(this.field.buildMonomial(g,v)),o=o.subtract(i.multiplyByMonomial(g,v))}l=f.multiply(s).subtract(d).negative()}var b=l.getCoefficient(0);if(b===0)throw Vr.getChecksumInstance();var y=this.field.inverse(b),C=l.multiply(y),S=o.multiply(y);return[C,S]},r.prototype.findErrorLocations=function(e){for(var t=e.getDegree(),n=new Int32Array(t),a=0,i=1;i<this.field.getSize()&&a<t;i++)e.evaluateAt(i)===0&&(n[a]=this.field.inverse(i),a++);if(a!==t)throw Vr.getChecksumInstance();return n},r.prototype.findErrorMagnitudes=function(e,t,n){for(var a=t.getDegree(),i=new Int32Array(a),o=1;o<=a;o++)i[a-o]=this.field.multiply(o,t.getCoefficient(o));for(var s=new Ns(this.field,i),l=n.length,u=new Int32Array(l),o=0;o<l;o++){var d=this.field.inverse(n[o]),f=this.field.subtract(0,e.evaluateAt(d)),h=this.field.inverse(s.evaluateAt(d));u[o]=this.field.multiply(f,h)}return u},r}(),Op=function(){function r(e,t,n,a,i){e instanceof r?this.constructor_2(e):this.constructor_1(e,t,n,a,i)}return r.prototype.constructor_1=function(e,t,n,a,i){var o=t==null||n==null,s=a==null||i==null;if(o&&s)throw new Ce;o?(t=new Je(0,a.getY()),n=new Je(0,i.getY())):s&&(a=new Je(e.getWidth()-1,t.getY()),i=new Je(e.getWidth()-1,n.getY())),this.image=e,this.topLeft=t,this.bottomLeft=n,this.topRight=a,this.bottomRight=i,this.minX=Math.trunc(Math.min(t.getX(),n.getX())),this.maxX=Math.trunc(Math.max(a.getX(),i.getX())),this.minY=Math.trunc(Math.min(t.getY(),a.getY())),this.maxY=Math.trunc(Math.max(n.getY(),i.getY()))},r.prototype.constructor_2=function(e){this.image=e.image,this.topLeft=e.getTopLeft(),this.bottomLeft=e.getBottomLeft(),this.topRight=e.getTopRight(),this.bottomRight=e.getBottomRight(),this.minX=e.getMinX(),this.maxX=e.getMaxX(),this.minY=e.getMinY(),this.maxY=e.getMaxY()},r.merge=function(e,t){return e==null?t:t==null?e:new r(e.image,e.topLeft,e.bottomLeft,t.topRight,t.bottomRight)},r.prototype.addMissingRows=function(e,t,n){var a=this.topLeft,i=this.bottomLeft,o=this.topRight,s=this.bottomRight;if(e>0){var l=n?this.topLeft:this.topRight,u=Math.trunc(l.getY()-e);u<0&&(u=0);var d=new Je(l.getX(),u);n?a=d:o=d}if(t>0){var f=n?this.bottomLeft:this.bottomRight,h=Math.trunc(f.getY()+t);h>=this.image.getHeight()&&(h=this.image.getHeight()-1);var p=new Je(f.getX(),h);n?i=p:s=p}return new r(this.image,a,i,o,s)},r.prototype.getMinX=function(){return this.minX},r.prototype.getMaxX=function(){return this.maxX},r.prototype.getMinY=function(){return this.minY},r.prototype.getMaxY=function(){return this.maxY},r.prototype.getTopLeft=function(){return this.topLeft},r.prototype.getTopRight=function(){return this.topRight},r.prototype.getBottomLeft=function(){return this.bottomLeft},r.prototype.getBottomRight=function(){return this.bottomRight},r}(),Z$=function(){function r(e,t,n,a){this.columnCount=e,this.errorCorrectionLevel=a,this.rowCountUpperPart=t,this.rowCountLowerPart=n,this.rowCount=t+n}return r.prototype.getColumnCount=function(){return this.columnCount},r.prototype.getErrorCorrectionLevel=function(){return this.errorCorrectionLevel},r.prototype.getRowCount=function(){return this.rowCount},r.prototype.getRowCountUpperPart=function(){return this.rowCountUpperPart},r.prototype.getRowCountLowerPart=function(){return this.rowCountLowerPart},r}(),Gg=function(){function r(){this.buffer=""}return r.form=function(e,t){var n=-1;function a(o,s,l,u,d,f){if(o==="%%")return"%";if(t[++n]!==void 0){o=u?parseInt(u.substr(1)):void 0;var h=d?parseInt(d.substr(1)):void 0,p;switch(f){case"s":p=t[n];break;case"c":p=t[n][0];break;case"f":p=parseFloat(t[n]).toFixed(o);break;case"p":p=parseFloat(t[n]).toPrecision(o);break;case"e":p=parseFloat(t[n]).toExponential(o);break;case"x":p=parseInt(t[n]).toString(h||16);break;case"d":p=parseFloat(parseInt(t[n],h||10).toPrecision(o)).toFixed(0);break}p=typeof p=="object"?JSON.stringify(p):(+p).toString(h);for(var g=parseInt(l),v=l&&l[0]+""=="0"?"0":" ";p.length<g;)p=s!==void 0?p+v:v+p;return p}}var i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return e.replace(i,a)},r.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.buffer+=r.form(e,t)},r.prototype.toString=function(){return this.buffer},r}(),J$=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},O4=function(){function r(e){this.boundingBox=new Op(e),this.codewords=new Array(e.getMaxY()-e.getMinY()+1)}return r.prototype.getCodewordNearby=function(e){var t=this.getCodeword(e);if(t!=null)return t;for(var n=1;n<r.MAX_NEARBY_DISTANCE;n++){var a=this.imageRowToCodewordIndex(e)-n;if(a>=0&&(t=this.codewords[a],t!=null)||(a=this.imageRowToCodewordIndex(e)+n,a<this.codewords.length&&(t=this.codewords[a],t!=null)))return t}return null},r.prototype.imageRowToCodewordIndex=function(e){return e-this.boundingBox.getMinY()},r.prototype.setCodeword=function(e,t){this.codewords[this.imageRowToCodewordIndex(e)]=t},r.prototype.getCodeword=function(e){return this.codewords[this.imageRowToCodewordIndex(e)]},r.prototype.getBoundingBox=function(){return this.boundingBox},r.prototype.getCodewords=function(){return this.codewords},r.prototype.toString=function(){var e,t,n=new Gg,a=0;try{for(var i=J$(this.codewords),o=i.next();!o.done;o=i.next()){var s=o.value;if(s==null){n.format("%3d:    |   %n",a++);continue}n.format("%3d: %3d|%3d%n",a++,s.getRowNumber(),s.getValue())}}catch(l){e={error:l}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}return n.toString()},r.MAX_NEARBY_DISTANCE=5,r}(),eU=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},tU=function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),a,i=[],o;try{for(;(e===void 0||e-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i},uu=function(){function r(){this.values=new Map}return r.prototype.setValue=function(e){e=Math.trunc(e);var t=this.values.get(e);t==null&&(t=0),t++,this.values.set(e,t)},r.prototype.getValue=function(){var e,t,n=-1,a=new Array,i=function(f,h){var p={getKey:function(){return f},getValue:function(){return h}};p.getValue()>n?(n=p.getValue(),a=[],a.push(p.getKey())):p.getValue()===n&&a.push(p.getKey())};try{for(var o=eU(this.values.entries()),s=o.next();!s.done;s=o.next()){var l=tU(s.value,2),u=l[0],d=l[1];i(u,d)}}catch(f){e={error:f}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return Vt.toIntArray(a)},r.prototype.getConfidence=function(e){return this.values.get(e)},r}(),rU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),S1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Ex=function(r){rU(e,r);function e(t,n){var a=r.call(this,t)||this;return a._isLeft=n,a}return e.prototype.setRowNumbers=function(){var t,n;try{for(var a=S1(this.getCodewords()),i=a.next();!i.done;i=a.next()){var o=i.value;o?.setRowNumberAsRowIndicatorColumn()}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},e.prototype.adjustCompleteIndicatorColumnRowNumbers=function(t){var n=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(n,t);for(var a=this.getBoundingBox(),i=this._isLeft?a.getTopLeft():a.getTopRight(),o=this._isLeft?a.getBottomLeft():a.getBottomRight(),s=this.imageRowToCodewordIndex(Math.trunc(i.getY())),l=this.imageRowToCodewordIndex(Math.trunc(o.getY())),u=-1,d=1,f=0,h=s;h<l;h++)if(n[h]!=null){var p=n[h],g=p.getRowNumber()-u;if(g===0)f++;else if(g===1)d=Math.max(d,f),f=1,u=p.getRowNumber();else if(g<0||p.getRowNumber()>=t.getRowCount()||g>h)n[h]=null;else{var v=void 0;d>2?v=(d-2)*g:v=g;for(var b=v>=h,y=1;y<=v&&!b;y++)b=n[h-y]!=null;b?n[h]=null:(u=p.getRowNumber(),f=1)}}},e.prototype.getRowHeights=function(){var t,n,a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);var i=new Int32Array(a.getRowCount());try{for(var o=S1(this.getCodewords()),s=o.next();!s.done;s=o.next()){var l=s.value;if(l!=null){var u=l.getRowNumber();if(u>=i.length)continue;i[u]++}}}catch(d){t={error:d}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i},e.prototype.adjustIncompleteIndicatorColumnRowNumbers=function(t){for(var n=this.getBoundingBox(),a=this._isLeft?n.getTopLeft():n.getTopRight(),i=this._isLeft?n.getBottomLeft():n.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(a.getY())),s=this.imageRowToCodewordIndex(Math.trunc(i.getY())),l=this.getCodewords(),u=-1,d=o;d<s;d++)if(l[d]!=null){var f=l[d];f.setRowNumberAsRowIndicatorColumn();var h=f.getRowNumber()-u;h===0||(h===1?u=f.getRowNumber():f.getRowNumber()>=t.getRowCount()?l[d]=null:u=f.getRowNumber())}},e.prototype.getBarcodeMetadata=function(){var t,n,a=this.getCodewords(),i=new uu,o=new uu,s=new uu,l=new uu;try{for(var u=S1(a),d=u.next();!d.done;d=u.next()){var f=d.value;if(f!=null){f.setRowNumberAsRowIndicatorColumn();var h=f.getValue()%30,p=f.getRowNumber();switch(this._isLeft||(p+=2),p%3){case 0:o.setValue(h*3+1);break;case 1:l.setValue(h/3),s.setValue(h%3);break;case 2:i.setValue(h+1);break}}}}catch(v){t={error:v}}finally{try{d&&!d.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}if(i.getValue().length===0||o.getValue().length===0||s.getValue().length===0||l.getValue().length===0||i.getValue()[0]<1||o.getValue()[0]+s.getValue()[0]<Vt.MIN_ROWS_IN_BARCODE||o.getValue()[0]+s.getValue()[0]>Vt.MAX_ROWS_IN_BARCODE)return null;var g=new Z$(i.getValue()[0],o.getValue()[0],s.getValue()[0],l.getValue()[0]);return this.removeIncorrectCodewords(a,g),g},e.prototype.removeIncorrectCodewords=function(t,n){for(var a=0;a<t.length;a++){var i=t[a];if(t[a]!=null){var o=i.getValue()%30,s=i.getRowNumber();if(s>n.getRowCount()){t[a]=null;continue}switch(this._isLeft||(s+=2),s%3){case 0:o*3+1!==n.getRowCountUpperPart()&&(t[a]=null);break;case 1:(Math.trunc(o/3)!==n.getErrorCorrectionLevel()||o%3!==n.getRowCountLowerPart())&&(t[a]=null);break;case 2:o+1!==n.getColumnCount()&&(t[a]=null);break}}}},e.prototype.isLeft=function(){return this._isLeft},e.prototype.toString=function(){return"IsLeft: "+this._isLeft+`
`+r.prototype.toString.call(this)},e}(O4),nU=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},aU=function(){function r(e,t){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=e,this.barcodeColumnCount=e.getColumnCount(),this.boundingBox=t,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}return r.prototype.getDetectionResultColumns=function(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);var e=Vt.MAX_CODEWORDS_IN_BARCODE,t;do t=e,e=this.adjustRowNumbersAndGetCount();while(e>0&&e<t);return this.detectionResultColumns},r.prototype.adjustIndicatorColumnRowNumbers=function(e){e?.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)},r.prototype.adjustRowNumbersAndGetCount=function(){var e=this.adjustRowNumbersByRow();if(e===0)return 0;for(var t=1;t<this.barcodeColumnCount+1;t++)for(var n=this.detectionResultColumns[t].getCodewords(),a=0;a<n.length;a++)n[a]!=null&&(n[a].hasValidRowNumber()||this.adjustRowNumbers(t,a,n));return e},r.prototype.adjustRowNumbersByRow=function(){this.adjustRowNumbersFromBothRI();var e=this.adjustRowNumbersFromLRI();return e+this.adjustRowNumbersFromRRI()},r.prototype.adjustRowNumbersFromBothRI=function(){if(!(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)){for(var e=this.detectionResultColumns[0].getCodewords(),t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<e.length;n++)if(e[n]!=null&&t[n]!=null&&e[n].getRowNumber()===t[n].getRowNumber())for(var a=1;a<=this.barcodeColumnCount;a++){var i=this.detectionResultColumns[a].getCodewords()[n];i!=null&&(i.setRowNumber(e[n].getRowNumber()),i.hasValidRowNumber()||(this.detectionResultColumns[a].getCodewords()[n]=null))}}},r.prototype.adjustRowNumbersFromRRI=function(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;for(var e=0,t=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords(),n=0;n<t.length;n++)if(t[n]!=null)for(var a=t[n].getRowNumber(),i=0,o=this.barcodeColumnCount+1;o>0&&i<this.ADJUST_ROW_NUMBER_SKIP;o--){var s=this.detectionResultColumns[o].getCodewords()[n];s!=null&&(i=r.adjustRowNumberIfValid(a,i,s),s.hasValidRowNumber()||e++)}return e},r.prototype.adjustRowNumbersFromLRI=function(){if(this.detectionResultColumns[0]==null)return 0;for(var e=0,t=this.detectionResultColumns[0].getCodewords(),n=0;n<t.length;n++)if(t[n]!=null)for(var a=t[n].getRowNumber(),i=0,o=1;o<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;o++){var s=this.detectionResultColumns[o].getCodewords()[n];s!=null&&(i=r.adjustRowNumberIfValid(a,i,s),s.hasValidRowNumber()||e++)}return e},r.adjustRowNumberIfValid=function(e,t,n){return n==null||n.hasValidRowNumber()||(n.isValidRowNumber(e)?(n.setRowNumber(e),t=0):++t),t},r.prototype.adjustRowNumbers=function(e,t,n){var a,i;if(this.detectionResultColumns[e-1]!=null){var o=n[t],s=this.detectionResultColumns[e-1].getCodewords(),l=s;this.detectionResultColumns[e+1]!=null&&(l=this.detectionResultColumns[e+1].getCodewords());var u=new Array(14);u[2]=s[t],u[3]=l[t],t>0&&(u[0]=n[t-1],u[4]=s[t-1],u[5]=l[t-1]),t>1&&(u[8]=n[t-2],u[10]=s[t-2],u[11]=l[t-2]),t<n.length-1&&(u[1]=n[t+1],u[6]=s[t+1],u[7]=l[t+1]),t<n.length-2&&(u[9]=n[t+2],u[12]=s[t+2],u[13]=l[t+2]);try{for(var d=nU(u),f=d.next();!f.done;f=d.next()){var h=f.value;if(r.adjustRowNumber(o,h))return}}catch(p){a={error:p}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}}},r.adjustRowNumber=function(e,t){return t==null?!1:t.hasValidRowNumber()&&t.getBucket()===e.getBucket()?(e.setRowNumber(t.getRowNumber()),!0):!1},r.prototype.getBarcodeColumnCount=function(){return this.barcodeColumnCount},r.prototype.getBarcodeRowCount=function(){return this.barcodeMetadata.getRowCount()},r.prototype.getBarcodeECLevel=function(){return this.barcodeMetadata.getErrorCorrectionLevel()},r.prototype.setBoundingBox=function(e){this.boundingBox=e},r.prototype.getBoundingBox=function(){return this.boundingBox},r.prototype.setDetectionResultColumn=function(e,t){this.detectionResultColumns[e]=t},r.prototype.getDetectionResultColumn=function(e){return this.detectionResultColumns[e]},r.prototype.toString=function(){var e=this.detectionResultColumns[0];e==null&&(e=this.detectionResultColumns[this.barcodeColumnCount+1]);for(var t=new Gg,n=0;n<e.getCodewords().length;n++){t.format("CW %3d:",n);for(var a=0;a<this.barcodeColumnCount+2;a++){if(this.detectionResultColumns[a]==null){t.format("    |   ");continue}var i=this.detectionResultColumns[a].getCodewords()[n];if(i==null){t.format("    |   ");continue}t.format(" %3d|%3d",i.getRowNumber(),i.getValue())}t.format("%n")}return t.toString()},r}(),iU=function(){function r(e,t,n,a){this.rowNumber=r.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(e),this.endX=Math.trunc(t),this.bucket=Math.trunc(n),this.value=Math.trunc(a)}return r.prototype.hasValidRowNumber=function(){return this.isValidRowNumber(this.rowNumber)},r.prototype.isValidRowNumber=function(e){return e!==r.BARCODE_ROW_UNKNOWN&&this.bucket===e%3*3},r.prototype.setRowNumberAsRowIndicatorColumn=function(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))},r.prototype.getWidth=function(){return this.endX-this.startX},r.prototype.getStartX=function(){return this.startX},r.prototype.getEndX=function(){return this.endX},r.prototype.getBucket=function(){return this.bucket},r.prototype.getValue=function(){return this.value},r.prototype.getRowNumber=function(){return this.rowNumber},r.prototype.setRowNumber=function(e){this.rowNumber=e},r.prototype.toString=function(){return this.rowNumber+"|"+this.value},r.BARCODE_ROW_UNKNOWN=-1,r}(),oU=function(){function r(){}return r.initialize=function(){for(var e=0;e<Vt.SYMBOL_TABLE.length;e++)for(var t=Vt.SYMBOL_TABLE[e],n=t&1,a=0;a<Vt.BARS_IN_MODULE;a++){for(var i=0;(t&1)===n;)i+=1,t>>=1;n=t&1,r.RATIOS_TABLE[e]||(r.RATIOS_TABLE[e]=new Array(Vt.BARS_IN_MODULE)),r.RATIOS_TABLE[e][Vt.BARS_IN_MODULE-a-1]=Math.fround(i/Vt.MODULES_IN_CODEWORD)}this.bSymbolTableReady=!0},r.getDecodedValue=function(e){var t=r.getDecodedCodewordValue(r.sampleBitCounts(e));return t!==-1?t:r.getClosestDecodedValue(e)},r.sampleBitCounts=function(e){for(var t=Wt.sum(e),n=new Int32Array(Vt.BARS_IN_MODULE),a=0,i=0,o=0;o<Vt.MODULES_IN_CODEWORD;o++){var s=t/(2*Vt.MODULES_IN_CODEWORD)+o*t/Vt.MODULES_IN_CODEWORD;i+e[a]<=s&&(i+=e[a],a++),n[a]++}return n},r.getDecodedCodewordValue=function(e){var t=r.getBitValue(e);return Vt.getCodeword(t)===-1?-1:t},r.getBitValue=function(e){for(var t=0,n=0;n<e.length;n++)for(var a=0;a<e[n];a++)t=t<<1|(n%2===0?1:0);return Math.trunc(t)},r.getClosestDecodedValue=function(e){var t=Wt.sum(e),n=new Array(Vt.BARS_IN_MODULE);if(t>1)for(var a=0;a<n.length;a++)n[a]=Math.fround(e[a]/t);var i=Dp.MAX_VALUE,o=-1;this.bSymbolTableReady||r.initialize();for(var s=0;s<r.RATIOS_TABLE.length;s++){for(var l=0,u=r.RATIOS_TABLE[s],d=0;d<Vt.BARS_IN_MODULE;d++){var f=Math.fround(u[d]-n[d]);if(l+=Math.fround(f*f),l>=i)break}l<i&&(i=l,o=Vt.SYMBOL_TABLE[s])}return o},r.bSymbolTableReady=!1,r.RATIOS_TABLE=new Array(Vt.SYMBOL_TABLE.length).map(function(e){return new Array(Vt.BARS_IN_MODULE)}),r}(),sU=function(){function r(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}return r.prototype.getSegmentIndex=function(){return this.segmentIndex},r.prototype.setSegmentIndex=function(e){this.segmentIndex=e},r.prototype.getFileId=function(){return this.fileId},r.prototype.setFileId=function(e){this.fileId=e},r.prototype.getOptionalData=function(){return this.optionalData},r.prototype.setOptionalData=function(e){this.optionalData=e},r.prototype.isLastSegment=function(){return this.lastSegment},r.prototype.setLastSegment=function(e){this.lastSegment=e},r.prototype.getSegmentCount=function(){return this.segmentCount},r.prototype.setSegmentCount=function(e){this.segmentCount=e},r.prototype.getSender=function(){return this.sender||null},r.prototype.setSender=function(e){this.sender=e},r.prototype.getAddressee=function(){return this.addressee||null},r.prototype.setAddressee=function(e){this.addressee=e},r.prototype.getFileName=function(){return this.fileName},r.prototype.setFileName=function(e){this.fileName=e},r.prototype.getFileSize=function(){return this.fileSize},r.prototype.setFileSize=function(e){this.fileSize=e},r.prototype.getChecksum=function(){return this.checksum},r.prototype.setChecksum=function(e){this.checksum=e},r.prototype.getTimestamp=function(){return this.timestamp},r.prototype.setTimestamp=function(e){this.timestamp=e},r}(),Ax=function(){function r(){}return r.parseLong=function(e,t){return t===void 0&&(t=void 0),parseInt(e,t)},r}(),cU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),lU=function(r){cU(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="NullPointerException",e}(da),uU=function(){function r(){}return r.prototype.writeBytes=function(e){this.writeBytesOffset(e,0,e.length)},r.prototype.writeBytesOffset=function(e,t,n){if(e==null)throw new lU;if(t<0||t>e.length||n<0||t+n>e.length||t+n<0)throw new Vg;if(n===0)return;for(var a=0;a<n;a++)this.write(e[t+a])},r.prototype.flush=function(){},r.prototype.close=function(){},r}(),dU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),fU=function(r){dU(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e}(da),hU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),pU=function(r){hU(e,r);function e(t){t===void 0&&(t=32);var n=r.call(this)||this;if(n.count=0,t<0)throw new st("Negative initial size: "+t);return n.buf=new Uint8Array(t),n}return e.prototype.ensureCapacity=function(t){t-this.buf.length>0&&this.grow(t)},e.prototype.grow=function(t){var n=this.buf.length,a=n<<1;if(a-t<0&&(a=t),a<0){if(t<0)throw new fU;a=Tt.MAX_VALUE}this.buf=on.copyOfUint8Array(this.buf,a)},e.prototype.write=function(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1},e.prototype.writeBytesOffset=function(t,n,a){if(n<0||n>t.length||a<0||n+a-t.length>0)throw new Vg;this.ensureCapacity(this.count+a),mr.arraycopy(t,n,this.buf,this.count,a),this.count+=a},e.prototype.writeTo=function(t){t.writeBytesOffset(this.buf,0,this.count)},e.prototype.reset=function(){this.count=0},e.prototype.toByteArray=function(){return on.copyOfUint8Array(this.buf,this.count)},e.prototype.size=function(){return this.count},e.prototype.toString=function(t){return t?typeof t=="string"?this.toString_string(t):this.toString_number(t):this.toString_void()},e.prototype.toString_void=function(){return new String(this.buf).toString()},e.prototype.toString_string=function(t){return new String(this.buf).toString()},e.prototype.toString_number=function(t){return new String(this.buf).toString()},e.prototype.close=function(){},e}(uU),sr;(function(r){r[r.ALPHA=0]="ALPHA",r[r.LOWER=1]="LOWER",r[r.MIXED=2]="MIXED",r[r.PUNCT=3]="PUNCT",r[r.ALPHA_SHIFT=4]="ALPHA_SHIFT",r[r.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(sr||(sr={}));function k4(){if(typeof window<"u")return window.BigInt||null;if(typeof global<"u")return global.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}var cf;function Io(r){if(typeof cf>"u"&&(cf=k4()),cf===null)throw new Error("BigInt is not supported!");return cf(r)}function mU(){var r=[];r[0]=Io(1);var e=Io(900);r[1]=e;for(var t=2;t<16;t++)r[t]=r[t-1]*e;return r}var gU=function(){function r(){}return r.decode=function(e,t){var n=new Pt(""),a=an.ISO8859_1;n.enableDecoding(a);for(var i=1,o=e[i++],s=new sU;i<e[0];){switch(o){case r.TEXT_COMPACTION_MODE_LATCH:i=r.textCompaction(e,i,n);break;case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:i=r.byteCompaction(o,e,a,i,n);break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[i++]);break;case r.NUMERIC_COMPACTION_MODE_LATCH:i=r.numericCompaction(e,i,n);break;case r.ECI_CHARSET:an.getCharacterSetECIByValue(e[i++]);break;case r.ECI_GENERAL_PURPOSE:i+=2;break;case r.ECI_USER_DEFINED:i++;break;case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=r.decodeMacroBlock(e,i,s);break;case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:throw new ke;default:i--,i=r.textCompaction(e,i,n);break}if(i<e.length)o=e[i++];else throw ke.getFormatInstance()}if(n.length()===0)throw ke.getFormatInstance();var l=new Hh(null,n.toString(),null,t);return l.setOther(s),l},r.decodeMacroBlock=function(e,t,n){if(t+r.NUMBER_OF_SEQUENCE_CODEWORDS>e[0])throw ke.getFormatInstance();for(var a=new Int32Array(r.NUMBER_OF_SEQUENCE_CODEWORDS),i=0;i<r.NUMBER_OF_SEQUENCE_CODEWORDS;i++,t++)a[i]=e[t];n.setSegmentIndex(Tt.parseInt(r.decodeBase900toBase10(a,r.NUMBER_OF_SEQUENCE_CODEWORDS)));var o=new Pt;t=r.textCompaction(e,t,o),n.setFileId(o.toString());var s=-1;for(e[t]===r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(s=t+1);t<e[0];)switch(e[t]){case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t++,e[t]){case r.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:var l=new Pt;t=r.textCompaction(e,t+1,l),n.setFileName(l.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_SENDER:var u=new Pt;t=r.textCompaction(e,t+1,u),n.setSender(u.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:var d=new Pt;t=r.textCompaction(e,t+1,d),n.setAddressee(d.toString());break;case r.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:var f=new Pt;t=r.numericCompaction(e,t+1,f),n.setSegmentCount(Tt.parseInt(f.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:var h=new Pt;t=r.numericCompaction(e,t+1,h),n.setTimestamp(Ax.parseLong(h.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:var p=new Pt;t=r.numericCompaction(e,t+1,p),n.setChecksum(Tt.parseInt(p.toString()));break;case r.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:var g=new Pt;t=r.numericCompaction(e,t+1,g),n.setFileSize(Ax.parseLong(g.toString()));break;default:throw ke.getFormatInstance()}break;case r.MACRO_PDF417_TERMINATOR:t++,n.setLastSegment(!0);break;default:throw ke.getFormatInstance()}if(s!==-1){var v=t-s;n.isLastSegment()&&v--,n.setOptionalData(on.copyOfRange(e,s,s+v))}return t},r.textCompaction=function(e,t,n){for(var a=new Int32Array((e[0]-t)*2),i=new Int32Array((e[0]-t)*2),o=0,s=!1;t<e[0]&&!s;){var l=e[t++];if(l<r.TEXT_COMPACTION_MODE_LATCH)a[o]=l/30,a[o+1]=l%30,o+=2;else switch(l){case r.TEXT_COMPACTION_MODE_LATCH:a[o++]=r.TEXT_COMPACTION_MODE_LATCH;break;case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:t--,s=!0;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a[o]=r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,l=e[t++],i[o]=l,o++;break}}return r.decodeTextCompaction(a,i,o,n),t},r.decodeTextCompaction=function(e,t,n,a){for(var i=sr.ALPHA,o=sr.ALPHA,s=0;s<n;){var l=e[s],u="";switch(i){case sr.ALPHA:if(l<26)u=String.fromCharCode(65+l);else switch(l){case 26:u=" ";break;case r.LL:i=sr.LOWER;break;case r.ML:i=sr.MIXED;break;case r.PS:o=i,i=sr.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=sr.ALPHA;break}break;case sr.LOWER:if(l<26)u=String.fromCharCode(97+l);else switch(l){case 26:u=" ";break;case r.AS:o=i,i=sr.ALPHA_SHIFT;break;case r.ML:i=sr.MIXED;break;case r.PS:o=i,i=sr.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=sr.ALPHA;break}break;case sr.MIXED:if(l<r.PL)u=r.MIXED_CHARS[l];else switch(l){case r.PL:i=sr.PUNCT;break;case 26:u=" ";break;case r.LL:i=sr.LOWER;break;case r.AL:i=sr.ALPHA;break;case r.PS:o=i,i=sr.PUNCT_SHIFT;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=sr.ALPHA;break}break;case sr.PUNCT:if(l<r.PAL)u=r.PUNCT_CHARS[l];else switch(l){case r.PAL:i=sr.ALPHA;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=sr.ALPHA;break}break;case sr.ALPHA_SHIFT:if(i=o,l<26)u=String.fromCharCode(65+l);else switch(l){case 26:u=" ";break;case r.TEXT_COMPACTION_MODE_LATCH:i=sr.ALPHA;break}break;case sr.PUNCT_SHIFT:if(i=o,l<r.PAL)u=r.PUNCT_CHARS[l];else switch(l){case r.PAL:i=sr.ALPHA;break;case r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:a.append(t[s]);break;case r.TEXT_COMPACTION_MODE_LATCH:i=sr.ALPHA;break}break}u!==""&&a.append(u),s++}},r.byteCompaction=function(e,t,n,a,i){var o=new pU,s=0,l=0,u=!1;switch(e){case r.BYTE_COMPACTION_MODE_LATCH:for(var d=new Int32Array(6),f=t[a++];a<t[0]&&!u;)switch(d[s++]=f,l=900*l+f,f=t[a++],f){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:a--,u=!0;break;default:if(s%5===0&&s>0){for(var h=0;h<6;++h)o.write(Number(Io(l)>>Io(8*(5-h))));l=0,s=0}break}a===t[0]&&f<r.TEXT_COMPACTION_MODE_LATCH&&(d[s++]=f);for(var p=0;p<s;p++)o.write(d[p]);break;case r.BYTE_COMPACTION_MODE_LATCH_6:for(;a<t[0]&&!u;){var g=t[a++];if(g<r.TEXT_COMPACTION_MODE_LATCH)s++,l=900*l+g;else switch(g){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.NUMERIC_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:a--,u=!0;break}if(s%5===0&&s>0){for(var h=0;h<6;++h)o.write(Number(Io(l)>>Io(8*(5-h))));l=0,s=0}}break}return i.append(Va.decode(o.toByteArray(),n)),a},r.numericCompaction=function(e,t,n){for(var a=0,i=!1,o=new Int32Array(r.MAX_NUMERIC_CODEWORDS);t<e[0]&&!i;){var s=e[t++];if(t===e[0]&&(i=!0),s<r.TEXT_COMPACTION_MODE_LATCH)o[a]=s,a++;else switch(s){case r.TEXT_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH:case r.BYTE_COMPACTION_MODE_LATCH_6:case r.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case r.MACRO_PDF417_TERMINATOR:t--,i=!0;break}(a%r.MAX_NUMERIC_CODEWORDS===0||s===r.NUMERIC_COMPACTION_MODE_LATCH||i)&&a>0&&(n.append(r.decodeBase900toBase10(o,a)),a=0)}return t},r.decodeBase900toBase10=function(e,t){for(var n=Io(0),a=0;a<t;a++)n+=r.EXP900[t-a-1]*Io(e[a]);var i=n.toString();if(i.charAt(0)!=="1")throw new ke;return i.substring(1)},r.TEXT_COMPACTION_MODE_LATCH=900,r.BYTE_COMPACTION_MODE_LATCH=901,r.NUMERIC_COMPACTION_MODE_LATCH=902,r.BYTE_COMPACTION_MODE_LATCH_6=924,r.ECI_USER_DEFINED=925,r.ECI_GENERAL_PURPOSE=926,r.ECI_CHARSET=927,r.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,r.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,r.MACRO_PDF417_TERMINATOR=922,r.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,r.MAX_NUMERIC_CODEWORDS=15,r.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,r.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,r.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,r.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,r.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,r.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,r.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,r.PL=25,r.LL=27,r.AS=27,r.ML=28,r.AL=28,r.PS=29,r.PAL=29,r.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,r.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",r.EXP900=k4()?mU():[],r.NUMBER_OF_SEQUENCE_CODEWORDS=2,r}(),au=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vU=function(){function r(){}return r.decode=function(e,t,n,a,i,o,s){for(var l=new Op(e,t,n,a,i),u=null,d=null,f,h=!0;;h=!1){if(t!=null&&(u=r.getRowIndicatorColumn(e,l,t,!0,o,s)),a!=null&&(d=r.getRowIndicatorColumn(e,l,a,!1,o,s)),f=r.merge(u,d),f==null)throw Ce.getNotFoundInstance();var p=f.getBoundingBox();if(h&&p!=null&&(p.getMinY()<l.getMinY()||p.getMaxY()>l.getMaxY()))l=p;else break}f.setBoundingBox(l);var g=f.getBarcodeColumnCount()+1;f.setDetectionResultColumn(0,u),f.setDetectionResultColumn(g,d);for(var v=u!=null,b=1;b<=g;b++){var y=v?b:g-b;if(f.getDetectionResultColumn(y)===void 0){var C=void 0;y===0||y===g?C=new Ex(l,y===0):C=new O4(l),f.setDetectionResultColumn(y,C);for(var S=-1,j=S,D=l.getMinY();D<=l.getMaxY();D++){if(S=r.getStartColumn(f,y,D,v),S<0||S>l.getMaxX()){if(j===-1)continue;S=j}var F=r.detectCodeword(e,l.getMinX(),l.getMaxX(),v,S,D,o,s);F!=null&&(C.setCodeword(D,F),j=S,o=Math.min(o,F.getWidth()),s=Math.max(s,F.getWidth()))}}}return r.createDecoderResult(f)},r.merge=function(e,t){if(e==null&&t==null)return null;var n=r.getBarcodeMetadata(e,t);if(n==null)return null;var a=Op.merge(r.adjustBoundingBox(e),r.adjustBoundingBox(t));return new aU(n,a)},r.adjustBoundingBox=function(e){var t,n;if(e==null)return null;var a=e.getRowHeights();if(a==null)return null;var i=r.getMax(a),o=0;try{for(var s=au(a),l=s.next();!l.done;l=s.next()){var u=l.value;if(o+=i-u,u>0)break}}catch(p){t={error:p}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}for(var d=e.getCodewords(),f=0;o>0&&d[f]==null;f++)o--;for(var h=0,f=a.length-1;f>=0&&(h+=i-a[f],!(a[f]>0));f--);for(var f=d.length-1;h>0&&d[f]==null;f--)h--;return e.getBoundingBox().addMissingRows(o,h,e.isLeft())},r.getMax=function(e){var t,n,a=-1;try{for(var i=au(e),o=i.next();!o.done;o=i.next()){var s=o.value;a=Math.max(a,s)}}catch(l){t={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return a},r.getBarcodeMetadata=function(e,t){var n;if(e==null||(n=e.getBarcodeMetadata())==null)return t==null?null:t.getBarcodeMetadata();var a;return t==null||(a=t.getBarcodeMetadata())==null?n:n.getColumnCount()!==a.getColumnCount()&&n.getErrorCorrectionLevel()!==a.getErrorCorrectionLevel()&&n.getRowCount()!==a.getRowCount()?null:n},r.getRowIndicatorColumn=function(e,t,n,a,i,o){for(var s=new Ex(t,a),l=0;l<2;l++)for(var u=l===0?1:-1,d=Math.trunc(Math.trunc(n.getX())),f=Math.trunc(Math.trunc(n.getY()));f<=t.getMaxY()&&f>=t.getMinY();f+=u){var h=r.detectCodeword(e,0,e.getWidth(),a,d,f,i,o);h!=null&&(s.setCodeword(f,h),a?d=h.getStartX():d=h.getEndX())}return s},r.adjustCodewordCount=function(e,t){var n=t[0][1],a=n.getValue(),i=e.getBarcodeColumnCount()*e.getBarcodeRowCount()-r.getNumberOfECCodeWords(e.getBarcodeECLevel());if(a.length===0){if(i<1||i>Vt.MAX_CODEWORDS_IN_BARCODE)throw Ce.getNotFoundInstance();n.setValue(i)}else a[0]!==i&&n.setValue(i)},r.createDecoderResult=function(e){var t=r.createBarcodeMatrix(e);r.adjustCodewordCount(e,t);for(var n=new Array,a=new Int32Array(e.getBarcodeRowCount()*e.getBarcodeColumnCount()),i=[],o=new Array,s=0;s<e.getBarcodeRowCount();s++)for(var l=0;l<e.getBarcodeColumnCount();l++){var u=t[s][l+1].getValue(),d=s*e.getBarcodeColumnCount()+l;u.length===0?n.push(d):u.length===1?a[d]=u[0]:(o.push(d),i.push(u))}for(var f=new Array(i.length),h=0;h<f.length;h++)f[h]=i[h];return r.createDecoderResultFromAmbiguousValues(e.getBarcodeECLevel(),a,Vt.toIntArray(n),Vt.toIntArray(o),f)},r.createDecoderResultFromAmbiguousValues=function(e,t,n,a,i){for(var o=new Int32Array(a.length),s=100;s-- >0;){for(var l=0;l<o.length;l++)t[a[l]]=i[l][o[l]];try{return r.decodeCodewords(t,e,n)}catch(d){var u=d instanceof Vr;if(!u)throw d}if(o.length===0)throw Vr.getChecksumInstance();for(var l=0;l<o.length;l++)if(o[l]<i[l].length-1){o[l]++;break}else if(o[l]=0,l===o.length-1)throw Vr.getChecksumInstance()}throw Vr.getChecksumInstance()},r.createBarcodeMatrix=function(e){for(var t,n,a,i,o=Array.from({length:e.getBarcodeRowCount()},function(){return new Array(e.getBarcodeColumnCount()+2)}),s=0;s<o.length;s++)for(var l=0;l<o[s].length;l++)o[s][l]=new uu;var u=0;try{for(var d=au(e.getDetectionResultColumns()),f=d.next();!f.done;f=d.next()){var h=f.value;if(h!=null)try{for(var p=(a=void 0,au(h.getCodewords())),g=p.next();!g.done;g=p.next()){var v=g.value;if(v!=null){var b=v.getRowNumber();if(b>=0){if(b>=o.length)continue;o[b][u].setValue(v.getValue())}}}}catch(y){a={error:y}}finally{try{g&&!g.done&&(i=p.return)&&i.call(p)}finally{if(a)throw a.error}}u++}}catch(y){t={error:y}}finally{try{f&&!f.done&&(n=d.return)&&n.call(d)}finally{if(t)throw t.error}}return o},r.isValidBarcodeColumn=function(e,t){return t>=0&&t<=e.getBarcodeColumnCount()+1},r.getStartColumn=function(e,t,n,a){var i,o,s=a?1:-1,l=null;if(r.isValidBarcodeColumn(e,t-s)&&(l=e.getDetectionResultColumn(t-s).getCodeword(n)),l!=null)return a?l.getEndX():l.getStartX();if(l=e.getDetectionResultColumn(t).getCodewordNearby(n),l!=null)return a?l.getStartX():l.getEndX();if(r.isValidBarcodeColumn(e,t-s)&&(l=e.getDetectionResultColumn(t-s).getCodewordNearby(n)),l!=null)return a?l.getEndX():l.getStartX();for(var u=0;r.isValidBarcodeColumn(e,t-s);){t-=s;try{for(var d=(i=void 0,au(e.getDetectionResultColumn(t).getCodewords())),f=d.next();!f.done;f=d.next()){var h=f.value;if(h!=null)return(a?h.getEndX():h.getStartX())+s*u*(h.getEndX()-h.getStartX())}}catch(p){i={error:p}}finally{try{f&&!f.done&&(o=d.return)&&o.call(d)}finally{if(i)throw i.error}}u++}return a?e.getBoundingBox().getMinX():e.getBoundingBox().getMaxX()},r.detectCodeword=function(e,t,n,a,i,o,s,l){i=r.adjustCodewordStartColumn(e,t,n,a,i,o);var u=r.getModuleBitCount(e,t,n,a,i,o);if(u==null)return null;var d,f=Wt.sum(u);if(a)d=i+f;else{for(var h=0;h<u.length/2;h++){var p=u[h];u[h]=u[u.length-1-h],u[u.length-1-h]=p}d=i,i=d-f}if(!r.checkCodewordSkew(f,s,l))return null;var g=oU.getDecodedValue(u),v=Vt.getCodeword(g);return v===-1?null:new iU(i,d,r.getCodewordBucketNumber(g),v)},r.getModuleBitCount=function(e,t,n,a,i,o){for(var s=i,l=new Int32Array(8),u=0,d=a?1:-1,f=a;(a?s<n:s>=t)&&u<l.length;)e.get(s,o)===f?(l[u]++,s+=d):(u++,f=!f);return u===l.length||s===(a?n:t)&&u===l.length-1?l:null},r.getNumberOfECCodeWords=function(e){return 2<<e},r.adjustCodewordStartColumn=function(e,t,n,a,i,o){for(var s=i,l=a?-1:1,u=0;u<2;u++){for(;(a?s>=t:s<n)&&a===e.get(s,o);){if(Math.abs(i-s)>r.CODEWORD_SKEW_SIZE)return i;s+=l}l=-l,a=!a}return s},r.checkCodewordSkew=function(e,t,n){return t-r.CODEWORD_SKEW_SIZE<=e&&e<=n+r.CODEWORD_SKEW_SIZE},r.decodeCodewords=function(e,t,n){if(e.length===0)throw ke.getFormatInstance();var a=1<<t+1,i=r.correctErrors(e,n,a);r.verifyCodewordCount(e,a);var o=gU.decode(e,""+t);return o.setErrorsCorrected(i),o.setErasures(n.length),o},r.correctErrors=function(e,t,n){if(t!=null&&t.length>n/2+r.MAX_ERRORS||n<0||n>r.MAX_EC_CODEWORDS)throw Vr.getChecksumInstance();return r.errorCorrection.decode(e,n,t)},r.verifyCodewordCount=function(e,t){if(e.length<4)throw ke.getFormatInstance();var n=e[0];if(n>e.length)throw ke.getFormatInstance();if(n===0)if(t<e.length)e[0]=e.length-t;else throw ke.getFormatInstance()},r.getBitCountForCodeword=function(e){for(var t=new Int32Array(8),n=0,a=t.length-1;!((e&1)!==n&&(n=e&1,a--,a<0));)t[a]++,e>>=1;return t},r.getCodewordBucketNumber=function(e){return e instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(e):this.getCodewordBucketNumber_number(e)},r.getCodewordBucketNumber_number=function(e){return r.getCodewordBucketNumber(r.getBitCountForCodeword(e))},r.getCodewordBucketNumber_Int32Array=function(e){return(e[0]-e[2]+e[4]-e[6]+9)%9},r.toString=function(e){for(var t=new Gg,n=0;n<e.length;n++){t.format("Row %2d: ",n);for(var a=0;a<e[n].length;a++){var i=e[n][a];i.getValue().length===0?t.format("        ",null):t.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}t.format("%n")}return t.toString()},r.CODEWORD_SKEW_SIZE=2,r.MAX_ERRORS=3,r.MAX_EC_CODEWORDS=512,r.errorCorrection=new Q$,r}(),xU=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},eh=function(){function r(){}return r.prototype.decode=function(e,t){t===void 0&&(t=null);var n=r.decode(e,t,!1);if(n==null||n.length===0||n[0]==null)throw Ce.getNotFoundInstance();return n[0]},r.prototype.decodeMultiple=function(e,t){t===void 0&&(t=null);try{return r.decode(e,t,!0)}catch(n){throw n instanceof ke||n instanceof Vr?Ce.getNotFoundInstance():n}},r.decode=function(e,t,n){var a,i,o=new Array,s=H$.detectMultiple(e,t,n);try{for(var l=xU(s.getPoints()),u=l.next();!u.done;u=l.next()){var d=u.value,f=vU.decode(s.getBits(),d[4],d[5],d[6],d[7],r.getMinCodewordWidth(d),r.getMaxCodewordWidth(d)),h=new $n(f.getText(),f.getRawBytes(),void 0,d,ot.PDF_417);h.putMetadata(En.ERROR_CORRECTION_LEVEL,f.getECLevel());var p=f.getOther();p!=null&&h.putMetadata(En.PDF417_EXTRA_METADATA,p),o.push(h)}}catch(g){a={error:g}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(a)throw a.error}}return o.map(function(g){return g})},r.getMaxWidth=function(e,t){return e==null||t==null?0:Math.trunc(Math.abs(e.getX()-t.getX()))},r.getMinWidth=function(e,t){return e==null||t==null?Tt.MAX_VALUE:Math.trunc(Math.abs(e.getX()-t.getX()))},r.getMaxCodewordWidth=function(e){return Math.floor(Math.max(Math.max(r.getMaxWidth(e[0],e[4]),r.getMaxWidth(e[6],e[2])*Vt.MODULES_IN_CODEWORD/Vt.MODULES_IN_STOP_PATTERN),Math.max(r.getMaxWidth(e[1],e[5]),r.getMaxWidth(e[7],e[3])*Vt.MODULES_IN_CODEWORD/Vt.MODULES_IN_STOP_PATTERN)))},r.getMinCodewordWidth=function(e){return Math.floor(Math.min(Math.min(r.getMinWidth(e[0],e[4]),r.getMinWidth(e[6],e[2])*Vt.MODULES_IN_CODEWORD/Vt.MODULES_IN_STOP_PATTERN),Math.min(r.getMinWidth(e[1],e[5]),r.getMinWidth(e[7],e[3])*Vt.MODULES_IN_CODEWORD/Vt.MODULES_IN_STOP_PATTERN)))},r.prototype.reset=function(){},r}(),yU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),jx=function(r){yU(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="ReaderException",e}(da),Px=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},M4=function(){function r(){}return r.prototype.decode=function(e,t){return this.setHints(t),this.decodeInternal(e)},r.prototype.decodeWithState=function(e){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(e)},r.prototype.setHints=function(e){this.hints=e;var t=e!=null&&e.get(gr.TRY_HARDER)!==void 0,n=e==null?null:e.get(gr.POSSIBLE_FORMATS),a=new Array;if(n!=null){var i=n.some(function(o){return o===ot.UPC_A||o===ot.UPC_E||o===ot.EAN_13||o===ot.EAN_8||o===ot.CODABAR||o===ot.CODE_39||o===ot.CODE_93||o===ot.CODE_128||o===ot.ITF||o===ot.RSS_14||o===ot.RSS_EXPANDED});i&&!t&&a.push(new Uc(e)),n.includes(ot.QR_CODE)&&a.push(new Jf),n.includes(ot.DATA_MATRIX)&&a.push(new Zf),n.includes(ot.AZTEC)&&a.push(new Xf),n.includes(ot.PDF_417)&&a.push(new eh),i&&t&&a.push(new Uc(e))}a.length===0&&(t||a.push(new Uc(e)),a.push(new Jf),a.push(new Zf),a.push(new Xf),a.push(new eh),t&&a.push(new Uc(e))),this.readers=a},r.prototype.reset=function(){var e,t;if(this.readers!==null)try{for(var n=Px(this.readers),a=n.next();!a.done;a=n.next()){var i=a.value;i.reset()}}catch(o){e={error:o}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},r.prototype.decodeInternal=function(e){var t,n;if(this.readers===null)throw new jx("No readers where selected, nothing can be read.");try{for(var a=Px(this.readers),i=a.next();!i.done;i=a.next()){var o=i.value;try{return o.decode(e,this.hints)}catch(s){if(s instanceof jx)continue}}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}throw new Ce("No MultiFormat Readers were able to detect the code.")},r}(),bU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){bU(e,r);function e(t,n){t===void 0&&(t=null),n===void 0&&(n=500);var a=this,i=new M4;return i.setHints(t),a=r.call(this,i,n)||this,a}return e.prototype.decodeBitmap=function(t){return this.reader.decodeWithState(t)},e})(vl);var wU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){wU(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new eh,t)||this}return e})(vl);var _U=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){_U(e,r);function e(t){return t===void 0&&(t=500),r.call(this,new Jf,t)||this}return e})(vl);var kp;(function(r){r[r.ERROR_CORRECTION=0]="ERROR_CORRECTION",r[r.CHARACTER_SET=1]="CHARACTER_SET",r[r.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",r[r.DATA_MATRIX_COMPACT=3]="DATA_MATRIX_COMPACT",r[r.MIN_SIZE=4]="MIN_SIZE",r[r.MAX_SIZE=5]="MAX_SIZE",r[r.MARGIN=6]="MARGIN",r[r.PDF417_COMPACT=7]="PDF417_COMPACT",r[r.PDF417_COMPACTION=8]="PDF417_COMPACTION",r[r.PDF417_DIMENSIONS=9]="PDF417_DIMENSIONS",r[r.AZTEC_LAYERS=10]="AZTEC_LAYERS",r[r.QR_VERSION=11]="QR_VERSION",r[r.GS1_FORMAT=12]="GS1_FORMAT",r[r.FORCE_C40=13]="FORCE_C40"})(kp||(kp={}));const lf=kp;var R4=function(){function r(e){this.field=e,this.cachedGenerators=[],this.cachedGenerators.push(new Vo(e,Int32Array.from([1])))}return r.prototype.buildGenerator=function(e){var t=this.cachedGenerators;if(e>=t.length)for(var n=t[t.length-1],a=this.field,i=t.length;i<=e;i++){var o=n.multiply(new Vo(a,Int32Array.from([1,a.exp(i-1+a.getGeneratorBase())])));t.push(o),n=o}return t[e]},r.prototype.encode=function(e,t){if(t===0)throw new st("No error correction bytes");var n=e.length-t;if(n<=0)throw new st("No data bytes provided");var a=this.buildGenerator(t),i=new Int32Array(n);mr.arraycopy(e,0,i,0,n);var o=new Vo(this.field,i);o=o.multiplyByMonomial(t,1);for(var s=o.divide(a)[1],l=s.getCoefficients(),u=t-l.length,d=0;d<u;d++)e[n+d]=0;mr.arraycopy(l,0,e,n+u,l.length)},r}(),du=function(){function r(){}return r.applyMaskPenaltyRule1=function(e){return r.applyMaskPenaltyRule1Internal(e,!0)+r.applyMaskPenaltyRule1Internal(e,!1)},r.applyMaskPenaltyRule2=function(e){for(var t=0,n=e.getArray(),a=e.getWidth(),i=e.getHeight(),o=0;o<i-1;o++)for(var s=n[o],l=0;l<a-1;l++){var u=s[l];u===s[l+1]&&u===n[o+1][l]&&u===n[o+1][l+1]&&t++}return r.N2*t},r.applyMaskPenaltyRule3=function(e){for(var t=0,n=e.getArray(),a=e.getWidth(),i=e.getHeight(),o=0;o<i;o++)for(var s=0;s<a;s++){var l=n[o];s+6<a&&l[s]===1&&l[s+1]===0&&l[s+2]===1&&l[s+3]===1&&l[s+4]===1&&l[s+5]===0&&l[s+6]===1&&(r.isWhiteHorizontal(l,s-4,s)||r.isWhiteHorizontal(l,s+7,s+11))&&t++,o+6<i&&n[o][s]===1&&n[o+1][s]===0&&n[o+2][s]===1&&n[o+3][s]===1&&n[o+4][s]===1&&n[o+5][s]===0&&n[o+6][s]===1&&(r.isWhiteVertical(n,s,o-4,o)||r.isWhiteVertical(n,s,o+7,o+11))&&t++}return t*r.N3},r.isWhiteHorizontal=function(e,t,n){t=Math.max(t,0),n=Math.min(n,e.length);for(var a=t;a<n;a++)if(e[a]===1)return!1;return!0},r.isWhiteVertical=function(e,t,n,a){n=Math.max(n,0),a=Math.min(a,e.length);for(var i=n;i<a;i++)if(e[i][t]===1)return!1;return!0},r.applyMaskPenaltyRule4=function(e){for(var t=0,n=e.getArray(),a=e.getWidth(),i=e.getHeight(),o=0;o<i;o++)for(var s=n[o],l=0;l<a;l++)s[l]===1&&t++;var u=e.getHeight()*e.getWidth(),d=Math.floor(Math.abs(t*2-u)*10/u);return d*r.N4},r.getDataMaskBit=function(e,t,n){var a,i;switch(e){case 0:a=n+t&1;break;case 1:a=n&1;break;case 2:a=t%3;break;case 3:a=(n+t)%3;break;case 4:a=Math.floor(n/2)+Math.floor(t/3)&1;break;case 5:i=n*t,a=(i&1)+i%3;break;case 6:i=n*t,a=(i&1)+i%3&1;break;case 7:i=n*t,a=i%3+(n+t&1)&1;break;default:throw new st("Invalid mask pattern: "+e)}return a===0},r.applyMaskPenaltyRule1Internal=function(e,t){for(var n=0,a=t?e.getHeight():e.getWidth(),i=t?e.getWidth():e.getHeight(),o=e.getArray(),s=0;s<a;s++){for(var l=0,u=-1,d=0;d<i;d++){var f=t?o[s][d]:o[d][s];f===u?l++:(l>=5&&(n+=r.N1+(l-5)),l=1,u=f)}l>=5&&(n+=r.N1+(l-5))}return n},r.N1=3,r.N2=3,r.N3=40,r.N4=10,r}(),CU=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},NU=function(){function r(e,t){this.width=e,this.height=t;for(var n=new Array(t),a=0;a!==t;a++)n[a]=new Uint8Array(e);this.bytes=n}return r.prototype.getHeight=function(){return this.height},r.prototype.getWidth=function(){return this.width},r.prototype.get=function(e,t){return this.bytes[t][e]},r.prototype.getArray=function(){return this.bytes},r.prototype.setNumber=function(e,t,n){this.bytes[t][e]=n},r.prototype.setBoolean=function(e,t,n){this.bytes[t][e]=n?1:0},r.prototype.clear=function(e){var t,n;try{for(var a=CU(this.bytes),i=a.next();!i.done;i=a.next()){var o=i.value;on.fill(o,e)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}},r.prototype.equals=function(e){if(!(e instanceof r))return!1;var t=e;if(this.width!==t.width||this.height!==t.height)return!1;for(var n=0,a=this.height;n<a;++n)for(var i=this.bytes[n],o=t.bytes[n],s=0,l=this.width;s<l;++s)if(i[s]!==o[s])return!1;return!0},r.prototype.toString=function(){for(var e=new Pt,t=0,n=this.height;t<n;++t){for(var a=this.bytes[t],i=0,o=this.width;i<o;++i)switch(a[i]){case 0:e.append(" 0");break;case 1:e.append(" 1");break;default:e.append("  ");break}e.append(`
`)}return e.toString()},r}(),Mp=function(){function r(){this.maskPattern=-1}return r.prototype.getMode=function(){return this.mode},r.prototype.getECLevel=function(){return this.ecLevel},r.prototype.getVersion=function(){return this.version},r.prototype.getMaskPattern=function(){return this.maskPattern},r.prototype.getMatrix=function(){return this.matrix},r.prototype.toString=function(){var e=new Pt;return e.append(`<<
`),e.append(" mode: "),e.append(this.mode?this.mode.toString():"null"),e.append(`
 ecLevel: `),e.append(this.ecLevel?this.ecLevel.toString():"null"),e.append(`
 version: `),e.append(this.version?this.version.toString():"null"),e.append(`
 maskPattern: `),e.append(this.maskPattern.toString()),this.matrix?(e.append(`
 matrix:
`),e.append(this.matrix.toString())):e.append(`
 matrix: null
`),e.append(`>>
`),e.toString()},r.prototype.setMode=function(e){this.mode=e},r.prototype.setECLevel=function(e){this.ecLevel=e},r.prototype.setVersion=function(e){this.version=e},r.prototype.setMaskPattern=function(e){this.maskPattern=e},r.prototype.setMatrix=function(e){this.matrix=e},r.isValidMaskPattern=function(e){return e>=0&&e<r.NUM_MASK_PATTERNS},r.NUM_MASK_PATTERNS=8,r}(),SU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),vr=function(r){SU(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.kind="WriterException",e}(da),Dx=function(){function r(){}return r.clearMatrix=function(e){e.clear(255)},r.buildMatrix=function(e,t,n,a,i){r.clearMatrix(i),r.embedBasicPatterns(n,i),r.embedTypeInfo(t,a,i),r.maybeEmbedVersionInfo(n,i),r.embedDataBits(e,a,i)},r.embedBasicPatterns=function(e,t){r.embedPositionDetectionPatternsAndSeparators(t),r.embedDarkDotAtLeftBottomCorner(t),r.maybeEmbedPositionAdjustmentPatterns(e,t),r.embedTimingPatterns(t)},r.embedTypeInfo=function(e,t,n){var a=new vn;r.makeTypeInfoBits(e,t,a);for(var i=0,o=a.getSize();i<o;++i){var s=a.get(a.getSize()-1-i),l=r.TYPE_INFO_COORDINATES[i],u=l[0],d=l[1];if(n.setBoolean(u,d,s),i<8){var f=n.getWidth()-i-1,h=8;n.setBoolean(f,h,s)}else{var f=8,h=n.getHeight()-7+(i-8);n.setBoolean(f,h,s)}}},r.maybeEmbedVersionInfo=function(e,t){if(!(e.getVersionNumber()<7)){var n=new vn;r.makeVersionInfoBits(e,n);for(var a=6*3-1,i=0;i<6;++i)for(var o=0;o<3;++o){var s=n.get(a);a--,t.setBoolean(i,t.getHeight()-11+o,s),t.setBoolean(t.getHeight()-11+o,i,s)}}},r.embedDataBits=function(e,t,n){for(var a=0,i=-1,o=n.getWidth()-1,s=n.getHeight()-1;o>0;){for(o===6&&(o-=1);s>=0&&s<n.getHeight();){for(var l=0;l<2;++l){var u=o-l;if(r.isEmpty(n.get(u,s))){var d=void 0;a<e.getSize()?(d=e.get(a),++a):d=!1,t!==255&&du.getDataMaskBit(t,u,s)&&(d=!d),n.setBoolean(u,s,d)}}s+=i}i=-i,s+=i,o-=2}if(a!==e.getSize())throw new vr("Not all bits consumed: "+a+"/"+e.getSize())},r.findMSBSet=function(e){return 32-Tt.numberOfLeadingZeros(e)},r.calculateBCHCode=function(e,t){if(t===0)throw new st("0 polynomial");var n=r.findMSBSet(t);for(e<<=n-1;r.findMSBSet(e)>=n;)e^=t<<r.findMSBSet(e)-n;return e},r.makeTypeInfoBits=function(e,t,n){if(!Mp.isValidMaskPattern(t))throw new vr("Invalid mask pattern");var a=e.getBits()<<3|t;n.appendBits(a,5);var i=r.calculateBCHCode(a,r.TYPE_INFO_POLY);n.appendBits(i,10);var o=new vn;if(o.appendBits(r.TYPE_INFO_MASK_PATTERN,15),n.xor(o),n.getSize()!==15)throw new vr("should not happen but we got: "+n.getSize())},r.makeVersionInfoBits=function(e,t){t.appendBits(e.getVersionNumber(),6);var n=r.calculateBCHCode(e.getVersionNumber(),r.VERSION_INFO_POLY);if(t.appendBits(n,12),t.getSize()!==18)throw new vr("should not happen but we got: "+t.getSize())},r.isEmpty=function(e){return e===255},r.embedTimingPatterns=function(e){for(var t=8;t<e.getWidth()-8;++t){var n=(t+1)%2;r.isEmpty(e.get(t,6))&&e.setNumber(t,6,n),r.isEmpty(e.get(6,t))&&e.setNumber(6,t,n)}},r.embedDarkDotAtLeftBottomCorner=function(e){if(e.get(8,e.getHeight()-8)===0)throw new vr;e.setNumber(8,e.getHeight()-8,1)},r.embedHorizontalSeparationPattern=function(e,t,n){for(var a=0;a<8;++a){if(!r.isEmpty(n.get(e+a,t)))throw new vr;n.setNumber(e+a,t,0)}},r.embedVerticalSeparationPattern=function(e,t,n){for(var a=0;a<7;++a){if(!r.isEmpty(n.get(e,t+a)))throw new vr;n.setNumber(e,t+a,0)}},r.embedPositionAdjustmentPattern=function(e,t,n){for(var a=0;a<5;++a)for(var i=r.POSITION_ADJUSTMENT_PATTERN[a],o=0;o<5;++o)n.setNumber(e+o,t+a,i[o])},r.embedPositionDetectionPattern=function(e,t,n){for(var a=0;a<7;++a)for(var i=r.POSITION_DETECTION_PATTERN[a],o=0;o<7;++o)n.setNumber(e+o,t+a,i[o])},r.embedPositionDetectionPatternsAndSeparators=function(e){var t=r.POSITION_DETECTION_PATTERN[0].length;r.embedPositionDetectionPattern(0,0,e),r.embedPositionDetectionPattern(e.getWidth()-t,0,e),r.embedPositionDetectionPattern(0,e.getWidth()-t,e);var n=8;r.embedHorizontalSeparationPattern(0,n-1,e),r.embedHorizontalSeparationPattern(e.getWidth()-n,n-1,e),r.embedHorizontalSeparationPattern(0,e.getWidth()-n,e);var a=7;r.embedVerticalSeparationPattern(a,0,e),r.embedVerticalSeparationPattern(e.getHeight()-a-1,0,e),r.embedVerticalSeparationPattern(a,e.getHeight()-a,e)},r.maybeEmbedPositionAdjustmentPatterns=function(e,t){if(!(e.getVersionNumber()<2))for(var n=e.getVersionNumber()-1,a=r.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[n],i=0,o=a.length;i!==o;i++){var s=a[i];if(s>=0)for(var l=0;l!==o;l++){var u=a[l];u>=0&&r.isEmpty(t.get(u,s))&&r.embedPositionAdjustmentPattern(u-2,s-2,t)}}},r.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),r.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),r.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),r.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),r.VERSION_INFO_POLY=7973,r.TYPE_INFO_POLY=1335,r.TYPE_INFO_MASK_PATTERN=21522,r}(),EU=function(){function r(e,t){this.dataBytes=e,this.errorCorrectionBytes=t}return r.prototype.getDataBytes=function(){return this.dataBytes},r.prototype.getErrorCorrectionBytes=function(){return this.errorCorrectionBytes},r}(),Ix=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function r(){}return r.calculateMaskPenalty=function(e){return du.applyMaskPenaltyRule1(e)+du.applyMaskPenaltyRule2(e)+du.applyMaskPenaltyRule3(e)+du.applyMaskPenaltyRule4(e)},r.encode=function(e,t,n){n===void 0&&(n=null);var a=r.DEFAULT_BYTE_MODE_ENCODING,i=n!==null&&n.get(lf.CHARACTER_SET)!==void 0;i&&(a=n.get(lf.CHARACTER_SET).toString());var o=this.chooseMode(e,a),s=new vn;if(o===xr.BYTE&&(i||r.DEFAULT_BYTE_MODE_ENCODING!==a)){var l=an.getCharacterSetECIByName(a);l!==void 0&&this.appendECI(l,s)}this.appendModeInfo(o,s);var u=new vn;this.appendBytes(e,o,u,a);var d;if(n!==null&&n.get(lf.QR_VERSION)!==void 0){var f=Number.parseInt(n.get(lf.QR_VERSION).toString(),10);d=Is.getVersionForNumber(f);var h=this.calculateBitsNeeded(o,s,u,d);if(!this.willFit(h,d,t))throw new vr("Data too big for requested version")}else d=this.recommendVersion(t,o,s,u);var p=new vn;p.appendBitArray(s);var g=o===xr.BYTE?u.getSizeInBytes():e.length;this.appendLengthInfo(g,d,o,p),p.appendBitArray(u);var v=d.getECBlocksForLevel(t),b=d.getTotalCodewords()-v.getTotalECCodewords();this.terminateBits(b,p);var y=this.interleaveWithECBytes(p,d.getTotalCodewords(),b,v.getNumBlocks()),C=new Mp;C.setECLevel(t),C.setMode(o),C.setVersion(d);var S=d.getDimensionForVersion(),j=new NU(S,S),D=this.chooseMaskPattern(y,t,d,j);return C.setMaskPattern(D),Dx.buildMatrix(y,t,d,D,j),C.setMatrix(j),C},r.recommendVersion=function(e,t,n,a){var i=this.calculateBitsNeeded(t,n,a,Is.getVersionForNumber(1)),o=this.chooseVersion(i,e),s=this.calculateBitsNeeded(t,n,a,o);return this.chooseVersion(s,e)},r.calculateBitsNeeded=function(e,t,n,a){return t.getSize()+e.getCharacterCountBits(a)+n.getSize()},r.getAlphanumericCode=function(e){return e<r.ALPHANUMERIC_TABLE.length?r.ALPHANUMERIC_TABLE[e]:-1},r.chooseMode=function(e,t){if(t===void 0&&(t=null),an.SJIS.getName()===t&&this.isOnlyDoubleByteKanji(e))return xr.KANJI;for(var n=!1,a=!1,i=0,o=e.length;i<o;++i){var s=e.charAt(i);if(r.isDigit(s))n=!0;else if(this.getAlphanumericCode(s.charCodeAt(0))!==-1)a=!0;else return xr.BYTE}return a?xr.ALPHANUMERIC:n?xr.NUMERIC:xr.BYTE},r.isOnlyDoubleByteKanji=function(e){var t;try{t=Va.encode(e,an.SJIS)}catch{return!1}var n=t.length;if(n%2!==0)return!1;for(var a=0;a<n;a+=2){var i=t[a]&255;if((i<129||i>159)&&(i<224||i>235))return!1}return!0},r.chooseMaskPattern=function(e,t,n,a){for(var i=Number.MAX_SAFE_INTEGER,o=-1,s=0;s<Mp.NUM_MASK_PATTERNS;s++){Dx.buildMatrix(e,t,n,s,a);var l=this.calculateMaskPenalty(a);l<i&&(i=l,o=s)}return o},r.chooseVersion=function(e,t){for(var n=1;n<=40;n++){var a=Is.getVersionForNumber(n);if(r.willFit(e,a,t))return a}throw new vr("Data too big")},r.willFit=function(e,t,n){var a=t.getTotalCodewords(),i=t.getECBlocksForLevel(n),o=i.getTotalECCodewords(),s=a-o,l=(e+7)/8;return s>=l},r.terminateBits=function(e,t){var n=e*8;if(t.getSize()>n)throw new vr("data bits cannot fit in the QR Code"+t.getSize()+" > "+n);for(var a=0;a<4&&t.getSize()<n;++a)t.appendBit(!1);var i=t.getSize()&7;if(i>0)for(var a=i;a<8;a++)t.appendBit(!1);for(var o=e-t.getSizeInBytes(),a=0;a<o;++a)t.appendBits(a&1?17:236,8);if(t.getSize()!==n)throw new vr("Bits size does not equal capacity")},r.getNumDataBytesAndNumECBytesForBlockID=function(e,t,n,a,i,o){if(a>=n)throw new vr("Block ID too large");var s=e%n,l=n-s,u=Math.floor(e/n),d=u+1,f=Math.floor(t/n),h=f+1,p=u-f,g=d-h;if(p!==g)throw new vr("EC bytes mismatch");if(n!==l+s)throw new vr("RS blocks mismatch");if(e!==(f+p)*l+(h+g)*s)throw new vr("Total bytes mismatch");a<l?(i[0]=f,o[0]=p):(i[0]=h,o[0]=g)},r.interleaveWithECBytes=function(e,t,n,a){var i,o,s,l;if(e.getSizeInBytes()!==n)throw new vr("Number of bits and data bytes does not match");for(var u=0,d=0,f=0,h=new Array,p=0;p<a;++p){var g=new Int32Array(1),v=new Int32Array(1);r.getNumDataBytesAndNumECBytesForBlockID(t,n,a,p,g,v);var b=g[0],y=new Uint8Array(b);e.toBytes(8*u,y,0,b);var C=r.generateECBytes(y,v[0]);h.push(new EU(y,C)),d=Math.max(d,b),f=Math.max(f,C.length),u+=g[0]}if(n!==u)throw new vr("Data bytes does not match offset");for(var S=new vn,p=0;p<d;++p)try{for(var j=(i=void 0,Ix(h)),D=j.next();!D.done;D=j.next()){var F=D.value,y=F.getDataBytes();p<y.length&&S.appendBits(y[p],8)}}catch(J){i={error:J}}finally{try{D&&!D.done&&(o=j.return)&&o.call(j)}finally{if(i)throw i.error}}for(var p=0;p<f;++p)try{for(var M=(s=void 0,Ix(h)),T=M.next();!T.done;T=M.next()){var F=T.value,C=F.getErrorCorrectionBytes();p<C.length&&S.appendBits(C[p],8)}}catch(J){s={error:J}}finally{try{T&&!T.done&&(l=M.return)&&l.call(M)}finally{if(s)throw s.error}}if(t!==S.getSizeInBytes())throw new vr("Interleaving error: "+t+" and "+S.getSizeInBytes()+" differ.");return S},r.generateECBytes=function(e,t){for(var n=e.length,a=new Int32Array(n+t),i=0;i<n;i++)a[i]=e[i]&255;new R4(aa.QR_CODE_FIELD_256).encode(a,t);for(var o=new Uint8Array(t),i=0;i<t;i++)o[i]=a[n+i];return o},r.appendModeInfo=function(e,t){t.appendBits(e.getBits(),4)},r.appendLengthInfo=function(e,t,n,a){var i=n.getCharacterCountBits(t);if(e>=1<<i)throw new vr(e+" is bigger than "+((1<<i)-1));a.appendBits(e,i)},r.appendBytes=function(e,t,n,a){switch(t){case xr.NUMERIC:r.appendNumericBytes(e,n);break;case xr.ALPHANUMERIC:r.appendAlphanumericBytes(e,n);break;case xr.BYTE:r.append8BitBytes(e,n,a);break;case xr.KANJI:r.appendKanjiBytes(e,n);break;default:throw new vr("Invalid mode: "+t)}},r.getDigit=function(e){return e.charCodeAt(0)-48},r.isDigit=function(e){var t=r.getDigit(e);return t>=0&&t<=9},r.appendNumericBytes=function(e,t){for(var n=e.length,a=0;a<n;){var i=r.getDigit(e.charAt(a));if(a+2<n){var o=r.getDigit(e.charAt(a+1)),s=r.getDigit(e.charAt(a+2));t.appendBits(i*100+o*10+s,10),a+=3}else if(a+1<n){var o=r.getDigit(e.charAt(a+1));t.appendBits(i*10+o,7),a+=2}else t.appendBits(i,4),a++}},r.appendAlphanumericBytes=function(e,t){for(var n=e.length,a=0;a<n;){var i=r.getAlphanumericCode(e.charCodeAt(a));if(i===-1)throw new vr;if(a+1<n){var o=r.getAlphanumericCode(e.charCodeAt(a+1));if(o===-1)throw new vr;t.appendBits(i*45+o,11),a+=2}else t.appendBits(i,6),a++}},r.append8BitBytes=function(e,t,n){var a;try{a=Va.encode(e,n)}catch(l){throw new vr(l)}for(var i=0,o=a.length;i!==o;i++){var s=a[i];t.appendBits(s,8)}},r.appendKanjiBytes=function(e,t){var n;try{n=Va.encode(e,an.SJIS)}catch(f){throw new vr(f)}for(var a=n.length,i=0;i<a;i+=2){var o=n[i]&255,s=n[i+1]&255,l=o<<8&4294967295|s,u=-1;if(l>=33088&&l<=40956?u=l-33088:l>=57408&&l<=60351&&(u=l-49472),u===-1)throw new vr("Invalid byte sequence");var d=(u>>8)*192+(u&255);t.appendBits(d,13)}},r.appendECI=function(e,t){t.appendBits(xr.ECI.getBits(),4),t.appendBits(e.getValue(),8)},r.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),r.DEFAULT_BYTE_MODE_ENCODING=an.UTF8.getName(),r})();var AU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){AU(e,r);function e(t,n,a,i,o,s,l,u){var d=r.call(this,s,l)||this;if(d.yuvData=t,d.dataWidth=n,d.dataHeight=a,d.left=i,d.top=o,i+s>n||o+l>a)throw new st("Crop rectangle does not fit within image data.");return u&&d.reverseHorizontal(s,l),d}return e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new st("Requested row is outside the image: "+t);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var i=(t+this.top)*this.dataWidth+this.left;return mr.arraycopy(this.yuvData,i,n,0,a),n},e.prototype.getMatrix=function(){var t=this.getWidth(),n=this.getHeight();if(t===this.dataWidth&&n===this.dataHeight)return this.yuvData;var a=t*n,i=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return mr.arraycopy(this.yuvData,o,i,0,a),i;for(var s=0;s<n;s++){var l=s*t;mr.arraycopy(this.yuvData,o,i,l,t),o+=this.dataWidth}return i},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,a,i){return new e(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+n,a,i,!1)},e.prototype.renderThumbnail=function(){for(var t=this.getWidth()/e.THUMBNAIL_SCALE_FACTOR,n=this.getHeight()/e.THUMBNAIL_SCALE_FACTOR,a=new Int32Array(t*n),i=this.yuvData,o=this.top*this.dataWidth+this.left,s=0;s<n;s++){for(var l=s*t,u=0;u<t;u++){var d=i[o+u*e.THUMBNAIL_SCALE_FACTOR]&255;a[l+u]=4278190080|d*65793}o+=this.dataWidth*e.THUMBNAIL_SCALE_FACTOR}return a},e.prototype.getThumbnailWidth=function(){return this.getWidth()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.getThumbnailHeight=function(){return this.getHeight()/e.THUMBNAIL_SCALE_FACTOR},e.prototype.reverseHorizontal=function(t,n){for(var a=this.yuvData,i=0,o=this.top*this.dataWidth+this.left;i<n;i++,o+=this.dataWidth)for(var s=o+t/2,l=o,u=o+t-1;l<s;l++,u--){var d=a[l];a[l]=a[u],a[u]=d}},e.prototype.invert=function(){return new zh(this)},e.THUMBNAIL_SCALE_FACTOR=2,e})(Ku);var jU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){jU(e,r);function e(t,n,a,i,o,s,l){var u=r.call(this,n,a)||this;if(u.dataWidth=i,u.dataHeight=o,u.left=s,u.top=l,t.BYTES_PER_ELEMENT===4){for(var d=n*a,f=new Uint8ClampedArray(d),h=0;h<d;h++){var p=t[h],g=p>>16&255,v=p>>7&510,b=p&255;f[h]=(g+v+b)/4&255}u.luminances=f}else u.luminances=t;if(i===void 0&&(u.dataWidth=n),o===void 0&&(u.dataHeight=a),s===void 0&&(u.left=0),l===void 0&&(u.top=0),u.left+n>u.dataWidth||u.top+a>u.dataHeight)throw new st("Crop rectangle does not fit within image data.");return u}return e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new st("Requested row is outside the image: "+t);var a=this.getWidth();(n==null||n.length<a)&&(n=new Uint8ClampedArray(a));var i=(t+this.top)*this.dataWidth+this.left;return mr.arraycopy(this.luminances,i,n,0,a),n},e.prototype.getMatrix=function(){var t=this.getWidth(),n=this.getHeight();if(t===this.dataWidth&&n===this.dataHeight)return this.luminances;var a=t*n,i=new Uint8ClampedArray(a),o=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return mr.arraycopy(this.luminances,o,i,0,a),i;for(var s=0;s<n;s++){var l=s*t;mr.arraycopy(this.luminances,o,i,l,t),o+=this.dataWidth}return i},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,a,i){return new e(this.luminances,a,i,this.dataWidth,this.dataHeight,this.left+t,this.top+n)},e.prototype.invert=function(){return new zh(this)},e})(Ku);var PU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),DU=function(r){PU(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.forName=function(t){return this.getCharacterSetECIByName(t)},e}(an),IU=function(){function r(){}return r.ISO_8859_1=an.ISO8859_1,r}(),Rp,TU=301,OU=function(r,e){for(var t=1,n=0;n<255;n++)e[n]=t,r[t]=n,t*=2,t>=256&&(t^=TU);return{LOG:r,ALOG:e}};Rp=OU([],[]),Rp.LOG;Rp.ALOG;var Tx;(function(r){r[r.FORCE_NONE=0]="FORCE_NONE",r[r.FORCE_SQUARE=1]="FORCE_SQUARE",r[r.FORCE_RECTANGLE=2]="FORCE_RECTANGLE"})(Tx||(Tx={}));var Ox=129,L4=230,kU=231,MU=235,RU=236,LU=237,FU=238,BU=239,$U=240,E1=254,UU=254,kx="[)>05",Mx="[)>06",Rx="",ar=0,Sn=1,Wn=2,tn=3,mn=4,On=5,qU=function(){function r(){}return r.prototype.getEncodingMode=function(){return ar},r.prototype.encode=function(e){var t=pi.determineConsecutiveDigitCount(e.getMessage(),e.pos);if(t>=2)e.writeCodeword(this.encodeASCIIDigits(e.getMessage().charCodeAt(e.pos),e.getMessage().charCodeAt(e.pos+1))),e.pos+=2;else{var n=e.getCurrentChar(),a=pi.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode())switch(a){case On:e.writeCodeword(kU),e.signalEncoderChange(On);return;case Sn:e.writeCodeword(L4),e.signalEncoderChange(Sn);return;case tn:e.writeCodeword(FU),e.signalEncoderChange(tn);break;case Wn:e.writeCodeword(BU),e.signalEncoderChange(Wn);break;case mn:e.writeCodeword($U),e.signalEncoderChange(mn);break;default:throw new Error("Illegal mode: "+a)}else pi.isExtendedASCII(n)?(e.writeCodeword(MU),e.writeCodeword(n-128+1),e.pos++):(e.writeCodeword(n+1),e.pos++)}},r.prototype.encodeASCIIDigits=function(e,t){if(pi.isDigit(e)&&pi.isDigit(t)){var n=(e-48)*10+(t-48);return n+130}throw new Error("not digits: "+e+t)},r}(),VU=function(){function r(){}return r.prototype.getEncodingMode=function(){return On},r.prototype.encode=function(e){var t=new Pt;for(t.append(0);e.hasMoreCharacters();){var n=e.getCurrentChar();t.append(n),e.pos++;var a=pi.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(a!==this.getEncodingMode()){e.signalEncoderChange(ar);break}}var i=t.length()-1,o=1,s=e.getCodewordCount()+i+o;e.updateSymbolInfo(s);var l=e.getSymbolInfo().getDataCapacity()-s>0;if(e.hasMoreCharacters()||l)if(i<=249)t.setCharAt(0,Bt.getCharAt(i));else if(i<=1555)t.setCharAt(0,Bt.getCharAt(Math.floor(i/250)+249)),t.insert(1,Bt.getCharAt(i%250));else throw new Error("Message length not in valid ranges: "+i);for(var u=0,n=t.length();u<n;u++)e.writeCodeword(this.randomize255State(t.charAt(u).charCodeAt(0),e.getCodewordCount()+1))},r.prototype.randomize255State=function(e,t){var n=149*t%255+1,a=e+n;return a<=255?a:a-256},r}(),Yg=function(){function r(){}return r.prototype.getEncodingMode=function(){return Sn},r.prototype.encodeMaximal=function(e){for(var t=new Pt,n=0,a=e.pos,i=0;e.hasMoreCharacters();){var o=e.getCurrentChar();e.pos++,n=this.encodeChar(o,t),t.length()%3===0&&(a=e.pos,i=t.length())}if(i!==t.length()){var s=Math.floor(t.length()/3*2),l=Math.floor(e.getCodewordCount()+s+1);e.updateSymbolInfo(l);var u=e.getSymbolInfo().getDataCapacity()-l,d=Math.floor(t.length()%3);(d===2&&u!==2||d===1&&(n>3||u!==1))&&(e.pos=a)}t.length()>0&&e.writeCodeword(L4),this.handleEOD(e,t)},r.prototype.encode=function(e){for(var t=new Pt;e.hasMoreCharacters();){var n=e.getCurrentChar();e.pos++;var a=this.encodeChar(n,t),i=Math.floor(t.length()/3)*2,o=e.getCodewordCount()+i;e.updateSymbolInfo(o);var s=e.getSymbolInfo().getDataCapacity()-o;if(!e.hasMoreCharacters()){var l=new Pt;for(t.length()%3===2&&s!==2&&(a=this.backtrackOneCharacter(e,t,l,a));t.length()%3===1&&(a>3||s!==1);)a=this.backtrackOneCharacter(e,t,l,a);break}var u=t.length();if(u%3===0){var d=pi.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(d!==this.getEncodingMode()){e.signalEncoderChange(ar);break}}}this.handleEOD(e,t)},r.prototype.backtrackOneCharacter=function(e,t,n,a){var i=t.length(),o=t.toString().substring(0,i-a);t.setLengthToZero(),t.append(o),e.pos--;var s=e.getCurrentChar();return a=this.encodeChar(s,n),e.resetSymbolInfo(),a},r.prototype.writeNextTriplet=function(e,t){e.writeCodewords(this.encodeToCodewords(t.toString()));var n=t.toString().substring(3);t.setLengthToZero(),t.append(n)},r.prototype.handleEOD=function(e,t){var n=Math.floor(t.length()/3*2),a=t.length()%3,i=e.getCodewordCount()+n;e.updateSymbolInfo(i);var o=e.getSymbolInfo().getDataCapacity()-i;if(a===2){for(t.append("\0");t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(E1)}else if(o===1&&a===1){for(;t.length()>=3;)this.writeNextTriplet(e,t);e.hasMoreCharacters()&&e.writeCodeword(E1),e.pos--}else if(a===0){for(;t.length()>=3;)this.writeNextTriplet(e,t);(o>0||e.hasMoreCharacters())&&e.writeCodeword(E1)}else throw new Error("Unexpected case. Please report!");e.signalEncoderChange(ar)},r.prototype.encodeChar=function(e,t){if(e===32)return t.append(3),1;if(e>=48&&e<=57)return t.append(e-48+4),1;if(e>=65&&e<=90)return t.append(e-65+14),1;if(e<32)return t.append(0),t.append(e),2;if(e<=47)return t.append(1),t.append(e-33),2;if(e<=64)return t.append(1),t.append(e-58+15),2;if(e<=95)return t.append(1),t.append(e-91+22),2;if(e<=127)return t.append(2),t.append(e-96),2;t.append("1");var n=2;return n+=this.encodeChar(e-128,t),n},r.prototype.encodeToCodewords=function(e){var t=1600*e.charCodeAt(0)+40*e.charCodeAt(1)+e.charCodeAt(2)+1,n=t/256,a=t%256,i=new Pt;return i.append(n),i.append(a),i.toString()},r}(),zU=function(){function r(){}return r.prototype.getEncodingMode=function(){return mn},r.prototype.encode=function(e){for(var t=new Pt;e.hasMoreCharacters();){var n=e.getCurrentChar();this.encodeChar(n,t),e.pos++;var a=t.length();if(a>=4){e.writeCodewords(this.encodeToCodewords(t.toString()));var i=t.toString().substring(4);t.setLengthToZero(),t.append(i);var o=pi.lookAheadTest(e.getMessage(),e.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){e.signalEncoderChange(ar);break}}}t.append(Bt.getCharAt(31)),this.handleEOD(e,t)},r.prototype.handleEOD=function(e,t){try{var n=t.length();if(n===0)return;if(n===1){e.updateSymbolInfo();var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount(),i=e.getRemainingCharacters();if(i>a&&(e.updateSymbolInfo(e.getCodewordCount()+1),a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount()),i<=a&&a<=2)return}if(n>4)throw new Error("Count must not exceed 4");var o=n-1,s=this.encodeToCodewords(t.toString()),l=!e.hasMoreCharacters(),u=l&&o<=2;if(o<=2){e.updateSymbolInfo(e.getCodewordCount()+o);var a=e.getSymbolInfo().getDataCapacity()-e.getCodewordCount();a>=3&&(u=!1,e.updateSymbolInfo(e.getCodewordCount()+s.length))}u?(e.resetSymbolInfo(),e.pos-=o):e.writeCodewords(s)}finally{e.signalEncoderChange(ar)}},r.prototype.encodeChar=function(e,t){e>=32&&e<=63?t.append(e):e>=64&&e<=94?t.append(Bt.getCharAt(e-64)):pi.illegalCharacter(Bt.getCharAt(e))},r.prototype.encodeToCodewords=function(e){var t=e.length;if(t===0)throw new Error("StringBuilder must not be empty");var n=e.charAt(0).charCodeAt(0),a=t>=2?e.charAt(1).charCodeAt(0):0,i=t>=3?e.charAt(2).charCodeAt(0):0,o=t>=4?e.charAt(3).charCodeAt(0):0,s=(n<<18)+(a<<12)+(i<<6)+o,l=s>>16&255,u=s>>8&255,d=s&255,f=new Pt;return f.append(l),t>=2&&f.append(u),t>=3&&f.append(d),f.toString()},r}(),HU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),WU=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Qt=function(){function r(e,t,n,a,i,o,s,l){s===void 0&&(s=0),l===void 0&&(l=0),this.rectangular=e,this.dataCapacity=t,this.errorCodewords=n,this.matrixWidth=a,this.matrixHeight=i,this.dataRegions=o,this.rsBlockData=s,this.rsBlockError=l}return r.lookup=function(e,t,n,a,i){var o,s;t===void 0&&(t=0),n===void 0&&(n=null),a===void 0&&(a=null),i===void 0&&(i=!0);try{for(var l=WU(YU),u=l.next();!u.done;u=l.next()){var d=u.value;if(!(t===1&&d.rectangular)&&!(t===2&&!d.rectangular)&&!(n!=null&&(d.getSymbolWidth()<n.getWidth()||d.getSymbolHeight()<n.getHeight()))&&!(a!=null&&(d.getSymbolWidth()>a.getWidth()||d.getSymbolHeight()>a.getHeight()))&&e<=d.dataCapacity)return d}}catch(f){o={error:f}}finally{try{u&&!u.done&&(s=l.return)&&s.call(l)}finally{if(o)throw o.error}}if(i)throw new Error("Can't find a symbol arrangement that matches the message. Data codewords: "+e);return null},r.prototype.getHorizontalDataRegions=function(){switch(this.dataRegions){case 1:return 1;case 2:case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},r.prototype.getVerticalDataRegions=function(){switch(this.dataRegions){case 1:case 2:return 1;case 4:return 2;case 16:return 4;case 36:return 6;default:throw new Error("Cannot handle this number of data regions")}},r.prototype.getSymbolDataWidth=function(){return this.getHorizontalDataRegions()*this.matrixWidth},r.prototype.getSymbolDataHeight=function(){return this.getVerticalDataRegions()*this.matrixHeight},r.prototype.getSymbolWidth=function(){return this.getSymbolDataWidth()+this.getHorizontalDataRegions()*2},r.prototype.getSymbolHeight=function(){return this.getSymbolDataHeight()+this.getVerticalDataRegions()*2},r.prototype.getCodewordCount=function(){return this.dataCapacity+this.errorCodewords},r.prototype.getInterleavedBlockCount=function(){return this.rsBlockData?this.dataCapacity/this.rsBlockData:1},r.prototype.getDataCapacity=function(){return this.dataCapacity},r.prototype.getErrorCodewords=function(){return this.errorCodewords},r.prototype.getDataLengthForInterleavedBlock=function(e){return this.rsBlockData},r.prototype.getErrorLengthForInterleavedBlock=function(e){return this.rsBlockError},r}(),GU=function(r){HU(e,r);function e(){return r.call(this,!1,1558,620,22,22,36,-1,62)||this}return e.prototype.getInterleavedBlockCount=function(){return 10},e.prototype.getDataLengthForInterleavedBlock=function(t){return t<=8?156:155},e}(Qt),YU=[new Qt(!1,3,5,8,8,1),new Qt(!1,5,7,10,10,1),new Qt(!0,5,7,16,6,1),new Qt(!1,8,10,12,12,1),new Qt(!0,10,11,14,6,2),new Qt(!1,12,12,14,14,1),new Qt(!0,16,14,24,10,1),new Qt(!1,18,14,16,16,1),new Qt(!1,22,18,18,18,1),new Qt(!0,22,18,16,10,2),new Qt(!1,30,20,20,20,1),new Qt(!0,32,24,16,14,2),new Qt(!1,36,24,22,22,1),new Qt(!1,44,28,24,24,1),new Qt(!0,49,28,22,14,2),new Qt(!1,62,36,14,14,4),new Qt(!1,86,42,16,16,4),new Qt(!1,114,48,18,18,4),new Qt(!1,144,56,20,20,4),new Qt(!1,174,68,22,22,4),new Qt(!1,204,84,24,24,4,102,42),new Qt(!1,280,112,14,14,16,140,56),new Qt(!1,368,144,16,16,16,92,36),new Qt(!1,456,192,18,18,16,114,48),new Qt(!1,576,224,20,20,16,144,56),new Qt(!1,696,272,22,22,16,174,68),new Qt(!1,816,336,24,24,16,136,56),new Qt(!1,1050,408,18,18,36,175,68),new Qt(!1,1304,496,20,20,36,163,62),new GU],KU=function(){function r(e){this.msg=e,this.pos=0,this.skipAtEnd=0;for(var t=e.split("").map(function(s){return s.charCodeAt(0)}),n=new Pt,a=0,i=t.length;a<i;a++){var o=String.fromCharCode(t[a]&255);if(o==="?"&&e.charAt(a)!=="?")throw new Error("Message contains characters outside ISO-8859-1 encoding.");n.append(o)}this.msg=n.toString(),this.shape=0,this.codewords=new Pt,this.newEncoding=-1}return r.prototype.setSymbolShape=function(e){this.shape=e},r.prototype.setSizeConstraints=function(e,t){this.minSize=e,this.maxSize=t},r.prototype.getMessage=function(){return this.msg},r.prototype.setSkipAtEnd=function(e){this.skipAtEnd=e},r.prototype.getCurrentChar=function(){return this.msg.charCodeAt(this.pos)},r.prototype.getCurrent=function(){return this.msg.charCodeAt(this.pos)},r.prototype.getCodewords=function(){return this.codewords},r.prototype.writeCodewords=function(e){this.codewords.append(e)},r.prototype.writeCodeword=function(e){this.codewords.append(e)},r.prototype.getCodewordCount=function(){return this.codewords.length()},r.prototype.getNewEncoding=function(){return this.newEncoding},r.prototype.signalEncoderChange=function(e){this.newEncoding=e},r.prototype.resetEncoderSignal=function(){this.newEncoding=-1},r.prototype.hasMoreCharacters=function(){return this.pos<this.getTotalMessageCharCount()},r.prototype.getTotalMessageCharCount=function(){return this.msg.length-this.skipAtEnd},r.prototype.getRemainingCharacters=function(){return this.getTotalMessageCharCount()-this.pos},r.prototype.getSymbolInfo=function(){return this.symbolInfo},r.prototype.updateSymbolInfo=function(e){e===void 0&&(e=this.getCodewordCount()),(this.symbolInfo==null||e>this.symbolInfo.getDataCapacity())&&(this.symbolInfo=Qt.lookup(e,this.shape,this.minSize,this.maxSize,!0))},r.prototype.resetSymbolInfo=function(){this.symbolInfo=null},r}(),XU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),QU=function(r){XU(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return tn},e.prototype.encode=function(t){for(var n=new Pt;t.hasMoreCharacters();){var a=t.getCurrentChar();t.pos++,this.encodeChar(a,n);var i=n.length();if(i%3===0){this.writeNextTriplet(t,n);var o=pi.lookAheadTest(t.getMessage(),t.pos,this.getEncodingMode());if(o!==this.getEncodingMode()){t.signalEncoderChange(ar);break}}}this.handleEOD(t,n)},e.prototype.encodeChar=function(t,n){switch(t){case 13:n.append(0);break;case 42:n.append(1);break;case 62:n.append(2);break;case 32:n.append(3);break;default:t>=48&&t<=57?n.append(t-48+4):t>=65&&t<=90?n.append(t-65+14):pi.illegalCharacter(Bt.getCharAt(t));break}return 1},e.prototype.handleEOD=function(t,n){t.updateSymbolInfo();var a=t.getSymbolInfo().getDataCapacity()-t.getCodewordCount(),i=n.length();t.pos-=i,(t.getRemainingCharacters()>1||a>1||t.getRemainingCharacters()!==a)&&t.writeCodeword(UU),t.getNewEncoding()<0&&t.signalEncoderChange(ar)},e}(Yg),ZU=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),JU=function(r){ZU(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return e.prototype.getEncodingMode=function(){return Wn},e.prototype.encodeChar=function(t,n){if(t===32)return n.append(3),1;if(t>=48&&t<=57)return n.append(t-48+4),1;if(t>=97&&t<=122)return n.append(t-97+14),1;if(t<32)return n.append(0),n.append(t),2;if(t<=47)return n.append(1),n.append(t-33),2;if(t<=64)return n.append(1),n.append(t-58+15),2;if(t>=91&&t<=95)return n.append(1),n.append(t-91+22),2;if(t===96)return n.append(2),n.append(0),2;if(t<=90)return n.append(2),n.append(t-65+1),2;if(t<=127)return n.append(2),n.append(t-123+27),2;n.append("1");var a=2;return a+=this.encodeChar(t-128,n),a},e}(Yg),pi=function(){function r(){}return r.randomize253State=function(e){var t=149*e%253+1,n=Ox+t;return n<=254?n:n-254},r.encodeHighLevel=function(e,t,n,a,i){t===void 0&&(t=0),n===void 0&&(n=null),a===void 0&&(a=null),i===void 0&&(i=!1);var o=new Yg,s=[new qU,o,new JU,new QU,new zU,new VU],l=new KU(e);l.setSymbolShape(t),l.setSizeConstraints(n,a),e.startsWith(kx)&&e.endsWith(Rx)?(l.writeCodeword(RU),l.setSkipAtEnd(2),l.pos+=kx.length):e.startsWith(Mx)&&e.endsWith(Rx)&&(l.writeCodeword(LU),l.setSkipAtEnd(2),l.pos+=Mx.length);var u=ar;for(i&&(o.encodeMaximal(l),u=l.getNewEncoding(),l.resetEncoderSignal());l.hasMoreCharacters();)s[u].encode(l),l.getNewEncoding()>=0&&(u=l.getNewEncoding(),l.resetEncoderSignal());var d=l.getCodewordCount();l.updateSymbolInfo();var f=l.getSymbolInfo().getDataCapacity();d<f&&u!==ar&&u!==On&&u!==mn&&l.writeCodeword("þ");var h=l.getCodewords();for(h.length()<f&&h.append(Ox);h.length()<f;)h.append(this.randomize253State(h.length()+1));return l.getCodewords().toString()},r.lookAheadTest=function(e,t,n){var a=this.lookAheadTestIntern(e,t,n);if(n===tn&&a===tn){for(var i=Math.min(t+3,e.length),o=t;o<i;o++)if(!this.isNativeX12(e.charCodeAt(o)))return ar}else if(n===mn&&a===mn){for(var i=Math.min(t+4,e.length),o=t;o<i;o++)if(!this.isNativeEDIFACT(e.charCodeAt(o)))return ar}return a},r.lookAheadTestIntern=function(e,t,n){if(t>=e.length)return n;var a;n===ar?a=[0,1,1,1,1,1.25]:(a=[1,2,2,2,2,2.25],a[n]=0);for(var i=0,o=new Uint8Array(6),s=[];;){if(t+i===e.length){on.fill(o,0),on.fill(s,0);var l=this.findMinimums(a,s,Tt.MAX_VALUE,o),u=this.getMinimumCount(o);if(s[ar]===l)return ar;if(u===1){if(o[On]>0)return On;if(o[mn]>0)return mn;if(o[Wn]>0)return Wn;if(o[tn]>0)return tn}return Sn}var d=e.charCodeAt(t+i);if(i++,this.isDigit(d)?a[ar]+=.5:this.isExtendedASCII(d)?(a[ar]=Math.ceil(a[ar]),a[ar]+=2):(a[ar]=Math.ceil(a[ar]),a[ar]++),this.isNativeC40(d)?a[Sn]+=2/3:this.isExtendedASCII(d)?a[Sn]+=8/3:a[Sn]+=4/3,this.isNativeText(d)?a[Wn]+=2/3:this.isExtendedASCII(d)?a[Wn]+=8/3:a[Wn]+=4/3,this.isNativeX12(d)?a[tn]+=2/3:this.isExtendedASCII(d)?a[tn]+=13/3:a[tn]+=10/3,this.isNativeEDIFACT(d)?a[mn]+=3/4:this.isExtendedASCII(d)?a[mn]+=17/4:a[mn]+=13/4,this.isSpecialB256(d)?a[On]+=4:a[On]++,i>=4){if(on.fill(o,0),on.fill(s,0),this.findMinimums(a,s,Tt.MAX_VALUE,o),s[ar]<this.min(s[On],s[Sn],s[Wn],s[tn],s[mn]))return ar;if(s[On]<s[ar]||s[On]+1<this.min(s[Sn],s[Wn],s[tn],s[mn]))return On;if(s[mn]+1<this.min(s[On],s[Sn],s[Wn],s[tn],s[ar]))return mn;if(s[Wn]+1<this.min(s[On],s[Sn],s[mn],s[tn],s[ar]))return Wn;if(s[tn]+1<this.min(s[On],s[Sn],s[mn],s[Wn],s[ar]))return tn;if(s[Sn]+1<this.min(s[ar],s[On],s[mn],s[Wn])){if(s[Sn]<s[tn])return Sn;if(s[Sn]===s[tn]){for(var f=t+i+1;f<e.length;){var h=e.charCodeAt(f);if(this.isX12TermSep(h))return tn;if(!this.isNativeX12(h))break;f++}return Sn}}}}},r.min=function(e,t,n,a,i){var o=Math.min(e,Math.min(t,Math.min(n,a)));return i===void 0?o:Math.min(o,i)},r.findMinimums=function(e,t,n,a){for(var i=0;i<6;i++){var o=t[i]=Math.ceil(e[i]);n>o&&(n=o,on.fill(a,0)),n===o&&(a[i]=a[i]+1)}return n},r.getMinimumCount=function(e){for(var t=0,n=0;n<6;n++)t+=e[n];return t||0},r.isDigit=function(e){return e>=48&&e<=57},r.isExtendedASCII=function(e){return e>=128&&e<=255},r.isNativeC40=function(e){return e===32||e>=48&&e<=57||e>=65&&e<=90},r.isNativeText=function(e){return e===32||e>=48&&e<=57||e>=97&&e<=122},r.isNativeX12=function(e){return this.isX12TermSep(e)||e===32||e>=48&&e<=57||e>=65&&e<=90},r.isX12TermSep=function(e){return e===13||e===42||e===62},r.isNativeEDIFACT=function(e){return e>=32&&e<=94},r.isSpecialB256=function(e){return!1},r.determineConsecutiveDigitCount=function(e,t){t===void 0&&(t=0);for(var n=e.length,a=t;a<n&&this.isDigit(e.charCodeAt(a));)a++;return a-t},r.illegalCharacter=function(e){var t=Tt.toHexString(e.charCodeAt(0));throw t="0000".substring(0,4-t.length)+t,new Error("Illegal character: "+e+" (0x"+t+")")},r}(),A1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Lx=function(){function r(e){this.charset=e,this.name=e.name}return r.prototype.canEncode=function(e){try{return Va.encode(e,this.charset)!=null}catch{return!1}},r}(),eq=function(){function r(e,t,n){var a,i,o,s,l,u;this.ENCODERS=["IBM437","ISO-8859-2","ISO-8859-3","ISO-8859-4","ISO-8859-5","ISO-8859-6","ISO-8859-7","ISO-8859-8","ISO-8859-9","ISO-8859-10","ISO-8859-11","ISO-8859-13","ISO-8859-14","ISO-8859-15","ISO-8859-16","windows-1250","windows-1251","windows-1252","windows-1256","Shift_JIS"].map(function(q){return new Lx(DU.forName(q))}),this.encoders=[];var d=[];d.push(new Lx(IU.ISO_8859_1));for(var f=t!=null&&t.name.startsWith("UTF"),h=0;h<e.length;h++){var p=!1;try{for(var g=(a=void 0,A1(d)),v=g.next();!v.done;v=g.next()){var b=v.value,y=e.charAt(h),C=y.charCodeAt(0);if(C===n||b.canEncode(y)){p=!0;break}}}catch(q){a={error:q}}finally{try{v&&!v.done&&(i=g.return)&&i.call(g)}finally{if(a)throw a.error}}if(!p)try{for(var S=(o=void 0,A1(this.ENCODERS)),j=S.next();!j.done;j=S.next()){var b=j.value;if(b.canEncode(e.charAt(h))){d.push(b),p=!0;break}}}catch(q){o={error:q}}finally{try{j&&!j.done&&(s=S.return)&&s.call(S)}finally{if(o)throw o.error}}p||(f=!0)}if(d.length===1&&!f)this.encoders=[d[0]];else{this.encoders=[];var D=0;try{for(var F=A1(d),M=F.next();!M.done;M=F.next()){var b=M.value;this.encoders[D++]=b}}catch(q){l={error:q}}finally{try{M&&!M.done&&(u=F.return)&&u.call(F)}finally{if(l)throw l.error}}}var T=-1;if(t!=null){for(var h=0;h<this.encoders.length;h++)if(this.encoders[h]!=null&&t.name===this.encoders[h].name){T=h;break}}this.priorityEncoderIndex=T}return r.prototype.length=function(){return this.encoders.length},r.prototype.getCharsetName=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].name},r.prototype.getCharset=function(e){if(!(e<this.length()))throw new Error("index must be less than length");return this.encoders[e].charset},r.prototype.getECIValue=function(e){return this.encoders[e].charset.getValueIdentifier()},r.prototype.getPriorityEncoderIndex=function(){return this.priorityEncoderIndex},r.prototype.canEncode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return!0},r.prototype.encode=function(e,t){if(!(t<this.length()))throw new Error("index must be less than length");return Va.encode(Bt.getCharAt(e),this.encoders[t].name)},r}(),tq=3,rq=function(){function r(e,t,n){this.fnc1=n;var a=new eq(e,t,n);if(a.length()===1)for(var i=0;i<this.bytes.length;i++){var o=e.charAt(i).charCodeAt(0);this.bytes[i]=o===n?1e3:o}else this.bytes=this.encodeMinimally(e,a,n)}return r.prototype.getFNC1Character=function(){return this.fnc1},r.prototype.length=function(){return this.bytes.length},r.prototype.haveNCharacters=function(e,t){if(e+t-1>=this.bytes.length)return!1;for(var n=0;n<t;n++)if(this.isECI(e+n))return!1;return!0},r.prototype.charAt=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(this.isECI(e))throw new Error("value at "+e+" is not a character but an ECI");return this.isFNC1(e)?this.fnc1:this.bytes[e]},r.prototype.subSequence=function(e,t){if(e<0||e>t||t>this.length())throw new Error(""+e);for(var n=new Pt,a=e;a<t;a++){if(this.isECI(a))throw new Error("value at "+a+" is not a character but an ECI");n.append(this.charAt(a))}return n.toString()},r.prototype.isECI=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]>255&&this.bytes[e]<=999},r.prototype.isFNC1=function(e){if(e<0||e>=this.length())throw new Error(""+e);return this.bytes[e]===1e3},r.prototype.getECIValue=function(e){if(e<0||e>=this.length())throw new Error(""+e);if(!this.isECI(e))throw new Error("value at "+e+" is not an ECI but a character");return this.bytes[e]-256},r.prototype.addEdge=function(e,t,n){(e[t][n.encoderIndex]==null||e[t][n.encoderIndex].cachedTotalSize>n.cachedTotalSize)&&(e[t][n.encoderIndex]=n)},r.prototype.addEdges=function(e,t,n,a,i,o){var s=e.charAt(a).charCodeAt(0),l=0,u=t.length();t.getPriorityEncoderIndex()>=0&&(s===o||t.canEncode(s,t.getPriorityEncoderIndex()))&&(l=t.getPriorityEncoderIndex(),u=l+1);for(var d=l;d<u;d++)(s===o||t.canEncode(s,d))&&this.addEdge(n,a+1,new Fx(s,t,d,i,o))},r.prototype.encodeMinimally=function(e,t,n){var a=e.length,i=new Fx[a+1][t.length()];this.addEdges(e,t,i,0,null,n);for(var o=1;o<=a;o++){for(var s=0;s<t.length();s++)i[o][s]!=null&&o<a&&this.addEdges(e,t,i,o,i[o][s],n);for(var s=0;s<t.length();s++)i[o-1][s]=null}for(var l=-1,u=Tt.MAX_VALUE,s=0;s<t.length();s++)if(i[a][s]!=null){var d=i[a][s];d.cachedTotalSize<u&&(u=d.cachedTotalSize,l=s)}if(l<0)throw new Error('Failed to encode "'+e+'"');for(var f=[],h=i[a][l];h!=null;){if(h.isFNC1())f.unshift(1e3);else for(var p=t.encode(h.c,h.encoderIndex),o=p.length-1;o>=0;o--)f.unshift(p[o]&255);var g=h.previous===null?0:h.previous.encoderIndex;g!==h.encoderIndex&&f.unshift(256+t.getECIValue(h.encoderIndex)),h=h.previous}for(var v=[],o=0;o<v.length;o++)v[o]=f[o];return v},r}(),Fx=function(){function r(e,t,n,a,i){this.c=e,this.encoderSet=t,this.encoderIndex=n,this.previous=a,this.fnc1=i,this.c=e===i?1e3:e;var o=this.isFNC1()?1:t.encode(e,n).length,s=a===null?0:a.encoderIndex;s!==n&&(o+=tq),a!=null&&(o+=a.cachedTotalSize),this.cachedTotalSize=o}return r.prototype.isFNC1=function(){return this.c===1e3},r}(),nq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();var Bx;(function(r){r[r.ASCII=0]="ASCII",r[r.C40=1]="C40",r[r.TEXT=2]="TEXT",r[r.X12=3]="X12",r[r.EDF=4]="EDF",r[r.B256=5]="B256"})(Bx||(Bx={}));(function(r){nq(e,r);function e(t,n,a,i,o){var s=r.call(this,t,n,a)||this;return s.shape=i,s.macroId=o,s}return e.prototype.getMacroId=function(){return this.macroId},e.prototype.getShapeHint=function(){return this.shape},e})(rq);var aq=function(){function r(){}return r.prototype.isCompact=function(){return this.compact},r.prototype.setCompact=function(e){this.compact=e},r.prototype.getSize=function(){return this.size},r.prototype.setSize=function(e){this.size=e},r.prototype.getLayers=function(){return this.layers},r.prototype.setLayers=function(e){this.layers=e},r.prototype.getCodeWords=function(){return this.codeWords},r.prototype.setCodeWords=function(e){this.codeWords=e},r.prototype.getMatrix=function(){return this.matrix},r.prototype.setMatrix=function(e){this.matrix=e},r}(),$x=function(){function r(){}return r.singletonList=function(e){return[e]},r.min=function(e,t){return e.sort(t)[0]},r}(),iq=function(){function r(e){this.previous=e}return r.prototype.getPrevious=function(){return this.previous},r}(),oq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Kg=function(r){oq(e,r);function e(t,n,a){var i=r.call(this,t)||this;return i.value=n,i.bitCount=a,i}return e.prototype.appendTo=function(t,n){t.appendBits(this.value,this.bitCount)},e.prototype.add=function(t,n){return new e(this,t,n)},e.prototype.addBinaryShift=function(t,n){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new e(this,t,n)},e.prototype.toString=function(){var t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+Tt.toBinaryString(t|1<<this.bitCount).substring(1)+">"},e}(iq),sq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)a.hasOwnProperty(i)&&(n[i]=a[i])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),cq=function(r){sq(e,r);function e(t,n,a){var i=r.call(this,t,0,0)||this;return i.binaryShiftStart=n,i.binaryShiftByteCount=a,i}return e.prototype.appendTo=function(t,n){for(var a=0;a<this.binaryShiftByteCount;a++)(a===0||a===31&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):a===0?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(n[this.binaryShiftStart+a],8)},e.prototype.addBinaryShift=function(t,n){return new e(this,t,n)},e.prototype.toString=function(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"},e}(Kg);function lq(r,e,t){return new cq(r,e,t)}function iu(r,e,t){return new Kg(r,e,t)}var uq=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],zo=0,th=1,Ua=2,F4=3,Oi=4,dq=new Kg(null,0,0),j1=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])],fq=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function hq(r){var e,t;try{for(var n=fq(r),a=n.next();!a.done;a=n.next()){var i=a.value;on.fill(i,-1)}}catch(o){e={error:o}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r[zo][Oi]=0,r[th][Oi]=0,r[th][zo]=28,r[F4][Oi]=0,r[Ua][Oi]=0,r[Ua][zo]=15,r}var B4=hq(on.createInt32Array(6,6)),pq=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},mq=function(){function r(e,t,n,a){this.token=e,this.mode=t,this.binaryShiftByteCount=n,this.bitCount=a}return r.prototype.getMode=function(){return this.mode},r.prototype.getToken=function(){return this.token},r.prototype.getBinaryShiftByteCount=function(){return this.binaryShiftByteCount},r.prototype.getBitCount=function(){return this.bitCount},r.prototype.latchAndAppend=function(e,t){var n=this.bitCount,a=this.token;if(e!==this.mode){var i=j1[this.mode][e];a=iu(a,i&65535,i>>16),n+=i>>16}var o=e===Ua?4:5;return a=iu(a,t,o),new r(a,e,0,n+o)},r.prototype.shiftAndAppend=function(e,t){var n=this.token,a=this.mode===Ua?4:5;return n=iu(n,B4[this.mode][e],a),n=iu(n,t,5),new r(n,this.mode,0,this.bitCount+a+5)},r.prototype.addBinaryShiftChar=function(e){var t=this.token,n=this.mode,a=this.bitCount;if(this.mode===Oi||this.mode===Ua){var i=j1[n][zo];t=iu(t,i&65535,i>>16),a+=i>>16,n=zo}var o=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,s=new r(t,n,this.binaryShiftByteCount+1,a+o);return s.binaryShiftByteCount===2078&&(s=s.endBinaryShift(e+1)),s},r.prototype.endBinaryShift=function(e){if(this.binaryShiftByteCount===0)return this;var t=this.token;return t=lq(t,e-this.binaryShiftByteCount,this.binaryShiftByteCount),new r(t,this.mode,0,this.bitCount)},r.prototype.isBetterThanOrEqualTo=function(e){var t=this.bitCount+(j1[this.mode][e.mode]>>16);return this.binaryShiftByteCount<e.binaryShiftByteCount?t+=r.calculateBinaryShiftCost(e)-r.calculateBinaryShiftCost(this):this.binaryShiftByteCount>e.binaryShiftByteCount&&e.binaryShiftByteCount>0&&(t+=10),t<=e.bitCount},r.prototype.toBitArray=function(e){for(var t,n,a=[],i=this.endBinaryShift(e.length).token;i!==null;i=i.getPrevious())a.unshift(i);var o=new vn;try{for(var s=pq(a),l=s.next();!l.done;l=s.next()){var u=l.value;u.appendTo(o,e)}}catch(d){t={error:d}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o},r.prototype.toString=function(){return Bt.format("%s bits=%d bytes=%d",uq[this.mode],this.bitCount,this.binaryShiftByteCount)},r.calculateBinaryShiftCost=function(e){return e.binaryShiftByteCount>62?21:e.binaryShiftByteCount>31?20:e.binaryShiftByteCount>0?10:0},r.INITIAL_STATE=new r(dq,zo,0,0),r}();function gq(r){var e=Bt.getCharCode(" "),t=Bt.getCharCode("."),n=Bt.getCharCode(",");r[zo][e]=1;for(var a=Bt.getCharCode("Z"),i=Bt.getCharCode("A"),o=i;o<=a;o++)r[zo][o]=o-i+2;r[th][e]=1;for(var s=Bt.getCharCode("z"),l=Bt.getCharCode("a"),o=l;o<=s;o++)r[th][o]=o-l+2;r[Ua][e]=1;for(var u=Bt.getCharCode("9"),d=Bt.getCharCode("0"),o=d;o<=u;o++)r[Ua][o]=o-d+2;r[Ua][n]=12,r[Ua][t]=13;for(var f=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""],h=0;h<f.length;h++)r[F4][Bt.getCharCode(f[h])]=h;for(var p=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"],h=0;h<p.length;h++)Bt.getCharCode(p[h])>0&&(r[Oi][Bt.getCharCode(p[h])]=h);return r}var P1=gq(on.createInt32Array(5,256)),uf=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vq=function(){function r(e){this.text=e}return r.prototype.encode=function(){for(var e=Bt.getCharCode(" "),t=Bt.getCharCode(`
`),n=$x.singletonList(mq.INITIAL_STATE),a=0;a<this.text.length;a++){var i=void 0,o=a+1<this.text.length?this.text[a+1]:0;switch(this.text[a]){case Bt.getCharCode("\r"):i=o===t?2:0;break;case Bt.getCharCode("."):i=o===e?3:0;break;case Bt.getCharCode(","):i=o===e?4:0;break;case Bt.getCharCode(":"):i=o===e?5:0;break;default:i=0}i>0?(n=r.updateStateListForPair(n,a,i),a++):n=this.updateStateListForChar(n,a)}var s=$x.min(n,function(l,u){return l.getBitCount()-u.getBitCount()});return s.toBitArray(this.text)},r.prototype.updateStateListForChar=function(e,t){var n,a,i=[];try{for(var o=uf(e),s=o.next();!s.done;s=o.next()){var l=s.value;this.updateStateForChar(l,t,i)}}catch(u){n={error:u}}finally{try{s&&!s.done&&(a=o.return)&&a.call(o)}finally{if(n)throw n.error}}return r.simplifyStates(i)},r.prototype.updateStateForChar=function(e,t,n){for(var a=this.text[t]&255,i=P1[e.getMode()][a]>0,o=null,s=0;s<=Oi;s++){var l=P1[s][a];if(l>0){if(o==null&&(o=e.endBinaryShift(t)),!i||s===e.getMode()||s===Ua){var u=o.latchAndAppend(s,l);n.push(u)}if(!i&&B4[e.getMode()][s]>=0){var d=o.shiftAndAppend(s,l);n.push(d)}}}if(e.getBinaryShiftByteCount()>0||P1[e.getMode()][a]===0){var f=e.addBinaryShiftChar(t);n.push(f)}},r.updateStateListForPair=function(e,t,n){var a,i,o=[];try{for(var s=uf(e),l=s.next();!l.done;l=s.next()){var u=l.value;this.updateStateForPair(u,t,n,o)}}catch(d){a={error:d}}finally{try{l&&!l.done&&(i=s.return)&&i.call(s)}finally{if(a)throw a.error}}return this.simplifyStates(o)},r.updateStateForPair=function(e,t,n,a){var i=e.endBinaryShift(t);if(a.push(i.latchAndAppend(Oi,n)),e.getMode()!==Oi&&a.push(i.shiftAndAppend(Oi,n)),n===3||n===4){var o=i.latchAndAppend(Ua,16-n).latchAndAppend(Ua,1);a.push(o)}if(e.getBinaryShiftByteCount()>0){var s=e.addBinaryShiftChar(t).addBinaryShiftChar(t+1);a.push(s)}},r.simplifyStates=function(e){var t,n,a,i,o=[];try{for(var s=uf(e),l=s.next();!l.done;l=s.next()){var u=l.value,d=!0,f=function(b){if(b.isBetterThanOrEqualTo(u))return d=!1,"break";u.isBetterThanOrEqualTo(b)&&(o=o.filter(function(y){return y!==b}))};try{for(var h=(a=void 0,uf(o)),p=h.next();!p.done;p=h.next()){var g=p.value,v=f(g);if(v==="break")break}}catch(b){a={error:b}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}d&&o.push(u)}}catch(b){t={error:b}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return o},r}(),xq=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};(function(){function r(){}return r.encodeBytes=function(e){return r.encode(e,r.DEFAULT_EC_PERCENT,r.DEFAULT_AZTEC_LAYERS)},r.encode=function(e,t,n){var a=new vq(e).encode(),i=Tt.truncDivision(a.getSize()*t,100)+11,o=a.getSize()+i,s,l,u,d,f;if(n!==r.DEFAULT_AZTEC_LAYERS){if(s=n<0,l=Math.abs(n),l>(s?r.MAX_NB_BITS_COMPACT:r.MAX_NB_BITS))throw new st(Bt.format("Illegal value %s for layers",n));u=r.totalBitsInLayer(l,s),d=r.WORD_SIZE[l];var h=u-u%d;if(f=r.stuffBits(a,d),f.getSize()+i>h)throw new st("Data to large for user specified layer");if(s&&f.getSize()>d*64)throw new st("Data to large for user specified layer")}else{d=0,f=null;for(var p=0;;p++){if(p>r.MAX_NB_BITS)throw new st("Data too large for an Aztec code");if(s=p<=3,l=s?p+1:p,u=r.totalBitsInLayer(l,s),!(o>u)){(f==null||d!==r.WORD_SIZE[l])&&(d=r.WORD_SIZE[l],f=r.stuffBits(a,d));var h=u-u%d;if(!(s&&f.getSize()>d*64)&&f.getSize()+i<=h)break}}}var g=r.generateCheckWords(f,u,d),v=f.getSize()/d,b=r.generateModeMessage(s,l,v),y=(s?11:14)+l*4,C=new Int32Array(y),S;if(s){S=y;for(var p=0;p<C.length;p++)C[p]=p}else{S=y+1+2*Tt.truncDivision(Tt.truncDivision(y,2)-1,15);for(var j=Tt.truncDivision(y,2),D=Tt.truncDivision(S,2),p=0;p<j;p++){var F=p+Tt.truncDivision(p,15);C[j-p-1]=D-F-1,C[j+p]=D+F+1}}for(var M=new $i(S),p=0,T=0;p<l;p++){for(var q=(l-p)*4+(s?9:12),J=0;J<q;J++)for(var O=J*2,k=0;k<2;k++)g.get(T+O+k)&&M.set(C[p*2+k],C[p*2+J]),g.get(T+q*2+O+k)&&M.set(C[p*2+J],C[y-1-p*2-k]),g.get(T+q*4+O+k)&&M.set(C[y-1-p*2-k],C[y-1-p*2-J]),g.get(T+q*6+O+k)&&M.set(C[y-1-p*2-J],C[p*2+k]);T+=q*8}if(r.drawModeMessage(M,s,S,b),s)r.drawBullsEye(M,Tt.truncDivision(S,2),5);else{r.drawBullsEye(M,Tt.truncDivision(S,2),7);for(var p=0,J=0;p<Tt.truncDivision(y,2)-1;p+=15,J+=16)for(var k=Tt.truncDivision(S,2)&1;k<S;k+=2)M.set(Tt.truncDivision(S,2)-J,k),M.set(Tt.truncDivision(S,2)+J,k),M.set(k,Tt.truncDivision(S,2)-J),M.set(k,Tt.truncDivision(S,2)+J)}var H=new aq;return H.setCompact(s),H.setSize(S),H.setLayers(l),H.setCodeWords(v),H.setMatrix(M),H},r.drawBullsEye=function(e,t,n){for(var a=0;a<n;a+=2)for(var i=t-a;i<=t+a;i++)e.set(i,t-a),e.set(i,t+a),e.set(t-a,i),e.set(t+a,i);e.set(t-n,t-n),e.set(t-n+1,t-n),e.set(t-n,t-n+1),e.set(t+n,t-n),e.set(t+n,t-n+1),e.set(t+n,t+n-1)},r.generateModeMessage=function(e,t,n){var a=new vn;return e?(a.appendBits(t-1,2),a.appendBits(n-1,6),a=r.generateCheckWords(a,28,4)):(a.appendBits(t-1,5),a.appendBits(n-1,11),a=r.generateCheckWords(a,40,4)),a},r.drawModeMessage=function(e,t,n,a){var i=Tt.truncDivision(n,2);if(t)for(var o=0;o<7;o++){var s=i-3+o;a.get(o)&&e.set(s,i-5),a.get(o+7)&&e.set(i+5,s),a.get(20-o)&&e.set(s,i+5),a.get(27-o)&&e.set(i-5,s)}else for(var o=0;o<10;o++){var s=i-5+o+Tt.truncDivision(o,5);a.get(o)&&e.set(s,i-7),a.get(o+10)&&e.set(i+7,s),a.get(29-o)&&e.set(s,i+7),a.get(39-o)&&e.set(i-7,s)}},r.generateCheckWords=function(e,t,n){var a,i,o=e.getSize()/n,s=new R4(r.getGF(n)),l=Tt.truncDivision(t,n),u=r.bitsToWords(e,n,l);s.encode(u,l-o);var d=t%n,f=new vn;f.appendBits(0,d);try{for(var h=xq(Array.from(u)),p=h.next();!p.done;p=h.next()){var g=p.value;f.appendBits(g,n)}}catch(v){a={error:v}}finally{try{p&&!p.done&&(i=h.return)&&i.call(h)}finally{if(a)throw a.error}}return f},r.bitsToWords=function(e,t,n){var a=new Int32Array(n),i,o;for(i=0,o=e.getSize()/t;i<o;i++){for(var s=0,l=0;l<t;l++)s|=e.get(i*t+l)?1<<t-l-1:0;a[i]=s}return a},r.getGF=function(e){switch(e){case 4:return aa.AZTEC_PARAM;case 6:return aa.AZTEC_DATA_6;case 8:return aa.AZTEC_DATA_8;case 10:return aa.AZTEC_DATA_10;case 12:return aa.AZTEC_DATA_12;default:throw new st("Unsupported word size "+e)}},r.stuffBits=function(e,t){for(var n=new vn,a=e.getSize(),i=(1<<t)-2,o=0;o<a;o+=t){for(var s=0,l=0;l<t;l++)(o+l>=a||e.get(o+l))&&(s|=1<<t-1-l);(s&i)===i?(n.appendBits(s&i,t),o--):s&i?n.appendBits(s,t):(n.appendBits(s|1,t),o--)}return n},r.totalBitsInLayer=function(e,t){return((t?88:112)+16*e)*e},r.DEFAULT_EC_PERCENT=33,r.DEFAULT_AZTEC_LAYERS=0,r.MAX_NB_BITS=32,r.MAX_NB_BITS_COMPACT=4,r.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]),r})();var yq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),bq=function(r){yq(e,r);function e(t){var n=r.call(this,t.width,t.height)||this;return n.canvas=t,n.tempCanvasElement=null,n.buffer=e.makeBufferFromCanvasImageData(t),n}return e.makeBufferFromCanvasImageData=function(t){var n;try{n=t.getContext("2d",{willReadFrequently:!0})}catch{n=t.getContext("2d")}if(!n)throw new Error("Couldn't get canvas context.");var a=n.getImageData(0,0,t.width,t.height);return e.toGrayscaleBuffer(a.data,t.width,t.height)},e.toGrayscaleBuffer=function(t,n,a){for(var i=new Uint8ClampedArray(n*a),o=0,s=0,l=t.length;o<l;o+=4,s++){var u=void 0,d=t[o+3];if(d===0)u=255;else{var f=t[o],h=t[o+1],p=t[o+2];u=306*f+601*h+117*p+512>>10}i[s]=u}return i},e.prototype.getRow=function(t,n){if(t<0||t>=this.getHeight())throw new st("Requested row is outside the image: "+t);var a=this.getWidth(),i=t*a;return n===null?n=this.buffer.slice(i,i+a):(n.length<a&&(n=new Uint8ClampedArray(a)),n.set(this.buffer.slice(i,i+a))),n},e.prototype.getMatrix=function(){return this.buffer},e.prototype.isCropSupported=function(){return!0},e.prototype.crop=function(t,n,a,i){return r.prototype.crop.call(this,t,n,a,i),this},e.prototype.isRotateSupported=function(){return!0},e.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},e.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},e.prototype.invert=function(){return new zh(this)},e.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement},e.prototype.rotate=function(t){var n=this.getTempCanvasElement();if(!n)throw new Error("Could not create a Canvas element.");var a=t*e.DEGREE_TO_RADIANS,i=this.canvas.width,o=this.canvas.height,s=Math.ceil(Math.abs(Math.cos(a))*i+Math.abs(Math.sin(a))*o),l=Math.ceil(Math.abs(Math.sin(a))*i+Math.abs(Math.cos(a))*o);n.width=s,n.height=l;var u=n.getContext("2d");if(!u)throw new Error("Could not create a Canvas Context element.");return u.translate(s/2,l/2),u.rotate(a),u.drawImage(this.canvas,i/-2,o/-2),this.buffer=e.makeBufferFromCanvasImageData(n),this},e.DEGREE_TO_RADIANS=Math.PI/180,e}(Ku);function $4(){return typeof navigator<"u"}function wq(){return $4()&&!!navigator.mediaDevices}function _q(){return!!(wq()&&navigator.mediaDevices.enumerateDevices)}var Vc=function(){return Vc=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a])}return r},Vc.apply(this,arguments)},Cr=function(r,e,t,n){function a(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function s(d){try{u(n.next(d))}catch(f){o(f)}}function l(d){try{u(n.throw(d))}catch(f){o(f)}}function u(d){d.done?i(d.value):a(d.value).then(s,l)}u((n=n.apply(r,e||[])).next())})},Nr=function(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,a,i,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(d){return l([u,d])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,a&&(i=u[0]&2?a.return:u[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,u[1])).done)return i;switch(a=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,a=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){t.label=u[1];break}if(u[0]===6&&t.label<i[1]){t.label=i[1],i=u;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(u);break}i[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(r,t)}catch(d){u=[6,d],a=0}finally{n=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},D1=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Cq={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},xl=function(){function r(e,t,n){t===void 0&&(t=new Map),n===void 0&&(n={}),this.reader=e,this.hints=t,this.options=Vc(Vc({},Cq),n)}return Object.defineProperty(r.prototype,"possibleFormats",{set:function(e){this.hints.set(gr.POSSIBLE_FORMATS,e)},enumerable:!1,configurable:!0}),r.addVideoSource=function(e,t){try{e.srcObject=t}catch{console.error("got interrupted by new loading request")}},r.mediaStreamSetTorch=function(e,t){return Cr(this,void 0,void 0,function(){return Nr(this,function(n){switch(n.label){case 0:return[4,e.applyConstraints({advanced:[{fillLightMode:t?"flash":"off",torch:!!t}]})];case 1:return n.sent(),[2]}})})},r.mediaStreamIsTorchCompatible=function(e){var t,n,a=e.getVideoTracks();try{for(var i=D1(a),o=i.next();!o.done;o=i.next()){var s=o.value;if(r.mediaStreamIsTorchCompatibleTrack(s))return!0}}catch(l){t={error:l}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!1},r.mediaStreamIsTorchCompatibleTrack=function(e){try{var t=e.getCapabilities();return"torch"in t}catch(n){return console.error(n),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},r.isVideoPlaying=function(e){return e.currentTime>0&&!e.paused&&e.readyState>2},r.getMediaElement=function(e,t){var n=document.getElementById(e);if(!n)throw new kr("element with id '".concat(e,"' not found"));if(n.nodeName.toLowerCase()!==t.toLowerCase())throw new kr("element with id '".concat(e,"' must be an ").concat(t," element"));return n},r.createVideoElement=function(e){if(e instanceof HTMLVideoElement)return e;if(typeof e=="string")return r.getMediaElement(e,"video");if(!e&&typeof document<"u"){var t=document.createElement("video");return t.width=200,t.height=200,t}throw new Error("Couldn't get videoElement from videoSource!")},r.prepareImageElement=function(e){if(e instanceof HTMLImageElement)return e;if(typeof e=="string")return r.getMediaElement(e,"img");if(typeof e>"u"){var t=document.createElement("img");return t.width=200,t.height=200,t}throw new Error("Couldn't get imageElement from imageSource!")},r.prepareVideoElement=function(e){var t=r.createVideoElement(e);return t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t},r.isImageLoaded=function(e){return!(!e.complete||e.naturalWidth===0)},r.createBinaryBitmapFromCanvas=function(e){var t=new bq(e),n=new N4(t);return new C4(n)},r.drawImageOnCanvas=function(e,t){e.drawImage(t,0,0)},r.getMediaElementDimensions=function(e){if(e instanceof HTMLVideoElement)return{height:e.videoHeight,width:e.videoWidth};if(e instanceof HTMLImageElement)return{height:e.naturalHeight||e.height,width:e.naturalWidth||e.width};throw new Error("Couldn't find the Source's dimensions!")},r.createCaptureCanvas=function(e){if(!e)throw new kr("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var t=document.createElement("canvas"),n=r.getMediaElementDimensions(e),a=n.width,i=n.height;return t.style.width=a+"px",t.style.height=i+"px",t.width=a,t.height=i,t},r.tryPlayVideo=function(e){return Cr(this,void 0,void 0,function(){var t;return Nr(this,function(n){switch(n.label){case 0:if(e?.ended)return console.error("Trying to play video that has ended."),[2,!1];if(r.isVideoPlaying(e))return console.warn("Trying to play video that is already playing."),[2,!0];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,e.play()];case 2:return n.sent(),[2,!0];case 3:return t=n.sent(),console.warn("It was not possible to play the video.",t),[2,!1];case 4:return[2]}})})},r.createCanvasFromMediaElement=function(e){var t=r.createCaptureCanvas(e),n=t.getContext("2d");if(!n)throw new Error("Couldn't find Canvas 2D Context.");return r.drawImageOnCanvas(n,e),t},r.createBinaryBitmapFromMediaElem=function(e){var t=r.createCanvasFromMediaElement(e);return r.createBinaryBitmapFromCanvas(t)},r.destroyImageElement=function(e){e.src="",e.removeAttribute("src"),e=void 0},r.listVideoInputDevices=function(){return Cr(this,void 0,void 0,function(){var e,t,n,a,i,o,s,l,u,d,f,h;return Nr(this,function(p){switch(p.label){case 0:if(!$4())throw new Error("Can't enumerate devices, navigator is not present.");if(!_q())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:e=p.sent(),t=[];try{for(n=D1(e),a=n.next();!a.done;a=n.next())i=a.value,o=i.kind==="video"?"videoinput":i.kind,o==="videoinput"&&(s=i.deviceId||i.id,l=i.label||"Video device ".concat(t.length+1),u=i.groupId,d={deviceId:s,label:l,kind:o,groupId:u},t.push(d))}catch(g){f={error:g}}finally{try{a&&!a.done&&(h=n.return)&&h.call(n)}finally{if(f)throw f.error}}return[2,t]}})})},r.findDeviceById=function(e){return Cr(this,void 0,void 0,function(){var t;return Nr(this,function(n){switch(n.label){case 0:return[4,r.listVideoInputDevices()];case 1:return t=n.sent(),t?[2,t.find(function(a){return a.deviceId===e})]:[2]}})})},r.cleanVideoSource=function(e){if(e){try{e.srcObject=null}catch{e.src=""}e&&e.removeAttribute("src")}},r.releaseAllStreams=function(){r.streamTracker.length!==0&&r.streamTracker.forEach(function(e){e.getTracks().forEach(function(t){return t.stop()})}),r.streamTracker=[]},r.playVideoOnLoadAsync=function(e,t){return Cr(this,void 0,void 0,function(){var n;return Nr(this,function(a){switch(a.label){case 0:return[4,r.tryPlayVideo(e)];case 1:return n=a.sent(),n?[2,!0]:[2,new Promise(function(i,o){var s=setTimeout(function(){r.isVideoPlaying(e)||(o(!1),e.removeEventListener("canplay",l))},t),l=function(){r.tryPlayVideo(e).then(function(u){clearTimeout(s),e.removeEventListener("canplay",l),i(u)})};e.addEventListener("canplay",l)})]}})})},r.attachStreamToVideo=function(e,t,n){return n===void 0&&(n=5e3),Cr(this,void 0,void 0,function(){var a;return Nr(this,function(i){switch(i.label){case 0:return a=r.prepareVideoElement(t),r.addVideoSource(a,e),[4,r.playVideoOnLoadAsync(a,n)];case 1:return i.sent(),[2,a]}})})},r._waitImageLoad=function(e){return new Promise(function(t,n){var a=1e4,i=setTimeout(function(){r.isImageLoaded(e)||(e.removeEventListener("load",o),n())},a),o=function(){clearTimeout(i),e.removeEventListener("load",o),t()};e.addEventListener("load",o)})},r.checkCallbackFnOrThrow=function(e){if(!e)throw new kr("`callbackFn` is a required parameter, you cannot capture results without it.")},r.disposeMediaStream=function(e){e.getVideoTracks().forEach(function(t){return t.stop()}),e=void 0},r.prototype.decode=function(e){var t=r.createCanvasFromMediaElement(e);return this.decodeFromCanvas(t)},r.prototype.decodeBitmap=function(e){return this.reader.decode(e,this.hints)},r.prototype.decodeFromCanvas=function(e){var t=r.createBinaryBitmapFromCanvas(e);return this.decodeBitmap(t)},r.prototype.decodeFromImageElement=function(e){return Cr(this,void 0,void 0,function(){var t;return Nr(this,function(n){switch(n.label){case 0:if(!e)throw new kr("An image element must be provided.");return t=r.prepareImageElement(e),[4,this._decodeOnLoadImage(t)];case 1:return[2,n.sent()]}})})},r.prototype.decodeFromImageUrl=function(e){return Cr(this,void 0,void 0,function(){var t;return Nr(this,function(n){switch(n.label){case 0:if(!e)throw new kr("An URL must be provided.");t=r.prepareImageElement(),t.src=e,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.decodeFromImageElement(t)];case 2:return[2,n.sent()];case 3:return r.destroyImageElement(t),[7];case 4:return[2]}})})},r.prototype.decodeFromConstraints=function(e,t,n){return Cr(this,void 0,void 0,function(){var a,i;return Nr(this,function(o){switch(o.label){case 0:return r.checkCallbackFnOrThrow(n),[4,this.getUserMedia(e)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,4,,5]),[4,this.decodeFromStream(a,t,n)];case 3:return[2,o.sent()];case 4:throw i=o.sent(),r.disposeMediaStream(a),i;case 5:return[2]}})})},r.prototype.decodeFromStream=function(e,t,n){return Cr(this,void 0,void 0,function(){var a,i,o,s,l,u,d,f,h,p=this;return Nr(this,function(g){switch(g.label){case 0:return r.checkCallbackFnOrThrow(n),a=this.options.tryPlayVideoTimeout,[4,r.attachStreamToVideo(e,t,a)];case 1:return i=g.sent(),o=function(){r.disposeMediaStream(e),r.cleanVideoSource(i)},s=this.scan(i,n,o),l=e.getVideoTracks(),u=Vc(Vc({},s),{stop:function(){s.stop()},streamVideoConstraintsApply:function(v,b){return Cr(this,void 0,void 0,function(){var y,C,S,j,D,F,M;return Nr(this,function(T){switch(T.label){case 0:y=b?l.filter(b):l,T.label=1;case 1:T.trys.push([1,6,7,8]),C=D1(y),S=C.next(),T.label=2;case 2:return S.done?[3,5]:(j=S.value,[4,j.applyConstraints(v)]);case 3:T.sent(),T.label=4;case 4:return S=C.next(),[3,2];case 5:return[3,8];case 6:return D=T.sent(),F={error:D},[3,8];case 7:try{S&&!S.done&&(M=C.return)&&M.call(C)}finally{if(F)throw F.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(v){return l.find(v).getConstraints()},streamVideoSettingsGet:function(v){return l.find(v).getSettings()},streamVideoCapabilitiesGet:function(v){return l.find(v).getCapabilities()}}),d=r.mediaStreamIsTorchCompatible(e),d&&(f=l?.find(function(v){return r.mediaStreamIsTorchCompatibleTrack(v)}),h=function(v){return Cr(p,void 0,void 0,function(){return Nr(this,function(b){switch(b.label){case 0:return[4,r.mediaStreamSetTorch(f,v)];case 1:return b.sent(),[2]}})})},u.switchTorch=h,u.stop=function(){return Cr(p,void 0,void 0,function(){return Nr(this,function(v){switch(v.label){case 0:return s.stop(),[4,h(!1)];case 1:return v.sent(),[2]}})})}),[2,u]}})})},r.prototype.decodeFromVideoDevice=function(e,t,n){return Cr(this,void 0,void 0,function(){var a,i;return Nr(this,function(o){switch(o.label){case 0:return r.checkCallbackFnOrThrow(n),e?a={deviceId:{exact:e}}:a={facingMode:"environment"},i={video:a},[4,this.decodeFromConstraints(i,t,n)];case 1:return[2,o.sent()]}})})},r.prototype.decodeFromVideoElement=function(e,t){return Cr(this,void 0,void 0,function(){var n,a;return Nr(this,function(i){switch(i.label){case 0:if(r.checkCallbackFnOrThrow(t),!e)throw new kr("A video element must be provided.");return n=r.prepareVideoElement(e),a=this.options.tryPlayVideoTimeout,[4,r.playVideoOnLoadAsync(n,a)];case 1:return i.sent(),[2,this.scan(n,t)]}})})},r.prototype.decodeFromVideoUrl=function(e,t){return Cr(this,void 0,void 0,function(){var n,a,i,o;return Nr(this,function(s){switch(s.label){case 0:if(r.checkCallbackFnOrThrow(t),!e)throw new kr("An URL must be provided.");return n=r.prepareVideoElement(),n.src=e,a=function(){r.cleanVideoSource(n)},i=this.options.tryPlayVideoTimeout,[4,r.playVideoOnLoadAsync(n,i)];case 1:return s.sent(),o=this.scan(n,t,a),[2,o]}})})},r.prototype.decodeOnceFromConstraints=function(e,t){return Cr(this,void 0,void 0,function(){var n;return Nr(this,function(a){switch(a.label){case 0:return[4,this.getUserMedia(e)];case 1:return n=a.sent(),[4,this.decodeOnceFromStream(n,t)];case 2:return[2,a.sent()]}})})},r.prototype.decodeOnceFromStream=function(e,t){return Cr(this,void 0,void 0,function(){var n,a,i;return Nr(this,function(o){switch(o.label){case 0:return n=!!t,[4,r.attachStreamToVideo(e,t)];case 1:a=o.sent(),o.label=2;case 2:return o.trys.push([2,,4,5]),[4,this.scanOneResult(a)];case 3:return i=o.sent(),[2,i];case 4:return n||r.cleanVideoSource(a),[7];case 5:return[2]}})})},r.prototype.decodeOnceFromVideoDevice=function(e,t){return Cr(this,void 0,void 0,function(){var n,a;return Nr(this,function(i){switch(i.label){case 0:return e?n={deviceId:{exact:e}}:n={facingMode:"environment"},a={video:n},[4,this.decodeOnceFromConstraints(a,t)];case 1:return[2,i.sent()]}})})},r.prototype.decodeOnceFromVideoElement=function(e){return Cr(this,void 0,void 0,function(){var t,n;return Nr(this,function(a){switch(a.label){case 0:if(!e)throw new kr("A video element must be provided.");return t=r.prepareVideoElement(e),n=this.options.tryPlayVideoTimeout,[4,r.playVideoOnLoadAsync(t,n)];case 1:return a.sent(),[4,this.scanOneResult(t)];case 2:return[2,a.sent()]}})})},r.prototype.decodeOnceFromVideoUrl=function(e){return Cr(this,void 0,void 0,function(){var t,n;return Nr(this,function(a){switch(a.label){case 0:if(!e)throw new kr("An URL must be provided.");t=r.prepareVideoElement(),t.src=e,n=this.decodeOnceFromVideoElement(t),a.label=1;case 1:return a.trys.push([1,,3,4]),[4,n];case 2:return[2,a.sent()];case 3:return r.cleanVideoSource(t),[7];case 4:return[2]}})})},r.prototype.scanOneResult=function(e,t,n,a){var i=this;return t===void 0&&(t=!0),n===void 0&&(n=!0),a===void 0&&(a=!0),new Promise(function(o,s){i.scan(e,function(l,u,d){if(l){o(l),d.stop();return}if(u){if(u instanceof Ce&&t||u instanceof Vr&&n||u instanceof ke&&a)return;d.stop(),s(u)}})})},r.prototype.scan=function(e,t,n){var a=this;r.checkCallbackFnOrThrow(t);var i=r.createCaptureCanvas(e),o;try{o=i.getContext("2d",{willReadFrequently:!0})}catch{o=i.getContext("2d")}if(!o)throw new Error("Couldn't create canvas for visual element scan.");var s=function(){o=void 0,i=void 0},l=!1,u,d=function(){l=!0,clearTimeout(u),s(),n&&n()},f={stop:d},h=function(){if(!l)try{r.drawImageOnCanvas(o,e);var p=a.decodeFromCanvas(i);t(p,void 0,f),u=setTimeout(h,a.options.delayBetweenScanSuccess)}catch(y){t(void 0,y,f);var g=y instanceof Vr,v=y instanceof ke,b=y instanceof Ce;if(g||v||b){u=setTimeout(h,a.options.delayBetweenScanAttempts);return}s(),n&&n(y)}};return h(),f},r.prototype._decodeOnLoadImage=function(e){return Cr(this,void 0,void 0,function(){var t;return Nr(this,function(n){switch(n.label){case 0:return t=r.isImageLoaded(e),t?[3,2]:[4,r._waitImageLoad(e)];case 1:n.sent(),n.label=2;case 2:return[2,this.decode(e)]}})})},r.prototype.getUserMedia=function(e){return Cr(this,void 0,void 0,function(){var t;return Nr(this,function(n){switch(n.label){case 0:return[4,navigator.mediaDevices.getUserMedia(e)];case 1:return t=n.sent(),r.streamTracker.push(t),[2,t]}})})},r.streamTracker=[],r}(),Nq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){Nq(e,r);function e(t,n){return r.call(this,new Xf,t,n)||this}return e})(xl);var Sq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){Sq(e,r);function e(t,n){return r.call(this,new Uc(t),t,n)||this}return e})(xl);var Eq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){Eq(e,r);function e(t,n){return r.call(this,new Zf,t,n)||this}return e})(xl);var Aq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),jq=function(r){Aq(e,r);function e(t,n){var a=this,i=new M4;return i.setHints(t),a=r.call(this,i,t,n)||this,a.reader=i,a}return Object.defineProperty(e.prototype,"possibleFormats",{set:function(t){this.hints.set(gr.POSSIBLE_FORMATS,t),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),e.prototype.decodeBitmap=function(t){return this.reader.decodeWithState(t)},e.prototype.setHints=function(t){this.hints=t,this.reader.setHints(this.hints)},e}(xl),Pq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}();(function(r){Pq(e,r);function e(t,n){return r.call(this,new eh,t,n)||this}return e})(xl);var Dq=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},r(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),Iq=function(r){Dq(e,r);function e(t,n){return r.call(this,new Jf,t,n)||this}return e}(xl);function U4(){const r=w.useRef(null),e=w.useCallback(()=>(r.current||(r.current=new(window.AudioContext||window.webkitAudioContext),console.log("🎵 AudioContext creado:",r.current.state)),r.current),[]),t=w.useCallback(async()=>{try{console.log("🔊 Iniciando reproducción de sonido de escáner...");const i=e();i.state==="suspended"&&(console.log("🎵 Reactivando AudioContext suspendido..."),await i.resume()),console.log("🎵 AudioContext state:",i.state);const o=i.createOscillator(),s=i.createGain();o.connect(s),s.connect(i.destination),o.frequency.setValueAtTime(2e3,i.currentTime),o.type="square",s.gain.setValueAtTime(0,i.currentTime),s.gain.linearRampToValueAtTime(.5,i.currentTime+.01),s.gain.linearRampToValueAtTime(0,i.currentTime+.2);const l=i.currentTime,u=.2;return o.start(l),o.stop(l+u),console.log("🔊 Sonido de escáner programado - inicio:",l,"duración:",u),new Promise(d=>{setTimeout(()=>{console.log("🔊 Sonido de escáner completado"),d()},u*1e3+50)})}catch(i){console.error("❌ Error al reproducir sonido de escáner:",i)}},[e]),n=w.useCallback(async()=>{try{console.log("🔊 Iniciando reproducción de sonido de error...");const i=e();i.state==="suspended"&&await i.resume();const o=i.createOscillator(),s=i.createGain();o.connect(s),s.connect(i.destination),o.frequency.setValueAtTime(400,i.currentTime),o.type="sawtooth",s.gain.setValueAtTime(0,i.currentTime),s.gain.linearRampToValueAtTime(.3,i.currentTime+.01),s.gain.linearRampToValueAtTime(0,i.currentTime+.4);const l=i.currentTime,u=.4;return o.start(l),o.stop(l+u),console.log("🔊 Sonido de error programado"),new Promise(d=>{setTimeout(()=>{console.log("🔊 Sonido de error completado"),d()},u*1e3+50)})}catch(i){console.error("❌ Error al reproducir sonido de error:",i)}},[e]),a=w.useCallback(()=>{console.log("🎵 Limpiando recursos de audio..."),r.current&&r.current.state!=="closed"&&(r.current.close(),r.current=null,console.log("🎵 AudioContext cerrado"))},[]);return{playSuccessBeep:t,playErrorBeep:n,cleanup:a}}function Tq(){const[r,e]=w.useState(!1),t=w.useRef(null),n=w.useRef(null),a=w.useRef(null),i=w.useRef(!1),{playSuccessBeep:o,playErrorBeep:s,cleanup:l}=U4(),u=async(p,g,v,b,y)=>{if(!(!y||!i.current))try{console.log("Attempting thermal printer Barcode scan (PRIORITY)...");const C=await g.decodeOnceFromVideoDevice(b,y);if(C&&i.current){console.log("🔊 Thermal printer Barcode successfully detected:",C.getText()),f(),console.log("🔊 Playing success sound..."),await o(),p(C.getText());return}}catch{try{console.log("Barcode failed, attempting thermal printer QR scan as fallback...");const S=await v.decodeOnceFromVideoDevice(b,y);if(S&&i.current){console.log("🔊 Thermal printer QR Code successfully detected as fallback:",S.getText()),f(),console.log("🔊 Playing success sound for QR..."),await o(),p(S.getText());return}}catch{i.current&&setTimeout(()=>{u(p,g,v,b,y)},25)}}},d=async(p,g,v)=>{if(!v){console.error("Video element not available");return}try{e(!0),i.current=!0,console.log("Starting thermal printer Barcode scan (PRIORITY) with device:",g);const b=new AbortController;a.current=b;const y=new jq(void 0,{delayBetweenScanAttempts:25,delayBetweenScanSuccess:300});n.current=y;const C=new Iq(void 0,{delayBetweenScanAttempts:50,delayBetweenScanSuccess:300});t.current=C,console.log("Starting continuous thermal printer Barcode decode (priority over QR)..."),u(p,y,C,g,v)}catch(b){throw console.error("Error starting thermal printer Barcode scan:",b),await s(),e(!1),i.current=!1,b}},f=()=>{console.log("Stopping thermal printer Barcode scanning..."),i.current=!1,a.current&&(a.current.abort(),a.current=null),t.current=null,n.current=null,e(!1)};return{isScanning:r,startScanning:d,stopScanning:f,cleanup:()=>{f(),setTimeout(()=>{l()},500)}}}function Oq(){const{hasPermission:r,error:e,setError:t,availableCameras:n,currentCameraIndex:a,switchCamera:i}=OF(),{videoRef:o,streamRef:s,startVideoStream:l,cleanup:u}=LF(),{isScanning:d,startScanning:f,stopScanning:h,cleanup:p}=Tq(),g=async()=>{n.length>1&&(h(),i())},v=async y=>{if(!o.current||n.length===0){console.error("Video element or cameras not available");return}try{t(null);const C=n[a];console.log("Starting scan with camera:",C.label||`Camera ${a+1}`),s.current||await l(C.deviceId),await f(y,C.deviceId,o.current)}catch(C){console.error("Error starting scan:",C),t("Error al inicializar el escáner para códigos de barras de impresora térmica")}},b=()=>{p(),u()};return w.useEffect(()=>{if(n.length>0&&r){const y=n[a];y&&l(y.deviceId).catch(C=>{console.error("Error starting video stream on camera change:",C),t("Error al inicializar la cámara con ultra alta resolución")})}},[a,n,r]),w.useEffect(()=>()=>{b()},[]),{hasPermission:r,error:e,isScanning:d,availableCameras:n,currentCameraIndex:a,videoRef:o,switchCamera:g,startScanning:v,stopScanning:h,setError:t}}function kq({hasPermission:r,onCancel:e}){return r===null?c.jsx(He,{children:c.jsx(We,{className:"p-8 text-center",children:c.jsx("p",{children:"Verificando permisos de cámara..."})})}):r===!1?c.jsx(He,{children:c.jsxs(We,{className:"p-8 text-center space-y-4",children:[c.jsx(Yy,{className:"h-12 w-12 mx-auto text-gray-400"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-medium text-gray-900",children:"Acceso a cámara requerido"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Para escanear códigos QR, necesitas permitir el acceso a la cámara"})]}),c.jsxs(Ne,{onClick:e,variant:"outline",children:[c.jsx(lo,{className:"h-4 w-4 mr-2"}),"Cancelar"]})]})}):null}function Mq({videoRef:r,isScanning:e,isLoading:t,availableCameras:n,currentCameraIndex:a,onStartScanning:i,onSwitchCamera:o}){return c.jsx(He,{children:c.jsxs(We,{className:"p-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("video",{ref:r,className:"w-full h-80 bg-black rounded-lg object-cover",autoPlay:!0,playsInline:!0,muted:!0,style:{imageRendering:"crisp-edges",filter:"contrast(1.5) brightness(1.3)"}}),!e&&c.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-70 rounded-lg",children:c.jsxs(Ne,{onClick:i,disabled:t,size:"lg",className:"bg-green-600 hover:bg-green-700",children:[c.jsx(U1,{className:"h-4 w-4 mr-2"}),t?"Procesando...":"Iniciar Escaneo"]})}),e&&c.jsx("div",{className:"absolute inset-0 rounded-lg",children:c.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-30 rounded-lg",children:c.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:c.jsxs("div",{className:"relative w-72 h-40 border-2 border-white rounded-lg",children:[c.jsx("div",{className:"absolute top-0 left-0 w-8 h-8 border-t-4 border-l-4 border-green-400 rounded-tl-lg"}),c.jsx("div",{className:"absolute top-0 right-0 w-8 h-8 border-t-4 border-r-4 border-green-400 rounded-tr-lg"}),c.jsx("div",{className:"absolute bottom-0 left-0 w-8 h-8 border-b-4 border-l-4 border-green-400 rounded-bl-lg"}),c.jsx("div",{className:"absolute bottom-0 right-0 w-8 h-8 border-b-4 border-r-4 border-green-400 rounded-br-lg"})]})})})}),n.length>1&&c.jsx("div",{className:"absolute top-4 right-4",children:c.jsx(Ne,{onClick:o,disabled:e,variant:"secondary",size:"icon",className:"rounded-full bg-white/90 hover:bg-white shadow-lg",children:c.jsx(GN,{className:"h-4 w-4"})})})]}),n.length>0&&c.jsx("div",{className:"mt-3 text-center",children:c.jsxs("p",{className:"text-sm text-gray-600",children:["Cámara ",a+1," de ",n.length]})})]})})}function Rq({isScanning:r,onCancel:e,onStopScanning:t}){return c.jsxs("div",{className:"flex gap-2",children:[c.jsxs(Ne,{onClick:e,variant:"outline",className:"flex-1",children:[c.jsx(lo,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),r&&c.jsx(Ne,{onClick:t,variant:"outline",className:"flex-1",children:"Detener"})]})}function Lq({availableCameras:r}){return c.jsx(He,{children:c.jsxs(We,{className:"p-4",children:[c.jsx("h3",{className:"font-medium mb-2",children:"Instrucciones:"}),c.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[c.jsx("li",{children:"• Apunta la cámara hacia el código QR"}),c.jsx("li",{children:"• Mantén el dispositivo estable"}),c.jsx("li",{children:"• Asegúrate de que haya buena iluminación"}),c.jsx("li",{children:"• El código QR debe estar completamente visible"}),r.length>1&&c.jsx("li",{children:"• Usa el botón de cambio para alternar entre cámaras"})]})]})})}function Fq({error:r}){return c.jsx(He,{className:"border-red-200 bg-red-50",children:c.jsx(We,{className:"p-4",children:c.jsx("p",{className:"text-red-700 text-sm",children:r})})})}function Bq({onQRCodeScanned:r,onCancel:e,isLoading:t=!1}){const{hasPermission:n,error:a,isScanning:i,availableCameras:o,currentCameraIndex:s,videoRef:l,switchCamera:u,startScanning:d,stopScanning:f}=Oq(),h=()=>{d(r)};return n!==!0?c.jsx(kq,{hasPermission:n,onCancel:e}):c.jsxs("div",{className:"space-y-4",children:[c.jsx(Mq,{videoRef:l,isScanning:i,isLoading:t,availableCameras:o,currentCameraIndex:s,onStartScanning:h,onSwitchCamera:u}),a&&c.jsx(Fq,{error:a}),c.jsx(Rq,{isScanning:i,onCancel:e,onStopScanning:f}),c.jsx(Lq,{availableCameras:o})]})}function $q({package:r,payments:e,deliveredBy:t,isPending:n,onCancel:a,onSubmit:i}){const o=r.amount_to_collect&&r.amount_to_collect>0,s=e.reduce((h,p)=>{const g=parseFloat(p.amount)||0;return h+g},0),l=(r.amount_to_collect||0)-s,u=r.currency||"COP";console.log("🎯 [MobileDeliveryActions] Package currency:",u),console.log("🎯 [MobileDeliveryActions] Remaining amount:",l);const f=(h=>{const g={AWG:"ƒ",USD:"$",COP:"$"}[h]||"$";return console.log("💱 [MobileDeliveryActions] Currency symbol for",h,":",g),g})(u);return c.jsxs("div",{className:"space-y-3",children:[o&&l>0&&c.jsx(He,{className:"border-orange-200 bg-orange-50",children:c.jsx(We,{className:"p-3",children:c.jsxs("p",{className:"text-sm text-orange-700",children:[c.jsx("strong",{children:"Atención:"})," Queda un saldo pendiente de"," ",c.jsxs("strong",{children:[f,l.toLocaleString("es-CO")," ",u]}),". Puedes registrar los pagos arriba."]})})}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(Ne,{type:"button",variant:"outline",onClick:a,className:"w-full",children:[c.jsx(lo,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),c.jsxs(Ne,{type:"button",disabled:!t.trim()||n,className:"w-full",onClick:i,children:[c.jsx(es,{className:"h-4 w-4 mr-2"}),n?"Entregando...":"Confirmar"]})]})]})}function Uq({package:r,onDeliveryComplete:e,onCancel:t}){const[n,a]=w.useState(""),{user:i}=$s(),o=p4(),{payments:s,addPayment:l,updatePayment:u,removePayment:d,getCurrencySymbol:f,getValidPayments:h}=m4(r.currency),p=i?.email||"Usuario no identificado",g=async()=>{if(console.log("🔄 [MobileDeliveryForm] Iniciando proceso de entrega..."),console.log("📦 [MobileDeliveryForm] Paquete:",r),console.log("👤 [MobileDeliveryForm] Usuario:",i),console.log("💰 [MobileDeliveryForm] Pagos:",s),!i){console.error("❌ [MobileDeliveryForm] Usuario no autenticado"),alert("No se puede procesar la entrega: usuario no autenticado");return}try{const b=h();console.log("✅ [MobileDeliveryForm] Pagos válidos:",b);const y={packageId:r.id,deliveredBy:p,payments:b.length>0?b:void 0};console.log("📤 [MobileDeliveryForm] Enviando datos de entrega:",y),await o.mutateAsync(y),console.log("✅ [MobileDeliveryForm] Entrega completada exitosamente"),setTimeout(()=>{console.log("🏁 [MobileDeliveryForm] Cerrando vista..."),e()},500)}catch(b){console.error("❌ [MobileDeliveryForm] Error completo en handleSubmit:",b)}},v=(b,y,C)=>{console.log("💳 [MobileDeliveryForm] Actualizando pago:",{index:b,field:y,value:C}),u(b,y,C,r.amount_to_collect||0)};return c.jsxs("div",{className:"space-y-4",children:[c.jsx(Mg,{package:r}),c.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[c.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-2",children:"Información de Entrega"}),c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("span",{className:"font-medium",children:"Entregado por:"})," ",p]})]}),c.jsx(Rg,{package:r,payments:s,onAddPayment:l,onUpdatePayment:v,onRemovePayment:d,getCurrencySymbol:f}),c.jsxs("div",{className:"space-y-4",children:[c.jsx(Lg,{deliveredBy:"",setDeliveredBy:()=>{},notes:n,setNotes:a,hideDeliveredBy:!0}),c.jsx($q,{package:r,payments:s,deliveredBy:p,isPending:o.isPending,onCancel:t,onSubmit:g})]})]})}function qq(r){return Rt({queryKey:["package-by-tracking",r],queryFn:async()=>{if(!r)return null;console.log("🔍 [usePackageByTrackingNumber] Buscando paquete con tracking number:",r);const{data:e,error:t}=await xe.from("packages").select("*").eq("tracking_number",r).single();if(t)throw console.error("❌ [usePackageByTrackingNumber] Error buscando paquete:",t),new Error(`No se encontró el paquete con tracking number: ${r}`);if(!e)throw new Error(`No se encontró el paquete con tracking number: ${r}`);console.log("📦 [usePackageByTrackingNumber] Paquete encontrado:",e);const{data:n,error:a}=await xe.from("customers").select("name, email").eq("id",e.customer_id).single();a&&console.error("⚠️ [usePackageByTrackingNumber] Error buscando cliente:",a);const i={id:e.id,tracking_number:e.tracking_number,origin:e.origin,destination:e.destination,status:e.status,description:e.description,weight:e.weight,freight:e.freight,amount_to_collect:e.amount_to_collect,currency:e.currency,trip_id:e.trip_id,customers:n?{name:n.name,email:n.email}:{name:"Cliente no encontrado",email:"N/A"}};return console.log("✅ [usePackageByTrackingNumber] Paquete con datos completos:",i),i},enabled:!!r,retry:!1,staleTime:0,gcTime:0})}function Xg({onClose:r}){const[e,t]=w.useState("menu"),[n,a]=w.useState(null),[i,o]=w.useState(!1),s=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),{playErrorBeep:l}=U4(),{data:u,error:d,isLoading:f}=qq(n),h=async b=>{console.log("📊 [MobileDeliveryView] Código de barras escaneado:",b),o(!0);try{const y=b.trim();if(y)console.log("🔍 [MobileDeliveryView] Buscando paquete con tracking number:",y),a(y);else throw new Error("Código de barras no válido o vacío")}catch(y){console.error("❌ [MobileDeliveryView] Error procesando código de barras:",y),await l(),alert(`Error: ${y instanceof Error?y.message:"Código de barras no válido o no se pudo procesar"}`),o(!1)}};w.useEffect(()=>{u&&n&&(console.log("✅ [MobileDeliveryView] Paquete cargado exitosamente:",u),o(!1),t("delivery"))},[u,n]),w.useEffect(()=>{d&&n&&(console.error("❌ [MobileDeliveryView] Error cargando paquete:",d),l(),alert(`Error: No se encontró el paquete con tracking number: ${n}`),a(null),o(!1),t("scanner"))},[d,n,l]);const p=()=>{console.log("🏁 [MobileDeliveryView] Entrega completada, reseteando estado..."),a(null),o(!1),t("menu")},g=()=>{console.log("🔙 [MobileDeliveryView] Regresando al menú, reseteando estado..."),a(null),o(!1),t("menu")},v=()=>{console.log("🔄 [MobileDeliveryView] Iniciando nuevo escaneo, reseteando estado..."),a(null),o(!1),t("scanner")};return c.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[c.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(Ne,{variant:"ghost",size:"sm",onClick:e==="menu"?r:g,children:c.jsx(Jo,{className:"h-4 w-4"})}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Zy,{className:"h-5 w-5 text-blue-600"}),c.jsx("h1",{className:"text-lg font-semibold",children:"Entrega Móvil"})]})]})}),c.jsxs("div",{className:"flex-1 p-4",children:[e==="menu"&&c.jsxs("div",{className:"space-y-4",children:[!s&&c.jsx(He,{className:"border-orange-200 bg-orange-50",children:c.jsx(We,{className:"p-4",children:c.jsxs("div",{className:"flex items-center gap-2 text-orange-700",children:[c.jsx(Yy,{className:"h-4 w-4"}),c.jsx("span",{className:"text-sm",children:"Esta función está optimizada para dispositivos móviles con cámara"})]})})}),c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(U1,{className:"h-5 w-5"}),"Entregar Paquete"]})}),c.jsxs(We,{className:"space-y-4",children:[c.jsx("p",{className:"text-gray-600",children:"Escanea el código de barras del paquete para iniciar el proceso de entrega"}),c.jsxs(Ne,{onClick:v,className:"w-full",size:"lg",children:[c.jsx(U1,{className:"h-4 w-4 mr-2"}),"Escanear Código de Barras"]})]})]}),c.jsx(He,{children:c.jsxs(We,{className:"p-4",children:[c.jsx("h3",{className:"font-medium mb-2",children:"¿Cómo funciona?"}),c.jsxs("ol",{className:"text-sm text-gray-600 space-y-1",children:[c.jsx("li",{children:'1. Haz clic en "Escanear Código de Barras"'}),c.jsx("li",{children:"2. Permite el acceso a la cámara"}),c.jsx("li",{children:"3. Apunta la cámara al código de barras del paquete"}),c.jsx("li",{children:"4. Escucha el pitido de confirmación"}),c.jsx("li",{children:"5. Completa la información de entrega"}),c.jsx("li",{children:"6. Confirma la entrega"})]})]})})]}),e==="scanner"&&c.jsx(Bq,{onQRCodeScanned:h,onCancel:g,isLoading:i||f}),e==="delivery"&&u&&c.jsx(Uq,{package:u,onDeliveryComplete:p,onCancel:g})]})]})}function Vq({onBack:r}){return c.jsxs(Fi,{className:"mb-4 border-blue-200 bg-blue-50",children:[c.jsx(wu,{className:"h-4 w-4"}),c.jsxs(Bi,{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-blue-800",children:[c.jsx("strong",{children:"Vista Preview:"})," Panel como Viajero - Puede crear paquetes y viajes, acceso a sus viajes asignados y entrega móvil"]}),c.jsxs(Ne,{variant:"outline",size:"sm",onClick:r,className:"ml-4",children:[c.jsx(Jo,{className:"h-4 w-4 mr-2"}),"Volver"]})]})]})}function zq(){return Rt({queryKey:["customers-pending-collection"],queryFn:async()=>{console.log("🔍 Fetching customers with pending collections...");try{const{data:r,error:e}=await xe.from("packages").select(`
            id,
            tracking_number,
            destination,
            status,
            amount_to_collect,
            delivered_at,
            created_at,
            currency,
            customers (
              name,
              phone
            )
          `).eq("status","delivered").gt("amount_to_collect",0).order("delivered_at",{ascending:!1,nullsFirst:!1}).order("created_at",{ascending:!1}).limit(50);if(e)throw console.error("❌ Error fetching pending collections:",e),new Error(`Error en la base de datos: ${e.message}`);if(console.log("📊 Raw packages data:",r),!Array.isArray(r))return console.warn("⚠️ Data is not an array, returning empty array"),[];const n=(await Promise.all(r.map(async a=>{const{data:i,error:o}=await xe.from("customer_payments").select("amount").eq("package_id",a.id);o&&console.warn("⚠️ Error fetching payments for package:",a.id,o);const s=(i||[]).reduce((u,d)=>u+(d.amount||0),0),l=Math.max(0,(a.amount_to_collect||0)-s);return l<=0?null:{package_id:a.id,tracking_number:a.tracking_number,customer_name:a.customers?.name||"N/A",customer_phone:a.customers?.phone||"N/A",destination:a.destination,package_status:a.status,pending_amount:l,delivery_date:a.delivered_at,created_at:a.created_at,currency:a.currency||"COP"}}))).filter(a=>a!==null);return console.log("✅ Transformed pending collections data:",n),n}catch(r){throw console.error("❌ Error in useCustomersPendingCollection:",r),r}},refetchInterval:3e4,retry:3,retryDelay:1e3})}function Hq(){return Rt({queryKey:["payment-methods"],queryFn:async()=>{const{data:r,error:e}=await xe.from("payment_methods").select("*").order("currency",{ascending:!0});if(e)throw e;return r||[]}})}function Wq({isOpen:r,packageCurrency:e,customerTotalAmount:t}){const[n,a]=w.useState([]),{data:i=[]}=Hq();return w.useEffect(()=>{if(r&&e){console.log("🔄 Resetting payment entries with package currency:",e);const d=i.find(f=>f.currency===e)||i.find(f=>f.currency==="COP");console.log("🎯 Setting default payment with currency:",e),a([{methodId:d?.id||"",amount:"",currency:e,type:"partial"}])}},[r,i,e]),{payments:n,handlePaymentUpdate:(d,f,h)=>{console.log("💳 Actualizando pago:",{index:d,field:f,value:h}),a(p=>{const g=[...p];if(g[d]={...g[d],[f]:h},f==="amount"&&t){const v=parseFloat(h)||0;g[d].type=v>=t?"full":"partial"}if(f==="currency"){const v=i.find(b=>b.currency===h);v&&(g[d].methodId=v.id)}return console.log("💳 Updated payment:",g[d]),g})},addPayment:()=>{const d=e||"COP",f=i.find(h=>h.currency===d)||i.find(h=>h.currency==="COP");a(h=>[...h,{methodId:f?.id||"",amount:"",currency:d,type:"partial"}])},removePayment:d=>{a(f=>f.filter((h,p)=>p!==d))},getCurrencySymbol:d=>{const h=i.find(p=>p.currency===d)?.symbol||"$";return console.log("💱 Currency symbol for",d,":",h),h}}}function Gq(r,e){const{data:t=[]}=Rt({queryKey:["customer-packages",r?.id],queryFn:async()=>{if(!r?.id)return[];console.log("🔍 Fetching packages for customer:",r.id);const{data:a,error:i}=await xe.from("packages").select("*").eq("id",r.id).single();return i?(console.error("Error fetching package:",i),[]):(console.log("📦 Fetched package:",a),a?[a]:[])},enabled:!!r?.id&&e}),n=r?{id:r.id,tracking_number:r.package_numbers,customer_id:r.id,amount_to_collect:r.total_pending_amount,currency:t[0]?.currency||"COP",status:"delivered",destination:t[0]?.destination||"Unknown"}:null;return{customerPackages:t,mockPackage:n}}class Yq{static async submitPayment({customer:e,payments:t,notes:n}){console.log("🚀 [PaymentSubmissionService] Starting payment submission:",{customerId:e.id,paymentsCount:t.length,totalAmount:t.reduce((l,u)=>l+(parseFloat(u.amount)||0),0)});const a=t.filter(l=>l.methodId&&l.amount&&parseFloat(l.amount)>0);if(a.length===0)throw new Error("Por favor ingresa al menos un pago válido");const{data:i,error:o}=await xe.from("packages").select("customer_id").eq("id",e.id).single();if(o)throw o;if(!i)throw new Error("No se encontró el paquete especificado");for(const l of a){const{error:u}=await xe.rpc("register_customer_payment",{p_customer_id:i.customer_id,p_package_id:e.id,p_amount:parseFloat(l.amount),p_payment_method:l.methodId,p_currency:l.currency,p_notes:n||null,p_created_by:"Usuario actual"});if(u)throw console.error("Error registering payment:",u),u}const s=a.reduce((l,u)=>l+parseFloat(u.amount),0);return console.log("✅ [PaymentSubmissionService] Payment submission completed successfully"),{totalPaid:s,currency:a[0].currency,paymentCount:a.length}}}function Kq(r,e){const[t,n]=w.useState(""),[a,i]=w.useState(!1),{toast:o}=Lt(),{customerPackages:s,mockPackage:l}=Gq(r,e),{payments:u,handlePaymentUpdate:d,addPayment:f,removePayment:h,getCurrencySymbol:p}=Wq({isOpen:e,packageCurrency:l?.currency,customerTotalAmount:r?.total_pending_amount});return console.log("💰 Mock package currency:",l?.currency),{notes:t,setNotes:n,isLoading:a,payments:u,mockPackage:l,handlePaymentUpdate:d,addPayment:f,removePayment:h,getCurrencySymbol:p,handleSubmit:async(v,b)=>{if(r){i(!0);try{const y=await Yq.submitPayment({customer:r,payments:u,notes:t}),C=p(y.currency);o({title:"Pago registrado",description:`Se registró un pago total por ${C}${y.totalPaid.toLocaleString("es-CO")} ${y.currency} para ${r.customer_name}`}),v(),b()}catch(y){console.error("Error recording payment:",y),o({title:"Error",description:y instanceof Error?y.message:"No se pudo registrar el pago",variant:"destructive"})}finally{i(!1)}}}}}function Xq({mockPackage:r,payments:e,notes:t,onAddPayment:n,onUpdatePayment:a,onRemovePayment:i,onNotesChange:o,getCurrencySymbol:s}){return console.log("📋 [PaymentFormFields] Mock package:",r),console.log("💳 [PaymentFormFields] Payments:",e),c.jsxs("div",{className:"space-y-4",children:[c.jsx(Rg,{package:r,payments:e,onAddPayment:n,onUpdatePayment:a,onRemovePayment:i,getCurrencySymbol:s}),c.jsx(Lg,{deliveredBy:"",setDeliveredBy:()=>{},notes:t,setNotes:o,hideDeliveredBy:!0})]})}function Qq({remainingAmount:r,currency:e,currencySymbol:t="$"}){return r<=0?null:c.jsx(He,{className:"border-orange-200 bg-orange-50",children:c.jsx(We,{className:"p-3",children:c.jsxs("p",{className:"text-sm text-orange-700",children:[c.jsx("strong",{children:"Atención:"})," Queda un saldo pendiente de"," ",c.jsxs("strong",{children:[t,r.toLocaleString("es-CO")," ",e]}),". Puedes registrar más pagos arriba."]})})})}function Zq({isLoading:r,hasPayments:e,onCancel:t,onSubmit:n}){return c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs(Ne,{type:"button",variant:"outline",onClick:t,className:"w-full",children:[c.jsx(lo,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),c.jsxs(Ne,{type:"button",disabled:r||!e,className:"w-full",onClick:n,children:[c.jsx(es,{className:"h-4 w-4 mr-2"}),r?"Registrando...":"Registrar Pago"]})]})}function Jq({customer:r,mockPackage:e,payments:t,notes:n,isLoading:a,onAddPayment:i,onUpdatePayment:o,onRemovePayment:s,onNotesChange:l,onCancel:u,onSubmit:d,getCurrencySymbol:f}){console.log("🏗️ [RecordPaymentContent] Mock package:",e),console.log("💳 [RecordPaymentContent] Payments:",t);const h=e?.currency||"COP";console.log("💰 [RecordPaymentContent] Package currency:",h);const p=t.reduce((y,C)=>{const S=parseFloat(C.amount)||0;return y+S},0),g=Math.max(0,r.total_pending_amount-p),v=f(h);console.log("💱 [RecordPaymentContent] Currency symbol:",v),console.log("📊 [RecordPaymentContent] Total collected:",p),console.log("📊 [RecordPaymentContent] Remaining amount:",g);const b=t.some(y=>y.methodId&&y.amount&&parseFloat(y.amount)>0);return c.jsxs("div",{className:"space-y-4",children:[c.jsx(Mg,{package:e}),c.jsx(Xq,{mockPackage:e,payments:t,notes:n,onAddPayment:i,onUpdatePayment:o,onRemovePayment:s,onNotesChange:l,getCurrencySymbol:f}),c.jsx(Qq,{remainingAmount:g,currency:h,currencySymbol:v}),c.jsx(Zq,{isLoading:a,hasPayments:b,onCancel:u,onSubmit:d})]})}function eV({isOpen:r,onClose:e,customer:t,onPaymentRecorded:n}){const{notes:a,setNotes:i,isLoading:o,payments:s,mockPackage:l,handlePaymentUpdate:u,addPayment:d,removePayment:f,getCurrencySymbol:h,handleSubmit:p}=Kq(t,r),g=()=>{p(n,e)};if(console.log("🎭 Dialog state:",{isOpen:r,customer:t,mockPackage:l}),!t)return console.log("❌ No customer provided to dialog"),null;const v=l||{id:t.id,tracking_number:t.package_numbers,customer_id:t.id,amount_to_collect:t.total_pending_amount,currency:"COP",status:"delivered",destination:"Unknown"};return c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[c.jsx(Kr,{children:c.jsxs(Xr,{children:["Registrar Pago - ",t.customer_name]})}),c.jsx(Jq,{customer:t,mockPackage:v,payments:s,notes:a,isLoading:o,onAddPayment:d,onUpdatePayment:u,onRemovePayment:f,onNotesChange:i,onCancel:e,onSubmit:g,getCurrencySymbol:h})]})})}function tV({customersCount:r,totalPendingAmount:e}){return c.jsx(yt,{children:c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-2 sm:space-y-0",children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx($o,{className:"h-5 w-5"}),"Clientes con Pagos Pendientes",r>0&&c.jsx(Ot,{variant:"secondary",className:"ml-2",children:r})]}),r>0&&c.jsxs("div",{className:"text-sm text-gray-600",children:["Total pendiente: ",c.jsx("span",{className:"font-medium text-red-600",children:oo(e,"COP")})]})]})})}function rV({customer:r,index:e,onRecordPayment:t}){const n=s=>{if(!s)return"N/A";try{return pt(new Date(s),"dd MMM yyyy",{locale:Bn})}catch{return"Fecha inválida"}},a=s=>{if(!s)return 0;try{const l=new Date(s),d=Math.abs(new Date().getTime()-l.getTime());return Math.ceil(d/864e5)}catch{return 0}},i=s=>s>=30?"destructive":s>=15?"secondary":"outline",o=a(r.delivery_date);return c.jsxs(Sr,{className:"hover:bg-gray-50",children:[c.jsx(Re,{children:c.jsxs("div",{className:"space-y-1",children:[c.jsx("div",{className:"font-medium",children:r.customer_name}),c.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[c.jsx(uh,{className:"h-3 w-3"}),r.customer_phone]})]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(Dr,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"text-sm font-mono",children:r.tracking_number})]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(gi,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"text-sm",children:r.destination})]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(Li,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"text-sm",children:n(r.delivery_date)})]})}),c.jsx(Re,{children:c.jsxs(Ot,{variant:i(o),className:"text-xs",children:[o," días"]})}),c.jsx(Re,{className:"text-right",children:c.jsx("div",{className:"font-medium text-red-600",children:oo(r.pending_amount||0,r.currency||"COP")})}),c.jsx(Re,{className:"text-center",children:c.jsxs(Ne,{size:"sm",onClick:()=>t(r),className:"gap-1",children:[c.jsx(_a,{className:"h-3 w-3"}),"Registrar Pago"]})})]},`${r.package_id}-${r.customer_name}-${e}`)}function nV({isLoading:r,error:e,isEmpty:t,onRetry:n}){return r?c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx($o,{className:"h-5 w-5"}),"Clientes con Pagos Pendientes"]})}),c.jsx(We,{children:c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Cargando clientes con pagos pendientes..."})]})})]}):e?c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx($o,{className:"h-5 w-5"}),"Clientes con Pagos Pendientes"]})}),c.jsx(We,{children:c.jsxs("div",{className:"text-center py-8",children:[c.jsx(mi,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),c.jsx("p",{className:"text-red-600 font-medium mb-2",children:"Error al cargar datos de clientes"}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:e instanceof Error?e.message:"Error desconocido"}),n&&c.jsxs(Ne,{onClick:n,variant:"outline",className:"gap-2",children:[c.jsx(dh,{className:"h-4 w-4"}),"Reintentar"]})]})})]}):t?c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx($o,{className:"h-5 w-5"}),"Clientes con Pagos Pendientes"]})}),c.jsx(We,{children:c.jsxs("div",{className:"text-center py-8",children:[c.jsx(_a,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"No hay clientes con pagos pendientes"})]})})]}):null}function aV(){const{data:r,isLoading:e,error:t,refetch:n}=zq(),[a,i]=w.useState(null),[o,s]=w.useState(!1),l=p=>{console.log("🎯 Registrar pago para:",p.customer_name),console.log("📦 Datos del cliente/paquete:",p);const g={id:p.package_id,customer_name:p.customer_name,phone:p.customer_phone,total_pending_amount:p.pending_amount,package_numbers:p.tracking_number};console.log("💰 Datos para registro de pago:",g),i(g),s(!0)},u=()=>{console.log("✅ Pago registrado exitosamente"),n()},d=()=>{s(!1),i(null)},f=()=>{console.log("🔄 Reintentando cargar datos..."),n()};if(e||t||!r||r.length===0)return c.jsx(nV,{isLoading:e,error:t,isEmpty:!r||r.length===0,onRetry:f});const h=r.reduce((p,g)=>p+(g.pending_amount||0),0);return c.jsxs(c.Fragment,{children:[c.jsxs(He,{children:[c.jsx(tV,{customersCount:r.length,totalPendingAmount:h}),c.jsx(We,{children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"Cliente"}),c.jsx(Me,{children:"Paquete"}),c.jsx(Me,{children:"Destino"}),c.jsx(Me,{children:"Fecha Entrega"}),c.jsx(Me,{children:"Días"}),c.jsx(Me,{className:"text-right",children:"Monto Pendiente"}),c.jsx(Me,{className:"text-center",children:"Acciones"})]})}),c.jsx(Wa,{children:r.map((p,g)=>c.jsx(rV,{customer:p,index:g,onRecordPayment:l},`${p.package_id}-${p.customer_name}-${g}`))})]})})})]}),a&&c.jsx(eV,{isOpen:o,onClose:d,customer:a,onPaymentRecorded:u})]})}function iV(){return Rt({queryKey:["collected-orders"],queryFn:async()=>{console.log("🔍 Fetching collected orders...");try{const{data:r,error:e}=await xe.from("customer_payments").select(`
            id,
            amount,
            payment_method,
            currency,
            payment_date,
            notes,
            created_by,
            package_id,
            packages!customer_payments_package_id_fkey (
              tracking_number,
              destination,
              delivered_at,
              customer_id,
              customers!packages_customer_id_fkey (
                name,
                phone
              )
            )
          `).order("payment_date",{ascending:!1}).limit(100);if(e)throw console.error("❌ Error fetching collected orders:",e),new Error(`Error en la base de datos: ${e.message}`);if(console.log("📊 Raw collected orders data:",r),!Array.isArray(r))return console.warn("⚠️ Data is not an array, returning empty array"),[];const t=r.filter(n=>n.packages).map(n=>({payment_id:n.id,amount:n.amount,payment_method:n.payment_method,currency:n.currency||"COP",payment_date:n.payment_date,notes:n.notes,created_by:n.created_by,tracking_number:n.packages?.tracking_number||"N/A",destination:n.packages?.destination||"N/A",delivered_at:n.packages?.delivered_at||null,customer_name:n.packages?.customers?.name||"N/A",customer_phone:n.packages?.customers?.phone||"N/A"}));return console.log("✅ Transformed collected orders data:",t),t}catch(r){throw console.error("❌ Error in useCollectedOrders:",r),r}},refetchInterval:3e4,retry:3,retryDelay:1e3})}function oV(){const{data:r,isLoading:e,error:t,refetch:n}=iV(),a=()=>{console.log("🔄 Reintentando cargar órdenes cobradas..."),n()},i=l=>{if(!l)return"N/A";try{return mN(new Date(l),{addSuffix:!0,locale:Bn})}catch{return"Fecha inválida"}},o=l=>{const d={efectivo:{label:"Efectivo",variant:"default"},transferencia:{label:"Transferencia",variant:"secondary"},tarjeta:{label:"Tarjeta",variant:"outline"}}[l]||{label:l,variant:"outline"};return c.jsx(Ot,{variant:d.variant,children:d.label})};if(e)return c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(Fn,{className:"h-5 w-5"}),"Órdenes Cobradas"]})}),c.jsx(We,{children:c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Cargando órdenes cobradas..."})]})})]});if(t)return c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(Fn,{className:"h-5 w-5"}),"Órdenes Cobradas"]})}),c.jsx(We,{children:c.jsxs("div",{className:"text-center py-8",children:[c.jsx(mi,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),c.jsx("p",{className:"text-red-600 font-medium mb-2",children:"Error al cargar órdenes cobradas"}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t instanceof Error?t.message:"Error desconocido"}),c.jsxs(Ne,{onClick:a,variant:"outline",className:"gap-2",children:[c.jsx(dh,{className:"h-4 w-4"}),"Reintentar"]})]})})]});const s=r?.reduce((l,u)=>l+(u.amount||0),0)||0;return c.jsxs(He,{children:[c.jsxs(yt,{children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between space-y-2 sm:space-y-0",children:[c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(Fn,{className:"h-5 w-5"}),"Órdenes Cobradas",r&&r.length>0&&c.jsx(Ot,{variant:"default",className:"ml-2 bg-green-100 text-green-800",children:r.length})]}),r&&r.length>0&&c.jsxs("div",{className:"text-sm text-gray-600",children:["Total cobrado: ",c.jsx("span",{className:"font-medium text-green-600",children:oo(s,"COP")})]})]}),c.jsx("p",{className:"text-sm text-muted-foreground",children:"Historial de pagos recibidos de clientes"})]}),c.jsx(We,{children:!r||r.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(Fn,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"No hay órdenes cobradas registradas"})]}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs(za,{children:[c.jsx(Ha,{children:c.jsxs(Sr,{children:[c.jsx(Me,{children:"Cliente"}),c.jsx(Me,{children:"Paquete"}),c.jsx(Me,{children:"Destino"}),c.jsx(Me,{children:"Método de Pago"}),c.jsx(Me,{className:"text-right",children:"Monto"}),c.jsx(Me,{children:"Fecha de Pago"}),c.jsx(Me,{children:"Procesado por"})]})}),c.jsx(Wa,{children:r.map((l,u)=>c.jsxs(Sr,{className:"hover:bg-gray-50",children:[c.jsx(Re,{children:c.jsxs("div",{className:"space-y-1",children:[c.jsx("div",{className:"font-medium",children:l.customer_name}),c.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600",children:[c.jsx(uh,{className:"h-3 w-3"}),l.customer_phone]})]})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(Dr,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"text-sm font-mono",children:l.tracking_number})]})}),c.jsx(Re,{children:c.jsx("span",{className:"text-sm",children:l.destination})}),c.jsx(Re,{children:o(l.payment_method)}),c.jsx(Re,{className:"text-right",children:c.jsx("div",{className:"font-medium text-green-600",children:oo(l.amount||0,l.currency||"COP")})}),c.jsx(Re,{children:c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(Li,{className:"h-3 w-3 text-gray-500"}),c.jsx("span",{className:"text-sm",children:i(l.payment_date)})]})}),c.jsx(Re,{children:c.jsx("span",{className:"text-sm text-gray-600",children:l.created_by||"Sistema"})})]},`${l.payment_id}-${u}`))})]})})})]})}function sV(){return c.jsxs(Us,{defaultValue:"pending",className:"w-full",children:[c.jsxs(Mu,{className:"grid w-full grid-cols-2",children:[c.jsxs(kn,{value:"pending",className:"flex items-center gap-2",children:[c.jsx($o,{className:"h-4 w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Pagos Pendientes"}),c.jsx("span",{className:"sm:hidden",children:"Pendientes"})]}),c.jsxs(kn,{value:"collected",className:"flex items-center gap-2",children:[c.jsx(Fn,{className:"h-4 w-4"}),c.jsx("span",{className:"hidden sm:inline",children:"Órdenes Cobradas"}),c.jsx("span",{className:"sm:hidden",children:"Cobradas"})]})]}),c.jsx(xn,{value:"pending",className:"mt-6",children:c.jsx(aV,{})}),c.jsx(xn,{value:"collected",className:"mt-6",children:c.jsx(oV,{})})]})}function cV(){return Rt({queryKey:["financial-data",pt(new Date,"yyyy-MM")],queryFn:async()=>{console.log("💰 Fetching financial data...");try{const r=new Date,e=sh(r),t=ch(r),{data:n,error:a}=await xe.from("packages").select(`
            id,
            tracking_number,
            freight,
            amount_to_collect,
            status,
            delivered_at,
            customer_id,
            customers(name, phone, email)
          `).gte("created_at",e.toISOString()).lte("created_at",t.toISOString());if(a)throw console.error("❌ Error fetching packages:",a),new Error(`Error al cargar paquetes: ${a.message}`);const{data:i,error:o}=await xe.from("customer_payments").select("amount").gte("created_at",e.toISOString()).lte("created_at",t.toISOString());o&&(console.error("❌ Error fetching payments:",o),console.warn("⚠️ Could not fetch payments, continuing without payment data"));const s=(i||[]).reduce((g,v)=>g+(v.amount||0),0),l=(n||[]).reduce((g,v)=>g+(v.freight||0),0),u=(n||[]).filter(g=>g.status==="delivered").length,d=(n||[]).length;let f=[],h=0;try{const{data:g,error:v}=await xe.rpc("get_collection_packages",{p_limit:100,p_offset:0});if(v)console.error("❌ Error fetching pending collections:",v),console.warn("⚠️ Could not fetch pending collections, continuing without this data");else if(Array.isArray(g)){h=g.reduce((y,C)=>y+(C.pending_amount||0),0);const b=new Map;g.forEach(y=>{const C=y.package_id,S=b.get(C);S?(S.total_pending+=y.pending_amount||0,S.package_count+=1,S.tracking_numbers.push(y.tracking_number)):b.set(C,{customer_id:C,customer_name:y.customer_name||"N/A",phone:y.customer_phone||"N/A",email:"N/A",total_pending:y.pending_amount||0,package_count:1,tracking_numbers:[y.tracking_number]})}),f=Array.from(b.values()).sort((y,C)=>C.total_pending-y.total_pending)}}catch(g){console.error("❌ Error in pending collections processing:",g)}const p={totalRevenue:s,totalExpenses:0,netProfit:s,totalFreight:l,pendingCollections:h,deliveredPackages:u,totalPackages:d};return console.log("✅ Financial data loaded successfully"),{summary:p,customersPending:f}}catch(r){throw console.error("❌ Error in useFinancialData:",r),r}},refetchInterval:3e4,staleTime:1e4,retry:3,retryDelay:1e3})}function q4(){const{data:r,isLoading:e,error:t}=cV(),n=i=>new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",minimumFractionDigits:0}).format(i);if(e)return c.jsxs(xn,{value:"finances",className:"space-y-4 sm:space-y-8 px-2 sm:px-0",children:[c.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-2 sm:gap-4",children:[1,2,3].map(i=>c.jsx(He,{className:"min-h-[100px] sm:min-h-auto",children:c.jsx(We,{className:"p-4",children:c.jsxs("div",{className:"animate-pulse",children:[c.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),c.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/2"})]})})},i))}),c.jsx(He,{children:c.jsx(We,{className:"p-8 text-center",children:c.jsx("p",{className:"text-gray-500",children:"Cargando datos financieros..."})})})]});if(t)return c.jsx(xn,{value:"finances",className:"space-y-4 sm:space-y-8 px-2 sm:px-0",children:c.jsx(He,{children:c.jsxs(We,{className:"p-8 text-center text-red-500",children:[c.jsx("p",{children:"Error al cargar datos financieros"}),c.jsx("p",{className:"text-sm text-gray-500 mt-2",children:t.message})]})})});const a=r?.summary;return c.jsx(xn,{value:"finances",className:"space-y-4 sm:space-y-8 px-2 sm:px-0",children:c.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-3 gap-2 sm:gap-4",children:[c.jsxs(He,{className:"min-h-[100px] sm:min-h-auto",children:[c.jsxs(yt,{className:"flex flex-row items-center justify-between space-y-0 pb-1 sm:pb-2 px-3 sm:px-6 pt-3 sm:pt-6",children:[c.jsxs(Nt,{className:"text-xs sm:text-sm font-medium leading-tight",children:[c.jsx("span",{className:"hidden sm:inline",children:"Fletes Cobrados"}),c.jsx("span",{className:"sm:hidden",children:"Fletes"})]}),c.jsx(_a,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500 flex-shrink-0"})]}),c.jsxs(We,{className:"px-3 sm:px-6 pb-3 sm:pb-6",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600 leading-tight",children:n(a?.totalFreight||0)}),c.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Total del mes"})]})]}),c.jsxs(He,{className:"min-h-[100px] sm:min-h-auto",children:[c.jsxs(yt,{className:"flex flex-row items-center justify-between space-y-0 pb-1 sm:pb-2 px-3 sm:px-6 pt-3 sm:pt-6",children:[c.jsxs(Nt,{className:"text-xs sm:text-sm font-medium leading-tight",children:[c.jsx("span",{className:"hidden sm:inline",children:"Pendiente Cobro"}),c.jsx("span",{className:"sm:hidden",children:"Pendiente"})]}),c.jsx(Dr,{className:"h-3 w-3 sm:h-4 sm:w-4 text-orange-500 flex-shrink-0"})]}),c.jsxs(We,{className:"px-3 sm:px-6 pb-3 sm:pb-6",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-orange-600 leading-tight",children:n(a?.pendingCollections||0)}),c.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Por cobrar"})]})]}),c.jsxs(He,{className:"min-h-[100px] sm:min-h-auto",children:[c.jsxs(yt,{className:"flex flex-row items-center justify-between space-y-0 pb-1 sm:pb-2 px-3 sm:px-6 pt-3 sm:pt-6",children:[c.jsxs(Nt,{className:"text-xs sm:text-sm font-medium leading-tight",children:[c.jsx("span",{className:"hidden sm:inline",children:"Paquetes Entregados"}),c.jsx("span",{className:"sm:hidden",children:"Entregados"})]}),c.jsx($o,{className:"h-3 w-3 sm:h-4 sm:w-4 text-purple-500 flex-shrink-0"})]}),c.jsxs(We,{className:"px-3 sm:px-6 pb-3 sm:pb-6",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600 leading-tight",children:a?.deliveredPackages||0}),c.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["de ",a?.totalPackages||0," total"]})]})]})]}),c.jsx(sV,{})]})})}function lV({currency:r,amountToCollect:e,amountToCollectFormatted:t,onCurrencyChange:n,onAmountChange:a}){const[i,o]=w.useState(!1);console.log("💱 [AmountToCollectSection] Props recibidas:",{currency:r,amountToCollect:e,amountToCollectFormatted:t,currencyType:typeof r});const s=d=>{const f=d.target.value,h=Xo(f),p=$u(h);a(p,h)},l=d=>{console.log("💱 [AmountToCollectSection] Cambio de divisa:",{anterior:r,nueva:d,tipo:typeof d}),n(d==="AWG"?"AWG":"COP"),o(!1)},u=()=>{o(!0)};return console.log("🎯 [AmountToCollectSection] Divisa a mostrar:",r),c.jsxs("div",{className:"space-y-4",children:[c.jsx(at,{htmlFor:"amountToCollect",className:"text-lg font-bold text-black",children:"Valor a Cobrar"}),c.jsxs("div",{className:"flex gap-3",children:[i?c.jsxs(Ca,{value:r,onValueChange:l,children:[c.jsx(ia,{className:"w-28",children:c.jsx(Na,{})}),c.jsxs(oa,{children:[c.jsx(pr,{value:"COP",children:"COP"}),c.jsx(pr,{value:"AWG",children:"AWG"})]})]}):c.jsx("div",{onClick:u,className:"w-28 h-12 flex items-center justify-center bg-gray-100 border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-200 transition-colors",children:c.jsx("span",{className:"text-gray-600 font-medium",children:r})}),c.jsx(It,{id:"amountToCollect",type:"text",value:t,onChange:s,placeholder:"0",className:"flex-1"})]})]})}function uV(){const[r,e]=w.useState({description:"",weight:"",freight:"",freightFormatted:"",amountToCollect:"",amountToCollectFormatted:"",currency:"COP",details:[""]});return console.log("📋 [PackageFormLogic] Current form data:",r),console.log("💰 [PackageFormLogic] Selected currency for amount to collect:",r.currency),console.log("💰 [PackageFormLogic] Amount to collect:",r.amountToCollect),console.log("🚢 [PackageFormLogic] Freight (always COP):",r.freight),{formData:r,updateFormData:n=>{e(a=>({...a,...n}))}}}function dV(){const{toast:r}=Lt(),e=n=>n.filter(a=>a.trim()!=="");return{validateForm:(n,a,i)=>!n||!a?(r({title:"Error",description:"Debe seleccionar un cliente y un viaje",variant:"destructive"}),!1):e(i.details).length===0?(r({title:"Error",description:"Debe ingresar al menos un detalle del producto",variant:"destructive"}),!1):!0,getFilledDetails:e}}function fV(){const[r,e]=w.useState(!1),{toast:t}=Lt(),n=()=>{const i="EO",o=new Date().getFullYear(),s=Math.floor(Math.random()*1e4).toString().padStart(4,"0");return`${i}-${o}-${s}`};return{isLoading:r,submitPackage:async(i,o,s,l)=>{e(!0);try{const u=n(),{data:d,error:f}=await xe.from("trips").select("origin, destination, flight_number").eq("id",o).single();if(f)throw f;let h=l.join(", ");s.description.trim()&&(h=`${s.description.trim()} - ${h}`);const p={tracking_number:u,customer_id:i,description:h,weight:s.weight?parseFloat(s.weight):null,freight:s.freight?parseFloat(s.freight):0,amount_to_collect:s.amountToCollect?parseFloat(s.amountToCollect):0,currency:s.currency,origin:d.origin,destination:d.destination,flight_number:d.flight_number,trip_id:o,status:"recibido"};console.log("📤 [PackageFormSubmission] Datos del paquete a insertar:",p),console.log("💰 [PackageFormSubmission] Divisa para monto a cobrar:",p.currency),console.log("💰 [PackageFormSubmission] Monto a cobrar:",p.amount_to_collect),console.log("🚢 [PackageFormSubmission] Flete (siempre en COP):",p.freight);const{error:g}=await xe.from("packages").insert([p]);if(g)throw console.error("❌ [PackageFormSubmission] Error al insertar en BD:",g),g;console.log("✅ [PackageFormSubmission] Paquete creado exitosamente en BD");const{data:v}=await xe.from("packages").select("id").eq("tracking_number",u).single();return v&&await xe.from("tracking_events").insert([{package_id:v.id,event_type:"created",description:"Encomienda creada",location:d.origin}]),t({title:"Encomienda creada",description:`Número de seguimiento: ${u}`}),!0}catch(u){return console.error("❌ [PackageFormSubmission] Error creating package:",u),t({title:"Error",description:"No se pudo crear la encomienda",variant:"destructive"}),!1}finally{e(!1)}}}}function hV({customerId:r,tripId:e,onSuccess:t,onCancel:n}){const{formData:a,updateFormData:i}=uV(),{validateForm:o,getFilledDetails:s}=dV(),{isLoading:l,submitPackage:u}=fV(),d=async f=>{if(f.preventDefault(),!o(r,e,a))return;const h=s(a.details);await u(r,e,a,h)&&t()};return c.jsxs("form",{onSubmit:d,className:"space-y-6",children:[c.jsx(e5,{details:a.details,onChange:f=>i({details:f})}),c.jsx(t5,{freight:a.freight,freightFormatted:a.freightFormatted,weight:a.weight,onFreightChange:(f,h)=>i({freight:f,freightFormatted:h}),onWeightChange:f=>i({weight:f})}),c.jsx(lV,{currency:a.currency,amountToCollect:a.amountToCollect,amountToCollectFormatted:a.amountToCollectFormatted,onCurrencyChange:f=>{console.log("💱 [PackageForm] Currency changed to:",f),i({currency:f})},onAmountChange:(f,h)=>{console.log("💰 [PackageForm] Amount changed to:",f),i({amountToCollect:f,amountToCollectFormatted:h})}}),c.jsx(r5,{description:a.description,onChange:f=>i({description:f})}),c.jsx("div",{className:"w-full",children:c.jsx(Ne,{type:"submit",disabled:l,className:"w-full",children:l?"Creando...":"Crear Encomienda"})})]})}function pV({open:r,onOpenChange:e,onSuccess:t,tripId:n}){const[a,i]=w.useState(""),[o,s]=w.useState(n||"");w.useEffect(()=>{r&&(i(""),s(n||""))},[r,n]);const l=()=>{i(""),s(n||""),t()},u=()=>{e(!1)};return c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[600px] max-h-[90vh] flex flex-col",children:[c.jsxs(Kr,{className:"flex-shrink-0",children:[c.jsx(Xr,{children:"Nueva Encomienda"}),c.jsx(sa,{children:"Completa la información para crear una nueva encomienda."})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4 min-h-0",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsx(Jw,{selectedCustomerId:a,onCustomerChange:i},r?"open":"closed"),c.jsx(wm,{selectedTripId:o,onTripChange:s,disabled:!!n})]}),c.jsx(hV,{customerId:a,tripId:o,onSuccess:l,onCancel:u})]})]})})}const mV=(r,e)=>{const t=r.route.split(" -> "),[n,a]=t;return{trip_date:pt(e,"yyyy-MM-dd"),origin:n,destination:a,flight_number:r.flight_number||null,traveler_id:r.traveler_id||null,status:"scheduled"}},gV=async r=>{if(r.flight_number){const{data:n}=await xe.from("trips").select("id").eq("flight_number",r.flight_number).eq("trip_date",r.trip_date).maybeSingle();if(n)throw new Error("FLIGHT_EXISTS")}const{data:e,error:t}=await xe.from("trips").insert(r).select().single();if(t)throw t;return e};function vV(){const{toast:r}=Lt();return{createFlightData:async t=>{if(console.log("=== INICIO createFlightData ==="),console.log("Datos del viaje recibidos:",t),!t.flight_number){console.log("No hay número de vuelo, saltando creación de flight_data");return}try{console.log("Creando flight_data para el vuelo:",t.flight_number),console.log("Verificando si existe flight_data...");const{data:n,error:a}=await xe.from("flight_data").select("id, flight_number").eq("flight_number",t.flight_number).maybeSingle();if(console.log("Resultado de verificación:",{existingFlight:n,checkError:a}),a)throw console.error("Error verificando flight_data existente:",a),a;if(n){console.log("Flight_data ya existe para el vuelo:",t.flight_number),r({title:"Viaje creado",description:"El viaje ha sido creado y el vuelo ya está siendo monitoreado"});return}const i=new Date(t.trip_date);i.setHours(6,0,0,0);const o=2*60*60*1e3,s=new Date(i.getTime()+o),l={flight_number:t.flight_number,departure_airport:t.origin,arrival_airport:t.destination,scheduled_departure:i.toISOString(),scheduled_arrival:s.toISOString(),status:"scheduled",has_landed:!1,notification_sent:!1,airline:"Avianca"};console.log("Insertando flight_data:",l);const{data:u,error:d}=await xe.from("flight_data").insert(l).select().single();if(console.log("Resultado de inserción:",{flightData:u,flightError:d}),d)throw console.error("Error creando flight_data:",d),r({title:"Viaje creado",description:`El viaje se creó pero hubo un error configurando el monitoreo: ${d.message}`,variant:"destructive"}),d;console.log("Flight_data creado exitosamente:",u),r({title:"Viaje creado",description:"El viaje ha sido creado y se ha iniciado el monitoreo del vuelo"})}catch(n){throw console.error("Error en createFlightData:",n),r({title:"Error en monitoreo",description:`No se pudo configurar el monitoreo del vuelo: ${n instanceof Error?n.message:"Error desconocido"}`,variant:"destructive"}),n}finally{console.log("=== FIN createFlightData ===")}}}}function xV(){const{toast:r}=Lt();return{validateForm:(t,n)=>t?n.route?n.traveler_id?!0:(r({title:"Error",description:"Por favor selecciona un viajero para el viaje",variant:"destructive"}),!1):(r({title:"Error",description:"Por favor selecciona una ruta para el viaje",variant:"destructive"}),!1):(r({title:"Error",description:"Por favor selecciona una fecha para el viaje",variant:"destructive"}),!1)}}function yV(r,e){const[t,n]=w.useState({route:"",flight_number:"",traveler_id:""}),[a,i]=w.useState(e),o=new Date,s=Gr(),{toast:l}=Lt(),{createFlightData:u}=vV(),{validateForm:d}=xV(),f=g=>{n(v=>({...v,...g}))},h=ln({mutationFn:async g=>await gV(g),onSuccess:async g=>{console.log("Trip created successfully:",g),g.flight_number?await u(g):l({title:"Viaje creado",description:"El viaje ha sido creado exitosamente"}),s.invalidateQueries({queryKey:["trips"]}),s.invalidateQueries({queryKey:["pending-flight-notifications"]}),n({route:"",flight_number:"",traveler_id:""}),i(void 0),r()},onError:g=>{if(console.error("Error creating trip:",g),g.message==="FLIGHT_EXISTS")l({title:"Número de vuelo ya existe",description:`Ya existe un viaje programado para ${pt(a,"dd/MM/yyyy")} con el número de vuelo ${t.flight_number}`,variant:"destructive"});else if(g.code==="23505"){const v=t.route.split(" -> "),[b,y]=v;l({title:"Viaje ya existe",description:`Ya existe un viaje programado para ${pt(a,"dd/MM/yyyy")} en la ruta ${b} → ${y}`,variant:"destructive"})}else l({title:"Error",description:"No se pudo crear el viaje. Por favor intente nuevamente.",variant:"destructive"})}}),p=g=>{if(g.preventDefault(),!d(a,t))return;const v=mV(t,a);console.log("Submitting trip data:",v),h.mutate(v)};return{formData:t,updateFormData:f,date:a,setDate:i,today:o,isLoading:h.isPending,handleSubmit:p}}var bV=typeof document<"u",wV=function(){},rh=bV?w.useLayoutEffect:wV;const _V={...oh},CV=_V.useInsertionEffect,NV=CV||(r=>r());function SV(r){const e=w.useRef(()=>{});return NV(()=>{e.current=r}),w.useCallback(function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return e.current==null?void 0:e.current(...n)},[])}const EV={...oh};let Ux=!1,AV=0;const qx=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+AV++;function jV(){const[r,e]=w.useState(()=>Ux?qx():void 0);return rh(()=>{r==null&&e(qx())},[]),w.useEffect(()=>{Ux=!0},[]),r}const PV=EV.useId,V4=PV||jV,DV=w.forwardRef(function(e,t){const{context:{placement:n,elements:{floating:a},middlewareData:{arrow:i,shift:o}},width:s=14,height:l=7,tipRadius:u=0,strokeWidth:d=0,staticOffset:f,stroke:h,d:p,style:{transform:g,...v}={},...b}=e,y=V4(),[C,S]=w.useState(!1);if(rh(()=>{if(!a)return;aN(a).direction==="rtl"&&S(!0)},[a]),!a)return null;const[j,D]=n.split("-"),F=j==="top"||j==="bottom";let M=f;(F&&o!=null&&o.x||!F&&o!=null&&o.y)&&(M=null);const T=d*2,q=T/2,J=s/2*(u/-8+1),O=l/2*u/4,k=!!p,H=M&&D==="end"?"bottom":"top";let X=M&&D==="end"?"right":"left";M&&C&&(X=D==="end"?"left":"right");const ce=i?.x!=null?M||i.x:"",Q=i?.y!=null?M||i.y:"",re=p||"M0,0"+(" H"+s)+(" L"+(s-J)+","+(l-O))+(" Q"+s/2+","+l+" "+J+","+(l-O))+" Z",G={top:k?"rotate(180deg)":"",left:k?"rotate(90deg)":"rotate(-90deg)",bottom:k?"":"rotate(180deg)",right:k?"rotate(-90deg)":"rotate(90deg)"}[j];return c.jsxs("svg",{...b,"aria-hidden":!0,ref:t,width:k?s:s+T,height:s,viewBox:"0 0 "+s+" "+(l>s?l:s),style:{position:"absolute",pointerEvents:"none",[X]:ce,[H]:Q,[j]:F||k?"100%":"calc(100% - "+T/2+"px)",transform:[G,g].filter(Y=>!!Y).join(" "),...v},children:[T>0&&c.jsx("path",{clipPath:"url(#"+y+")",fill:"none",stroke:h,strokeWidth:T+(p?0:1),d:re}),c.jsx("path",{stroke:T&&!p?b.fill:"none",d:re}),c.jsx("clipPath",{id:y,children:c.jsx("rect",{x:-q,y:q*(k?-1:1),width:s+T,height:s})})]})});function IV(){const r=new Map;return{emit(e,t){var n;(n=r.get(e))==null||n.forEach(a=>a(t))},on(e,t){r.has(e)||r.set(e,new Set),r.get(e).add(t)},off(e,t){var n;(n=r.get(e))==null||n.delete(t)}}}const TV=w.createContext(null),OV=w.createContext(null),kV=()=>{var r;return((r=w.useContext(TV))==null?void 0:r.id)||null},MV=()=>w.useContext(OV);function RV(r){const{open:e=!1,onOpenChange:t,elements:n}=r,a=V4(),i=w.useRef({}),[o]=w.useState(()=>IV()),s=kV()!=null,[l,u]=w.useState(n.reference),d=SV((p,g,v)=>{i.current.openEvent=p?g:void 0,o.emit("openchange",{open:p,event:g,reason:v,nested:s}),t?.(p,g,v)}),f=w.useMemo(()=>({setPositionReference:u}),[]),h=w.useMemo(()=>({reference:l||n.reference||null,floating:n.floating||null,domReference:n.reference}),[l,n.reference,n.floating]);return w.useMemo(()=>({dataRef:i,open:e,onOpenChange:d,elements:h,events:o,floatingId:a,refs:f}),[e,d,h,o,a,f])}function LV(r){r===void 0&&(r={});const{nodeId:e}=r,t=RV({...r,elements:{reference:null,floating:null,...r.elements}}),n=r.rootContext||t,a=n.elements,[i,o]=w.useState(null),[s,l]=w.useState(null),d=a?.domReference||i,f=w.useRef(null),h=MV();rh(()=>{d&&(f.current=d)},[d]);const p=iN({...r,elements:{...a,...s&&{reference:s}}}),g=w.useCallback(S=>{const j=Vd(S)?{getBoundingClientRect:()=>S.getBoundingClientRect(),getClientRects:()=>S.getClientRects(),contextElement:S}:S;l(j),p.refs.setReference(j)},[p.refs]),v=w.useCallback(S=>{(Vd(S)||S===null)&&(f.current=S,o(S)),(Vd(p.refs.reference.current)||p.refs.reference.current===null||S!==null&&!Vd(S))&&p.refs.setReference(S)},[p.refs]),b=w.useMemo(()=>({...p.refs,setReference:v,setPositionReference:g,domReference:f}),[p.refs,v,g]),y=w.useMemo(()=>({...p.elements,domReference:d}),[p.elements,d]),C=w.useMemo(()=>({...p,...n,refs:b,elements:y,nodeId:e}),[p,b,y,e,n]);return rh(()=>{n.dataRef.current.floatingContext=C;const S=h?.nodesRef.current.find(j=>j.id===e);S&&(S.context=C)}),w.useMemo(()=>({...p,context:C,refs:b,elements:y}),[p,b,y,C])}/*!
  react-datepicker v8.4.0
  https://github.com/Hacker0x01/react-datepicker
  Released under the MIT License.
*/var Lp=function(e,t){return Lp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,a){n.__proto__=a}||function(n,a){for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(n[i]=a[i])},Lp(e,t)};function bn(r,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Lp(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ht=function(){return Ht=Object.assign||function(t){for(var n,a=1,i=arguments.length;a<i;a++){n=arguments[a];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Ht.apply(this,arguments)};function ki(r,e,t){if(t||arguments.length===2)for(var n=0,a=e.length,i;n<a;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return r.concat(i||Array.prototype.slice.call(e))}var FV=function(r){var e=r.showTimeSelectOnly,t=e===void 0?!1:e,n=r.showTime,a=n===void 0?!1:n,i=r.className,o=r.children,s=t?"Choose Time":"Choose Date".concat(a?" and Time":"");return se.createElement("div",{className:i,role:"dialog","aria-label":s,"aria-modal":"true"},o)},BV=function(r,e){var t=w.useRef(null),n=w.useRef(r);n.current=r;var a=w.useCallback(function(i){var o,s=i.composed&&i.composedPath&&i.composedPath().find(function(l){return l instanceof Node})||i.target;t.current&&!t.current.contains(s)&&(e&&s instanceof HTMLElement&&s.classList.contains(e)||(o=n.current)===null||o===void 0||o.call(n,i))},[e]);return w.useEffect(function(){return document.addEventListener("mousedown",a),function(){document.removeEventListener("mousedown",a)}},[a]),t},Gh=function(r){var e=r.children,t=r.onClickOutside,n=r.className,a=r.containerRef,i=r.style,o=r.ignoreClass,s=BV(t,o);return se.createElement("div",{className:n,style:i,ref:function(l){s.current=l,a&&(a.current=l)}},e)},Ge;(function(r){r.ArrowUp="ArrowUp",r.ArrowDown="ArrowDown",r.ArrowLeft="ArrowLeft",r.ArrowRight="ArrowRight",r.PageUp="PageUp",r.PageDown="PageDown",r.Home="Home",r.End="End",r.Enter="Enter",r.Space=" ",r.Tab="Tab",r.Escape="Escape",r.Backspace="Backspace",r.X="x"})(Ge||(Ge={}));function z4(){var r=typeof window<"u"?window:globalThis;return r}var Qu=12;function er(r){if(r==null)return new Date;var e=typeof r=="string"?Go(r):Uy(r);return Yh(e)?e:new Date}function I1(r,e,t,n,a){a===void 0&&(a=er());for(var i=cl(t)||cl(Qg()),o=Array.isArray(e)?e:[e],s=0,l=o;s<l.length;s++){var u=l[s],d=yN(r,u,a,{locale:i,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});if(Yh(d)&&(!n||r===wr(d,u,t)))return d}return null}function Yh(r,e){return B1(r)&&!Wo(r,new Date("1/1/1800"))}function wr(r,e,t){if(t==="en")return pt(r,e,{useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0});var n=t?cl(t):void 0;return t&&!n&&console.warn('A locale object was not found for the provided string ["'.concat(t,'"].')),n=n||cl(Qg()),pt(r,e,{locale:n,useAdditionalWeekYearTokens:!0,useAdditionalDayOfYearTokens:!0})}function Fa(r,e){var t=e.dateFormat,n=e.locale,a=Array.isArray(t)&&t.length>0?t[0]:t;return r&&wr(r,a,n)||""}var H4=" - ";function $V(r,e,t){if(!r)return"";var n=Fa(r,t),a=e?Fa(e,t):"";return"".concat(n).concat(H4).concat(a)}function UV(r,e){if(!r?.length)return"";var t=r[0]?Fa(r[0],e):"";if(r.length===1)return t;if(r.length===2&&r[1]){var n=Fa(r[1],e);return"".concat(t,", ").concat(n)}var a=r.length-1;return"".concat(t," (+").concat(a,")")}function T1(r,e){var t=e.hour,n=t===void 0?0:t,a=e.minute,i=a===void 0?0:a,o=e.second,s=o===void 0?0:o;return gf(vf(xf(r,s),i),n)}function qV(r){return bN(r)}function VV(r,e){return wr(r,"ddd",e)}function Pf(r){return yu(r)}function Ho(r,e,t){var n=cl(e||Qg());return Ly(r,{locale:n,weekStartsOn:t})}function so(r){return sh(r)}function fu(r){return Qp(r)}function Vx(r){return wN(r)}function zx(){return yu(er())}function Hx(r){return qy(r)}function zV(r){return Fy(r)}function HV(r){return ch(r)}function Di(r,e){return r&&e?_N(r,e):!r&&!e}function Gn(r,e){return r&&e?My(r,e):!r&&!e}function nh(r,e){return r&&e?CN(r,e):!r&&!e}function zt(r,e){return r&&e?Ry(r,e):!r&&!e}function Ss(r,e){return r&&e?gN(r,e):!r&&!e}function hu(r,e,t){var n,a=yu(e),i=qy(t);try{n=bu(r,{start:a,end:i})}catch{n=!1}return n}function Qg(){var r=z4();return r.__localeId__}function cl(r){if(typeof r=="string"){var e=z4();return e.__localeData__?e.__localeData__[r]:void 0}else return r}function WV(r,e,t){return e(wr(r,"EEEE",t))}function GV(r,e){return wr(r,"EEEEEE",e)}function YV(r,e){return wr(r,"EEE",e)}function Zg(r,e){return wr(li(er(),r),"LLLL",e)}function W4(r,e){return wr(li(er(),r),"LLL",e)}function KV(r,e){return wr(kc(er(),r),"QQQ",e)}function Ba(r,e){var t=e===void 0?{}:e,n=t.minDate,a=t.maxDate,i=t.excludeDates,o=t.excludeDateIntervals,s=t.includeDates,l=t.includeDateIntervals,u=t.filterDate;return Zu(r,{minDate:n,maxDate:a})||i&&i.some(function(d){return d instanceof Date?zt(r,d):zt(r,d.date)})||o&&o.some(function(d){var f=d.start,h=d.end;return bu(r,{start:f,end:h})})||s&&!s.some(function(d){return zt(r,d)})||l&&!l.some(function(d){var f=d.start,h=d.end;return bu(r,{start:f,end:h})})||u&&!u(er(r))||!1}function Jg(r,e){var t=e===void 0?{}:e,n=t.excludeDates,a=t.excludeDateIntervals;return a&&a.length>0?a.some(function(i){var o=i.start,s=i.end;return bu(r,{start:o,end:s})}):n&&n.some(function(i){var o;return i instanceof Date?zt(r,i):zt(r,(o=i.date)!==null&&o!==void 0?o:new Date)})||!1}function G4(r,e){var t=e===void 0?{}:e,n=t.minDate,a=t.maxDate,i=t.excludeDates,o=t.includeDates,s=t.filterDate;return Zu(r,{minDate:n?sh(n):void 0,maxDate:a?ch(a):void 0})||i?.some(function(l){return Gn(r,l instanceof Date?l:l.date)})||o&&!o.some(function(l){return Gn(r,l)})||s&&!s(er(r))||!1}function df(r,e,t,n){var a=Dt(r),i=Mn(r),o=Dt(e),s=Mn(e),l=Dt(n);return a===o&&a===l?i<=t&&t<=s:a<o?l===a&&i<=t||l===o&&s>=t||l<o&&l>a:!1}function XV(r,e){var t=e===void 0?{}:e,n=t.minDate,a=t.maxDate,i=t.excludeDates,o=t.includeDates;return Zu(r,{minDate:n,maxDate:a})||i&&i.some(function(s){return Gn(s instanceof Date?s:s.date,r)})||o&&!o.some(function(s){return Gn(s,r)})||!1}function ff(r,e){var t=e===void 0?{}:e,n=t.minDate,a=t.maxDate,i=t.excludeDates,o=t.includeDates,s=t.filterDate;return Zu(r,{minDate:n,maxDate:a})||i?.some(function(l){return nh(r,l instanceof Date?l:l.date)})||o&&!o.some(function(l){return nh(r,l)})||s&&!s(er(r))||!1}function hf(r,e,t){if(!e||!t||!B1(e)||!B1(t))return!1;var n=Dt(e),a=Dt(t);return n<=r&&a>=r}function Df(r,e){var t=e===void 0?{}:e,n=t.minDate,a=t.maxDate,i=t.excludeDates,o=t.includeDates,s=t.filterDate,l=new Date(r,0,1);return Zu(l,{minDate:n?Qp(n):void 0,maxDate:a?Vy(a):void 0})||i?.some(function(u){return Di(l,u instanceof Date?u:u.date)})||o&&!o.some(function(u){return Di(l,u)})||s&&!s(er(l))||!1}function pf(r,e,t,n){var a=Dt(r),i=pu(r),o=Dt(e),s=pu(e),l=Dt(n);return a===o&&a===l?i<=t&&t<=s:a<o?l===a&&i<=t||l===o&&s>=t||l<o&&l>a:!1}function Zu(r,e){var t,n=e===void 0?{}:e,a=n.minDate,i=n.maxDate;return(t=a&&If(r,a)<0||i&&If(r,i)>0)!==null&&t!==void 0?t:!1}function Wx(r,e){return e.some(function(t){return ro(t)===ro(r)&&no(t)===no(r)&&Fo(t)===Fo(r)})}function Gx(r,e){var t=e===void 0?{}:e,n=t.excludeTimes,a=t.includeTimes,i=t.filterTime;return n&&Wx(r,n)||a&&!Wx(r,a)||i&&!i(r)||!1}function Yx(r,e){var t=e.minTime,n=e.maxTime;if(!t||!n)throw new Error("Both minTime and maxTime props required");var a=er();a=gf(a,ro(r)),a=vf(a,no(r)),a=xf(a,Fo(r));var i=er();i=gf(i,ro(t)),i=vf(i,no(t)),i=xf(i,Fo(t));var o=er();o=gf(o,ro(n)),o=vf(o,no(n)),o=xf(o,Fo(n));var s;try{s=!bu(a,{start:i,end:o})}catch{s=!1}return s}function Kx(r,e){var t=e===void 0?{}:e,n=t.minDate,a=t.includeDates,i=Ro(r,1);return n&&Tf(n,i)>0||a&&a.every(function(o){return Tf(o,i)>0})||!1}function Xx(r,e){var t=e===void 0?{}:e,n=t.maxDate,a=t.includeDates,i=co(r,1);return n&&Tf(i,n)>0||a&&a.every(function(o){return Tf(i,o)>0})||!1}function QV(r,e){var t=e===void 0?{}:e,n=t.minDate,a=t.includeDates,i=Qp(r),o=By(i,1);return n&&Of(n,o)>0||a&&a.every(function(s){return Of(s,o)>0})||!1}function ZV(r,e){var t=e===void 0?{}:e,n=t.maxDate,a=t.includeDates,i=Vy(r),o=$y(i,1);return n&&Of(o,n)>0||a&&a.every(function(s){return Of(o,s)>0})||!1}function Qx(r,e){var t=e===void 0?{}:e,n=t.minDate,a=t.includeDates,i=Zc(r,1);return n&&kf(n,i)>0||a&&a.every(function(o){return kf(o,i)>0})||!1}function JV(r,e){var t=e===void 0?{}:e,n=t.minDate,a=t.yearItemNumber,i=a===void 0?Qu:a,o=fu(Zc(r,i)),s=Mo(o,i).endPeriod,l=n&&Dt(n);return l&&l>s||!1}function Zx(r,e){var t=e===void 0?{}:e,n=t.maxDate,a=t.includeDates,i=Bo(r,1);return n&&kf(i,n)>0||a&&a.every(function(o){return kf(i,o)>0})||!1}function ez(r,e){var t=e===void 0?{}:e,n=t.maxDate,a=t.yearItemNumber,i=a===void 0?Qu:a,o=Bo(r,i),s=Mo(o,i).startPeriod,l=n&&Dt(n);return l&&l<s||!1}function Y4(r){var e=r.minDate,t=r.includeDates;if(t&&e){var n=t.filter(function(a){return If(a,e)>=0});return Dv(n)}else return t?Dv(t):e}function K4(r){var e=r.maxDate,t=r.includeDates;if(t&&e){var n=t.filter(function(a){return If(a,e)<=0});return Iv(n)}else return t?Iv(t):e}function Jx(r,e){var t;r===void 0&&(r=[]),e===void 0&&(e="react-datepicker__day--highlighted");for(var n=new Map,a=0,i=r.length;a<i;a++){var o=r[a];if(Lo(o)){var s=wr(o,"MM.dd.yyyy"),l=n.get(s)||[];l.includes(e)||(l.push(e),n.set(s,l))}else if(typeof o=="object"){var u=Object.keys(o),d=(t=u[0])!==null&&t!==void 0?t:"",f=o[d];if(typeof d=="string"&&Array.isArray(f))for(var h=0,p=f.length;h<p;h++){var g=f[h];if(g){var s=wr(g,"MM.dd.yyyy"),l=n.get(s)||[];l.includes(d)||(l.push(d),n.set(s,l))}}}}return n}function tz(r,e){return r.length!==e.length?!1:r.every(function(t,n){return t===e[n]})}function rz(r,e){r===void 0&&(r=[]),e===void 0&&(e="react-datepicker__day--holidays");var t=new Map;return r.forEach(function(n){var a=n.date,i=n.holidayName;if(Lo(a)){var o=wr(a,"MM.dd.yyyy"),s=t.get(o)||{className:"",holidayNames:[]};if(!("className"in s&&s.className===e&&tz(s.holidayNames,[i]))){s.className=e;var l=s.holidayNames;s.holidayNames=l?ki(ki([],l,!0),[i],!1):[i],t.set(o,s)}}}),t}function nz(r,e,t,n,a){for(var i=a.length,o=[],s=0;s<i;s++){var l=r,u=a[s];u&&(l=NN(l,ro(u)),l=F1(l,no(u)),l=SN(l,Fo(u)));var d=F1(r,(t+1)*n);Yo(l,e)&&Wo(l,d)&&u!=null&&o.push(u)}return o}function ey(r){return r<10?"0".concat(r):"".concat(r)}function Mo(r,e){e===void 0&&(e=Qu);var t=Math.ceil(Dt(r)/e)*e,n=t-(e-1);return{startPeriod:n,endPeriod:t}}function az(r){var e=new Date(r.getFullYear(),r.getMonth(),r.getDate()),t=new Date(r.getFullYear(),r.getMonth(),r.getDate(),24);return Math.round((+t-+e)/36e5)}function ty(r){var e=r.getSeconds(),t=r.getMilliseconds();return Uy(r.getTime()-e*1e3-t)}function iz(r,e){return ty(r).getTime()===ty(e).getTime()}function ry(r){if(!Lo(r))throw new Error("Invalid date");var e=new Date(r);return e.setHours(0,0,0,0),e}function ny(r,e){if(!Lo(r)||!Lo(e))throw new Error("Invalid date received");var t=ry(r),n=ry(e);return Wo(t,n)}function X4(r){return r.key===Ge.Space}var oz=function(r){bn(e,r);function e(t){var n=r.call(this,t)||this;return n.inputRef=se.createRef(),n.onTimeChange=function(a){var i,o;n.setState({time:a});var s=n.props.date,l=s instanceof Date&&!isNaN(+s),u=l?s:new Date;if(a?.includes(":")){var d=a.split(":"),f=d[0],h=d[1];u.setHours(Number(f)),u.setMinutes(Number(h))}(o=(i=n.props).onChange)===null||o===void 0||o.call(i,u)},n.renderTimeInput=function(){var a=n.state.time,i=n.props,o=i.date,s=i.timeString,l=i.customTimeInput;return l?w.cloneElement(l,{date:o,value:a,onChange:n.onTimeChange}):se.createElement("input",{type:"time",className:"react-datepicker-time__input",placeholder:"Time",name:"time-input",ref:n.inputRef,onClick:function(){var u;(u=n.inputRef.current)===null||u===void 0||u.focus()},required:!0,value:a,onChange:function(u){n.onTimeChange(u.target.value||s)}})},n.state={time:n.props.timeString},n}return e.getDerivedStateFromProps=function(t,n){return t.timeString!==n.time?{time:t.timeString}:null},e.prototype.render=function(){return se.createElement("div",{className:"react-datepicker__input-time-container"},se.createElement("div",{className:"react-datepicker-time__caption"},this.props.timeInputLabel),se.createElement("div",{className:"react-datepicker-time__input-container"},se.createElement("div",{className:"react-datepicker-time__input"},this.renderTimeInput())))},e}(w.Component),sz=function(r){bn(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.dayEl=w.createRef(),t.handleClick=function(n){!t.isDisabled()&&t.props.onClick&&t.props.onClick(n)},t.handleMouseEnter=function(n){!t.isDisabled()&&t.props.onMouseEnter&&t.props.onMouseEnter(n)},t.handleOnKeyDown=function(n){var a,i,o=n.key;o===Ge.Space&&(n.preventDefault(),n.key=Ge.Enter),(i=(a=t.props).handleOnKeyDown)===null||i===void 0||i.call(a,n)},t.isSameDay=function(n){return zt(t.props.day,n)},t.isKeyboardSelected=function(){var n;if(t.props.disabledKeyboardNavigation)return!1;var a=t.props.selectsMultiple?(n=t.props.selectedDates)===null||n===void 0?void 0:n.some(function(o){return t.isSameDayOrWeek(o)}):t.isSameDayOrWeek(t.props.selected),i=t.props.preSelection&&t.isDisabled(t.props.preSelection);return!a&&t.isSameDayOrWeek(t.props.preSelection)&&!i},t.isDisabled=function(n){return n===void 0&&(n=t.props.day),Ba(n,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(){return Jg(t.props.day,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.isStartOfWeek=function(){return zt(t.props.day,Ho(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameWeek=function(n){return t.props.showWeekPicker&&zt(n,Ho(t.props.day,t.props.locale,t.props.calendarStartDay))},t.isSameDayOrWeek=function(n){return t.isSameDay(n)||t.isSameWeek(n)},t.getHighLightedClass=function(){var n=t.props,a=n.day,i=n.highlightDates;if(!i)return!1;var o=wr(a,"MM.dd.yyyy");return i.get(o)},t.getHolidaysClass=function(){var n,a=t.props,i=a.day,o=a.holidays;if(!o)return[void 0];var s=wr(i,"MM.dd.yyyy");return o.has(s)?[(n=o.get(s))===null||n===void 0?void 0:n.className]:[void 0]},t.isInRange=function(){var n=t.props,a=n.day,i=n.startDate,o=n.endDate;return!i||!o?!1:hu(a,i,o)},t.isInSelectingRange=function(){var n,a=t.props,i=a.day,o=a.selectsStart,s=a.selectsEnd,l=a.selectsRange,u=a.selectsDisabledDaysInRange,d=a.startDate,f=a.endDate,h=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return!(o||s||l)||!h||!u&&t.isDisabled()?!1:o&&f&&(Wo(h,f)||Ss(h,f))?hu(i,h,f):s&&d&&(Yo(h,d)||Ss(h,d))||l&&d&&!f&&(Yo(h,d)||Ss(h,d))?hu(i,d,h):!1},t.isSelectingRangeStart=function(){var n;if(!t.isInSelectingRange())return!1;var a=t.props,i=a.day,o=a.startDate,s=a.selectsStart,l=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return s?zt(i,l):zt(i,o)},t.isSelectingRangeEnd=function(){var n;if(!t.isInSelectingRange())return!1;var a=t.props,i=a.day,o=a.endDate,s=a.selectsEnd,l=a.selectsRange,u=(n=t.props.selectingDate)!==null&&n!==void 0?n:t.props.preSelection;return s||l?zt(i,u):zt(i,o)},t.isRangeStart=function(){var n=t.props,a=n.day,i=n.startDate,o=n.endDate;return!i||!o?!1:zt(i,a)},t.isRangeEnd=function(){var n=t.props,a=n.day,i=n.startDate,o=n.endDate;return!i||!o?!1:zt(o,a)},t.isWeekend=function(){var n=vN(t.props.day);return n===0||n===6},t.isAfterMonth=function(){return t.props.month!==void 0&&(t.props.month+1)%12===Mn(t.props.day)},t.isBeforeMonth=function(){return t.props.month!==void 0&&(Mn(t.props.day)+1)%12===t.props.month},t.isCurrentDay=function(){return t.isSameDay(er())},t.isSelected=function(){var n;return t.props.selectsMultiple?(n=t.props.selectedDates)===null||n===void 0?void 0:n.some(function(a){return t.isSameDayOrWeek(a)}):t.isSameDayOrWeek(t.props.selected)},t.getClassNames=function(n){var a=t.props.dayClassName?t.props.dayClassName(n):void 0;return sn("react-datepicker__day",a,"react-datepicker__day--"+VV(t.props.day),{"react-datepicker__day--disabled":t.isDisabled(),"react-datepicker__day--excluded":t.isExcluded(),"react-datepicker__day--selected":t.isSelected(),"react-datepicker__day--keyboard-selected":t.isKeyboardSelected(),"react-datepicker__day--range-start":t.isRangeStart(),"react-datepicker__day--range-end":t.isRangeEnd(),"react-datepicker__day--in-range":t.isInRange(),"react-datepicker__day--in-selecting-range":t.isInSelectingRange(),"react-datepicker__day--selecting-range-start":t.isSelectingRangeStart(),"react-datepicker__day--selecting-range-end":t.isSelectingRangeEnd(),"react-datepicker__day--today":t.isCurrentDay(),"react-datepicker__day--weekend":t.isWeekend(),"react-datepicker__day--outside-month":t.isAfterMonth()||t.isBeforeMonth()},t.getHighLightedClass(),t.getHolidaysClass())},t.getAriaLabel=function(){var n=t.props,a=n.day,i=n.ariaLabelPrefixWhenEnabled,o=i===void 0?"Choose":i,s=n.ariaLabelPrefixWhenDisabled,l=s===void 0?"Not available":s,u=t.isDisabled()||t.isExcluded()?l:o;return"".concat(u," ").concat(wr(a,"PPPP",t.props.locale))},t.getTitle=function(){var n=t.props,a=n.day,i=n.holidays,o=i===void 0?new Map:i,s=n.excludeDates,l=wr(a,"MM.dd.yyyy"),u=[];return o.has(l)&&u.push.apply(u,o.get(l).holidayNames),t.isExcluded()&&u.push(s?.filter(function(d){return d instanceof Date?zt(d,a):zt(d?.date,a)}).map(function(d){if(!(d instanceof Date))return d?.message})),u.join(", ")},t.getTabIndex=function(){var n=t.props.selected,a=t.props.preSelection,i=!(t.props.showWeekPicker&&(t.props.showWeekNumber||!t.isStartOfWeek()))&&(t.isKeyboardSelected()||t.isSameDay(n)&&zt(a,n))?0:-1;return i},t.handleFocusDay=function(){var n;t.shouldFocusDay()&&((n=t.dayEl.current)===null||n===void 0||n.focus({preventScroll:!0}))},t.renderDayContents=function(){return t.props.monthShowsDuplicateDaysEnd&&t.isAfterMonth()||t.props.monthShowsDuplicateDaysStart&&t.isBeforeMonth()?null:t.props.renderDayContents?t.props.renderDayContents(Pv(t.props.day),t.props.day):Pv(t.props.day)},t.render=function(){return se.createElement("div",{ref:t.dayEl,className:t.getClassNames(t.props.day),onKeyDown:t.handleOnKeyDown,onClick:t.handleClick,onMouseEnter:t.props.usePointerEvent?void 0:t.handleMouseEnter,onPointerEnter:t.props.usePointerEvent?t.handleMouseEnter:void 0,tabIndex:t.getTabIndex(),"aria-label":t.getAriaLabel(),role:"option",title:t.getTitle(),"aria-disabled":t.isDisabled(),"aria-current":t.isCurrentDay()?"date":void 0,"aria-selected":t.isSelected()||t.isInRange()},t.renderDayContents(),t.getTitle()!==""&&se.createElement("span",{className:"overlay"},t.getTitle()))},t}return e.prototype.componentDidMount=function(){this.handleFocusDay()},e.prototype.componentDidUpdate=function(){this.handleFocusDay()},e.prototype.shouldFocusDay=function(){var t=!1;return this.getTabIndex()===0&&this.isSameDay(this.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(t=!0),this.props.inline&&!this.props.shouldFocusDayInline&&(t=!1),this.isDayActiveElement()&&(t=!0),this.isDuplicateDay()&&(t=!1)),t},e.prototype.isDayActiveElement=function(){var t,n,a;return((n=(t=this.props.containerRef)===null||t===void 0?void 0:t.current)===null||n===void 0?void 0:n.contains(document.activeElement))&&((a=document.activeElement)===null||a===void 0?void 0:a.classList.contains("react-datepicker__day"))},e.prototype.isDuplicateDay=function(){return this.props.monthShowsDuplicateDaysEnd&&this.isAfterMonth()||this.props.monthShowsDuplicateDaysStart&&this.isBeforeMonth()},e}(w.Component),cz=function(r){bn(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.weekNumberEl=w.createRef(),t.handleClick=function(n){t.props.onClick&&t.props.onClick(n)},t.handleOnKeyDown=function(n){var a,i,o=n.key;o===Ge.Space&&(n.preventDefault(),n.key=Ge.Enter),(i=(a=t.props).handleOnKeyDown)===null||i===void 0||i.call(a,n)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!zt(t.props.date,t.props.selected)&&zt(t.props.date,t.props.preSelection)},t.getTabIndex=function(){return t.props.showWeekPicker&&t.props.showWeekNumber&&(t.isKeyboardSelected()||zt(t.props.date,t.props.selected)&&zt(t.props.preSelection,t.props.selected))?0:-1},t.handleFocusWeekNumber=function(n){var a=!1;t.getTabIndex()===0&&!n?.isInputFocused&&zt(t.props.date,t.props.preSelection)&&((!document.activeElement||document.activeElement===document.body)&&(a=!0),t.props.inline&&!t.props.shouldFocusDayInline&&(a=!1),t.props.containerRef&&t.props.containerRef.current&&t.props.containerRef.current.contains(document.activeElement)&&document.activeElement&&document.activeElement.classList.contains("react-datepicker__week-number")&&(a=!0)),a&&t.weekNumberEl.current&&t.weekNumberEl.current.focus({preventScroll:!0})},t}return Object.defineProperty(e,"defaultProps",{get:function(){return{ariaLabelPrefix:"week "}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){this.handleFocusWeekNumber()},e.prototype.componentDidUpdate=function(t){this.handleFocusWeekNumber(t)},e.prototype.render=function(){var t=this.props,n=t.weekNumber,a=t.isWeekDisabled,i=t.ariaLabelPrefix,o=i===void 0?e.defaultProps.ariaLabelPrefix:i,s=t.onClick,l={"react-datepicker__week-number":!0,"react-datepicker__week-number--clickable":!!s&&!a,"react-datepicker__week-number--selected":!!s&&zt(this.props.date,this.props.selected)};return se.createElement("div",{ref:this.weekNumberEl,className:sn(l),"aria-label":"".concat(o," ").concat(this.props.weekNumber),onClick:this.handleClick,onKeyDown:this.handleOnKeyDown,tabIndex:this.getTabIndex()},n)},e}(w.Component),lz=function(r){bn(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isDisabled=function(n){return Ba(n,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.handleDayClick=function(n,a){t.props.onDayClick&&t.props.onDayClick(n,a)},t.handleDayMouseEnter=function(n){t.props.onDayMouseEnter&&t.props.onDayMouseEnter(n)},t.handleWeekClick=function(n,a,i){for(var o,s,l,u=new Date(n),d=0;d<7;d++){var f=new Date(n);f.setDate(f.getDate()+d);var h=!t.isDisabled(f);if(h){u=f;break}}typeof t.props.onWeekSelect=="function"&&t.props.onWeekSelect(u,a,i),t.props.showWeekPicker&&t.handleDayClick(u,i),((o=t.props.shouldCloseOnSelect)!==null&&o!==void 0?o:e.defaultProps.shouldCloseOnSelect)&&((l=(s=t.props).setOpen)===null||l===void 0||l.call(s,!1))},t.formatWeekNumber=function(n){return t.props.formatWeekNumber?t.props.formatWeekNumber(n):qV(n)},t.isWeekDisabled=function(){for(var n=t.startOfWeek(),a=Es(n,6),i=new Date(n);i<=a;){if(!t.isDisabled(i))return!1;i=Es(i,1)}return!0},t.renderDays=function(){var n=t.startOfWeek(),a=[],i=t.formatWeekNumber(n);if(t.props.showWeekNumber){var o=t.props.onWeekSelect||t.props.showWeekPicker?t.handleWeekClick.bind(t,n,i):void 0;a.push(se.createElement(cz,Ht({key:"W"},e.defaultProps,t.props,{weekNumber:i,isWeekDisabled:t.isWeekDisabled(),date:n,onClick:o})))}return a.concat([0,1,2,3,4,5,6].map(function(s){var l=Es(n,s);return se.createElement(sz,Ht({},e.defaultProps,t.props,{ariaLabelPrefixWhenEnabled:t.props.chooseDayAriaLabelPrefix,ariaLabelPrefixWhenDisabled:t.props.disabledDayAriaLabelPrefix,key:l.valueOf(),day:l,onClick:t.handleDayClick.bind(t,l),onMouseEnter:t.handleDayMouseEnter.bind(t,l)}))}))},t.startOfWeek=function(){return Ho(t.props.day,t.props.locale,t.props.calendarStartDay)},t.isKeyboardSelected=function(){return!t.props.disabledKeyboardNavigation&&!zt(t.startOfWeek(),t.props.selected)&&zt(t.startOfWeek(),t.props.preSelection)},t}return Object.defineProperty(e,"defaultProps",{get:function(){return{shouldCloseOnSelect:!0}},enumerable:!1,configurable:!0}),e.prototype.render=function(){var t={"react-datepicker__week":!0,"react-datepicker__week--selected":zt(this.startOfWeek(),this.props.selected),"react-datepicker__week--keyboard-selected":this.isKeyboardSelected()};return se.createElement("div",{className:sn(t)},this.renderDays())},e}(w.Component),ou,uz=6,Qc={TWO_COLUMNS:"two_columns",THREE_COLUMNS:"three_columns",FOUR_COLUMNS:"four_columns"},O1=(ou={},ou[Qc.TWO_COLUMNS]={grid:[[0,1],[2,3],[4,5],[6,7],[8,9],[10,11]],verticalNavigationOffset:2},ou[Qc.THREE_COLUMNS]={grid:[[0,1,2],[3,4,5],[6,7,8],[9,10,11]],verticalNavigationOffset:3},ou[Qc.FOUR_COLUMNS]={grid:[[0,1,2,3],[4,5,6,7],[8,9,10,11]],verticalNavigationOffset:4},ou),mf=1;function ay(r,e){return r?Qc.FOUR_COLUMNS:e?Qc.TWO_COLUMNS:Qc.THREE_COLUMNS}var dz=function(r){bn(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.MONTH_REFS=ki([],Array(12),!0).map(function(){return w.createRef()}),t.QUARTER_REFS=ki([],Array(4),!0).map(function(){return w.createRef()}),t.isDisabled=function(n){return Ba(n,{minDate:t.props.minDate,maxDate:t.props.maxDate,excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals,includeDateIntervals:t.props.includeDateIntervals,includeDates:t.props.includeDates,filterDate:t.props.filterDate})},t.isExcluded=function(n){return Jg(n,{excludeDates:t.props.excludeDates,excludeDateIntervals:t.props.excludeDateIntervals})},t.handleDayClick=function(n,a){var i,o;(o=(i=t.props).onDayClick)===null||o===void 0||o.call(i,n,a,t.props.orderInDisplay)},t.handleDayMouseEnter=function(n){var a,i;(i=(a=t.props).onDayMouseEnter)===null||i===void 0||i.call(a,n)},t.handleMouseLeave=function(){var n,a;(a=(n=t.props).onMouseLeave)===null||a===void 0||a.call(n)},t.isRangeStartMonth=function(n){var a=t.props,i=a.day,o=a.startDate,s=a.endDate;return!o||!s?!1:Gn(li(i,n),o)},t.isRangeStartQuarter=function(n){var a=t.props,i=a.day,o=a.startDate,s=a.endDate;return!o||!s?!1:nh(kc(i,n),o)},t.isRangeEndMonth=function(n){var a=t.props,i=a.day,o=a.startDate,s=a.endDate;return!o||!s?!1:Gn(li(i,n),s)},t.isRangeEndQuarter=function(n){var a=t.props,i=a.day,o=a.startDate,s=a.endDate;return!o||!s?!1:nh(kc(i,n),s)},t.isInSelectingRangeMonth=function(n){var a,i=t.props,o=i.day,s=i.selectsStart,l=i.selectsEnd,u=i.selectsRange,d=i.startDate,f=i.endDate,h=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(s||l||u)||!h?!1:s&&f?df(h,f,n,o):l&&d||u&&d&&!f?df(d,h,n,o):!1},t.isSelectingMonthRangeStart=function(n){var a;if(!t.isInSelectingRangeMonth(n))return!1;var i=t.props,o=i.day,s=i.startDate,l=i.selectsStart,u=li(o,n),d=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return l?Gn(u,d):Gn(u,s)},t.isSelectingMonthRangeEnd=function(n){var a;if(!t.isInSelectingRangeMonth(n))return!1;var i=t.props,o=i.day,s=i.endDate,l=i.selectsEnd,u=i.selectsRange,d=li(o,n),f=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return l||u?Gn(d,f):Gn(d,s)},t.isInSelectingRangeQuarter=function(n){var a,i=t.props,o=i.day,s=i.selectsStart,l=i.selectsEnd,u=i.selectsRange,d=i.startDate,f=i.endDate,h=(a=t.props.selectingDate)!==null&&a!==void 0?a:t.props.preSelection;return!(s||l||u)||!h?!1:s&&f?pf(h,f,n,o):l&&d||u&&d&&!f?pf(d,h,n,o):!1},t.isWeekInMonth=function(n){var a=t.props.day,i=Es(n,6);return Gn(n,a)||Gn(i,a)},t.isCurrentMonth=function(n,a){return Dt(n)===Dt(er())&&a===Mn(er())},t.isCurrentQuarter=function(n,a){return Dt(n)===Dt(er())&&a===pu(er())},t.isSelectedMonth=function(n,a,i){return Mn(i)===a&&Dt(n)===Dt(i)},t.isSelectMonthInList=function(n,a,i){return i.some(function(o){return t.isSelectedMonth(n,a,o)})},t.isSelectedQuarter=function(n,a,i){return pu(n)===a&&Dt(n)===Dt(i)},t.isMonthSelected=function(){var n=t.props,a=n.day,i=n.selected,o=n.selectedDates,s=n.selectsMultiple,l=Mn(a);return s?o?.some(function(u){return t.isSelectedMonth(a,l,u)}):!!i&&t.isSelectedMonth(a,l,i)},t.renderWeeks=function(){for(var n=[],a=t.props.fixedHeight,i=0,o=!1,s=Ho(so(t.props.day),t.props.locale,t.props.calendarStartDay),l=function(g){return t.props.showWeekPicker?Ho(g,t.props.locale,t.props.calendarStartDay):t.props.preSelection},u=function(g){return t.props.showWeekPicker?Ho(g,t.props.locale,t.props.calendarStartDay):t.props.selected},d=t.props.selected?u(t.props.selected):void 0,f=t.props.preSelection?l(t.props.preSelection):void 0;n.push(se.createElement(lz,Ht({},t.props,{ariaLabelPrefix:t.props.weekAriaLabelPrefix,key:i,day:s,month:Mn(t.props.day),onDayClick:t.handleDayClick,onDayMouseEnter:t.handleDayMouseEnter,selected:d,preSelection:f,showWeekNumber:t.props.showWeekNumbers}))),!o;){i++,s=R1(s,1);var h=a&&i>=uz,p=!a&&!t.isWeekInMonth(s);if(h||p)if(t.props.peekNextMonth)o=!0;else break}return n},t.onMonthClick=function(n,a){var i=t.isMonthDisabledForLabelDate(a),o=i.isDisabled,s=i.labelDate;o||t.handleDayClick(so(s),n)},t.onMonthMouseEnter=function(n){var a=t.isMonthDisabledForLabelDate(n),i=a.isDisabled,o=a.labelDate;i||t.handleDayMouseEnter(so(o))},t.handleMonthNavigation=function(n,a){var i,o,s,l;(o=(i=t.props).setPreSelection)===null||o===void 0||o.call(i,a),(l=(s=t.MONTH_REFS[n])===null||s===void 0?void 0:s.current)===null||l===void 0||l.focus()},t.handleKeyboardNavigation=function(n,a,i){var o,s=t.props,l=s.selected,u=s.preSelection,d=s.setPreSelection,f=s.minDate,h=s.maxDate,p=s.showFourColumnMonthYearPicker,g=s.showTwoColumnMonthYearPicker;if(u){var v=ay(p,g),b=t.getVerticalOffset(v),y=(o=O1[v])===null||o===void 0?void 0:o.grid,C=function(M,T,q){var J,O,k=T,H=q;switch(M){case Ge.ArrowRight:k=co(T,mf),H=q===11?0:q+mf;break;case Ge.ArrowLeft:k=Ro(T,mf),H=q===0?11:q-mf;break;case Ge.ArrowUp:k=Ro(T,b),H=!((J=y?.[0])===null||J===void 0)&&J.includes(q)?q+12-b:q-b;break;case Ge.ArrowDown:k=co(T,b),H=!((O=y?.[y.length-1])===null||O===void 0)&&O.includes(q)?q-12+b:q+b;break}return{newCalculatedDate:k,newCalculatedMonth:H}},S=function(M,T,q){for(var J=40,O=M,k=!1,H=0,X=C(O,T,q),ce=X.newCalculatedDate,Q=X.newCalculatedMonth;!k;){if(H>=J){ce=T,Q=q;break}if(f&&ce<f){O=Ge.ArrowRight;var re=C(O,ce,Q);ce=re.newCalculatedDate,Q=re.newCalculatedMonth}if(h&&ce>h){O=Ge.ArrowLeft;var re=C(O,ce,Q);ce=re.newCalculatedDate,Q=re.newCalculatedMonth}if(XV(ce,t.props)){var re=C(O,ce,Q);ce=re.newCalculatedDate,Q=re.newCalculatedMonth}else k=!0;H++}return{newCalculatedDate:ce,newCalculatedMonth:Q}};if(a===Ge.Enter){t.isMonthDisabled(i)||(t.onMonthClick(n,i),d?.(l));return}var j=S(a,u,i),D=j.newCalculatedDate,F=j.newCalculatedMonth;switch(a){case Ge.ArrowRight:case Ge.ArrowLeft:case Ge.ArrowUp:case Ge.ArrowDown:t.handleMonthNavigation(F,D);break}}},t.getVerticalOffset=function(n){var a,i;return(i=(a=O1[n])===null||a===void 0?void 0:a.verticalNavigationOffset)!==null&&i!==void 0?i:0},t.onMonthKeyDown=function(n,a){var i=t.props,o=i.disabledKeyboardNavigation,s=i.handleOnMonthKeyDown,l=n.key;l!==Ge.Tab&&n.preventDefault(),o||t.handleKeyboardNavigation(n,l,a),s&&s(n)},t.onQuarterClick=function(n,a){var i=kc(t.props.day,a);ff(i,t.props)||t.handleDayClick(Vx(i),n)},t.onQuarterMouseEnter=function(n){var a=kc(t.props.day,n);ff(a,t.props)||t.handleDayMouseEnter(Vx(a))},t.handleQuarterNavigation=function(n,a){var i,o,s,l;t.isDisabled(a)||t.isExcluded(a)||((o=(i=t.props).setPreSelection)===null||o===void 0||o.call(i,a),(l=(s=t.QUARTER_REFS[n-1])===null||s===void 0?void 0:s.current)===null||l===void 0||l.focus())},t.onQuarterKeyDown=function(n,a){var i,o,s=n.key;if(!t.props.disabledKeyboardNavigation)switch(s){case Ge.Enter:t.onQuarterClick(n,a),(o=(i=t.props).setPreSelection)===null||o===void 0||o.call(i,t.props.selected);break;case Ge.ArrowRight:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===4?1:a+1,$y(t.props.preSelection,1));break;case Ge.ArrowLeft:if(!t.props.preSelection)break;t.handleQuarterNavigation(a===1?4:a-1,By(t.props.preSelection,1));break}},t.isMonthDisabledForLabelDate=function(n){var a,i=t.props,o=i.day,s=i.minDate,l=i.maxDate,u=i.excludeDates,d=i.includeDates,f=li(o,n);return{isDisabled:(a=(s||l||u||d)&&G4(f,t.props))!==null&&a!==void 0?a:!1,labelDate:f}},t.isMonthDisabled=function(n){var a=t.isMonthDisabledForLabelDate(n).isDisabled;return a},t.getMonthClassNames=function(n){var a=t.props,i=a.day,o=a.startDate,s=a.endDate,l=a.preSelection,u=a.monthClassName,d=u?u(li(i,n)):void 0,f=t.getSelection();return sn("react-datepicker__month-text","react-datepicker__month-".concat(n),d,{"react-datepicker__month-text--disabled":t.isMonthDisabled(n),"react-datepicker__month-text--selected":f?t.isSelectMonthInList(i,n,f):void 0,"react-datepicker__month-text--keyboard-selected":!t.props.disabledKeyboardNavigation&&l&&t.isSelectedMonth(i,n,l)&&!t.isMonthSelected()&&!t.isMonthDisabled(n),"react-datepicker__month-text--in-selecting-range":t.isInSelectingRangeMonth(n),"react-datepicker__month-text--in-range":o&&s?df(o,s,n,i):void 0,"react-datepicker__month-text--range-start":t.isRangeStartMonth(n),"react-datepicker__month-text--range-end":t.isRangeEndMonth(n),"react-datepicker__month-text--selecting-range-start":t.isSelectingMonthRangeStart(n),"react-datepicker__month-text--selecting-range-end":t.isSelectingMonthRangeEnd(n),"react-datepicker__month-text--today":t.isCurrentMonth(i,n)})},t.getTabIndex=function(n){if(t.props.preSelection==null)return"-1";var a=Mn(t.props.preSelection),i=t.isMonthDisabledForLabelDate(a).isDisabled,o=n===a&&!(i||t.props.disabledKeyboardNavigation)?"0":"-1";return o},t.getQuarterTabIndex=function(n){if(t.props.preSelection==null)return"-1";var a=pu(t.props.preSelection),i=ff(t.props.day,t.props),o=n===a&&!(i||t.props.disabledKeyboardNavigation)?"0":"-1";return o},t.getAriaLabel=function(n){var a=t.props,i=a.chooseDayAriaLabelPrefix,o=i===void 0?"Choose":i,s=a.disabledDayAriaLabelPrefix,l=s===void 0?"Not available":s,u=a.day,d=a.locale,f=li(u,n),h=t.isDisabled(f)||t.isExcluded(f)?l:o;return"".concat(h," ").concat(wr(f,"MMMM yyyy",d))},t.getQuarterClassNames=function(n){var a=t.props,i=a.day,o=a.startDate,s=a.endDate,l=a.selected,u=a.minDate,d=a.maxDate,f=a.excludeDates,h=a.includeDates,p=a.filterDate,g=a.preSelection,v=a.disabledKeyboardNavigation,b=(u||d||f||h||p)&&ff(kc(i,n),t.props);return sn("react-datepicker__quarter-text","react-datepicker__quarter-".concat(n),{"react-datepicker__quarter-text--disabled":b,"react-datepicker__quarter-text--selected":l?t.isSelectedQuarter(i,n,l):void 0,"react-datepicker__quarter-text--keyboard-selected":!v&&g&&t.isSelectedQuarter(i,n,g)&&!b,"react-datepicker__quarter-text--in-selecting-range":t.isInSelectingRangeQuarter(n),"react-datepicker__quarter-text--in-range":o&&s?pf(o,s,n,i):void 0,"react-datepicker__quarter-text--range-start":t.isRangeStartQuarter(n),"react-datepicker__quarter-text--range-end":t.isRangeEndQuarter(n),"react-datepicker__quarter-text--today":t.isCurrentQuarter(i,n)})},t.getMonthContent=function(n){var a=t.props,i=a.showFullMonthYearPicker,o=a.renderMonthContent,s=a.locale,l=a.day,u=W4(n,s),d=Zg(n,s);return o?o(n,u,d,l):i?d:u},t.getQuarterContent=function(n){var a,i=t.props,o=i.renderQuarterContent,s=i.locale,l=KV(n,s);return(a=o?.(n,l))!==null&&a!==void 0?a:l},t.renderMonths=function(){var n,a=t.props,i=a.showTwoColumnMonthYearPicker,o=a.showFourColumnMonthYearPicker,s=a.day,l=a.selected,u=(n=O1[ay(o,i)])===null||n===void 0?void 0:n.grid;return u?.map(function(d,f){return se.createElement("div",{className:"react-datepicker__month-wrapper",key:f},d.map(function(h,p){return se.createElement("div",{ref:t.MONTH_REFS[h],key:p,onClick:function(g){t.onMonthClick(g,h)},onKeyDown:function(g){X4(g)&&(g.preventDefault(),g.key=Ge.Enter),t.onMonthKeyDown(g,h)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onMonthMouseEnter(h)},onPointerEnter:t.props.usePointerEvent?function(){return t.onMonthMouseEnter(h)}:void 0,tabIndex:Number(t.getTabIndex(h)),className:t.getMonthClassNames(h),"aria-disabled":t.isMonthDisabled(h),role:"option","aria-label":t.getAriaLabel(h),"aria-current":t.isCurrentMonth(s,h)?"date":void 0,"aria-selected":l?t.isSelectedMonth(s,h,l):void 0},t.getMonthContent(h))}))})},t.renderQuarters=function(){var n=t.props,a=n.day,i=n.selected,o=[1,2,3,4];return se.createElement("div",{className:"react-datepicker__quarter-wrapper"},o.map(function(s,l){return se.createElement("div",{key:l,ref:t.QUARTER_REFS[l],role:"option",onClick:function(u){t.onQuarterClick(u,s)},onKeyDown:function(u){t.onQuarterKeyDown(u,s)},onMouseEnter:t.props.usePointerEvent?void 0:function(){return t.onQuarterMouseEnter(s)},onPointerEnter:t.props.usePointerEvent?function(){return t.onQuarterMouseEnter(s)}:void 0,className:t.getQuarterClassNames(s),"aria-selected":i?t.isSelectedQuarter(a,s,i):void 0,tabIndex:Number(t.getQuarterTabIndex(s)),"aria-current":t.isCurrentQuarter(a,s)?"date":void 0},t.getQuarterContent(s))}))},t.getClassNames=function(){var n=t.props,a=n.selectingDate,i=n.selectsStart,o=n.selectsEnd,s=n.showMonthYearPicker,l=n.showQuarterYearPicker,u=n.showWeekPicker;return sn("react-datepicker__month",{"react-datepicker__month--selecting-range":a&&(i||o)},{"react-datepicker__monthPicker":s},{"react-datepicker__quarterPicker":l},{"react-datepicker__weekPicker":u})},t}return e.prototype.getSelection=function(){var t=this.props,n=t.selected,a=t.selectedDates,i=t.selectsMultiple;if(i)return a;if(n)return[n]},e.prototype.render=function(){var t=this.props,n=t.showMonthYearPicker,a=t.showQuarterYearPicker,i=t.day,o=t.ariaLabelPrefix,s=o===void 0?"Month ":o,l=s?s.trim()+" ":"";return se.createElement("div",{className:this.getClassNames(),onMouseLeave:this.props.usePointerEvent?void 0:this.handleMouseLeave,onPointerLeave:this.props.usePointerEvent?this.handleMouseLeave:void 0,"aria-label":"".concat(l).concat(wr(i,"MMMM, yyyy",this.props.locale)),role:"listbox"},n?this.renderMonths():a?this.renderQuarters():this.renderWeeks())},e}(w.Component),fz=function(r){bn(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.isSelectedMonth=function(n){return t.props.month===n},t.renderOptions=function(){return t.props.monthNames.map(function(n,a){return se.createElement("div",{className:t.isSelectedMonth(a)?"react-datepicker__month-option react-datepicker__month-option--selected_month":"react-datepicker__month-option",key:n,onClick:t.onChange.bind(t,a),"aria-selected":t.isSelectedMonth(a)?"true":void 0},t.isSelectedMonth(a)?se.createElement("span",{className:"react-datepicker__month-option--selected"},"✓"):"",n)})},t.onChange=function(n){return t.props.onChange(n)},t.handleClickOutside=function(){return t.props.onCancel()},t}return e.prototype.render=function(){return se.createElement(Gh,{className:"react-datepicker__month-dropdown",onClickOutside:this.handleClickOutside},this.renderOptions())},e}(w.Component),hz=function(r){bn(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(n){return n.map(function(a,i){return se.createElement("option",{key:a,value:i},a)})},t.renderSelectMode=function(n){return se.createElement("select",{value:t.props.month,className:"react-datepicker__month-select",onChange:function(a){return t.onChange(parseInt(a.target.value))}},t.renderSelectOptions(n))},t.renderReadView=function(n,a){return se.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-read-view",onClick:t.toggleDropdown},se.createElement("span",{className:"react-datepicker__month-read-view--down-arrow"}),se.createElement("span",{className:"react-datepicker__month-read-view--selected-month"},a[t.props.month]))},t.renderDropdown=function(n){return se.createElement(fz,Ht({key:"dropdown"},t.props,{monthNames:n,onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(n){var a=t.state.dropdownVisible,i=[t.renderReadView(!a,n)];return a&&i.unshift(t.renderDropdown(n)),i},t.onChange=function(n){t.toggleDropdown(),n!==t.props.month&&t.props.onChange(n)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return e.prototype.render=function(){var t=this,n=[0,1,2,3,4,5,6,7,8,9,10,11].map(this.props.useShortMonthInDropdown?function(i){return W4(i,t.props.locale)}:function(i){return Zg(i,t.props.locale)}),a;switch(this.props.dropdownMode){case"scroll":a=this.renderScrollMode(n);break;case"select":a=this.renderSelectMode(n);break}return se.createElement("div",{className:"react-datepicker__month-dropdown-container react-datepicker__month-dropdown-container--".concat(this.props.dropdownMode)},a)},e}(w.Component);function pz(r,e){for(var t=[],n=so(r),a=so(e);!Yo(n,a);)t.push(er(n)),n=co(n,1);return t}var mz=function(r){bn(e,r);function e(t){var n=r.call(this,t)||this;return n.renderOptions=function(){return n.state.monthYearsList.map(function(a){var i=L1(a),o=Di(n.props.date,a)&&Gn(n.props.date,a);return se.createElement("div",{className:o?"react-datepicker__month-year-option--selected_month-year":"react-datepicker__month-year-option",key:i,onClick:n.onChange.bind(n,i),"aria-selected":o?"true":void 0},o?se.createElement("span",{className:"react-datepicker__month-year-option--selected"},"✓"):"",wr(a,n.props.dateFormat,n.props.locale))})},n.onChange=function(a){return n.props.onChange(a)},n.handleClickOutside=function(){n.props.onCancel()},n.state={monthYearsList:pz(n.props.minDate,n.props.maxDate)},n}return e.prototype.render=function(){var t=sn({"react-datepicker__month-year-dropdown":!0,"react-datepicker__month-year-dropdown--scrollable":this.props.scrollableMonthYearDropdown});return se.createElement(Gh,{className:t,onClickOutside:this.handleClickOutside},this.renderOptions())},e}(w.Component),gz=function(r){bn(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var n=so(t.props.minDate),a=so(t.props.maxDate),i=[];!Yo(n,a);){var o=L1(n);i.push(se.createElement("option",{key:o,value:o},wr(n,t.props.dateFormat,t.props.locale))),n=co(n,1)}return i},t.onSelectChange=function(n){t.onChange(parseInt(n.target.value))},t.renderSelectMode=function(){return se.createElement("select",{value:L1(so(t.props.date)),className:"react-datepicker__month-year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(n){var a=wr(t.props.date,t.props.dateFormat,t.props.locale);return se.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__month-year-read-view",onClick:t.toggleDropdown},se.createElement("span",{className:"react-datepicker__month-year-read-view--down-arrow"}),se.createElement("span",{className:"react-datepicker__month-year-read-view--selected-month-year"},a))},t.renderDropdown=function(){return se.createElement(mz,Ht({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var n=t.state.dropdownVisible,a=[t.renderReadView(!n)];return n&&a.unshift(t.renderDropdown()),a},t.onChange=function(n){t.toggleDropdown();var a=er(n);Di(t.props.date,a)&&Gn(t.props.date,a)||t.props.onChange(a)},t.toggleDropdown=function(){return t.setState({dropdownVisible:!t.state.dropdownVisible})},t}return e.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return se.createElement("div",{className:"react-datepicker__month-year-dropdown-container react-datepicker__month-year-dropdown-container--".concat(this.props.dropdownMode)},t)},e}(w.Component),vz=function(r){bn(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.state={height:null},t.scrollToTheSelectedTime=function(){requestAnimationFrame(function(){var n,a,i;t.list&&(t.list.scrollTop=(i=t.centerLi&&e.calcCenterPosition(t.props.monthRef?t.props.monthRef.clientHeight-((a=(n=t.header)===null||n===void 0?void 0:n.clientHeight)!==null&&a!==void 0?a:0):t.list.clientHeight,t.centerLi))!==null&&i!==void 0?i:0)})},t.handleClick=function(n){var a,i;(t.props.minTime||t.props.maxTime)&&Yx(n,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&Gx(n,t.props)||(i=(a=t.props).onChange)===null||i===void 0||i.call(a,n)},t.isSelectedTime=function(n){return t.props.selected&&iz(t.props.selected,n)},t.isDisabledTime=function(n){return(t.props.minTime||t.props.maxTime)&&Yx(n,t.props)||(t.props.excludeTimes||t.props.includeTimes||t.props.filterTime)&&Gx(n,t.props)},t.liClasses=function(n){var a,i=["react-datepicker__time-list-item",t.props.timeClassName?t.props.timeClassName(n):void 0];return t.isSelectedTime(n)&&i.push("react-datepicker__time-list-item--selected"),t.isDisabledTime(n)&&i.push("react-datepicker__time-list-item--disabled"),t.props.injectTimes&&(ro(n)*3600+no(n)*60+Fo(n))%(((a=t.props.intervals)!==null&&a!==void 0?a:e.defaultProps.intervals)*60)!==0&&i.push("react-datepicker__time-list-item--injected"),i.join(" ")},t.handleOnKeyDown=function(n,a){var i,o;n.key===Ge.Space&&(n.preventDefault(),n.key=Ge.Enter),(n.key===Ge.ArrowUp||n.key===Ge.ArrowLeft)&&n.target instanceof HTMLElement&&n.target.previousSibling&&(n.preventDefault(),n.target.previousSibling instanceof HTMLElement&&n.target.previousSibling.focus()),(n.key===Ge.ArrowDown||n.key===Ge.ArrowRight)&&n.target instanceof HTMLElement&&n.target.nextSibling&&(n.preventDefault(),n.target.nextSibling instanceof HTMLElement&&n.target.nextSibling.focus()),n.key===Ge.Enter&&t.handleClick(a),(o=(i=t.props).handleOnKeyDown)===null||o===void 0||o.call(i,n)},t.renderTimes=function(){for(var n,a=[],i=typeof t.props.format=="string"?t.props.format:"p",o=(n=t.props.intervals)!==null&&n!==void 0?n:e.defaultProps.intervals,s=t.props.selected||t.props.openToDate||er(),l=Pf(s),u=t.props.injectTimes&&t.props.injectTimes.sort(function(b,y){return b.getTime()-y.getTime()}),d=60*az(s),f=d/o,h=0;h<f;h++){var p=F1(l,h*o);if(a.push(p),u){var g=nz(l,p,h,o,u);a=a.concat(g)}}var v=a.reduce(function(b,y){return y.getTime()<=s.getTime()?y:b},a[0]);return a.map(function(b){return se.createElement("li",{key:b.valueOf(),onClick:t.handleClick.bind(t,b),className:t.liClasses(b),ref:function(y){b===v&&(t.centerLi=y)},onKeyDown:function(y){t.handleOnKeyDown(y,b)},tabIndex:b===v?0:-1,role:"option","aria-selected":t.isSelectedTime(b)?"true":void 0,"aria-disabled":t.isDisabledTime(b)?"true":void 0},wr(b,i,t.props.locale))})},t.renderTimeCaption=function(){return t.props.showTimeCaption===!1?se.createElement(se.Fragment,null):se.createElement("div",{className:"react-datepicker__header react-datepicker__header--time ".concat(t.props.showTimeSelectOnly?"react-datepicker__header--time--only":""),ref:function(n){t.header=n}},se.createElement("div",{className:"react-datepicker-time__header"},t.props.timeCaption))},t}return Object.defineProperty(e,"defaultProps",{get:function(){return{intervals:30,todayButton:null,timeCaption:"Time",showTimeCaption:!0}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){this.scrollToTheSelectedTime(),this.observeDatePickerHeightChanges()},e.prototype.componentWillUnmount=function(){var t;(t=this.resizeObserver)===null||t===void 0||t.disconnect()},e.prototype.observeDatePickerHeightChanges=function(){var t=this,n=this.props.monthRef;this.updateContainerHeight(),n&&(this.resizeObserver=new ResizeObserver(function(){t.updateContainerHeight()}),this.resizeObserver.observe(n))},e.prototype.updateContainerHeight=function(){this.props.monthRef&&this.header&&this.setState({height:this.props.monthRef.clientHeight-this.header.clientHeight})},e.prototype.render=function(){var t=this,n,a=this.state.height;return se.createElement("div",{className:"react-datepicker__time-container ".concat(((n=this.props.todayButton)!==null&&n!==void 0?n:e.defaultProps.todayButton)?"react-datepicker__time-container--with-today-button":"")},this.renderTimeCaption(),se.createElement("div",{className:"react-datepicker__time"},se.createElement("div",{className:"react-datepicker__time-box"},se.createElement("ul",{className:"react-datepicker__time-list",ref:function(i){t.list=i},style:a?{height:a}:{},role:"listbox","aria-label":this.props.timeCaption},this.renderTimes()))))},e.calcCenterPosition=function(t,n){return n.offsetTop-(t/2-n.clientHeight/2)},e}(w.Component),iy=3,xz=function(r){bn(e,r);function e(t){var n=r.call(this,t)||this;return n.YEAR_REFS=ki([],Array(n.props.yearItemNumber),!0).map(function(){return w.createRef()}),n.isDisabled=function(a){return Ba(a,{minDate:n.props.minDate,maxDate:n.props.maxDate,excludeDates:n.props.excludeDates,includeDates:n.props.includeDates,filterDate:n.props.filterDate})},n.isExcluded=function(a){return Jg(a,{excludeDates:n.props.excludeDates})},n.selectingDate=function(){var a;return(a=n.props.selectingDate)!==null&&a!==void 0?a:n.props.preSelection},n.updateFocusOnPaginate=function(a){var i=function(){var o,s;(s=(o=n.YEAR_REFS[a])===null||o===void 0?void 0:o.current)===null||s===void 0||s.focus()};window.requestAnimationFrame(i)},n.handleYearClick=function(a,i){n.props.onDayClick&&n.props.onDayClick(a,i)},n.handleYearNavigation=function(a,i){var o,s,l,u,d=n.props,f=d.date,h=d.yearItemNumber;if(!(f===void 0||h===void 0)){var p=Mo(f,h).startPeriod;n.isDisabled(i)||n.isExcluded(i)||((s=(o=n.props).setPreSelection)===null||s===void 0||s.call(o,i),a-p<0?n.updateFocusOnPaginate(h-(p-a)):a-p>=h?n.updateFocusOnPaginate(Math.abs(h-(a-p))):(u=(l=n.YEAR_REFS[a-p])===null||l===void 0?void 0:l.current)===null||u===void 0||u.focus())}},n.isSameDay=function(a,i){return zt(a,i)},n.isCurrentYear=function(a){return a===Dt(er())},n.isRangeStart=function(a){return n.props.startDate&&n.props.endDate&&Di(Pi(er(),a),n.props.startDate)},n.isRangeEnd=function(a){return n.props.startDate&&n.props.endDate&&Di(Pi(er(),a),n.props.endDate)},n.isInRange=function(a){return hf(a,n.props.startDate,n.props.endDate)},n.isInSelectingRange=function(a){var i=n.props,o=i.selectsStart,s=i.selectsEnd,l=i.selectsRange,u=i.startDate,d=i.endDate;return!(o||s||l)||!n.selectingDate()?!1:o&&d?hf(a,n.selectingDate(),d):s&&u||l&&u&&!d?hf(a,u,n.selectingDate()):!1},n.isSelectingRangeStart=function(a){var i;if(!n.isInSelectingRange(a))return!1;var o=n.props,s=o.startDate,l=o.selectsStart,u=Pi(er(),a);return l?Di(u,(i=n.selectingDate())!==null&&i!==void 0?i:null):Di(u,s??null)},n.isSelectingRangeEnd=function(a){var i;if(!n.isInSelectingRange(a))return!1;var o=n.props,s=o.endDate,l=o.selectsEnd,u=o.selectsRange,d=Pi(er(),a);return l||u?Di(d,(i=n.selectingDate())!==null&&i!==void 0?i:null):Di(d,s??null)},n.isKeyboardSelected=function(a){if(!(n.props.date===void 0||n.props.selected==null||n.props.preSelection==null)){var i=n.props,o=i.minDate,s=i.maxDate,l=i.excludeDates,u=i.includeDates,d=i.filterDate,f=fu(Pi(n.props.date,a)),h=(o||s||l||u||d)&&Df(a,n.props);return!n.props.disabledKeyboardNavigation&&!n.props.inline&&!zt(f,fu(n.props.selected))&&zt(f,fu(n.props.preSelection))&&!h}},n.isSelectedYear=function(a){var i=n.props,o=i.selectsMultiple,s=i.selected,l=i.selectedDates;return o?l?.some(function(u){return a===Dt(u)}):!!s&&a===Dt(s)},n.onYearClick=function(a,i){var o=n.props.date;o!==void 0&&n.handleYearClick(fu(Pi(o,i)),a)},n.onYearKeyDown=function(a,i){var o,s,l=a.key,u=n.props,d=u.date,f=u.yearItemNumber,h=u.handleOnKeyDown;if(l!==Ge.Tab&&a.preventDefault(),!n.props.disabledKeyboardNavigation)switch(l){case Ge.Enter:if(n.props.selected==null)break;n.onYearClick(a,i),(s=(o=n.props).setPreSelection)===null||s===void 0||s.call(o,n.props.selected);break;case Ge.ArrowRight:if(n.props.preSelection==null)break;n.handleYearNavigation(i+1,Bo(n.props.preSelection,1));break;case Ge.ArrowLeft:if(n.props.preSelection==null)break;n.handleYearNavigation(i-1,Zc(n.props.preSelection,1));break;case Ge.ArrowUp:{if(d===void 0||f===void 0||n.props.preSelection==null)break;var p=Mo(d,f).startPeriod,g=iy,v=i-g;if(v<p){var b=f%g;i>=p&&i<p+b?g=b:g+=b,v=i-g}n.handleYearNavigation(v,Zc(n.props.preSelection,g));break}case Ge.ArrowDown:{if(d===void 0||f===void 0||n.props.preSelection==null)break;var y=Mo(d,f).endPeriod,g=iy,v=i+g;if(v>y){var b=f%g;i<=y&&i>y-b?g=b:g+=b,v=i+g}n.handleYearNavigation(v,Bo(n.props.preSelection,g));break}}h&&h(a)},n.getYearClassNames=function(a){var i=n.props,o=i.date,s=i.minDate,l=i.maxDate,u=i.excludeDates,d=i.includeDates,f=i.filterDate,h=i.yearClassName;return sn("react-datepicker__year-text","react-datepicker__year-".concat(a),o?h?.(Pi(o,a)):void 0,{"react-datepicker__year-text--selected":n.isSelectedYear(a),"react-datepicker__year-text--disabled":(s||l||u||d||f)&&Df(a,n.props),"react-datepicker__year-text--keyboard-selected":n.isKeyboardSelected(a),"react-datepicker__year-text--range-start":n.isRangeStart(a),"react-datepicker__year-text--range-end":n.isRangeEnd(a),"react-datepicker__year-text--in-range":n.isInRange(a),"react-datepicker__year-text--in-selecting-range":n.isInSelectingRange(a),"react-datepicker__year-text--selecting-range-start":n.isSelectingRangeStart(a),"react-datepicker__year-text--selecting-range-end":n.isSelectingRangeEnd(a),"react-datepicker__year-text--today":n.isCurrentYear(a)})},n.getYearTabIndex=function(a){if(n.props.disabledKeyboardNavigation||n.props.preSelection==null)return"-1";var i=Dt(n.props.preSelection),o=Df(a,n.props);return a===i&&!o?"0":"-1"},n.getYearContent=function(a){return n.props.renderYearContent?n.props.renderYearContent(a):a},n}return e.prototype.render=function(){var t=this,n=[],a=this.props,i=a.date,o=a.yearItemNumber,s=a.onYearMouseEnter,l=a.onYearMouseLeave;if(i===void 0)return null;for(var u=Mo(i,o),d=u.startPeriod,f=u.endPeriod,h=function(v){n.push(se.createElement("div",{ref:p.YEAR_REFS[v-d],onClick:function(b){t.onYearClick(b,v)},onKeyDown:function(b){X4(b)&&(b.preventDefault(),b.key=Ge.Enter),t.onYearKeyDown(b,v)},tabIndex:Number(p.getYearTabIndex(v)),className:p.getYearClassNames(v),onMouseEnter:p.props.usePointerEvent?void 0:function(b){return s(b,v)},onPointerEnter:p.props.usePointerEvent?function(b){return s(b,v)}:void 0,onMouseLeave:p.props.usePointerEvent?void 0:function(b){return l(b,v)},onPointerLeave:p.props.usePointerEvent?function(b){return l(b,v)}:void 0,key:v,"aria-current":p.isCurrentYear(v)?"date":void 0},p.getYearContent(v)))},p=this,g=d;g<=f;g++)h(g);return se.createElement("div",{className:"react-datepicker__year"},se.createElement("div",{className:"react-datepicker__year-wrapper",onMouseLeave:this.props.usePointerEvent?void 0:this.props.clearSelectingDate,onPointerLeave:this.props.usePointerEvent?this.props.clearSelectingDate:void 0},n))},e}(w.Component);function yz(r,e,t,n){for(var a=[],i=0;i<2*e+1;i++){var o=r+e-i,s=!0;t&&(s=Dt(t)<=o),n&&s&&(s=Dt(n)>=o),s&&a.push(o)}return a}var bz=function(r){bn(e,r);function e(t){var n=r.call(this,t)||this;n.renderOptions=function(){var s=n.props.year,l=n.state.yearsList.map(function(f){return se.createElement("div",{className:s===f?"react-datepicker__year-option react-datepicker__year-option--selected_year":"react-datepicker__year-option",key:f,onClick:n.onChange.bind(n,f),"aria-selected":s===f?"true":void 0},s===f?se.createElement("span",{className:"react-datepicker__year-option--selected"},"✓"):"",f)}),u=n.props.minDate?Dt(n.props.minDate):null,d=n.props.maxDate?Dt(n.props.maxDate):null;return(!d||!n.state.yearsList.find(function(f){return f===d}))&&l.unshift(se.createElement("div",{className:"react-datepicker__year-option",key:"upcoming",onClick:n.incrementYears},se.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-upcoming"}))),(!u||!n.state.yearsList.find(function(f){return f===u}))&&l.push(se.createElement("div",{className:"react-datepicker__year-option",key:"previous",onClick:n.decrementYears},se.createElement("a",{className:"react-datepicker__navigation react-datepicker__navigation--years react-datepicker__navigation--years-previous"}))),l},n.onChange=function(s){n.props.onChange(s)},n.handleClickOutside=function(){n.props.onCancel()},n.shiftYears=function(s){var l=n.state.yearsList.map(function(u){return u+s});n.setState({yearsList:l})},n.incrementYears=function(){return n.shiftYears(1)},n.decrementYears=function(){return n.shiftYears(-1)};var a=t.yearDropdownItemNumber,i=t.scrollableYearDropdown,o=a||(i?10:5);return n.state={yearsList:yz(n.props.year,o,n.props.minDate,n.props.maxDate)},n.dropdownRef=w.createRef(),n}return e.prototype.componentDidMount=function(){var t=this.dropdownRef.current;if(t){var n=t.children?Array.from(t.children):null,a=n?n.find(function(i){return i.ariaSelected}):null;t.scrollTop=a&&a instanceof HTMLElement?a.offsetTop+(a.clientHeight-t.clientHeight)/2:(t.scrollHeight-t.clientHeight)/2}},e.prototype.render=function(){var t=sn({"react-datepicker__year-dropdown":!0,"react-datepicker__year-dropdown--scrollable":this.props.scrollableYearDropdown});return se.createElement(Gh,{className:t,containerRef:this.dropdownRef,onClickOutside:this.handleClickOutside},this.renderOptions())},e}(w.Component),wz=function(r){bn(e,r);function e(){var t=r!==null&&r.apply(this,arguments)||this;return t.state={dropdownVisible:!1},t.renderSelectOptions=function(){for(var n=t.props.minDate?Dt(t.props.minDate):1900,a=t.props.maxDate?Dt(t.props.maxDate):2100,i=[],o=n;o<=a;o++)i.push(se.createElement("option",{key:o,value:o},o));return i},t.onSelectChange=function(n){t.onChange(parseInt(n.target.value))},t.renderSelectMode=function(){return se.createElement("select",{value:t.props.year,className:"react-datepicker__year-select",onChange:t.onSelectChange},t.renderSelectOptions())},t.renderReadView=function(n){return se.createElement("div",{key:"read",style:{visibility:n?"visible":"hidden"},className:"react-datepicker__year-read-view",onClick:function(a){return t.toggleDropdown(a)}},se.createElement("span",{className:"react-datepicker__year-read-view--down-arrow"}),se.createElement("span",{className:"react-datepicker__year-read-view--selected-year"},t.props.year))},t.renderDropdown=function(){return se.createElement(bz,Ht({key:"dropdown"},t.props,{onChange:t.onChange,onCancel:t.toggleDropdown}))},t.renderScrollMode=function(){var n=t.state.dropdownVisible,a=[t.renderReadView(!n)];return n&&a.unshift(t.renderDropdown()),a},t.onChange=function(n){t.toggleDropdown(),n!==t.props.year&&t.props.onChange(n)},t.toggleDropdown=function(n){t.setState({dropdownVisible:!t.state.dropdownVisible},function(){t.props.adjustDateOnChange&&t.handleYearChange(t.props.date,n)})},t.handleYearChange=function(n,a){var i;(i=t.onSelect)===null||i===void 0||i.call(t,n,a),t.setOpen()},t.onSelect=function(n,a){var i,o;(o=(i=t.props).onSelect)===null||o===void 0||o.call(i,n,a)},t.setOpen=function(){var n,a;(a=(n=t.props).setOpen)===null||a===void 0||a.call(n,!0)},t}return e.prototype.render=function(){var t;switch(this.props.dropdownMode){case"scroll":t=this.renderScrollMode();break;case"select":t=this.renderSelectMode();break}return se.createElement("div",{className:"react-datepicker__year-dropdown-container react-datepicker__year-dropdown-container--".concat(this.props.dropdownMode)},t)},e}(w.Component),_z=["react-datepicker__year-select","react-datepicker__month-select","react-datepicker__month-year-select"],Cz=function(r){var e=(r.className||"").split(/\s+/);return _z.some(function(t){return e.indexOf(t)>=0})},Nz=function(r){bn(e,r);function e(t){var n=r.call(this,t)||this;return n.monthContainer=void 0,n.handleClickOutside=function(a){n.props.onClickOutside(a)},n.setClickOutsideRef=function(){return n.containerRef.current},n.handleDropdownFocus=function(a){var i,o;Cz(a.target)&&((o=(i=n.props).onDropdownFocus)===null||o===void 0||o.call(i,a))},n.getDateInView=function(){var a=n.props,i=a.preSelection,o=a.selected,s=a.openToDate,l=Y4(n.props),u=K4(n.props),d=er(),f=s||o||i;return f||(l&&Wo(d,l)?l:u&&Yo(d,u)?u:d)},n.increaseMonth=function(){n.setState(function(a){var i=a.date;return{date:co(i,1)}},function(){return n.handleMonthChange(n.state.date)})},n.decreaseMonth=function(){n.setState(function(a){var i=a.date;return{date:Ro(i,1)}},function(){return n.handleMonthChange(n.state.date)})},n.handleDayClick=function(a,i,o){n.props.onSelect(a,i,o),n.props.setPreSelection&&n.props.setPreSelection(a)},n.handleDayMouseEnter=function(a){n.setState({selectingDate:a}),n.props.onDayMouseEnter&&n.props.onDayMouseEnter(a)},n.handleMonthMouseLeave=function(){n.setState({selectingDate:void 0}),n.props.onMonthMouseLeave&&n.props.onMonthMouseLeave()},n.handleYearMouseEnter=function(a,i){n.setState({selectingDate:Pi(er(),i)}),n.props.onYearMouseEnter&&n.props.onYearMouseEnter(a,i)},n.handleYearMouseLeave=function(a,i){n.props.onYearMouseLeave&&n.props.onYearMouseLeave(a,i)},n.handleYearChange=function(a){var i,o,s,l;(o=(i=n.props).onYearChange)===null||o===void 0||o.call(i,a),n.setState({isRenderAriaLiveMessage:!0}),n.props.adjustDateOnChange&&(n.props.onSelect(a),(l=(s=n.props).setOpen)===null||l===void 0||l.call(s,!0)),n.props.setPreSelection&&n.props.setPreSelection(a)},n.getEnabledPreSelectionDateForMonth=function(a){if(!Ba(a,n.props))return a;for(var i=so(a),o=HV(a),s=xN(o,i),l=null,u=0;u<=s;u++){var d=Es(i,u);if(!Ba(d,n.props)){l=d;break}}return l},n.handleMonthChange=function(a){var i,o,s,l=(i=n.getEnabledPreSelectionDateForMonth(a))!==null&&i!==void 0?i:a;n.handleCustomMonthChange(l),n.props.adjustDateOnChange&&(n.props.onSelect(l),(s=(o=n.props).setOpen)===null||s===void 0||s.call(o,!0)),n.props.setPreSelection&&n.props.setPreSelection(l)},n.handleCustomMonthChange=function(a){var i,o;(o=(i=n.props).onMonthChange)===null||o===void 0||o.call(i,a),n.setState({isRenderAriaLiveMessage:!0})},n.handleMonthYearChange=function(a){n.handleYearChange(a),n.handleMonthChange(a)},n.changeYear=function(a){n.setState(function(i){var o=i.date;return{date:Pi(o,Number(a))}},function(){return n.handleYearChange(n.state.date)})},n.changeMonth=function(a){n.setState(function(i){var o=i.date;return{date:li(o,Number(a))}},function(){return n.handleMonthChange(n.state.date)})},n.changeMonthYear=function(a){n.setState(function(i){var o=i.date;return{date:Pi(li(o,Mn(a)),Dt(a))}},function(){return n.handleMonthYearChange(n.state.date)})},n.header=function(a){a===void 0&&(a=n.state.date);var i=Ho(a,n.props.locale,n.props.calendarStartDay),o=[];return n.props.showWeekNumbers&&o.push(se.createElement("div",{key:"W",className:"react-datepicker__day-name"},n.props.weekLabel||"#")),o.concat([0,1,2,3,4,5,6].map(function(s){var l=Es(i,s),u=n.formatWeekday(l,n.props.locale),d=n.props.weekDayClassName?n.props.weekDayClassName(l):void 0;return se.createElement("div",{key:s,"aria-label":wr(l,"EEEE",n.props.locale),className:sn("react-datepicker__day-name",d)},u)}))},n.formatWeekday=function(a,i){return n.props.formatWeekDay?WV(a,n.props.formatWeekDay,i):n.props.useWeekdaysShort?YV(a,i):GV(a,i)},n.decreaseYear=function(){n.setState(function(a){var i,o=a.date;return{date:Zc(o,n.props.showYearPicker?(i=n.props.yearItemNumber)!==null&&i!==void 0?i:e.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.clearSelectingDate=function(){n.setState({selectingDate:void 0})},n.renderPreviousButton=function(){var a,i,o;if(!n.props.renderCustomHeader){var s=(a=n.props.monthsShown)!==null&&a!==void 0?a:e.defaultProps.monthsShown,l=n.props.showPreviousMonths?s-1:0,u=(i=n.props.monthSelectedIn)!==null&&i!==void 0?i:l,d=Ro(n.state.date,u),f;switch(!0){case n.props.showMonthYearPicker:f=Qx(n.state.date,n.props);break;case n.props.showYearPicker:f=JV(n.state.date,n.props);break;case n.props.showQuarterYearPicker:f=QV(n.state.date,n.props);break;default:f=Kx(d,n.props);break}if(!(!((o=n.props.forceShowMonthNavigation)!==null&&o!==void 0?o:e.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&f||n.props.showTimeSelectOnly)){var h=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--previous"],p=["react-datepicker__navigation","react-datepicker__navigation--previous"],g=n.decreaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(g=n.decreaseYear),f&&n.props.showDisabledMonthNavigation&&(p.push("react-datepicker__navigation--previous--disabled"),g=void 0);var v=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,b=n.props,y=b.previousMonthButtonLabel,C=y===void 0?e.defaultProps.previousMonthButtonLabel:y,S=b.previousYearButtonLabel,j=S===void 0?e.defaultProps.previousYearButtonLabel:S,D=n.props,F=D.previousMonthAriaLabel,M=F===void 0?typeof C=="string"?C:"Previous Month":F,T=D.previousYearAriaLabel,q=T===void 0?typeof j=="string"?j:"Previous Year":T;return se.createElement("button",{type:"button",className:p.join(" "),onClick:g,onKeyDown:n.props.handleOnKeyDown,"aria-label":v?q:M},se.createElement("span",{className:h.join(" ")},v?j:C))}}},n.increaseYear=function(){n.setState(function(a){var i,o=a.date;return{date:Bo(o,n.props.showYearPicker?(i=n.props.yearItemNumber)!==null&&i!==void 0?i:e.defaultProps.yearItemNumber:1)}},function(){return n.handleYearChange(n.state.date)})},n.renderNextButton=function(){var a;if(!n.props.renderCustomHeader){var i;switch(!0){case n.props.showMonthYearPicker:i=Zx(n.state.date,n.props);break;case n.props.showYearPicker:i=ez(n.state.date,n.props);break;case n.props.showQuarterYearPicker:i=ZV(n.state.date,n.props);break;default:i=Xx(n.state.date,n.props);break}if(!(!((a=n.props.forceShowMonthNavigation)!==null&&a!==void 0?a:e.defaultProps.forceShowMonthNavigation)&&!n.props.showDisabledMonthNavigation&&i||n.props.showTimeSelectOnly)){var o=["react-datepicker__navigation","react-datepicker__navigation--next"],s=["react-datepicker__navigation-icon","react-datepicker__navigation-icon--next"];n.props.showTimeSelect&&o.push("react-datepicker__navigation--next--with-time"),n.props.todayButton&&o.push("react-datepicker__navigation--next--with-today-button");var l=n.increaseMonth;(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker)&&(l=n.increaseYear),i&&n.props.showDisabledMonthNavigation&&(o.push("react-datepicker__navigation--next--disabled"),l=void 0);var u=n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker,d=n.props,f=d.nextMonthButtonLabel,h=f===void 0?e.defaultProps.nextMonthButtonLabel:f,p=d.nextYearButtonLabel,g=p===void 0?e.defaultProps.nextYearButtonLabel:p,v=n.props,b=v.nextMonthAriaLabel,y=b===void 0?typeof h=="string"?h:"Next Month":b,C=v.nextYearAriaLabel,S=C===void 0?typeof g=="string"?g:"Next Year":C;return se.createElement("button",{type:"button",className:o.join(" "),onClick:l,onKeyDown:n.props.handleOnKeyDown,"aria-label":u?S:y},se.createElement("span",{className:s.join(" ")},u?g:h))}}},n.renderCurrentMonth=function(a){a===void 0&&(a=n.state.date);var i=["react-datepicker__current-month"];return n.props.showYearDropdown&&i.push("react-datepicker__current-month--hasYearDropdown"),n.props.showMonthDropdown&&i.push("react-datepicker__current-month--hasMonthDropdown"),n.props.showMonthYearDropdown&&i.push("react-datepicker__current-month--hasMonthYearDropdown"),se.createElement("h2",{className:i.join(" ")},wr(a,n.props.dateFormat,n.props.locale))},n.renderYearDropdown=function(a){if(a===void 0&&(a=!1),!(!n.props.showYearDropdown||a))return se.createElement(wz,Ht({},e.defaultProps,n.props,{date:n.state.date,onChange:n.changeYear,year:Dt(n.state.date)}))},n.renderMonthDropdown=function(a){if(a===void 0&&(a=!1),!(!n.props.showMonthDropdown||a))return se.createElement(hz,Ht({},e.defaultProps,n.props,{month:Mn(n.state.date),onChange:n.changeMonth}))},n.renderMonthYearDropdown=function(a){if(a===void 0&&(a=!1),!(!n.props.showMonthYearDropdown||a))return se.createElement(gz,Ht({},e.defaultProps,n.props,{date:n.state.date,onChange:n.changeMonthYear}))},n.handleTodayButtonClick=function(a){n.props.onSelect(zx(),a),n.props.setPreSelection&&n.props.setPreSelection(zx())},n.renderTodayButton=function(){if(!(!n.props.todayButton||n.props.showTimeSelectOnly))return se.createElement("div",{className:"react-datepicker__today-button",onClick:n.handleTodayButtonClick},n.props.todayButton)},n.renderDefaultHeader=function(a){var i=a.monthDate,o=a.i;return se.createElement("div",{className:"react-datepicker__header ".concat(n.props.showTimeSelect?"react-datepicker__header--has-time-select":"")},n.renderCurrentMonth(i),se.createElement("div",{className:"react-datepicker__header__dropdown react-datepicker__header__dropdown--".concat(n.props.dropdownMode),onFocus:n.handleDropdownFocus},n.renderMonthDropdown(o!==0),n.renderMonthYearDropdown(o!==0),n.renderYearDropdown(o!==0)),se.createElement("div",{className:"react-datepicker__day-names"},n.header(i)))},n.renderCustomHeader=function(a){var i,o,s=a.monthDate,l=a.i;if(n.props.showTimeSelect&&!n.state.monthContainer||n.props.showTimeSelectOnly)return null;var u=Kx(n.state.date,n.props),d=Xx(n.state.date,n.props),f=Qx(n.state.date,n.props),h=Zx(n.state.date,n.props),p=!n.props.showMonthYearPicker&&!n.props.showQuarterYearPicker&&!n.props.showYearPicker;return se.createElement("div",{className:"react-datepicker__header react-datepicker__header--custom",onFocus:n.props.onDropdownFocus},(o=(i=n.props).renderCustomHeader)===null||o===void 0?void 0:o.call(i,Ht(Ht({},n.state),{customHeaderCount:l,monthDate:s,changeMonth:n.changeMonth,changeYear:n.changeYear,decreaseMonth:n.decreaseMonth,increaseMonth:n.increaseMonth,decreaseYear:n.decreaseYear,increaseYear:n.increaseYear,prevMonthButtonDisabled:u,nextMonthButtonDisabled:d,prevYearButtonDisabled:f,nextYearButtonDisabled:h})),p&&se.createElement("div",{className:"react-datepicker__day-names"},n.header(s)))},n.renderYearHeader=function(a){var i=a.monthDate,o=n.props,s=o.showYearPicker,l=o.yearItemNumber,u=l===void 0?e.defaultProps.yearItemNumber:l,d=Mo(i,u),f=d.startPeriod,h=d.endPeriod;return se.createElement("div",{className:"react-datepicker__header react-datepicker-year-header"},s?"".concat(f," - ").concat(h):Dt(i))},n.renderHeader=function(a){var i=a.monthDate,o=a.i,s=o===void 0?0:o,l={monthDate:i,i:s};switch(!0){case n.props.renderCustomHeader!==void 0:return n.renderCustomHeader(l);case(n.props.showMonthYearPicker||n.props.showQuarterYearPicker||n.props.showYearPicker):return n.renderYearHeader(l);default:return n.renderDefaultHeader(l)}},n.renderMonths=function(){var a,i;if(!(n.props.showTimeSelectOnly||n.props.showYearPicker)){for(var o=[],s=(a=n.props.monthsShown)!==null&&a!==void 0?a:e.defaultProps.monthsShown,l=n.props.showPreviousMonths?s-1:0,u=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?Bo(n.state.date,l):Ro(n.state.date,l),d=(i=n.props.monthSelectedIn)!==null&&i!==void 0?i:l,f=0;f<s;++f){var h=f-d+l,p=n.props.showMonthYearPicker||n.props.showQuarterYearPicker?Bo(u,h):co(u,h),g="month-".concat(f),v=f<s-1,b=f>0;o.push(se.createElement("div",{key:g,ref:function(y){n.monthContainer=y??void 0},className:"react-datepicker__month-container"},n.renderHeader({monthDate:p,i:f}),se.createElement(dz,Ht({},e.defaultProps,n.props,{containerRef:n.containerRef,ariaLabelPrefix:n.props.monthAriaLabelPrefix,day:p,onDayClick:n.handleDayClick,handleOnKeyDown:n.props.handleOnDayKeyDown,handleOnMonthKeyDown:n.props.handleOnKeyDown,onDayMouseEnter:n.handleDayMouseEnter,onMouseLeave:n.handleMonthMouseLeave,orderInDisplay:f,selectingDate:n.state.selectingDate,monthShowsDuplicateDaysEnd:v,monthShowsDuplicateDaysStart:b}))))}return o}},n.renderYears=function(){if(!n.props.showTimeSelectOnly&&n.props.showYearPicker)return se.createElement("div",{className:"react-datepicker__year--container"},n.renderHeader({monthDate:n.state.date}),se.createElement(xz,Ht({},e.defaultProps,n.props,{selectingDate:n.state.selectingDate,date:n.state.date,onDayClick:n.handleDayClick,clearSelectingDate:n.clearSelectingDate,onYearMouseEnter:n.handleYearMouseEnter,onYearMouseLeave:n.handleYearMouseLeave})))},n.renderTimeSection=function(){if(n.props.showTimeSelect&&(n.state.monthContainer||n.props.showTimeSelectOnly))return se.createElement(vz,Ht({},e.defaultProps,n.props,{onChange:n.props.onTimeChange,format:n.props.timeFormat,intervals:n.props.timeIntervals,monthRef:n.state.monthContainer}))},n.renderInputTimeSection=function(){var a=n.props.selected?new Date(n.props.selected):void 0,i=a&&Yh(a)&&!!n.props.selected,o=i?"".concat(ey(a.getHours()),":").concat(ey(a.getMinutes())):"";if(n.props.showTimeInput)return se.createElement(oz,Ht({},e.defaultProps,n.props,{date:a,timeString:o,onChange:n.props.onTimeChange}))},n.renderAriaLiveRegion=function(){var a,i=Mo(n.state.date,(a=n.props.yearItemNumber)!==null&&a!==void 0?a:e.defaultProps.yearItemNumber),o=i.startPeriod,s=i.endPeriod,l;return n.props.showYearPicker?l="".concat(o," - ").concat(s):n.props.showMonthYearPicker||n.props.showQuarterYearPicker?l=Dt(n.state.date):l="".concat(Zg(Mn(n.state.date),n.props.locale)," ").concat(Dt(n.state.date)),se.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},n.state.isRenderAriaLiveMessage&&l)},n.renderChildren=function(){if(n.props.children)return se.createElement("div",{className:"react-datepicker__children-container"},n.props.children)},n.containerRef=w.createRef(),n.state={date:n.getDateInView(),selectingDate:void 0,monthContainer:void 0,isRenderAriaLiveMessage:!1},n}return Object.defineProperty(e,"defaultProps",{get:function(){return{monthsShown:1,forceShowMonthNavigation:!1,timeCaption:"Time",previousYearButtonLabel:"Previous Year",nextYearButtonLabel:"Next Year",previousMonthButtonLabel:"Previous Month",nextMonthButtonLabel:"Next Month",yearItemNumber:Qu}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){var t=this;this.props.showTimeSelect&&(this.assignMonthContainer=function(){t.setState({monthContainer:t.monthContainer})}())},e.prototype.componentDidUpdate=function(t){var n=this;if(this.props.preSelection&&(!zt(this.props.preSelection,t.preSelection)||this.props.monthSelectedIn!==t.monthSelectedIn)){var a=!Gn(this.state.date,this.props.preSelection);this.setState({date:this.props.preSelection},function(){return a&&n.handleCustomMonthChange(n.state.date)})}else this.props.openToDate&&!zt(this.props.openToDate,t.openToDate)&&this.setState({date:this.props.openToDate})},e.prototype.render=function(){var t=this.props.container||FV;return se.createElement(Gh,{onClickOutside:this.handleClickOutside,style:{display:"contents"},ignoreClass:this.props.outsideClickIgnoreClass},se.createElement("div",{style:{display:"contents"},ref:this.containerRef},se.createElement(t,{className:sn("react-datepicker",this.props.className,{"react-datepicker--time-only":this.props.showTimeSelectOnly}),showTime:this.props.showTimeSelect||this.props.showTimeInput,showTimeSelectOnly:this.props.showTimeSelectOnly},this.renderAriaLiveRegion(),this.renderPreviousButton(),this.renderNextButton(),this.renderMonths(),this.renderYears(),this.renderTodayButton(),this.renderTimeSection(),this.renderInputTimeSection(),this.renderChildren())))},e}(w.Component),Sz=function(r){var e=r.icon,t=r.className,n=t===void 0?"":t,a=r.onClick,i="react-datepicker__calendar-icon";if(typeof e=="string")return se.createElement("i",{className:"".concat(i," ").concat(e," ").concat(n),"aria-hidden":"true",onClick:a});if(se.isValidElement(e)){var o=e;return se.cloneElement(o,{className:"".concat(o.props.className||""," ").concat(i," ").concat(n),onClick:function(s){typeof o.props.onClick=="function"&&o.props.onClick(s),typeof a=="function"&&a(s)}})}return se.createElement("svg",{className:"".concat(i," ").concat(n),xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",onClick:a},se.createElement("path",{d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"}))},Q4=function(r){bn(e,r);function e(t){var n=r.call(this,t)||this;return n.portalRoot=null,n.el=document.createElement("div"),n}return e.prototype.componentDidMount=function(){this.portalRoot=(this.props.portalHost||document).getElementById(this.props.portalId),this.portalRoot||(this.portalRoot=document.createElement("div"),this.portalRoot.setAttribute("id",this.props.portalId),(this.props.portalHost||document.body).appendChild(this.portalRoot)),this.portalRoot.appendChild(this.el)},e.prototype.componentWillUnmount=function(){this.portalRoot&&this.portalRoot.removeChild(this.el)},e.prototype.render=function(){return Xp.createPortal(this.props.children,this.el)},e}(w.Component),Ez="[tabindex], a, button, input, select, textarea",Az=function(r){return(r instanceof HTMLAnchorElement||!r.disabled)&&r.tabIndex!==-1},Z4=function(r){bn(e,r);function e(t){var n=r.call(this,t)||this;return n.getTabChildren=function(){var a;return Array.prototype.slice.call((a=n.tabLoopRef.current)===null||a===void 0?void 0:a.querySelectorAll(Ez),1,-1).filter(Az)},n.handleFocusStart=function(){var a=n.getTabChildren();a&&a.length>1&&a[a.length-1].focus()},n.handleFocusEnd=function(){var a=n.getTabChildren();a&&a.length>1&&a[0].focus()},n.tabLoopRef=w.createRef(),n}return e.prototype.render=function(){var t;return((t=this.props.enableTabLoop)!==null&&t!==void 0?t:e.defaultProps.enableTabLoop)?se.createElement("div",{className:"react-datepicker__tab-loop",ref:this.tabLoopRef},se.createElement("div",{className:"react-datepicker__tab-loop__start",tabIndex:0,onFocus:this.handleFocusStart}),this.props.children,se.createElement("div",{className:"react-datepicker__tab-loop__end",tabIndex:0,onFocus:this.handleFocusEnd})):this.props.children},e.defaultProps={enableTabLoop:!0},e}(w.Component);function jz(r){var e=function(t){var n,a=typeof t.hidePopper=="boolean"?t.hidePopper:!0,i=w.useRef(null),o=LV(Ht({open:!a,whileElementsMounted:oN,placement:t.popperPlacement,middleware:ki([sN({padding:15}),cN(10),lN({element:i})],(n=t.popperModifiers)!==null&&n!==void 0?n:[],!0)},t.popperProps)),s=Ht(Ht({},t),{hidePopper:a,popperProps:Ht(Ht({},o),{arrowRef:i})});return se.createElement(r,Ht({},s))};return e}var Pz=function(r){bn(e,r);function e(){return r!==null&&r.apply(this,arguments)||this}return Object.defineProperty(e,"defaultProps",{get:function(){return{hidePopper:!0}},enumerable:!1,configurable:!0}),e.prototype.render=function(){var t=this.props,n=t.className,a=t.wrapperClassName,i=t.hidePopper,o=i===void 0?e.defaultProps.hidePopper:i,s=t.popperComponent,l=t.targetComponent,u=t.enableTabLoop,d=t.popperOnKeyDown,f=t.portalId,h=t.portalHost,p=t.popperProps,g=t.showArrow,v=void 0;if(!o){var b=sn("react-datepicker-popper",n);v=se.createElement(Z4,{enableTabLoop:u},se.createElement("div",{ref:p.refs.setFloating,style:p.floatingStyles,className:b,"data-placement":p.placement,onKeyDown:d},s,g&&se.createElement(DV,{ref:p.arrowRef,context:p.context,fill:"currentColor",strokeWidth:1,height:8,width:16,style:{transform:"translateY(-1px)"},className:"react-datepicker__triangle"})))}this.props.popperContainer&&(v=w.createElement(this.props.popperContainer,{},v)),f&&!o&&(v=se.createElement(Q4,{portalId:f,portalHost:h},v));var y=sn("react-datepicker-wrapper",a);return se.createElement(se.Fragment,null,se.createElement("div",{ref:p.refs.setReference,className:y},l),v)},e}(w.Component),Dz=jz(Pz),oy="react-datepicker-ignore-onclickoutside";function Iz(r,e){return r&&e?Mn(r)!==Mn(e)||Dt(r)!==Dt(e):r!==e}var k1="Date input not valid.",Tz=function(r){bn(e,r);function e(t){var n=r.call(this,t)||this;return n.calendar=null,n.input=null,n.getPreSelection=function(){return n.props.openToDate?n.props.openToDate:n.props.selectsEnd&&n.props.startDate?n.props.startDate:n.props.selectsStart&&n.props.endDate?n.props.endDate:er()},n.modifyHolidays=function(){var a;return(a=n.props.holidays)===null||a===void 0?void 0:a.reduce(function(i,o){var s=new Date(o.date);return Yh(s)?ki(ki([],i,!0),[Ht(Ht({},o),{date:s})],!1):i},[])},n.calcInitialState=function(){var a,i=n.getPreSelection(),o=Y4(n.props),s=K4(n.props),l=o&&Wo(i,Pf(o))?o:s&&Yo(i,Hx(s))?s:i;return{open:n.props.startOpen||!1,preventFocus:!1,inputValue:null,preSelection:(a=n.props.selectsRange?n.props.startDate:n.props.selected)!==null&&a!==void 0?a:l,highlightDates:Jx(n.props.highlightDates),focused:!1,shouldFocusDayInline:!1,isRenderAriaLiveMessage:!1,wasHidden:!1}},n.resetHiddenStatus=function(){n.setState(Ht(Ht({},n.state),{wasHidden:!1}))},n.setHiddenStatus=function(){n.setState(Ht(Ht({},n.state),{wasHidden:!0}))},n.setHiddenStateOnVisibilityHidden=function(){document.visibilityState==="hidden"&&n.setHiddenStatus()},n.clearPreventFocusTimeout=function(){n.preventFocusTimeout&&clearTimeout(n.preventFocusTimeout)},n.setFocus=function(){var a,i;(i=(a=n.input)===null||a===void 0?void 0:a.focus)===null||i===void 0||i.call(a,{preventScroll:!0})},n.setBlur=function(){var a,i;(i=(a=n.input)===null||a===void 0?void 0:a.blur)===null||i===void 0||i.call(a),n.cancelFocusInput()},n.deferBlur=function(){requestAnimationFrame(function(){n.setBlur()})},n.setOpen=function(a,i){i===void 0&&(i=!1),n.setState({open:a,preSelection:a&&n.state.open?n.state.preSelection:n.calcInitialState().preSelection,lastPreSelectChange:M1},function(){a||n.setState(function(o){return{focused:i?o.focused:!1}},function(){!i&&n.deferBlur(),n.setState({inputValue:null})})})},n.inputOk=function(){return Lo(n.state.preSelection)},n.isCalendarOpen=function(){return n.props.open===void 0?n.state.open&&!n.props.disabled&&!n.props.readOnly:n.props.open},n.handleFocus=function(a){var i,o,s=n.state.wasHidden,l=s?n.state.open:!0;s&&n.resetHiddenStatus(),n.state.preventFocus||((o=(i=n.props).onFocus)===null||o===void 0||o.call(i,a),l&&!n.props.preventOpenOnFocus&&!n.props.readOnly&&n.setOpen(!0)),n.setState({focused:!0})},n.sendFocusBackToInput=function(){n.preventFocusTimeout&&n.clearPreventFocusTimeout(),n.setState({preventFocus:!0},function(){n.preventFocusTimeout=setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})})},n.cancelFocusInput=function(){clearTimeout(n.inputFocusTimeout),n.inputFocusTimeout=void 0},n.deferFocusInput=function(){n.cancelFocusInput(),n.inputFocusTimeout=setTimeout(function(){return n.setFocus()},1)},n.handleDropdownFocus=function(){n.cancelFocusInput()},n.handleBlur=function(a){var i,o;(!n.state.open||n.props.withPortal||n.props.showTimeInput)&&((o=(i=n.props).onBlur)===null||o===void 0||o.call(i,a)),n.state.open&&n.props.open===!1&&n.setOpen(!1),n.setState({focused:!1})},n.handleCalendarClickOutside=function(a){var i,o;n.props.inline||n.setOpen(!1),(o=(i=n.props).onClickOutside)===null||o===void 0||o.call(i,a),n.props.withPortal&&a.preventDefault()},n.handleChange=function(){for(var a,i,o,s,l,u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];var f=u[0];if(!(n.props.onChangeRaw&&(n.props.onChangeRaw.apply(n,u),!f||typeof f.isDefaultPrevented!="function"||f.isDefaultPrevented()))){n.setState({inputValue:f?.target instanceof HTMLInputElement?f.target.value:null,lastPreSelectChange:Oz});var h=n.props,p=h.selectsRange,g=h.startDate,v=h.endDate,b=(a=n.props.dateFormat)!==null&&a!==void 0?a:e.defaultProps.dateFormat,y=(i=n.props.strictParsing)!==null&&i!==void 0?i:e.defaultProps.strictParsing,C=f?.target instanceof HTMLInputElement?f.target.value:"";if(p){var S=C.split(b.includes("-")?H4:"-",2).map(function(O){return O.trim()}),j=S[0],D=S[1],F=I1(j??"",b,n.props.locale,y),M=I1(D??"",b,n.props.locale,y),T=g?.getTime()!==F?.getTime(),q=v?.getTime()!==M?.getTime();if(!T&&!q||F&&Ba(F,n.props)||M&&Ba(M,n.props))return;(s=(o=n.props).onChange)===null||s===void 0||s.call(o,[F,M],f)}else{var J=I1(C,b,n.props.locale,y,(l=n.props.selected)!==null&&l!==void 0?l:void 0);(J||!C)&&n.setSelected(J,f,!0)}}},n.handleSelect=function(a,i,o){if(!n.props.readOnly){if(n.props.shouldCloseOnSelect&&!n.props.showTimeSelect&&n.sendFocusBackToInput(),n.props.onChangeRaw&&n.props.onChangeRaw(i),n.setSelected(a,i,!1,o),n.props.showDateSelect&&n.setState({isRenderAriaLiveMessage:!0}),!n.props.shouldCloseOnSelect||n.props.showTimeSelect)n.setPreSelection(a);else if(!n.props.inline){n.props.selectsRange||n.setOpen(!1);var s=n.props,l=s.startDate,u=s.endDate;l&&!u&&(n.props.swapRange||!ny(a,l))&&n.setOpen(!1)}}},n.setSelected=function(a,i,o,s){var l,u,d=a;if(n.props.showYearPicker){if(d!==null&&Df(Dt(d),n.props))return}else if(n.props.showMonthYearPicker){if(d!==null&&G4(d,n.props))return}else if(d!==null&&Ba(d,n.props))return;var f=n.props,h=f.onChange,p=f.selectsRange,g=f.startDate,v=f.endDate,b=f.selectsMultiple,y=f.selectedDates,C=f.minTime,S=f.swapRange;if(!Ss(n.props.selected,d)||n.props.allowSameDay||p||b)if(d!==null&&(n.props.selected&&(!o||!n.props.showTimeSelect&&!n.props.showTimeSelectOnly&&!n.props.showTimeInput)&&(d=T1(d,{hour:ro(n.props.selected),minute:no(n.props.selected),second:Fo(n.props.selected)})),!o&&(n.props.showTimeSelect||n.props.showTimeSelectOnly)&&C&&(d=T1(d,{hour:C.getHours(),minute:C.getMinutes(),second:C.getSeconds()})),n.props.inline||n.setState({preSelection:d}),n.props.focusSelectedMonth||n.setState({monthSelectedIn:s})),p){var j=!g&&!v,D=g&&!v,F=g&&v;j?h?.([d,null],i):D&&(d===null?h?.([null,null],i):ny(d,g)?h?.(S?[d,g]:[d,null],i):h?.([g,d],i)),F&&h?.([d,null],i)}else if(b){if(d!==null)if(!y?.length)h?.([d],i);else{var M=y.some(function(q){return zt(q,d)});if(M){var T=y.filter(function(q){return!zt(q,d)});h?.(T,i)}else h?.(ki(ki([],y,!0),[d],!1),i)}}else h?.(d,i);o||((u=(l=n.props).onSelect)===null||u===void 0||u.call(l,d,i),n.setState({inputValue:null}))},n.setPreSelection=function(a){if(!n.props.readOnly){var i=Lo(n.props.minDate),o=Lo(n.props.maxDate),s=!0;if(a){var l=Pf(a);if(i&&o)s=hu(a,n.props.minDate,n.props.maxDate);else if(i){var u=Pf(n.props.minDate);s=Yo(a,u)||Ss(l,u)}else if(o){var d=Hx(n.props.maxDate);s=Wo(a,d)||Ss(l,d)}}s&&n.setState({preSelection:a})}},n.toggleCalendar=function(){n.setOpen(!n.state.open)},n.handleTimeChange=function(a){var i,o;if(!(n.props.selectsRange||n.props.selectsMultiple)){var s=n.props.selected?n.props.selected:n.getPreSelection(),l=n.props.selected?a:T1(s,{hour:ro(a),minute:no(a)});n.setState({preSelection:l}),(o=(i=n.props).onChange)===null||o===void 0||o.call(i,l),n.props.shouldCloseOnSelect&&!n.props.showTimeInput&&(n.sendFocusBackToInput(),n.setOpen(!1)),n.props.showTimeInput&&n.setOpen(!0),(n.props.showTimeSelectOnly||n.props.showTimeSelect)&&n.setState({isRenderAriaLiveMessage:!0}),n.setState({inputValue:null})}},n.onInputClick=function(){var a,i;!n.props.disabled&&!n.props.readOnly&&n.setOpen(!0),(i=(a=n.props).onInputClick)===null||i===void 0||i.call(a)},n.onInputKeyDown=function(a){var i,o,s,l,u,d;(o=(i=n.props).onKeyDown)===null||o===void 0||o.call(i,a);var f=a.key;if(!n.state.open&&!n.props.inline&&!n.props.preventOpenOnFocus){(f===Ge.ArrowDown||f===Ge.ArrowUp||f===Ge.Enter)&&((s=n.onInputClick)===null||s===void 0||s.call(n));return}if(n.state.open){if(f===Ge.ArrowDown||f===Ge.ArrowUp){a.preventDefault();var h=n.props.showTimeSelectOnly?".react-datepicker__time-list-item[tabindex='0']":n.props.showWeekPicker&&n.props.showWeekNumbers?'.react-datepicker__week-number[tabindex="0"]':n.props.showFullMonthYearPicker||n.props.showMonthYearPicker?'.react-datepicker__month-text[tabindex="0"]':'.react-datepicker__day[tabindex="0"]',p=((l=n.calendar)===null||l===void 0?void 0:l.containerRef.current)instanceof Element&&n.calendar.containerRef.current.querySelector(h);p instanceof HTMLElement&&p.focus({preventScroll:!0});return}var g=er(n.state.preSelection);f===Ge.Enter?(a.preventDefault(),a.target.blur(),n.inputOk()&&n.state.lastPreSelectChange===M1?(n.handleSelect(g,a),!n.props.shouldCloseOnSelect&&n.setPreSelection(g)):n.setOpen(!1)):f===Ge.Escape?(a.preventDefault(),a.target.blur(),n.sendFocusBackToInput(),n.setOpen(!1)):f===Ge.Tab&&n.setOpen(!1),n.inputOk()||(d=(u=n.props).onInputError)===null||d===void 0||d.call(u,{code:1,msg:k1})}},n.onPortalKeyDown=function(a){var i=a.key;i===Ge.Escape&&(a.preventDefault(),n.setState({preventFocus:!0},function(){n.setOpen(!1),setTimeout(function(){n.setFocus(),n.setState({preventFocus:!1})})}))},n.onDayKeyDown=function(a){var i,o,s,l,u,d,f=n.props,h=f.minDate,p=f.maxDate,g=f.disabledKeyboardNavigation,v=f.showWeekPicker,b=f.shouldCloseOnSelect,y=f.locale,C=f.calendarStartDay,S=f.adjustDateOnChange,j=f.inline;if((o=(i=n.props).onKeyDown)===null||o===void 0||o.call(i,a),!g){var D=a.key,F=a.shiftKey,M=er(n.state.preSelection),T=function(ce,Q){var re=Q;switch(ce){case Ge.ArrowRight:re=v?R1(Q,1):Es(Q,1);break;case Ge.ArrowLeft:re=v?Tv(Q,1):EN(Q,1);break;case Ge.ArrowUp:re=Tv(Q,1);break;case Ge.ArrowDown:re=R1(Q,1);break;case Ge.PageUp:re=F?Zc(Q,1):Ro(Q,1);break;case Ge.PageDown:re=F?Bo(Q,1):co(Q,1);break;case Ge.Home:re=Ho(Q,y,C);break;case Ge.End:re=zV(Q);break}return re},q=function(ce,Q){for(var re=40,G=ce,Y=!1,ge=0,ye=T(ce,Q);!Y;){if(ge>=re){ye=Q;break}h&&ye<h&&(G=Ge.ArrowRight,ye=Ba(h,n.props)?T(G,ye):h),p&&ye>p&&(G=Ge.ArrowLeft,ye=Ba(p,n.props)?T(G,ye):p),Ba(ye,n.props)?((G===Ge.PageUp||G===Ge.Home)&&(G=Ge.ArrowRight),(G===Ge.PageDown||G===Ge.End)&&(G=Ge.ArrowLeft),ye=T(G,ye)):Y=!0,ge++}return ye};if(D===Ge.Enter){a.preventDefault(),n.handleSelect(M,a),!b&&n.setPreSelection(M);return}else if(D===Ge.Escape){a.preventDefault(),n.setOpen(!1),n.inputOk()||(l=(s=n.props).onInputError)===null||l===void 0||l.call(s,{code:1,msg:k1});return}var J=null;switch(D){case Ge.ArrowLeft:case Ge.ArrowRight:case Ge.ArrowUp:case Ge.ArrowDown:case Ge.PageUp:case Ge.PageDown:case Ge.Home:case Ge.End:J=q(D,M);break}if(!J){(d=(u=n.props).onInputError)===null||d===void 0||d.call(u,{code:1,msg:k1});return}if(a.preventDefault(),n.setState({lastPreSelectChange:M1}),S&&n.setSelected(J),n.setPreSelection(J),j){var O=Mn(M),k=Mn(J),H=Dt(M),X=Dt(J);O!==k||H!==X?n.setState({shouldFocusDayInline:!0}):n.setState({shouldFocusDayInline:!1})}}},n.onPopperKeyDown=function(a){var i=a.key;i===Ge.Escape&&(a.preventDefault(),n.sendFocusBackToInput(),n.setOpen(!1))},n.onClearClick=function(a){a&&a.preventDefault&&a.preventDefault(),n.sendFocusBackToInput();var i=n.props,o=i.selectsRange,s=i.onChange;s?.(o?[null,null]:null,a),n.setState({inputValue:null})},n.clear=function(){n.onClearClick()},n.onScroll=function(a){typeof n.props.closeOnScroll=="boolean"&&n.props.closeOnScroll?(a.target===document||a.target===document.documentElement||a.target===document.body)&&n.setOpen(!1):typeof n.props.closeOnScroll=="function"&&n.props.closeOnScroll(a)&&n.setOpen(!1)},n.renderCalendar=function(){var a,i;return!n.props.inline&&!n.isCalendarOpen()?null:se.createElement(Nz,Ht({showMonthYearDropdown:void 0,ref:function(o){n.calendar=o}},n.props,n.state,{setOpen:n.setOpen,dateFormat:(a=n.props.dateFormatCalendar)!==null&&a!==void 0?a:e.defaultProps.dateFormatCalendar,onSelect:n.handleSelect,onClickOutside:n.handleCalendarClickOutside,holidays:rz(n.modifyHolidays()),outsideClickIgnoreClass:oy,onDropdownFocus:n.handleDropdownFocus,onTimeChange:n.handleTimeChange,className:n.props.calendarClassName,container:n.props.calendarContainer,handleOnKeyDown:n.props.onKeyDown,handleOnDayKeyDown:n.onDayKeyDown,setPreSelection:n.setPreSelection,dropdownMode:(i=n.props.dropdownMode)!==null&&i!==void 0?i:e.defaultProps.dropdownMode}),n.props.children)},n.renderAriaLiveRegion=function(){var a=n.props,i=a.dateFormat,o=i===void 0?e.defaultProps.dateFormat:i,s=a.locale,l=n.props.showTimeInput||n.props.showTimeSelect,u=l?"PPPPp":"PPPP",d;return n.props.selectsRange?d="Selected start date: ".concat(Fa(n.props.startDate,{dateFormat:u,locale:s}),". ").concat(n.props.endDate?"End date: "+Fa(n.props.endDate,{dateFormat:u,locale:s}):""):n.props.showTimeSelectOnly?d="Selected time: ".concat(Fa(n.props.selected,{dateFormat:o,locale:s})):n.props.showYearPicker?d="Selected year: ".concat(Fa(n.props.selected,{dateFormat:"yyyy",locale:s})):n.props.showMonthYearPicker?d="Selected month: ".concat(Fa(n.props.selected,{dateFormat:"MMMM yyyy",locale:s})):n.props.showQuarterYearPicker?d="Selected quarter: ".concat(Fa(n.props.selected,{dateFormat:"yyyy, QQQ",locale:s})):d="Selected date: ".concat(Fa(n.props.selected,{dateFormat:u,locale:s})),se.createElement("span",{role:"alert","aria-live":"polite",className:"react-datepicker__aria-live"},d)},n.renderDateInput=function(){var a,i,o,s=sn(n.props.className,(a={},a[oy]=n.state.open,a)),l=n.props.customInput||se.createElement("input",{type:"text"}),u=n.props.customInputRef||"ref",d=n.props,f=d.dateFormat,h=f===void 0?e.defaultProps.dateFormat:f,p=d.locale,g=typeof n.props.value=="string"?n.props.value:typeof n.state.inputValue=="string"?n.state.inputValue:n.props.selectsRange?$V(n.props.startDate,n.props.endDate,{dateFormat:h,locale:p}):n.props.selectsMultiple?UV((o=n.props.selectedDates)!==null&&o!==void 0?o:[],{dateFormat:h,locale:p}):Fa(n.props.selected,{dateFormat:h,locale:p});return w.cloneElement(l,(i={},i[u]=function(v){n.input=v},i.value=g,i.onBlur=n.handleBlur,i.onChange=n.handleChange,i.onClick=n.onInputClick,i.onFocus=n.handleFocus,i.onKeyDown=n.onInputKeyDown,i.id=n.props.id,i.name=n.props.name,i.form=n.props.form,i.autoFocus=n.props.autoFocus,i.placeholder=n.props.placeholderText,i.disabled=n.props.disabled,i.autoComplete=n.props.autoComplete,i.className=sn(l.props.className,s),i.title=n.props.title,i.readOnly=n.props.readOnly,i.required=n.props.required,i.tabIndex=n.props.tabIndex,i["aria-describedby"]=n.props.ariaDescribedBy,i["aria-invalid"]=n.props.ariaInvalid,i["aria-labelledby"]=n.props.ariaLabelledBy,i["aria-required"]=n.props.ariaRequired,i))},n.renderClearButton=function(){var a=n.props,i=a.isClearable,o=a.disabled,s=a.selected,l=a.startDate,u=a.endDate,d=a.clearButtonTitle,f=a.clearButtonClassName,h=f===void 0?"":f,p=a.ariaLabelClose,g=p===void 0?"Close":p,v=a.selectedDates,b=a.readOnly;return i&&!b&&(s!=null||l!=null||u!=null||v?.length)?se.createElement("button",{type:"button",className:sn("react-datepicker__close-icon",h,{"react-datepicker__close-icon--disabled":o}),disabled:o,"aria-label":g,onClick:n.onClearClick,title:d,tabIndex:-1}):null},n.state=n.calcInitialState(),n.preventFocusTimeout=void 0,n}return Object.defineProperty(e,"defaultProps",{get:function(){return{allowSameDay:!1,dateFormat:"MM/dd/yyyy",dateFormatCalendar:"LLLL yyyy",disabled:!1,disabledKeyboardNavigation:!1,dropdownMode:"scroll",preventOpenOnFocus:!1,monthsShown:1,readOnly:!1,withPortal:!1,selectsDisabledDaysInRange:!1,shouldCloseOnSelect:!0,showTimeSelect:!1,showTimeInput:!1,showPreviousMonths:!1,showMonthYearPicker:!1,showFullMonthYearPicker:!1,showTwoColumnMonthYearPicker:!1,showFourColumnMonthYearPicker:!1,showYearPicker:!1,showQuarterYearPicker:!1,showWeekPicker:!1,strictParsing:!1,swapRange:!1,timeIntervals:30,timeCaption:"Time",previousMonthAriaLabel:"Previous Month",previousMonthButtonLabel:"Previous Month",nextMonthAriaLabel:"Next Month",nextMonthButtonLabel:"Next Month",previousYearAriaLabel:"Previous Year",previousYearButtonLabel:"Previous Year",nextYearAriaLabel:"Next Year",nextYearButtonLabel:"Next Year",timeInputLabel:"Time",enableTabLoop:!0,yearItemNumber:Qu,focusSelectedMonth:!1,showPopperArrow:!0,excludeScrollbar:!0,customTimeInput:null,calendarStartDay:void 0,toggleCalendarOnIconClick:!1,usePointerEvent:!1}},enumerable:!1,configurable:!0}),e.prototype.componentDidMount=function(){window.addEventListener("scroll",this.onScroll,!0),document.addEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},e.prototype.componentDidUpdate=function(t,n){var a,i,o,s;t.inline&&Iz(t.selected,this.props.selected)&&this.setPreSelection(this.props.selected),this.state.monthSelectedIn!==void 0&&t.monthsShown!==this.props.monthsShown&&this.setState({monthSelectedIn:0}),t.highlightDates!==this.props.highlightDates&&this.setState({highlightDates:Jx(this.props.highlightDates)}),!n.focused&&!Ss(t.selected,this.props.selected)&&this.setState({inputValue:null}),n.open!==this.state.open&&(n.open===!1&&this.state.open===!0&&((i=(a=this.props).onCalendarOpen)===null||i===void 0||i.call(a)),n.open===!0&&this.state.open===!1&&((s=(o=this.props).onCalendarClose)===null||s===void 0||s.call(o)))},e.prototype.componentWillUnmount=function(){this.clearPreventFocusTimeout(),window.removeEventListener("scroll",this.onScroll,!0),document.removeEventListener("visibilitychange",this.setHiddenStateOnVisibilityHidden)},e.prototype.renderInputContainer=function(){var t=this.props,n=t.showIcon,a=t.icon,i=t.calendarIconClassname,o=t.calendarIconClassName,s=t.toggleCalendarOnIconClick,l=this.state.open;return i&&console.warn("calendarIconClassname props is deprecated. should use calendarIconClassName props."),se.createElement("div",{className:"react-datepicker__input-container".concat(n?" react-datepicker__view-calendar-icon":"")},n&&se.createElement(Sz,Ht({icon:a,className:sn(o,!o&&i,l&&"react-datepicker-ignore-onclickoutside")},s?{onClick:this.toggleCalendar}:null)),this.state.isRenderAriaLiveMessage&&this.renderAriaLiveRegion(),this.renderDateInput(),this.renderClearButton())},e.prototype.render=function(){var t=this.renderCalendar();if(this.props.inline)return t;if(this.props.withPortal){var n=this.state.open?se.createElement(Z4,{enableTabLoop:this.props.enableTabLoop},se.createElement("div",{className:"react-datepicker__portal",tabIndex:-1,onKeyDown:this.onPortalKeyDown},t)):null;return this.state.open&&this.props.portalId&&(n=se.createElement(Q4,Ht({portalId:this.props.portalId},this.props),n)),se.createElement("div",null,this.renderInputContainer(),n)}return se.createElement(Dz,Ht({},this.props,{className:this.props.popperClassName,hidePopper:!this.isCalendarOpen(),targetComponent:this.renderInputContainer(),popperComponent:t,popperOnKeyDown:this.onPopperKeyDown,showArrow:this.props.showPopperArrow}))},e}(w.Component),Oz="input",M1="navigate";function J4({className:r,selected:e,onSelect:t,disabled:n,weekStartsOn:a=0,initialFocus:i}){const o=l=>{t&&t(l||void 0)},s=l=>n?n(l):!1;return c.jsxs("div",{className:Le("p-3",r),children:[c.jsx("style",{children:`
        .react-datepicker {
          border: none !important;
          box-shadow: none !important;
          font-family: inherit !important;
        }
        .react-datepicker__header {
          background-color: transparent !important;
          border-bottom: 1px solid #e5e7eb !important;
          padding: 0.75rem !important;
        }
        .react-datepicker__current-month {
          font-size: 0.875rem !important;
          font-weight: 500 !important;
          color: #111827 !important;
        }
        .react-datepicker__day-names {
          margin-bottom: 0.5rem !important;
        }
        .react-datepicker__day-name {
          color: #6b7280 !important;
          font-size: 0.8rem !important;
          font-weight: normal !important;
          width: 2.25rem !important;
          height: 2.25rem !important;
          line-height: 2.25rem !important;
        }
        .react-datepicker__month {
          margin: 0.25rem !important;
        }
        .react-datepicker__week {
          display: flex !important;
        }
        .react-datepicker__day {
          width: 2.25rem !important;
          height: 2.25rem !important;
          line-height: 2.25rem !important;
          text-align: center !important;
          font-size: 0.875rem !important;
          font-weight: normal !important;
          color: #111827 !important;
          border-radius: 0.375rem !important;
          margin: 0.125rem !important;
          cursor: pointer !important;
          transition: all 0.2s ease !important;
        }
        .react-datepicker__day:hover {
          background-color: #f3f4f6 !important;
          color: #111827 !important;
        }
        .react-datepicker__day--selected {
          background-color: #111827 !important;
          color: #ffffff !important;
        }
        .react-datepicker__day--selected:hover {
          background-color: #111827 !important;
          color: #ffffff !important;
        }
        .react-datepicker__day--today {
          background-color: #f3f4f6 !important;
          color: #111827 !important;
          font-weight: 500 !important;
        }
        .react-datepicker__day--outside-month {
          color: #9ca3af !important;
          opacity: 0.5 !important;
        }
        .react-datepicker__day--disabled {
          color: #9ca3af !important;
          opacity: 0.5 !important;
          cursor: not-allowed !important;
        }
        .react-datepicker__day--disabled:hover {
          background-color: transparent !important;
        }
        .react-datepicker__navigation {
          top: 0.75rem !important;
          width: 1.75rem !important;
          height: 1.75rem !important;
          background: transparent !important;
          border: 1px solid #d1d5db !important;
          border-radius: 0.375rem !important;
          opacity: 0.5 !important;
          transition: opacity 0.2s ease !important;
        }
        .react-datepicker__navigation:hover {
          opacity: 1 !important;
        }
        .react-datepicker__navigation--previous {
          left: 0.25rem !important;
        }
        .react-datepicker__navigation--next {
          right: 0.25rem !important;
        }
        .react-datepicker__navigation-icon::before {
          border-color: #6b7280 !important;
          border-width: 2px 2px 0 0 !important;
          width: 6px !important;
          height: 6px !important;
          top: 9px !important;
        }
      `}),c.jsx(Tz,{selected:e,onChange:o,inline:!0,calendarStartDay:a,filterDate:l=>!s(l),autoFocus:i})]})}J4.displayName="Calendar";function kz({date:r,onDateChange:e,today:t}){const[n,a]=w.useState(!1);console.log("TripDatePicker rendering with date:",r);const i=s=>{console.log("Date selected:",s),e(s),s&&a(!1)},o=s=>{const l=new Date;return l.setHours(0,0,0,0),s<l};return c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"trip_date",className:"text-sm font-medium text-black",children:"Fecha del Viaje"}),c.jsxs(Yw,{open:n,onOpenChange:a,children:[c.jsx(Kw,{asChild:!0,children:c.jsxs(Ne,{variant:"outline",className:Le("w-full h-12 justify-start text-left font-normal bg-gray-100 border-0 hover:bg-white focus:bg-white focus:ring-2 focus:ring-black rounded-lg",!r&&"text-gray-500"),children:[c.jsx(Li,{className:"mr-3 h-4 w-4 text-gray-400"}),r?pt(r,"dd/MM/yyyy",{locale:Bn}):"Seleccionar fecha"]})}),c.jsx(bm,{className:"w-auto p-0 bg-white border-0 shadow-xl rounded-lg pointer-events-auto",align:"start",children:c.jsx(J4,{mode:"single",selected:r,onSelect:i,disabled:o,initialFocus:!0,weekStartsOn:0,className:"pointer-events-auto"})})]})]})}function Mz({value:r,onValueChange:e}){const t=o=>{switch(o){case"Barranquilla -> Curazao":return"Barranquilla -> Curazao";case"Curazao -> Barranquilla":return"Curazao -> Barranquilla";default:return o}},n=o=>{switch(o){case"Barranquilla -> Curazao":return"Barranquilla -> Curazao";case"Curazao -> Barranquilla":return"Curazao -> Barranquilla";default:return o}},a=o=>{const s=t(o);e(s)},i=n(r);return c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"route",className:"text-sm font-medium text-black",children:"Viaje"}),c.jsxs(Ca,{value:i,onValueChange:a,required:!0,children:[c.jsx(ia,{className:"h-12 bg-gray-100 border-0 hover:bg-white focus:bg-white focus:ring-2 focus:ring-black rounded-lg",children:c.jsx(Na,{placeholder:"Seleccionar viaje"})}),c.jsxs(oa,{className:"bg-white border-0 shadow-xl rounded-lg",children:[c.jsx(pr,{value:"Barranquilla -> Curazao",className:"h-12 cursor-pointer hover:bg-gray-50 focus:bg-gray-50",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"font-medium text-black",children:"Barranquilla"}),c.jsx(Lv,{className:"h-4 w-4 text-gray-400"}),c.jsx("span",{className:"font-medium text-black",children:"Curazao"})]})}),c.jsx(pr,{value:"Curazao -> Barranquilla",className:"h-12 cursor-pointer hover:bg-gray-50 focus:bg-gray-50",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("span",{className:"font-medium text-black",children:"Curazao"}),c.jsx(Lv,{className:"h-4 w-4 text-gray-400"}),c.jsx("span",{className:"font-medium text-black",children:"Barranquilla"})]})})]})]})]})}function Rz({value:r,onValueChange:e}){return c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"flight_number",className:"text-sm font-medium text-black",children:"Número de Vuelo (Opcional)"}),c.jsx(It,{id:"flight_number",value:r,onChange:t=>e(t.target.value),placeholder:"AV123",className:"uber-input"})]})}function Lz(){return Rt({queryKey:["travelers"],queryFn:async()=>{const{data:r,error:e}=await xe.from("travelers").select("*").order("first_name",{ascending:!0});if(e)throw e;return r}})}function Fz({selectedTravelerId:r,onTravelerChange:e,onAddNewTraveler:t}){const{data:n=[],isLoading:a}=Lz();return c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"traveler",children:"Viajero *"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs(Ca,{value:r,onValueChange:e,required:!0,children:[c.jsx(ia,{className:"flex-1",children:c.jsx(Na,{placeholder:a?"Cargando...":"Seleccionar viajero"})}),c.jsx(oa,{children:n.map(i=>c.jsxs(pr,{value:i.id,children:[i.first_name," ",i.last_name," - ",i.phone]},i.id))})]}),c.jsx(Ne,{type:"button",variant:"outline",size:"icon",onClick:t,title:"Agregar nuevo viajero",children:c.jsx(ao,{className:"h-4 w-4"})})]})]})}function Bz({open:r,onOpenChange:e,onSuccess:t}){const[n,a]=w.useState({first_name:"",last_name:"",phone:""}),i=Gr(),{toast:o}=Lt(),s=ln({mutationFn:async d=>{const{data:f,error:h}=await xe.from("travelers").insert(d).select().single();if(h)throw h;return f},onSuccess:d=>{o({title:"Viajero creado",description:"El viajero ha sido creado exitosamente"}),i.invalidateQueries({queryKey:["travelers"]}),a({first_name:"",last_name:"",phone:""}),t(d.id),e(!1)},onError:d=>{console.error("Error creating traveler:",d),o({title:"Error",description:"No se pudo crear el viajero. Por favor intente nuevamente.",variant:"destructive"})}}),l=d=>{if(d.preventDefault(),!n.first_name.trim()||!n.last_name.trim()||!n.phone.trim()){o({title:"Error",description:"Todos los campos son obligatorios",variant:"destructive"});return}s.mutate(n)},u=(d,f)=>{a(h=>({...h,[d]:f}))};return c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[400px]",children:[c.jsxs(Kr,{children:[c.jsx(Xr,{children:"Nuevo Viajero"}),c.jsx(sa,{children:"Crea un nuevo viajero para asignar al viaje."})]}),c.jsxs("form",{onSubmit:l,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"first_name",children:"Nombre"}),c.jsx(It,{id:"first_name",value:n.first_name,onChange:d=>u("first_name",d.target.value),placeholder:"Nombre del viajero",required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"last_name",children:"Apellido"}),c.jsx(It,{id:"last_name",value:n.last_name,onChange:d=>u("last_name",d.target.value),placeholder:"Apellido del viajero",required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"phone",children:"Teléfono"}),c.jsx(It,{id:"phone",value:n.phone,onChange:d=>u("phone",d.target.value),placeholder:"+57 300 123 4567",required:!0})]}),c.jsxs(rs,{className:"gap-3",children:[c.jsx(Ne,{type:"button",variant:"secondary",onClick:()=>e(!1),children:"Cancelar"}),c.jsx(Ne,{type:"submit",disabled:s.isPending,children:s.isPending?"Creando...":"Crear Viajero"})]})]})]})})}function $z({open:r,onOpenChange:e,onSuccess:t,initialDate:n}){const[a,i]=w.useState(!1),{formData:o,updateFormData:s,date:l,setDate:u,today:d,isLoading:f,handleSubmit:h}=yV(t,n),p=!!n,g=p?n:l,v=b=>{s({traveler_id:b}),i(!1)};return c.jsxs(c.Fragment,{children:[c.jsx(un,{open:r,onOpenChange:e,children:c.jsxs(Yr,{className:"sm:max-w-[500px] max-h-[90vh] uber-dialog flex flex-col",children:[c.jsxs(Kr,{className:"space-y-3 pb-6 flex-shrink-0",children:[c.jsx(Xr,{className:"text-2xl font-bold text-black",children:"Nuevo Viaje"}),c.jsx(sa,{className:"text-gray-600",children:p&&g?`Crea un nuevo viaje para el ${pt(g,"dd/MM/yyyy",{locale:Bn})}`:"Crea un nuevo viaje para agrupar encomiendas."})]}),c.jsxs("form",{onSubmit:h,className:"flex-1 flex flex-col min-h-0",children:[c.jsxs("div",{className:"flex-1 overflow-y-auto space-y-4",children:[p?c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"text-sm font-medium text-black",children:"Fecha del Viaje"}),c.jsx("div",{className:"w-full h-12 px-3 py-2 bg-gray-100 border rounded-lg flex items-center text-gray-700",children:g?pt(g,"dd/MM/yyyy",{locale:Bn}):"Fecha no válida"})]}):c.jsx(kz,{date:l,onDateChange:u,today:d}),c.jsx(Mz,{value:o.route,onValueChange:b=>s({route:b})}),c.jsx(Fz,{selectedTravelerId:o.traveler_id,onTravelerChange:b=>s({traveler_id:b}),onAddNewTraveler:()=>i(!0)}),c.jsx(Rz,{value:o.flight_number,onValueChange:b=>s({flight_number:b})})]}),c.jsxs(rs,{className:"gap-3 pt-6 flex-shrink-0",children:[c.jsx(Ne,{type:"button",variant:"secondary",onClick:()=>e(!1),className:"flex-1",children:"Cancelar"}),c.jsx(Ne,{type:"submit",disabled:f,className:"flex-1 uber-button-primary",children:f?"Creando...":"Crear Viaje"})]})]})]})}),c.jsx(Bz,{open:a,onOpenChange:i,onSuccess:v})]})}function ev({packageDialogOpen:r,setPackageDialogOpen:e,onPackageSuccess:t,selectedTripId:n,tripDialogOpen:a,onTripDialogChange:i,onTripSuccess:o,selectedDate:s}){return c.jsxs(c.Fragment,{children:[c.jsx(pV,{open:r,onOpenChange:e,onSuccess:t,tripId:n}),c.jsx($z,{open:a,onOpenChange:i,onSuccess:o,initialDate:s})]})}function Uz({activeTab:r,setActiveTab:e,unreadCount:t,packageStats:n,customersCount:a,packages:i,filteredPackages:o,isLoading:s,trips:l,tripsLoading:u,viewingPackagesByDate:d,onNewPackage:f,onNewTrip:h,onMobileDelivery:p,onPackagesUpdate:g,onAddPackageToTrip:v,onCreateTripFromCalendar:b,onViewPackagesByDate:y,onBackToCalendar:C,packageDialogOpen:S,setPackageDialogOpen:j,onPackageSuccess:D,selectedTripId:F,tripDialogOpen:M,onTripDialogChange:T,onTripSuccess:q,selectedDate:J}){return c.jsxs("main",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[c.jsx(pm,{activeTab:r,onTabChange:e,unreadCount:t,previewRole:"traveler"}),c.jsxs(Us,{value:r,onValueChange:e,className:"mt-4 sm:mt-8",children:[c.jsx(Ig,{packageStats:n,customersCount:a,onNewPackage:f,onNewTrip:h,onViewNotifications:()=>{},onMobileDelivery:p,packages:i,filteredPackages:o,isLoading:s,onUpdate:g}),c.jsx(kg,{viewingPackagesByDate:d,trips:l,tripsLoading:u,onAddPackage:v,onCreateTrip:b,onViewPackagesByDate:y,onBack:C}),c.jsx(Fg,{}),c.jsx(q4,{}),c.jsx(v4,{})]}),c.jsx(ev,{packageDialogOpen:S,setPackageDialogOpen:j,onPackageSuccess:D,selectedTripId:F,tripDialogOpen:M,onTripDialogChange:T,onTripSuccess:q,selectedDate:J})]})}function qz(){return c.jsxs("div",{className:"mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[c.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Permisos del Rol Viajero:"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-green-700 mb-2",children:"✅ Puede acceder a:"}),c.jsxs("ul",{className:"text-green-700 space-y-1",children:[c.jsx("li",{children:"• Dashboard (vista limitada)"}),c.jsx("li",{children:"• Crear nuevos paquetes"}),c.jsx("li",{children:"• Crear nuevos viajes"}),c.jsx("li",{children:"• Viajes (solo los asignados)"}),c.jsx("li",{children:"• Despachos (solo los relacionados)"}),c.jsx("li",{children:"• Deudores (solo los relacionados)"}),c.jsx("li",{children:"• Chat (funcionalidad básica)"}),c.jsx("li",{children:"• Entrega móvil"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"❌ No puede acceder a:"}),c.jsxs("ul",{className:"text-red-700 space-y-1",children:[c.jsx("li",{children:"• Notificaciones"}),c.jsx("li",{children:"• Gestión de usuarios"}),c.jsx("li",{children:"• Configuración del sistema"}),c.jsx("li",{children:"• Funciones administrativas"})]})]})]})]})}function Vz({onBack:r}){const[e,t]=w.useState(!1),{packagesData:n,trips:a,tripsLoading:i,refetchTrips:o,customersCount:s,packageStats:l,unreadCount:u,refetchUnreadMessages:d}=$g(),{searchTerm:f,setSearchTerm:h,packageDialogOpen:p,setPackageDialogOpen:g,tripDialogOpen:v,setTripDialogOpen:b,selectedTripId:y,setSelectedTripId:C,selectedDate:S,setSelectedDate:j,activeTab:D,setActiveTab:F,viewingPackagesByDate:M,setViewingPackagesByDate:T}=Ug(),{handleNewPackage:q,handleAddPackageToTrip:J,handleCreateTripFromCalendar:O,handleViewPackagesByDate:k,handlePackageSuccess:H,handleTripSuccess:X,handleTripDialogClose:ce,handlePackagesUpdate:Q,handleBackToCalendar:re}=qg({activeTab:D,refetchUnreadMessages:d,refetchTrips:o,packagesRefetch:n?.refetch||(()=>{}),setSelectedTripId:C,setPackageDialogOpen:g,setTripDialogOpen:b,setSelectedDate:j,setViewingPackagesByDate:T,setActiveTab:F}),G=()=>{t(!0)};w.useEffect(()=>{d()},[]);const Y=n?.data||[],ge=n?.isLoading||!1,ye=Y.filter(ee=>{const oe=f.toLowerCase();return ee.tracking_number.toLowerCase().includes(oe)||ee.description.toLowerCase().includes(oe)||ee.customers?.name.toLowerCase().includes(oe)}),A={total:Math.floor(l?.total/3)||5,recibido:Math.floor(l?.recibido/3)||2,bodega:Math.floor(l?.bodega/3)||1,procesado:Math.floor(l?.procesado/3)||1,transito:Math.floor(l?.transito/3)||1,en_destino:0,delivered:0,pending:Math.floor(l?.pending/3)||2,inTransit:Math.floor(l?.inTransit/3)||1},$=Y.slice(0,3),V=ye.slice(0,3),K=a.filter(ee=>ee.traveler_id==="current-traveler-id");return e?c.jsx(Xg,{onClose:()=>t(!1)}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx(Vq,{onBack:r}),c.jsx(dm,{searchTerm:f,onSearchChange:h}),c.jsx(Uz,{activeTab:D,setActiveTab:F,unreadCount:u,packageStats:A,customersCount:Math.floor(s/3),packages:$,filteredPackages:V,isLoading:ge,trips:K,tripsLoading:i,viewingPackagesByDate:M,onNewPackage:q,onNewTrip:()=>O(new Date),onMobileDelivery:G,onPackagesUpdate:Q,onAddPackageToTrip:J,onCreateTripFromCalendar:O,onViewPackagesByDate:k,onBackToCalendar:re,packageDialogOpen:p,setPackageDialogOpen:g,onPackageSuccess:H,selectedTripId:y,tripDialogOpen:v,onTripDialogChange:ce,onTripSuccess:X,selectedDate:S}),c.jsx(qz,{})]})}function zz({onBack:r}){const[e,t]=w.useState(!1),{packagesData:n,trips:a,tripsLoading:i,refetchTrips:o,customersCount:s,packageStats:l,unreadCount:u,refetchUnreadMessages:d}=$g(),{searchTerm:f,setSearchTerm:h,packageDialogOpen:p,setPackageDialogOpen:g,tripDialogOpen:v,setTripDialogOpen:b,selectedTripId:y,setSelectedTripId:C,selectedDate:S,setSelectedDate:j,activeTab:D,setActiveTab:F,viewingPackagesByDate:M,setViewingPackagesByDate:T}=Ug(),{handleNewPackage:q,handleAddPackageToTrip:J,handleCreateTripFromCalendar:O,handleViewPackagesByDate:k,handlePackageSuccess:H,handleTripSuccess:X,handleTripDialogClose:ce,handlePackagesUpdate:Q,handleBackToCalendar:re}=qg({activeTab:D,refetchUnreadMessages:d,refetchTrips:o,packagesRefetch:n?.refetch||(()=>{}),setSelectedTripId:C,setPackageDialogOpen:g,setTripDialogOpen:b,setSelectedDate:j,setViewingPackagesByDate:T,setActiveTab:F}),G=()=>{t(!0)};w.useEffect(()=>{d()},[]);const Y=n?.data||[],ge=n?.isLoading||!1,ye=Y.filter(ee=>{const oe=f.toLowerCase();return ee.tracking_number.toLowerCase().includes(oe)||ee.description.toLowerCase().includes(oe)||ee.customers?.name.toLowerCase().includes(oe)}),A=l,$=Y,V=ye,K=a;return e?c.jsx(Xg,{onClose:()=>t(!1)}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsxs(Fi,{className:"mb-4 border-blue-200 bg-blue-50",children:[c.jsx(Gy,{className:"h-4 w-4"}),c.jsxs(Bi,{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-blue-800",children:[c.jsx("strong",{children:"Vista Preview:"})," Panel como Empleado - Acceso a operaciones diarias sin gestión de usuarios, chat, deudores, notificaciones o configuración"]}),c.jsxs(Ne,{variant:"outline",size:"sm",onClick:r,className:"ml-4",children:[c.jsx(Jo,{className:"h-4 w-4 mr-2"}),"Volver"]})]})]}),c.jsx(dm,{searchTerm:f,onSearchChange:h}),c.jsxs("main",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[c.jsx(pm,{activeTab:D,onTabChange:F,unreadCount:u,previewRole:"employee"}),c.jsxs(Us,{value:D,onValueChange:F,className:"mt-4 sm:mt-8",children:[c.jsx(Ig,{packageStats:A,customersCount:s,onNewPackage:q,onNewTrip:()=>O(new Date),onViewNotifications:()=>{},onMobileDelivery:G,packages:$,filteredPackages:V,isLoading:ge,onUpdate:Q,disableChat:!0,previewRole:"employee"}),c.jsx(kg,{viewingPackagesByDate:M,trips:K,tripsLoading:i,onAddPackage:J,onCreateTrip:O,onViewPackagesByDate:k,onBack:re,disableChat:!0,previewRole:"employee"}),c.jsx(Fg,{})]}),c.jsx(ev,{packageDialogOpen:p,setPackageDialogOpen:g,onPackageSuccess:H,selectedTripId:y,tripDialogOpen:v,onTripDialogChange:ce,onTripSuccess:X,selectedDate:S}),c.jsxs("div",{className:"mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[c.jsx("h3",{className:"font-semibold text-yellow-800 mb-2",children:"Permisos del Rol Empleado:"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-green-700 mb-2",children:"✅ Puede acceder a:"}),c.jsxs("ul",{className:"text-green-700 space-y-1",children:[c.jsx("li",{children:"• Dashboard completo"}),c.jsx("li",{children:"• Gestión completa de encomiendas"}),c.jsx("li",{children:"• Gestión de viajes"}),c.jsx("li",{children:"• Todos los despachos"}),c.jsx("li",{children:"• Entrega móvil"})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"❌ No puede acceder a:"}),c.jsxs("ul",{className:"text-red-700 space-y-1",children:[c.jsx("li",{children:"• Gestión de usuarios"}),c.jsx("li",{children:"• Chat con clientes"}),c.jsx("li",{children:"• Deudores"}),c.jsx("li",{children:"• Notificaciones"}),c.jsx("li",{children:"• Configuración del sistema"}),c.jsx("li",{children:"• Funciones administrativas"})]})]})]})]})]})]})}function Hz(){const[r,e]=w.useState(null);if(r==="traveler")return c.jsx(Vz,{onBack:()=>e(null)});if(r==="employee")return c.jsx(zz,{onBack:()=>e(null)});const t=[{role:"admin",title:"Administrador",description:"Acceso completo a todas las funciones del sistema",icon:$o,color:"bg-red-500",features:["Panel de usuarios","Gestión completa de encomiendas","Configuración del sistema","Reportes y estadísticas","Notificaciones","Gestión de viajeros","Entrega móvil"]},{role:"employee",title:"Empleado",description:"Acceso a operaciones diarias sin gestión de usuarios, notificaciones o configuración",icon:Gy,color:"bg-blue-500",features:["Gestión de encomiendas","Gestión de viajes","Chat con clientes","Despachos","Deudores","Entrega móvil","Sin acceso a notificaciones, usuarios o configuración"]},{role:"traveler",title:"Viajero",description:"Puede crear paquetes y viajes, acceso a sus asignaciones y entrega móvil",icon:Rn,color:"bg-green-500",features:["Crear nuevos paquetes","Crear nuevos viajes","Ver viajes asignados","Ver despachos relacionados","Ver deudores relacionados","Chat básico","Entrega móvil","Sin acceso a notificaciones, usuarios o configuración"]}];return c.jsx("div",{className:"space-y-6",children:c.jsxs(He,{children:[c.jsx(yt,{children:c.jsxs(Nt,{className:"flex items-center gap-2",children:[c.jsx(wu,{className:"h-5 w-5"}),"Vista Preview por Roles"]})}),c.jsxs(We,{children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Selecciona un rol para ver cómo se ve el panel desde la perspectiva de ese usuario."}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:t.map(n=>{const a=n.icon,i=n.role==="traveler"||n.role==="employee";return c.jsx(He,{className:"hover:shadow-md transition-shadow cursor-pointer",children:c.jsxs(We,{className:"p-6",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:`p-2 rounded-lg ${n.color} text-white`,children:c.jsx(a,{className:"h-5 w-5"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold",children:n.title}),c.jsx(Ot,{variant:"outline",className:"text-xs",children:n.role})]})]}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:n.description}),c.jsxs("div",{className:"space-y-2 mb-4",children:[c.jsx("h4",{className:"text-sm font-medium",children:"Funciones disponibles:"}),c.jsx("ul",{className:"text-xs text-gray-600 space-y-1",children:n.features.map((o,s)=>c.jsxs("li",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-1 h-1 bg-gray-400 rounded-full"}),o]},s))})]}),c.jsxs(Ne,{variant:"outline",className:"w-full",onClick:()=>e(n.role),disabled:!i,children:[c.jsx(wu,{className:"h-4 w-4 mr-2"}),i?"Ver Preview":"Próximamente"]})]})},n.role)})})]})]})})}function Wz(){return c.jsx(xn,{value:"developer",className:"space-y-4 sm:space-y-6",children:c.jsx(Hz,{})})}function Gz(){const[r,e]=w.useState(!1),{packagesData:t,trips:n,tripsLoading:a,refetchTrips:i,customersCount:o,packageStats:s,unreadCount:l,refetchUnreadMessages:u}=$g(),{searchTerm:d,setSearchTerm:f,packageDialogOpen:h,setPackageDialogOpen:p,tripDialogOpen:g,setTripDialogOpen:v,selectedTripId:b,setSelectedTripId:y,selectedDate:C,setSelectedDate:S,activeTab:j,setActiveTab:D,viewingPackagesByDate:F,setViewingPackagesByDate:M}=Ug(),{handleNewPackage:T,handleAddPackageToTrip:q,handleCreateTripFromCalendar:J,handleViewPackagesByDate:O,handlePackageSuccess:k,handleTripSuccess:H,handleTripDialogClose:X,handleViewNotifications:ce,handlePackagesUpdate:Q,handleBackToCalendar:re}=qg({activeTab:j,refetchUnreadMessages:u,refetchTrips:i,packagesRefetch:t?.refetch||(()=>{}),setSelectedTripId:y,setPackageDialogOpen:p,setTripDialogOpen:v,setSelectedDate:S,setViewingPackagesByDate:M,setActiveTab:D}),G=()=>{e(!0)};w.useEffect(()=>{u()},[]);const Y=t?.data||[],ge=t?.isLoading||!1,ye=Y.filter(A=>{const $=d.toLowerCase();return A.tracking_number.toLowerCase().includes($)||A.description.toLowerCase().includes($)||A.customers?.name.toLowerCase().includes($)});return r?c.jsx(Xg,{onClose:()=>e(!1)}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx(dm,{searchTerm:d,onSearchChange:f}),c.jsxs("main",{className:"container mx-auto px-2 sm:px-4 py-4 sm:py-8",children:[c.jsx(pm,{activeTab:j,onTabChange:D,unreadCount:l}),c.jsxs(Us,{value:j,onValueChange:D,className:"mt-4 sm:mt-8",children:[c.jsx(Ig,{packageStats:s,customersCount:o,onNewPackage:T,onNewTrip:()=>J(new Date),onViewNotifications:ce,onMobileDelivery:G,packages:Y,filteredPackages:ye,isLoading:ge,onUpdate:Q}),c.jsx(kg,{viewingPackagesByDate:F,trips:n,tripsLoading:a,onAddPackage:q,onCreateTrip:J,onViewPackagesByDate:O,onBack:re}),c.jsx(Fg,{}),c.jsx(q4,{}),c.jsx(v4,{}),c.jsx(pF,{}),c.jsx(jF,{}),c.jsx(wF,{}),c.jsx(Wz,{})]}),c.jsx(ev,{packageDialogOpen:h,setPackageDialogOpen:p,onPackageSuccess:k,selectedTripId:b,tripDialogOpen:g,onTripDialogChange:X,onTripSuccess:H,selectedDate:C})]})]})}function Yz(){const[r,e]=w.useState(!0),[t,n]=w.useState(""),[a,i]=w.useState(""),[o,s]=w.useState(!1),{signIn:l,signUp:u}=$s(),{toast:d}=Lt(),f=async h=>{if(h.preventDefault(),!t||!a){d({title:"Error",description:"Por favor completa todos los campos",variant:"destructive"});return}s(!0);try{const{error:p}=r?await l(t,a):await u(t,a);if(p){let g="Ha ocurrido un error";p.message.includes("Invalid login credentials")?g="Credenciales inválidas":p.message.includes("User already registered")?g="El usuario ya está registrado":p.message.includes("Password should be at least")?g="La contraseña debe tener al menos 6 caracteres":p.message.includes("Invalid email")&&(g="Email inválido"),d({title:"Error",description:g,variant:"destructive"})}else r||d({title:"Cuenta creada",description:"Revisa tu email para confirmar tu cuenta"})}catch{d({title:"Error",description:"Ha ocurrido un error inesperado",variant:"destructive"})}finally{s(!1)}};return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:c.jsxs(He,{className:"w-full max-w-md",children:[c.jsxs(yt,{className:"space-y-1",children:[c.jsx(Nt,{className:"text-2xl text-center",children:r?"Iniciar Sesión":"Crear Cuenta"}),c.jsx(Hr,{className:"text-center",children:r?"Ingresa tus credenciales para acceder":"Crea una nueva cuenta para comenzar"})]}),c.jsxs(We,{children:[c.jsxs("form",{onSubmit:f,className:"space-y-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"email",children:"Email"}),c.jsx(It,{id:"email",type:"email",placeholder:"tu@email.com",value:t,onChange:h=>n(h.target.value),disabled:o,required:!0})]}),c.jsxs("div",{className:"space-y-2",children:[c.jsx(at,{htmlFor:"password",children:"Contraseña"}),c.jsx(It,{id:"password",type:"password",placeholder:"Tu contraseña",value:a,onChange:h=>i(h.target.value),disabled:o,required:!0})]}),c.jsxs(Ne,{type:"submit",className:"w-full",disabled:o,children:[o&&c.jsx(Qy,{className:"mr-2 h-4 w-4 animate-spin"}),r?"Iniciar Sesión":"Crear Cuenta"]})]}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx("button",{type:"button",onClick:()=>e(!r),className:"text-sm text-blue-600 hover:underline",disabled:o,children:r?"¿No tienes cuenta? Crear una":"¿Ya tienes cuenta? Iniciar sesión"})})]})]})})}const Kz=()=>{const r=gh();return w.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",r.pathname)},[r.pathname]),c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),c.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),c.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},Xz=new lE({defaultOptions:{queries:{retry:!1,refetchOnWindowFocus:!1}}});function Qz(){const{user:r,loading:e}=$s();return w.useEffect(()=>{console.log("AppRoutes - user:",r,"loading:",e)},[r,e]),e?c.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-black mx-auto mb-4"}),c.jsx("p",{className:"text-black font-medium",children:"Cargando..."})]})}):c.jsxs(hA,{children:[c.jsx(wf,{path:"/auth",element:r?c.jsx(q0,{to:"/",replace:!0}):c.jsx(Yz,{})}),c.jsx(wf,{path:"/",element:r?c.jsx(bA,{children:c.jsx(Gz,{})}):c.jsx(q0,{to:"/auth",replace:!0})}),c.jsx(wf,{path:"*",element:r?c.jsx(Kz,{}):c.jsx(q0,{to:"/auth",replace:!0})})]})}const Zz=()=>(console.log("App component rendering"),c.jsx(pE,{client:Xz,children:c.jsx(yA,{children:c.jsx(GS,{children:c.jsxs("div",{className:"min-h-screen bg-white",children:[c.jsx(tS,{}),c.jsx(DS,{}),c.jsx(gA,{children:c.jsx(Qz,{})})]})})})})),sy=document.getElementById("root");sy?zy(sy).render(c.jsx(Zz,{})):console.error("Root element not found");export{ir as _};
